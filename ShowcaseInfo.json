{
    "escu_stories": {
        "0432039c-ef41-4b03-b157-450c25dad1e6": {
            "author": "Rod Soto, Splunk",
            "description": "Track when a user assumes an IAM role in another GCP account to obtain cross-account access to services and resources in that account. Accessing new roles could be an indication of malicious activity.",
            "detections": [
                "gcp_detect_accounts_with_high_risk_roles_by_project",
                "gcp_detect_gcploit_framework",
                "gcp_detect_high_risk_permissions_by_resource_and_account",
                "gcp_detect_oauth_token_abuse"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Get Notable History"
            ],
            "modification_date": "2020-09-01",
            "name": "GCP Cross Account Activity",
            "narrative": "Google Cloud Platform (GCP) admins manage access to GCP resources and services across the enterprise using GCP Identity and Access Management (IAM) functionality. IAM provides the ability to create and manage GCP users, groups, and roles-each with their own unique set of privileges and defined access to specific resources (such as Compute instances, the GCP Management Console, API, or the command-line interface). Unlike conventional (human) users, IAM roles are potentially assumable by anyone in the organization. They provide users with dynamically created temporary security credentials that expire within a set time period.\\\nIn between the time between when the temporary credentials are issued and when they expire is a period of opportunity, where a user could leverage the temporary credentials to wreak havoc-spin up or remove instances, create new users, elevate privileges, and other malicious activities-throughout the environment.\\\nThis Analytic Story includes searches that will help you monitor your GCP Audit logs logs for evidence of suspicious cross-account activity.  For example, while accessing multiple GCP accounts and roles may be perfectly valid behavior, it may be suspicious when an account requests privileges of an account it has not accessed in the past. After identifying suspicious activities, you can use the provided investigative searches to help you probe more deeply.",
            "references": [
                "https://cloud.google.com/iam/docs/understanding-service-accounts"
            ],
            "responses": [],
            "story_id": "0432039c-ef41-4b03-b157-450c25dad1e6",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef": {
            "author": "Rico Valdez, Splunk",
            "description": "Monitor for suspicious activities associated with DHS Technical Alert US-CERT TA18-074A. Some of the activities that adversaries used in these compromises included spearfishing attacks, malware, watering-hole domains, many and more.",
            "detections": [
                "first_time_seen_command_line_argument",
                "create_local_admin_accounts_using_net_exe",
                "detect_new_local_admin_account",
                "detect_psexec_with_accepteula_flag",
                "first_time_seen_command_line_argument",
                "malicious_powershell_process_-_execution_policy_bypass",
                "processes_launching_netsh",
                "registry_keys_used_for_persistence",
                "sc_exe_manipulating_windows_services",
                "scheduled_task_deleted_or_created_via_cmd",
                "scheduled_task_name_used_by_dragonfly_threat_actors",
                "single_letter_process_on_endpoint",
                "suspicious_reg_exe_process",
                "detect_outbound_smb_traffic",
                "smb_traffic_spike",
                "smb_traffic_spike_-_mltk"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Process Registry Activity",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process File Activity",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Process Registry Activity",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-01-22",
            "name": "DHS Report TA18-074A",
            "narrative": "The frequency of nation-state cyber attacks has increased significantly over the last decade. Employing numerous tactics and techniques, these attacks continue to escalate in complexity. \\\nThere is a wide range of motivations for these state-sponsored hacks, including stealing valuable corporate, military, or diplomatic data&#1151;all of which could confer advantages in various arenas. They may also target critical infrastructure. \\\nOne joint Technical Alert (TA) issued by the Department of Homeland and the FBI in mid-March of 2018 attributed some cyber activity targeting utility infrastructure to operatives sponsored by the Russian government. The hackers executed spearfishing attacks, installed malware, employed watering-hole domains, and more. While they caused no physical damage, the attacks provoked fears that a nation-state could turn off water, redirect power, or compromise a nuclear power plant.\\\nSuspicious activities--spikes in SMB traffic, processes that launch netsh (to modify the network configuration), suspicious registry modifications, and many more--may all be events you may wish to investigate further. While the use of these technique may be an indication that a nation-state actor is attempting to compromise your environment, it is important to note that these techniques are often employed by other groups, as well.",
            "references": [
                "https://www.us-cert.gov/ncas/alerts/TA18-074A"
            ],
            "responses": [],
            "story_id": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "support": [
                "Baseline of SMB Traffic - MLTK",
                "Previously seen command line arguments"
            ],
            "type": "ESCU",
            "version": 2
        },
        "1a51dd71-effc-48b2-abc4-3e9cdb61e5b9": {
            "author": "Patrick Bareiss, Splunk",
            "description": "This story is focused around detecting Office 365 Attacks.",
            "detections": [
                "high_number_of_login_failures_from_a_single_source",
                "o365_suspicious_admin_email_forwarding",
                "o365_suspicious_rights_delegation",
                "o365_suspicious_user_email_forwarding"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [],
            "modification_date": "2020-12-16",
            "name": "Office 365 Detections",
            "narrative": "More and more companies are using Microsofts Office 365 cloud offering. Therefore, we see more and more attacks against Office 365. This story provides various detections for Office 365 attacks.",
            "references": [
                "https://i.blackhat.com/USA-20/Thursday/us-20-Bienstock-My-Cloud-Is-APTs-Cloud-Investigating-And-Defending-Office-365.pdf"
            ],
            "responses": [],
            "story_id": "1a51dd71-effc-48b2-abc4-3e9cdb61e5b9",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "1ed5ce7d-5469-4232-92af-89d1a3595b39": {
            "author": "David Dorsey, Splunk",
            "description": "Detect and investigate suspicious activities by users and roles in your cloud environments.",
            "detections": [
                "abnormally_high_number_of_cloud_infrastructure_api_calls",
                "abnormally_high_number_of_cloud_security_group_api_calls",
                "cloud_api_calls_from_previously_unseen_user_roles"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN"
            ],
            "modification_date": "2020-09-04",
            "name": "Suspicious Cloud User Activities",
            "narrative": "It seems obvious that it is critical to monitor and control the users who have access to your cloud infrastructure. Nevertheless, it's all too common for enterprises to lose track of ad-hoc accounts, leaving their servers vulnerable to attack. In fact, this was the very oversight that led to Tesla's cryptojacking attack in February, 2018.\\\nIn addition to compromising the security of your data, when bad actors leverage your compute resources, it can incur monumental costs, since you will be billed for any new instances and increased bandwidth usage.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf",
                "https://redlock.io/blog/cryptojacking-tesla"
            ],
            "responses": [],
            "story_id": "1ed5ce7d-5469-4232-92af-89d1a3595b39",
            "support": [
                "Baseline Of Cloud Infrastructure API Calls Per User",
                "Baseline Of Cloud Security Group API Calls Per User",
                "Previously Seen Cloud API Calls Per User Role - Initial",
                "Previously Seen Cloud API Calls Per User Role - Update"
            ],
            "type": "ESCU",
            "version": 1
        },
        "1f5294cb-b85f-4c2d-9c58-ffcf248f52bd": {
            "author": "Bhavin Patel, Splunk",
            "description": "In March of 2016, adversaries were seen using JexBoss--an open-source utility used for testing and exploiting JBoss application servers. These searches help detect evidence of these attacks, such as network connections to external resources or web services spawning atypical child processes, among others.",
            "detections": [
                "detect_attackers_scanning_for_vulnerable_jboss_servers",
                "detect_malicious_requests_to_exploit_jboss_servers"
            ],
            "escu_category": [
                "Vulnerability"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host"
            ],
            "modification_date": "2017-09-14",
            "name": "JBoss Vulnerability",
            "narrative": "This Analytic Story looks for probing and exploitation attempts targeting JBoss application servers. While the vulnerabilities associated with this story are rather dated, they were leveraged in a spring 2016 campaign in connection with the Samsam ransomware variant. Incidents involving this ransomware are unique, in that they begin with attacks against vulnerable services, rather than the phishing or drive-by attacks more common with ransomware. In this case, vulnerable JBoss applications appear to be the target of choice.\\\nIt is helpful to understand how often a notable event generated by this story occurs, as well as the commonalities between some of these events, both of which may provide clues about whether this is a common occurrence of minimal concern or a rare event that may require more extensive investigation. It may also help to understand whether the issue is restricted to a single user/system or whether it is broader in scope.\\\nWhen looking at the target of the behavior uncovered by the event, you should note the sensitivity of the user and or/system to help determine the potential impact. It is also helpful to identify other recent events involving the target. This can help tie different events together and give further situational awareness regarding the target host.\\\nVarious types of information for external systems should be reviewed and, potentially, collected if the incident is, indeed, judged to be malicious. This data may be useful for generating your own threat intelligence, so you can create future alerts.\\\nThe following factors may assist you in determining whether the event is malicious: \\\n1. Country of origin\\\n1. Responsible party\\\n1. Fully qualified domain names associated with the external IP address\\\n1. Registration of fully qualified domain names associated with external IP address Determining whether it is a dynamic domain frequently visited by others and/or how third parties categorize it can also help you qualify and understand the event and possible motivation for the attack. In addition, there are various sources that may provide reputation information on the IP address or domain name, which can assist you in determining whether the event is malicious in nature. Finally, determining whether there are other events associated with the IP address may help connect data points or expose other historic events that might be brought back into scope.\\\nGathering various data on the system of interest can sometimes help quickly determine whether something suspicious is happening. Some of these items include determining who else may have logged into the system recently, whether any unusual scheduled tasks exist, whether the system is communicating on suspicious ports, whether there are modifications to sensitive registry keys, and/or whether there are any known vulnerabilities on the system. This information can often highlight other activity commonly seen in attack scenarios or give more information about how the system may have been targeted.\\\nhen a specific service or application is targeted, it is often helpful to know the associated version, to help determine whether it is vulnerable to a specific exploit.\\\nIf you suspect an attack targeting a web server, it is helpful to look at some of the behavior of the web service to see if there is evidence that the service has been compromised. Some indications of this might be network connections to external resources, the web service spawning child processes that are not associated with typical behavior, and whether the service wrote any files that might be malicious in nature.\\\nIf a suspicious file is found, we can review more information about it to help determine if it is, in fact, malicious. Identifying the file type, any processes that opened the file, the processes that may have created and/or modified the file, and how many other systems potentially have this file can you determine whether the file is malicious. Also, determining the file hash and checking it against reputation sources, such as VirusTotal, can sometimes help you quickly determine if it is malicious in nature.\\\nOften, a simple inspection of a suspect process name and path can tell you if the system has been compromised. For example, if svchost.exe is found running from a location other than `C:\\Windows\\System32`, it is likely something malicious designed to hide in plain sight when simply reviewing process names. \\\nIt can also be helpful to examine various behaviors of and the parent of the process of interest. For example, if it turns out the process of interest is malicious, it would be good to see whether the parent process spawned other processes that might also warrant further scrutiny. If a process is suspect, a review of the network connections made around the time of the event and noting whether the process has spawned any child processes could be helpful in determining whether it is malicious or executing a malicious script.",
            "references": [
                "http://www.deependresearch.org/2016/04/jboss-exploits-view-from-victim.html"
            ],
            "responses": [],
            "story_id": "1f5294cb-b85f-4c2d-9c58-ffcf248f52bd",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "1fc34cbc-34e9-43ba-87ab-6811c9e95400": {
            "author": "David Dorsey, Splunk",
            "description": "Reduce the risk of CVE-2018-11409, an information disclosure vulnerability within some older versions of Splunk Enterprise, with searches designed to help ensure that your Splunk system does not leak information to authenticated users.",
            "detections": [
                "splunk_enterprise_information_disclosure"
            ],
            "escu_category": [
                "Vulnerability"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Investigate Web Activity From src ip",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Investigate Network Traffic From src ip",
                "Investigate Web Activity From src ip"
            ],
            "modification_date": "2018-06-14",
            "name": "Splunk Enterprise Vulnerability CVE-2018-11409",
            "narrative": "Although there have been no reports of it being exploited, Splunk Enterprise versions through 7.0.1 reportedly have a vulnerability that may expose information through a REST endpoint (read more here: https://www.splunk.com/view/SP-CAAAP5E#VulnerabilityDescriptionsandRatings). NIST has included it in its vulnerability database (read more here: https://nvd.nist.gov/vuln/detail/CVE-2018-11409). The REST endpoint that exposes system information is also necessary for the proper operation of Splunk clustering and instrumentation. Customers should upgrade to the latest version to reduce the risk of this vulnerability.\\\nSplunk Enterprise exposes partial information about the host operating system, hardware, and Splunk license. Splunk Enterprise before 6.6.0 exposes this information without authentication. Splunk Enterprise 6.6.0 and later exposes this information only to authenticated Splunk users. Based on the information exposure, Splunk characterizes this issue as a low severity impact.\\\nRead more in Splunk's official response: https://www.splunk.com/view/SP-CAAAP5E#VulnerabilityDescriptionsandRatings.\\\nA detection search within this Analytic Story looks for vulnerabilities described in CVE-2018-11409: Information Exposure (https://nvd.nist.gov/vuln/detail/CVE-2018-11409). If it turns up activities that may be specific, you can use the included investigative searches to return information regarding web activity and network traffic by src_ip.",
            "references": [
                "https://nvd.nist.gov/vuln/detail/CVE-2018-11409",
                "https://www.splunk.com/view/SP-CAAAP5E#VulnerabilityDescriptionsandRatings",
                "https://www.exploit-db.com/exploits/44865/"
            ],
            "responses": [],
            "story_id": "1fc34cbc-34e9-43ba-87ab-6811c9e95400",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "2574e6d9-7254-4751-8925-0447deeec8ea": {
            "author": "Rod Soto, Splunk",
            "description": "This story addresses detection and response of accounts acccesing Kubernetes cluster sensitive objects such as configmaps or secrets providing information on items such as user user, group. object, namespace and authorization reason.",
            "detections": [
                "aws_eks_kubernetes_cluster_sensitive_object_access",
                "kubernetes_aws_detect_service_accounts_forbidden_failure_access",
                "kubernetes_aws_detect_suspicious_kubectl_calls",
                "kubernetes_azure_detect_sensitive_object_access",
                "kubernetes_azure_detect_service_accounts_forbidden_failure_access",
                "kubernetes_azure_detect_suspicious_kubectl_calls",
                "kubernetes_gcp_detect_sensitive_object_access",
                "kubernetes_gcp_detect_service_accounts_forbidden_failure_access",
                "kubernetes_gcp_detect_suspicious_kubectl_calls"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Notable History",
                "Get Notable Info"
            ],
            "modification_date": "2020-05-20",
            "name": "Kubernetes Sensitive Object Access Activity",
            "narrative": "Kubernetes is the most used container orchestration platform, this orchestration platform contains sensitive objects within its architecture, specifically configmaps and secrets, if accessed by an attacker can lead to further compromise. These searches allow operator to detect suspicious requests against Kubernetes sensitive objects.",
            "references": [
                "https://www.splunk.com/en_us/blog/security/approaching-kubernetes-security-detecting-kubernetes-scan-with-splunk.html"
            ],
            "responses": [],
            "story_id": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "2574e6d9-7254-4751-8925-0447deeec8ew": {
            "author": "Rod Soto, Splunk",
            "description": "This story addresses detection and response around Sensitive Role usage within a Kubernetes clusters against cluster resources and namespaces.",
            "detections": [
                "kubernetes_aws_detect_most_active_service_accounts_by_pod",
                "kubernetes_aws_detect_rbac_authorization_by_account",
                "kubernetes_aws_detect_sensitive_role_access",
                "kubernetes_azure_detect_most_active_service_accounts_by_pod_namespace",
                "kubernetes_azure_detect_rbac_authorization_by_account",
                "kubernetes_azure_detect_sensitive_role_access",
                "kubernetes_gcp_detect_rbac_authorizations_by_account",
                "kubernetes_gcp_detect_most_active_service_accounts_by_pod",
                "kubernetes_gcp_detect_sensitive_role_access"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Notable History",
                "Get Notable Info"
            ],
            "modification_date": "2020-05-20",
            "name": "Kubernetes Sensitive Role Activity",
            "narrative": "Kubernetes is the most used container orchestration platform, this orchestration platform contains sensitive roles within its architecture, specifically configmaps and secrets, if accessed by an attacker can lead to further compromise. These searches allow operator to detect suspicious requests against Kubernetes role activities",
            "references": [
                "https://www.splunk.com/en_us/blog/security/approaching-kubernetes-security-detecting-kubernetes-scan-with-splunk.html"
            ],
            "responses": [],
            "story_id": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "2b1800dd-92f9-47dd-a981-fdf1351e5d55": {
            "author": "Bhavin Patel, Splunk",
            "description": "Monitor and detect registry changes initiated from remote locations, which can be a sign that an attacker has infiltrated your system.",
            "detections": [
                "reg_exe_used_to_hide_files_directories_via_registry_keys",
                "remote_registry_key_modifications",
                "suspicious_changes_to_file_associations",
                "disabling_remote_user_account_control",
                "monitor_registry_keys_for_print_monitors",
                "reg_exe_used_to_hide_files_directories_via_registry_keys",
                "registry_keys_for_creating_shim_databases",
                "registry_keys_used_for_persistence",
                "registry_keys_used_for_privilege_escalation",
                "remote_registry_key_modifications",
                "suspicious_changes_to_file_associations"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-05-31",
            "name": "Suspicious Windows Registry Activities",
            "narrative": "Attackers are developing increasingly sophisticated techniques for hijacking target servers, while evading detection. One such technique that has become progressively more common is registry modification.\\\n The registry is a key component of the Windows operating system. It has a hierarchical database called \"registry\" that contains settings, options, and values for executables. Once the threat actor gains access to a machine, they can use reg.exe to modify their account to obtain administrator-level privileges, maintain persistence, and move laterally within the environment.\\\n The searches in this story are designed to help you detect behaviors associated with manipulation of the Windows registry.",
            "references": [
                "https://redcanary.com/blog/windows-registry-attacks-threat-detection/",
                "https://attack.mitre.org/wiki/Technique/T1112"
            ],
            "responses": [],
            "story_id": "2b1800dd-92f9-47dd-a981-fdf1351e5d55",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "2b1800dd-92f9-47dd-a981-fdf13w1q5d55": {
            "author": "Bhavin Patel, Splunk",
            "description": "Monitor and detect techniques used by attackers who leverage the mshta.exe process to execute malicious code.",
            "detections": [
                "detect_mshta_exe_running_scripts_in_command-line_arguments",
                "detect_prohibited_applications_spawning_cmd_exe",
                "registry_keys_used_for_persistence"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-02-03",
            "name": "Suspicious MSHTA Activity",
            "narrative": "One common adversary tactic is to bypass application white-listing solutions via the mshta.exe process, which executes Microsoft HTML applications with the .hta suffix. In these cases, attackers use the trusted Windows utility to eproxy execution of malicious files, whether an .hta application, javascript, or VBScript.\\\nOne example of a notable mshta.exe attack was the Kovter malware (https://medium.com/@mbromileyDFIR/malware-monday-aebb456356c5) that was implicated in ransomware and click-fraud attacks. Kovter utilized .hta to execute a series of javascript commands, each progressively more dangerous. According to the Mitre Parternship Network (https://attack.mitre.org/wiki/Technique/T1170), FIN7 has leveraged mshta.exe, as has the MuddyWater group, who used it to execute its POWERSTATS payload (which then used the utility to execute additional payloads).\\\nThe searches in this story help you detect and investigate suspicious activity that may indicate that an attacker is leveraging mshta.exe to execute malicious code.",
            "references": [
                "https://redcanary.com/blog/windows-registry-attacks-threat-detection/",
                "https://medium.com/@mbromileyDFIR/malware-monday-aebb456356c5",
                "https://attack.mitre.org/wiki/Technique/T1170"
            ],
            "responses": [],
            "story_id": "2b1800dd-92f9-47dd-a981-fdf13w1q5d55",
            "support": [
                "Baseline of Command Line Length - MLTK",
                "Previously seen command line arguments"
            ],
            "type": "ESCU",
            "version": 1
        },
        "2b1800dd-92f9-47ec-a981-fdf1351e5d55": {
            "author": "Bhavin Patel, Splunk",
            "description": "Email remains one of the primary means for attackers to gain an initial foothold within the modern enterprise. Detect and investigate suspicious emails in your environment with the help of the searches in this Analytic Story.",
            "detections": [
                "email_attachments_with_lots_of_spaces",
                "monitor_email_for_brand_abuse",
                "suspicious_email_-_uba_anomaly",
                "suspicious_email_attachment_extensions"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Get Authentication Logs For Endpoint",
                "Get Email Info",
                "Get Emails From Specific Sender",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host"
            ],
            "modification_date": "2020-01-27",
            "name": "Suspicious Emails",
            "narrative": "It is a common practice for attackers of all types to leverage targeted spearphishing campaigns and mass mailers to deliver weaponized email messages and attachments. Fortunately, there are a number of ways to monitor email data in Splunk to detect suspicious content.\\\nOnce a phishing message has been detected, the next steps are to answer the following questions: \\\n1. Which users have received this or a similar message in the past?\\\n1. When did the targeted campaign begin?\\\n1. Have any users interacted with the content of the messages (by downloading an attachment or clicking on a malicious URL)?This Analytic Story provides detection searches to identify suspicious emails, as well as contextual and investigative searches to help answer some of these questions.",
            "references": [
                "https://www.splunk.com/blog/2015/06/26/phishing-hits-a-new-level-of-quality/"
            ],
            "responses": [],
            "story_id": "2b1800dd-92f9-47ec-a981-fdf1351e5d55",
            "support": [
                "DNSTwist Domain Names"
            ],
            "type": "ESCU",
            "version": 1
        },
        "2b1800dd-92f9-47ec-a981-fdf1351e5f65": {
            "author": "Bhavin Patel, Splunk",
            "description": "Detect activities and various techniques associated with the abuse of `netsh.exe`, which can disable local firewall settings or set up a remote connection to a host from an infected system.",
            "detections": [
                "processes_created_by_netsh",
                "processes_created_by_netsh",
                "processes_launching_netsh"
            ],
            "escu_category": [
                "Abuse"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-01-05",
            "name": "Netsh Abuse",
            "narrative": "It is a common practice for attackers of all types to leverage native Windows tools and functionality to execute commands for malicious reasons. One such tool on Windows OS is `netsh.exe`,a command-line scripting utility that allows you to--either locally or remotely--display or modify the network configuration of a computer that is currently running. `Netsh.exe` can be used to discover and disable local firewall settings. It can also be used to set up a remote connection to a host from an infected system.\\\nTo get started, run the detection search to identify parent processes of `netsh.exe`.",
            "references": [
                "https://docs.microsoft.com/en-us/previous-versions/tn-archive/bb490939(v=technet.10)",
                "https://htmlpreview.github.io/?https://github.com/MatthewDemaske/blogbackup/blob/master/netshell.html",
                "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"
            ],
            "responses": [],
            "story_id": "2b1800dd-92f9-47ec-a981-fdf1351e5f65",
            "support": [
                "Baseline of SMB Traffic - MLTK",
                "Previously seen command line arguments"
            ],
            "type": "ESCU",
            "version": 1
        },
        "2c8ff66e-0b57-42af-8ad7-912438a403fc": {
            "author": "David Dorsey, Splunk",
            "description": "Attackers are finding stealthy ways \"live off the land,\" leveraging utilities and tools that come standard on the endpoint--such as PowerShell--to achieve their goals without downloading binary files. These searches can help you detect and investigate PowerShell command-line options that may be indicative of malicious intent.",
            "detections": [
                "malicious_powershell_process_-_multiple_suspicious_command-line_arguments",
                "malicious_powershell_process_with_obfuscation_techniques",
                "attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass",
                "malicious_powershell_process_-_connect_to_internet_with_hidden_window",
                "malicious_powershell_process_-_encoded_command",
                "malicious_powershell_process_-_multiple_suspicious_command-line_arguments",
                "malicious_powershell_process_with_obfuscation_techniques"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-08-23",
            "name": "Malicious PowerShell",
            "narrative": "The searches in this Analytic Story monitor for parameters often used for malicious purposes. It is helpful to understand how often the notable events generated by this story occur, as well as the commonalities between some of these events. These factors may provide clues about whether this is a common occurrence of minimal concern or a rare event that may require more extensive investigation. Likewise, it is important to determine whether the issue is restricted to a single user/system or is broader in scope.\\\nThe following factors may assist you in determining whether the event is malicious: \\\n1. Country of origin\\\n1. Responsible party\\\n1. Fully qualified domain names associated with the external IP address\\\n1. Registration of fully qualified domain names associated with external IP addressDetermining whether it is a dynamic domain frequently visited by others and/or how third parties categorize it can also help you answer some questions surrounding the attacker and details related to the external system. In addition, there are various sources--such as VirusTotal&#151; that can provide some reputation information on the IP address or domain name, which can assist in determining whether the event is malicious. Finally, determining whether there are other events associated with the IP address may help connect data points or show other events that should be brought into scope.\\\nGathering data on the system of interest can sometimes help you quickly determine whether something suspicious is happening. Some of these items include finding out who else may have recently logged into the system, whether any unusual scheduled tasks exist, whether the system is communicating on suspicious ports, whether there are modifications to sensitive registry keys, and whether there are any known vulnerabilities on the system. This information can often highlight other activity commonly seen in attack scenarios or give more information about how the system may have been targeted.\\\nOften, a simple inspection of the process name and path can tell you if the system has been compromised. For example, if `svchost.exe` is found running from a location other than `C:\\Windows\\System32`, it is likely something malicious designed to hide in plain sight when cursorily reviewing process names. Similarly, if the process itself seems legitimate, but the parent process is running from the temporary browser cache, that could be indicative of activity initiated via a compromised website a user visited.\\\nIt can also be very helpful to examine various behaviors of the process of interest or the parent of the process of interest. For example, if it turns out the process of interest is malicious, it would be good to see if the parent to that process spawned other processes that might be worth further scrutiny. If a process is suspect, a review of the network connections made in and around the time of the event and/or whether the process spawned any child processes could be helpful, as well.\\\nIn the event a system is suspected of having been compromised via a malicious website, we suggest reviewing the browsing activity from that system around the time of the event. If categories are given for the URLs visited, that can help you zero in on possible malicious sites.",
            "references": [
                "https://blogs.mcafee.com/mcafee-labs/malware-employs-powershell-to-infect-systems/",
                "https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/"
            ],
            "responses": [],
            "story_id": "2c8ff66e-0b57-42af-8ad7-912438a403fc",
            "support": [],
            "type": "ESCU",
            "version": 4
        },
        "2dcfd6a2-e7d2-4873-b6ba-adaf819d2a1e": {
            "author": "Rico Valdez, Splunk",
            "description": "Detect and investigate activities--such as unusually long `Content-Type` length, suspicious java classes and web servers executing suspicious processes--consistent with attempts to exploit Apache Struts vulnerabilities.",
            "detections": [
                "suspicious_java_classes",
                "web_servers_executing_suspicious_processes",
                "suspicious_java_classes",
                "unusually_long_content-type_length",
                "web_servers_executing_suspicious_processes",
                "unusually_long_content-type_length"
            ],
            "escu_category": [
                "Vulnerability"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Suspicious Strings in HTTP Header",
                "Investigate Web POSTs From src"
            ],
            "modification_date": "2018-12-06",
            "name": "Apache Struts Vulnerability",
            "narrative": "In March of 2017, a remote code-execution vulnerability in the Jakarta Multipart parser in Apache Struts, a widely used open-source framework for creating Java web applications, was disclosed and assigned to CVE-2017-5638. About two months later, hackers exploited the flaw to carry out the world's <a href=https://www.usatoday.com/story/tech/2017/09/07/nations-biggest-hacks-and-data-breaches-millions/644311001/> 5th largest data breach</a>. The target, credit giant Equifax, <a href=https://money.cnn.com/2017/09/16/technology/equifax-breach-security-hole/index.html>told investigators</a> that it had become aware of the vulnerability two months before the attack. \\\nThe exploit involved manipulating the `Content-Type HTTP` header to execute commands embedded in the header.\\\nThis Analytic Story contains two different searches that help to identify activity that may be related to this issue. The first search looks for characteristics of the `Content-Type` header consistent with attempts to exploit the vulnerability. This should be a relatively pertinent indicator, as the `Content-Type` header is generally consistent and does not have a large degree of variation.\\\nThe second search looks for the execution of various commands typically entered on the command shell when an attacker first lands on a system. These commands are not generally executed on web servers during the course of day-to-day operation, but they may be used when the system is undergoing maintenance or troubleshooting.\\\nFirst, it is helpful is to understand how often the notable event is generated, as well as the commonalities in some of these events. This may help determine whether this is a common occurrence that is of a lesser concern or a rare event that may require more extensive investigation. It can also help to understand whether the issue is restricted to a single user or system or is broader in scope.\\\nWhen looking at the target of the behavior illustrated by the event, you should note the sensitivity of the user and or/system to help determine the potential impact. It is also helpful to see what other events involving the target have occurred in the recent past. This can help tie different events together and give further situational awareness regarding the target.\\\nVarious types of information for external systems should be reviewed and (potentially) collected if the incident is, indeed, judged to be malicious. Information like this can be useful in generating your own threat intelligence to create alerts in the future.\\\nLooking at the country, responsible party, and fully qualified domain names associated with the external IP address--as well as the registration information associated with those domain names, if they are frequently visited by others--can help you answer the question of \"who,\" in regard to the external system. Answering that can help qualify the event and may serve useful for tracking. In addition, there are various sources that can provide some reputation information on the IP address or domain name, which can assist in determining if the event is malicious in nature. Finally, determining whether or not there are other events associated with the IP address may help connect some dots or show other events that should be brought into scope.\\\nGathering various data elements on the system of interest can sometimes help quickly determine that something suspicious may be happening. Some of these items include determining who else may have recently logged into the system, whether any unusual scheduled tasks exist, whether the system is communicating on suspicious ports, whether there are modifications to sensitive registry keys, and whether there are any known vulnerabilities on the system. This information can often highlight other activity commonly seen in attack scenarios or give more information about how the system may have been targeted.\\\nhen a specific service or application is targeted, it is often helpful to know the associated version to help determine whether or not it is vulnerable to a specific exploit.\\\nhen it is suspected there is an attack targeting a web server, it is helpful to look at some of the behavior of the web service to see if there is evidence that the service has been compromised. Some indications of this might be network connections to external resources, the web service spawning child processes that are not associated with typical behavior, and whether the service wrote any files that might be malicious in nature.\\\nIn the event that a suspicious file is found, we can review more information about it to help determine if it is, in fact, malicious. Identifying the file type, any processes that have the file open, what processes created and/or modified the file, and the number of systems that may have this file can help to determine if the file is malicious. Also, determining the file hash and checking it against reputation sources, such as VirusTotal, can sometimes quickly help determine whether it is malicious in nature.\\\nOften, a simple inspection of a suspect process name and path can tell you if the system has been compromised. For example, if `svchost.exe` is found running from a location other than `C:\\Windows\\System32`, it is likely something malicious designed to hide in plain sight when simply reviewing process names. Similarly, if the process itself seems legitimate, but the parent process is running from the temporary browser cache, there may be activity initiated via a compromised website the user visited.\\\nIt can also be very helpful to examine various behaviors of the process of interest or the parent of the process that is of interest. For example, if it turns out that the process of interest is malicious, it would be good to see if the parent to that process spawned other processes that might also be worth further scrutiny. If a process is suspect, reviewing the network connections made around the time of the event and/or if the process spawned any child processes could be helpful in determining whether it is malicious or executing a malicious script.",
            "references": [
                "https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.2/dev/rules/REQUEST-944-APPLICATION-ATTACK-JAVA.conf"
            ],
            "responses": [],
            "story_id": "2dcfd6a2-e7d2-4873-b6ba-adaf819d2a1e",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "2e8948a5-5239-406b-b56b-6c50f1268af3": {
            "author": "Bhavin Patel, Splunk",
            "description": "Use the searches in this Analytic Story to monitor your AWS EC2 instances for evidence of anomalous activity and suspicious behaviors, such as EC2 instances that originate from unusual locations or those launched by previously unseen users (among others). Included investigative searches will help you probe more deeply, when the information warrants it.",
            "detections": [
                "abnormally_high_aws_instances_launched_by_user",
                "abnormally_high_aws_instances_launched_by_user_-_mltk",
                "abnormally_high_aws_instances_terminated_by_user",
                "abnormally_high_aws_instances_terminated_by_user_-_mltk",
                "ec2_instance_started_in_previously_unseen_region",
                "ec2_instance_started_with_previously_unseen_user"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate Security Hub alerts by dest",
                "AWS Investigate User Activities By ARN",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Get EC2 Instance Details by instanceId",
                "Get EC2 Launch Details",
                "Get Notable History",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Investigate AWS activities via region name"
            ],
            "modification_date": "2018-02-09",
            "name": "Suspicious AWS EC2 Activities",
            "narrative": "AWS CloudTrail is an AWS service that helps you enable governance, compliance, and risk auditing within your AWS account. Actions taken by a user, role, or an AWS service are recorded as events in CloudTrail. It is crucial for a company to monitor events and actions taken in the AWS Console, AWS command-line interface, and AWS SDKs and APIs to ensure that your EC2 instances are not vulnerable to attacks. This Analytic Story identifies suspicious activities in your AWS EC2 instances and helps you respond and investigate those activities.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf"
            ],
            "responses": [],
            "story_id": "2e8948a5-5239-406b-b56b-6c50f1268af3",
            "support": [
                "Baseline of Excessive AWS Instances Launched by User - MLTK",
                "Baseline of Excessive AWS Instances Terminated by User - MLTK",
                "Previously Seen AWS Regions",
                "Previously Seen EC2 Launches By User"
            ],
            "type": "ESCU",
            "version": 1
        },
        "2e8948a5-5239-406b-b56b-6c50f1269af3": {
            "author": "Bhavin Patel, Splunk",
            "description": "Detect and investigate dormant user accounts for your AWS environment that have become active again. Because inactive and ad-hoc accounts are common attack targets, it's critical to enable governance within your environment.",
            "detections": [
                "detect_api_activity_from_users_without_mfa",
                "detect_aws_api_activities_from_unapproved_accounts",
                "detect_new_api_calls_from_user_roles",
                "detect_spike_in_aws_api_activity",
                "detect_spike_in_security_group_activity"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Notable History",
                "Get Notable Info",
                "Investigate AWS User Activities by user field"
            ],
            "modification_date": "2018-03-12",
            "name": "AWS User Monitoring",
            "narrative": "It seems obvious that it is critical to monitor and control the users who have access to your cloud infrastructure. Nevertheless, it's all too common for enterprises to lose track of ad-hoc accounts, leaving their servers vulnerable to attack. In fact, this was the very oversight that led to Tesla's cryptojacking attack in February, 2018.\\\nIn addition to compromising the security of your data, when bad actors leverage your compute resources, it can incur monumental costs, since you will be billed for any new EC2 instances and increased bandwidth usage. \\\nFortunately, you can leverage Amazon Web Services (AWS) CloudTrail--a tool that helps you enable governance, compliance, and risk auditing of your AWS account--to give you increased visibility into your user and resource activity by recording AWS Management Console actions and API calls. You can identify which users and accounts called AWS, the source IP address from which the calls were made, and when the calls occurred.\\\nThe detection searches in this Analytic Story are designed to help you uncover AWS API activities from users not listed in the identity table, as well as similar activities from disabled accounts.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf",
                "https://redlock.io/blog/cryptojacking-tesla"
            ],
            "responses": [],
            "story_id": "2e8948a5-5239-406b-b56b-6c50f1269af3",
            "support": [
                "Baseline of API Calls per User ARN",
                "Baseline of Security Group Activity by ARN",
                "Create a list of approved AWS service accounts",
                "Previously seen API call per user roles in CloudTrail"
            ],
            "type": "ESCU",
            "version": 1
        },
        "2e8948a5-5239-406b-b56b-6c50f2168af3": {
            "author": "Bhavin Patel, Splunk",
            "description": "Leverage these searches to monitor your AWS network traffic for evidence of anomalous activity and suspicious behaviors, such as a spike in blocked outbound traffic in your virtual private cloud (VPC).",
            "detections": [
                "detect_spike_in_blocked_outbound_traffic_from_your_aws"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "AWS Network ACL Details from ID",
                "AWS Network Interface details via resourceId",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get All AWS Activity From IP Address",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get DNS traffic ratio",
                "Get Notable History",
                "Get Notable Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-05-07",
            "name": "Suspicious AWS Traffic",
            "narrative": "A virtual private cloud (VPC) is an on-demand managed cloud-computing service that isolates computing resources for each client. Inside the VPC container, the environment resembles a physical network. \\\nAmazon's VPC service enables you to launch EC2 instances and leverage other Amazon resources. The traffic that flows in and out of this VPC can be controlled via network access-control rules and security groups. Amazon also has a feature called VPC Flow Logs that enables you to log IP traffic going to and from the network interfaces in your VPC. This data is stored using Amazon CloudWatch Logs.\\\n Attackers may abuse the AWS infrastructure with insecure VPCs so they can co-opt AWS resources for command-and-control nodes, data exfiltration, and more. Once an EC2 instance is compromised, an attacker may initiate outbound network connections for malicious reasons. Monitoring these network traffic behaviors is crucial for understanding the type of traffic flowing in and out of your network and to alert you to suspicious activities.\\\nThe searches in this Analytic Story will monitor your AWS network traffic for evidence of anomalous activity and suspicious behaviors.",
            "references": [
                "https://rhinosecuritylabs.com/aws/hiding-cloudcobalt-strike-beacon-c2-using-amazon-apis/"
            ],
            "responses": [],
            "story_id": "2e8948a5-5239-406b-b56b-6c50f2168af3",
            "support": [
                "Baseline of blocked outbound traffic from AWS"
            ],
            "type": "ESCU",
            "version": 1
        },
        "2e8948a5-5239-406b-b56b-6c50fe268af4": {
            "author": "Rico Valdez, Splunk",
            "description": "Detect evidence of tactics used to redirect traffic from a host to a destination other than the one intended--potentially one that is part of an adversary's attack infrastructure. An example is redirecting communications regarding patches and updates or misleading users into visiting a malicious website.",
            "detections": [
                "windows_hosts_file_modification",
                "windows_hosts_file_modification",
                "clients_connecting_to_multiple_dns_servers",
                "dns_query_requests_resolved_by_unauthorized_dns_servers"
            ],
            "escu_category": [
                "Abuse"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table"
            ],
            "modification_date": "2017-09-14",
            "name": "Host Redirection",
            "narrative": "Attackers will often attempt to manipulate client communications for nefarious purposes. In some cases, an attacker may endeavor to modify a local host file to redirect communications with resources (such as antivirus or system-update services) to prevent clients from receiving patches or updates. In other cases, an attacker might use this tactic to have the client connect to a site that looks like the intended site, but instead installs malware or collects information from the victim. Additionally, an attacker may redirect a victim in order to execute a MITM attack and observe communications.",
            "references": [
                "https://blog.malwarebytes.com/cybercrime/2016/09/hosts-file-hijacks/"
            ],
            "responses": [],
            "story_id": "2e8948a5-5239-406b-b56b-6c50fe268af4",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "2e8948a5-5239-406b-b56b-6c50ff268af4": {
            "author": "Bhavin Patel, Splunk",
            "description": "Monitor your AWS network infrastructure for bad configurations and malicious activity. Investigative searches help you probe deeper, when the facts warrant it.",
            "detections": [
                "aws_network_access_control_list_created_with_all_open_ports",
                "aws_network_access_control_list_deleted",
                "detect_spike_in_blocked_outbound_traffic_from_your_aws",
                "detect_spike_in_network_acl_activity"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "AWS Network ACL Details from ID",
                "AWS Network Interface details via resourceId",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get All AWS Activity From IP Address",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get DNS traffic ratio",
                "Get Notable History",
                "Get Notable Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-05-21",
            "name": "AWS Network ACL Activity",
            "narrative": "AWS CloudTrail is an AWS service that helps you enable governance, compliance, and operational/risk auditing of your AWS account. Actions taken by a user, role, or an AWS service are recorded as events in CloudTrail. It is crucial for a company to monitor events and actions taken in the AWS Management Console, AWS Command Line Interface, and AWS SDKs and APIs to ensure that your servers are not vulnerable to attacks. This analytic story contains detection searches that leverage CloudTrail logs from AWS to check for bad configurations and malicious activity in your AWS network access controls.",
            "references": [
                "https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Appendix_NACLs.html",
                "https://aws.amazon.com/blogs/security/how-to-help-prepare-for-ddos-attacks-by-reducing-your-attack-surface/"
            ],
            "responses": [],
            "story_id": "2e8948a5-5239-406b-b56b-6c50ff268af4",
            "support": [
                "Baseline of blocked outbound traffic from AWS",
                "Baseline of Network ACL Activity by ARN"
            ],
            "type": "ESCU",
            "version": 2
        },
        "2e8948a5-5239-406b-b56b-6c50w3168af3": {
            "author": "Bhavin Patel, Splunk",
            "description": "Use the searches in this Analytic Story to monitor your AWS S3 buckets for evidence of anomalous activity and suspicious behaviors, such as detecting open S3 buckets and buckets being accessed from a new IP. The contextual and investigative searches will give you more information, when required.",
            "detections": [
                "detect_new_open_s3_buckets",
                "detect_s3_access_from_a_new_ip",
                "detect_spike_in_s3_bucket_deletion"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "AWS S3 Bucket details via bucketName",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Get All AWS Activity From IP Address",
                "Get Notable History",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Investigate AWS activities via region name"
            ],
            "modification_date": "2018-07-24",
            "name": "Suspicious AWS S3 Activities",
            "narrative": "As cloud computing has exploded, so has the number of creative attacks on virtual environments. And as the number-two cloud-service provider, Amazon Web Services (AWS) has certainly had its share.\\\nAmazon's \"shared responsibility\" model dictates that the company has responsibility for the environment outside of the VM and the customer is responsible for the security inside of the S3 container. As such, it's important to stay vigilant for activities that may belie suspicious behavior inside of your environment.\\\nAmong things to look out for are S3 access from unfamiliar locations and by unfamiliar users. Some of the searches in this Analytic Story help you detect suspicious behavior and others help you investigate more deeply, when the situation warrants.   ",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf",
                "https://www.tripwire.com/state-of-security/security-data-protection/cloud/public-aws-s3-buckets-writable/"
            ],
            "responses": [],
            "story_id": "2e8948a5-5239-406b-b56b-6c50w3168af3",
            "support": [
                "Baseline of S3 Bucket deletion activity by ARN",
                "Previously seen S3 bucket access by remote IP"
            ],
            "type": "ESCU",
            "version": 2
        },
        "2e8948a5-5239-406b-b56b-6c59f1268af3": {
            "author": "Bhavin Patel, Splunk",
            "description": "Monitor your AWS authentication events using your CloudTrail logs. Searches within this Analytic Story will help you stay aware of and investigate suspicious logins. ",
            "detections": [
                "detect_aws_console_login_by_user_from_new_city",
                "detect_aws_console_login_by_user_from_new_country",
                "detect_aws_console_login_by_user_from_new_region",
                "detect_new_user_aws_console_login"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN"
            ],
            "modification_date": "2019-05-01",
            "name": "Suspicious AWS Login Activities",
            "narrative": "It is important to monitor and control who has access to your AWS infrastructure. Detecting suspicious logins to your AWS infrastructure will provide good starting points for investigations. Abusive behaviors caused by compromised credentials can lead to direct monetary costs, as you will be billed for any EC2 instances created by the attacker.",
            "references": [
                "https://docs.aws.amazon.com/IAM/latest/UserGuide/cloudtrail-integration.html"
            ],
            "responses": [],
            "story_id": "2e8948a5-5239-406b-b56b-6c59f1268af3",
            "support": [
                "Previously seen users in CloudTrail",
                "Update previously seen users in CloudTrail"
            ],
            "type": "ESCU",
            "version": 1
        },
        "2f2f610a-d64d-48c2-b57c-96722b49ab5a": {
            "author": "Bhavin Patel, Splunk",
            "description": "This story is focused around detecting Security Hub alerts generated from AWS",
            "detections": [
                "detect_spike_in_aws_security_hub_alerts_for_ec2_instance",
                "detect_spike_in_aws_security_hub_alerts_for_user"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "Get EC2 Instance Details by instanceId",
                "Get EC2 Launch Details"
            ],
            "modification_date": "2020-08-04",
            "name": "AWS Security Hub Alerts",
            "narrative": "AWS Security Hub collects and consolidates findings from AWS security services enabled in your environment, such as intrusion detection findings from Amazon GuardDuty, vulnerability scans from Amazon Inspector, S3 bucket policy findings from Amazon Macie, publicly accessible and cross-account resources from IAM Access Analyzer, and resources lacking WAF coverage from AWS Firewall Manager.",
            "references": [
                "https://aws.amazon.com/security-hub/features/"
            ],
            "responses": [],
            "story_id": "2f2f610a-d64d-48c2-b57c-96722b49ab5a",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "2f2f610a-d64d-48c2-b57c-967a2b49ab5a": {
            "author": "David Dorsey, Splunk",
            "description": "Track when a user assumes an IAM role in another AWS account to obtain cross-account access to services and resources in that account. Accessing new roles could be an indication of malicious activity.",
            "detections": [
                "aws_detect_attach_to_role_policy",
                "aws_detect_permanent_key_creation",
                "aws_detect_role_creation",
                "aws_detect_sts_assume_role_abuse",
                "aws_detect_sts_get_session_token_abuse"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By AccessKeyId",
                "AWS Investigate User Activities By Source User",
                "AWS Investigate User Activities By Source User",
                "Get Notable History"
            ],
            "modification_date": "2018-06-04",
            "name": "AWS Cross Account Activity",
            "narrative": "Amazon Web Services (AWS) admins manage access to AWS resources and services across the enterprise using AWS's Identity and Access Management (IAM) functionality. IAM provides the ability to create and manage AWS users, groups, and roles-each with their own unique set of privileges and defined access to specific resources (such as EC2 instances, the AWS Management Console, API, or the command-line interface). Unlike conventional (human) users, IAM roles are assumable by anyone in the organization. They provide users with dynamically created temporary security credentials that expire within a set time period.\\\nHerein lies the rub. In between the time between when the temporary credentials are issued and when they expire is a period of opportunity, where a user could leverage the temporary credentials to wreak havoc-spin up or remove instances, create new users, elevate privileges, and other malicious activities-throughout the environment.\\\nThis Analytic Story includes searches that will help you monitor your AWS CloudTrail logs for evidence of suspicious cross-account activity.  For example, while accessing multiple AWS accounts and roles may be perfectly valid behavior, it may be suspicious when an account requests privileges of an account it has not accessed in the past. After identifying suspicious activities, you can use the provided investigative searches to help you probe more deeply.",
            "references": [
                "https://aws.amazon.com/blogs/security/aws-cloudtrail-now-tracks-cross-account-activity-to-its-origin/"
            ],
            "responses": [],
            "story_id": "2f2f610a-d64d-48c2-b57c-967a2b49ab5a",
            "support": [
                "Previously Seen AWS Cross Account Activity"
            ],
            "type": "ESCU",
            "version": 1
        },
        "30552a76-ac78-48e4-b3c0-de4e34e9563d": {
            "author": "Rico Valdez, Splunk",
            "description": "Detect and investigate suspected abuse of file extensions and Windows file associations. Some of the malicious behaviors involved may include inserting spaces before file extensions or prepending the file extension with a different one, among other techniques.",
            "detections": [
                "execution_of_file_with_spaces_before_extension",
                "suspicious_changes_to_file_associations",
                "execution_of_file_with_multiple_extensions",
                "execution_of_file_with_spaces_before_extension",
                "suspicious_changes_to_file_associations"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-01-26",
            "name": "Windows File Extension and Association Abuse",
            "narrative": "Attackers use a variety of techniques to entice users to run malicious code or to persist on an endpoint. One way to accomplish these goals is to leverage file extensions and the mechanism Windows uses to associate files with specific applications. \\\n Since its earliest days, Windows has used extensions to identify file types. Users have become familiar with these extensions and their application associations. For example, if users see that a file ends in `.doc` or `.docx`, they will assume that it is a Microsoft Word document and expect that double-clicking will open it using `winword.exe`. The user will typically also presume that the `.docx` file is safe. \\\n Attackers take advantage of this expectation by obfuscating the true file extension. They can accomplish this in a couple of ways. One technique involves inserting multiple spaces in the file name before the extension to hide the extension from the GUI, obscuring the true nature of the file. Another approach involves prepending the real extension with a different one. This is especially effective when Windows is configured to \"hide extensions for known file types.\" In this case, the real extension is not displayed, but the prepended one is, leading end users to believe the file is a different type than it actually is.\\\nChanging the association between a file extension and an application can allow an attacker to execute arbitrary code. The technique typically involves changing the association for an often-launched file type to associate instead with a malicious program the attacker has dropped on the endpoint. When the end user launches a file that has been manipulated in this way, it will execute the attacker's malware. It will also execute the application the end user expected to run, cleverly obscuring the fact that something suspicious has occurred.\\\nRun the searches in this story to detect and investigate suspicious behavior that may indicate abuse or manipulation of Windows file extensions and/or associations.",
            "references": [
                "https://blog.malwarebytes.com/cybercrime/2013/12/file-extensions-2/",
                "https://attack.mitre.org/wiki/Technique/T1042"
            ],
            "responses": [],
            "story_id": "30552a76-ac78-48e4-b3c0-de4e34e9563d",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "30874d4f-20a1-488f-85ec-5d52ef74e3f9": {
            "author": "Bhavin Patel, Splunk",
            "description": "Monitor for activities and techniques associated with maintaining persistence on a Windows system--a sign that an adversary may have compromised your environment.",
            "detections": [
                "reg_exe_used_to_hide_files_directories_via_registry_keys",
                "remote_registry_key_modifications",
                "detect_path_interception_by_creation_of_program_exe",
                "hiding_files_and_directories_with_attrib_exe",
                "monitor_registry_keys_for_print_monitors",
                "reg_exe_manipulating_windows_services_registry_keys",
                "reg_exe_used_to_hide_files_directories_via_registry_keys",
                "registry_keys_for_creating_shim_databases",
                "registry_keys_used_for_persistence",
                "remote_registry_key_modifications",
                "sc_exe_manipulating_windows_services",
                "schtasks_used_for_forcing_a_reboot",
                "shim_database_file_creation",
                "shim_database_installation_with_suspicious_parameters"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-05-31",
            "name": "Windows Persistence Techniques",
            "narrative": "Maintaining persistence is one of the first steps taken by attackers after the initial compromise. Attackers leverage various custom and built-in tools to ensure survivability and persistent access within a compromised enterprise. This Analytic Story provides searches to help you identify various behaviors used by attackers to maintain persistent access to a Windows environment.",
            "references": [
                "http://www.fuzzysecurity.com/tutorials/19.html",
                "https://www.fireeye.com/blog/threat-research/2010/07/malware-persistence-windows-registry.html",
                "http://resources.infosecinstitute.com/common-malware-persistence-mechanisms/",
                "https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html",
                "https://www.youtube.com/watch?v=dq2Hv7J9fvk"
            ],
            "responses": [],
            "story_id": "30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "support": [],
            "type": "ESCU",
            "version": 2
        },
        "31337aaa-bc22-4752-b599-ef112dq1dq7a": {
            "author": "Jim Apger, Splunk",
            "description": "Monitor your environment for activity consistent with common attack techniques bad actors use when attempting to compromise web servers or other web-related assets.",
            "detections": [
                "web_fraud_-_account_harvesting",
                "web_fraud_-_anomalous_user_clickspeed",
                "web_fraud_-_password_sharing_across_accounts"
            ],
            "escu_category": [
                "Abuse"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Emails From Specific Sender",
                "Get Notable History",
                "Get Notable Info",
                "Get Web Session Information via session id"
            ],
            "modification_date": "2018-10-08",
            "name": "Web Fraud Detection",
            "narrative": "The Federal Bureau of Investigations (FBI) defines Internet fraud as the use of Internet services or software with Internet access to defraud victims or to otherwise take advantage of them. According to the Bureau, Internet crime schemes are used to steal millions of dollars each year from victims and continue to plague the Internet through various methods. The agency includes phishing scams, data breaches, Denial of Service (DOS) attacks, email account compromise, malware, spoofing, and ransomware in this category.\\\nThese crimes are not the fraud itself, but rather the attack techniques commonly employed by fraudsters in their pursuit of data that enables them to commit malicious actssuch as obtaining and using stolen credit cards. They represent a serious problem that is steadily increasing and not likely to go away anytime soon.\\\nWhen developing a strategy for preventing fraud in your environment, its important to  look across all of your web services for evidence that attackers are abusing enterprise resources to enumerate systems, harvest data for secondary fraudulent activity, or abuse terms of service.This Analytic Story looks for evidence of common Internet attack techniques that could be indicative of web fraud in your environmentincluding account harvesting, anomalous user clickspeed, and password sharing across accounts, to name just a few.\\\nThe account-harvesting search focuses on web pages used for user-account registration. It detects the creation of a large number of user accounts using the same email domain name, a type of activity frequently seen in advance of a fraud campaign.\\\nThe anomalous clickspeed search looks for users who are moving through your website at a faster-than-normal speed or with a perfect click cadence (high periodicity or low standard deviation), which could indicate that the user is a script, not an actual human.\\\nAnother search detects incidents wherein a single password is used across multiple accounts, which may indicate that a fraudster has infiltrated your environment and embedded a common password within a script.",
            "references": [
                "https://www.fbi.gov/scams-and-safety/common-fraud-schemes/internet-fraud",
                "https://www.fbi.gov/news/stories/2017-internet-crime-report-released-050718"
            ],
            "responses": [],
            "story_id": "31337aaa-bc22-4752-b599-ef112dq1dq7a",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "3338b567-3804-4261-9889-cf0ca4753c7f": {
            "author": "David Dorsey, Splunk",
            "description": "Monitor your AWS provisioning activities for behaviors originating from unfamiliar or unusual locations. These behaviors may indicate that malicious activities are occurring somewhere within your network.",
            "detections": [
                "aws_cloud_provisioning_from_previously_unseen_city",
                "aws_cloud_provisioning_from_previously_unseen_country",
                "aws_cloud_provisioning_from_previously_unseen_ip_address",
                "aws_cloud_provisioning_from_previously_unseen_region"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate Security Hub alerts by dest",
                "AWS Investigate User Activities By ARN",
                "Get All AWS Activity From City",
                "Get All AWS Activity From Country",
                "Get All AWS Activity From IP Address",
                "Get All AWS Activity From Region"
            ],
            "modification_date": "2018-03-16",
            "name": "AWS Suspicious Provisioning Activities",
            "narrative": "Because most enterprise AWS activities originate from familiar geographic locations, monitoring for activity from unknown or unusual regions is an important security measure. This indicator can be especially useful in environments where it is impossible to whitelist specific IPs (because they vary).\\\nThis Analytic Story was designed to provide you with flexibility in the precision you employ in specifying legitimate geographic regions. It can be as specific as an IP address or a city, or as broad as a region (think state) or an entire country. By determining how precise you want your geographical locations to be and monitoring for new locations that haven't previously accessed your environment, you can detect adversaries as they begin to probe your environment. Since there are legitimate reasons for activities from unfamiliar locations, this is not a standalone indicator. Nevertheless, location can be a relevant piece of information that you may wish to investigate further.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf"
            ],
            "responses": [],
            "story_id": "3338b567-3804-4261-9889-cf0ca4753c7f",
            "support": [
                "Previously Seen AWS Provisioning Activity Sources"
            ],
            "type": "ESCU",
            "version": 1
        },
        "36dbb206-d073-11ea-87d0-0242ac130003": {
            "author": "Shannon Davis, Splunk",
            "description": "Uncover activity consistent with CVE-2020-1350, or SIGRed. Discovered by Checkpoint researchers, this vulnerability affects Windows 2003 to 2019, and is triggered by a malicious DNS response (only affects DNS over TCP). An attacker can use the malicious payload to cause a buffer overflow on the vulnerable system, leading to compromise.  The included searches in this Analytic Story are designed to identify the large response payload for SIG and KEY DNS records which can be used for the exploit.",
            "detections": [
                "detect_windows_dns_sigred_via_splunk_stream",
                "detect_windows_dns_sigred_via_zeek",
                "detect_windows_dns_sigred_via_splunk_stream",
                "detect_windows_dns_sigred_via_zeek"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Notable History",
                "Get Notable Info"
            ],
            "modification_date": "2020-07-28",
            "name": "Windows DNS SIGRed CVE-2020-1350",
            "narrative": "When a client requests a DNS record for a particular domain, that request gets routed first through the client's locally configured DNS server, then to any DNS server(s) configured as forwarders, and then onto the target domain's own DNS server(s).  If a attacker wanted to, they could host a malicious DNS server that responds to the initial request with a specially crafted large response (~65KB).  This response would flow through to the client's local DNS server, which if not patched for CVE-2020-1350, would cause the buffer overflow. The detection searches in this Analytic Story use wire data to detect the malicious behavior. Searches for Splunk Stream and Zeek are included.  The Splunk Stream search correlates across stream:dns and stream:tcp, while the Zeek search correlates across bro:dns:json and bro:conn:json.  These correlations are required to pick up both the DNS record types (SIG and KEY) along with the payload size (>65KB).",
            "references": [
                "https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/",
                "https://support.microsoft.com/en-au/help/4569509/windows-dns-server-remote-code-execution-vulnerability"
            ],
            "responses": [],
            "story_id": "36dbb206-d073-11ea-87d0-0242ac130003",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "399d65dc-1f08-499b-a259-aad9051f38ad": {
            "author": "David Dorsey, Splunk",
            "description": "Detect and investigate tactics, techniques, and procedures around how attackers move laterally within the enterprise. Because lateral movement can expose the adversary to detection, it should be an important focus for security analysts.",
            "detections": [
                "detect_activity_related_to_pass_the_hash_attacks",
                "kerberoasting_spn_request_with_rc4_encryption",
                "remote_desktop_process_running_on_system",
                "schtasks_scheduling_job_on_remote_system",
                "remote_desktop_process_running_on_system",
                "remote_desktop_network_traffic"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Successful Remote Desktop Authentications",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-02-04",
            "name": "Lateral Movement",
            "narrative": "Once attackers gain a foothold within an enterprise, they will seek to expand their accesses and leverage techniques that facilitate lateral movement. Attackers will often spend quite a bit of time and effort moving laterally. Because lateral movement renders an attacker the most vulnerable to detection, it's an excellent focus for detection and investigation.\\\nIndications of lateral movement can include the abuse of system utilities (such as `psexec.exe`), unauthorized use of remote desktop services, `file/admin$` shares, WMI, PowerShell, pass-the-hash, or the abuse of scheduled tasks. Organizations must be extra vigilant in detecting lateral movement techniques and look for suspicious activity in and around high-value strategic network assets, such as Active Directory, which are often considered the primary target or \"crown jewels\" to a persistent threat actor.\\\nAn adversary can use lateral movement for multiple purposes, including remote execution of tools, pivoting to additional systems, obtaining access to specific information or files, access to additional credentials, exfiltrating data, or delivering a secondary effect. Adversaries may use legitimate credentials alongside inherent network and operating-system functionality to remotely connect to other systems and remain under the radar of network defenders.\\\nIf there is evidence of lateral movement, it is imperative for analysts to collect evidence of the associated offending hosts. For example, an attacker might leverage host A to gain access to host B. From there, the attacker may try to move laterally to host C. In this example, the analyst should gather as much information as possible from all three hosts. \\\n It is also important to collect authentication logs for each host, to ensure that the offending accounts are well-documented. Analysts should account for all processes to ensure that the attackers did not install unauthorized software.",
            "references": [
                "https://www.fireeye.com/blog/executive-perspective/2015/08/malware_lateral_move.html"
            ],
            "responses": [],
            "story_id": "399d65dc-1f08-499b-a259-aad9051f38ad",
            "support": [],
            "type": "ESCU",
            "version": 2
        },
        "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a": {
            "author": "David Dorsey, Splunk",
            "description": "Monitor your cloud compute instances for activities related to cryptojacking/cryptomining. New instances that originate from previously unseen regions, users who launch abnormally high numbers of instances, or compute instances started by previously unseen users are just a few examples of potentially malicious behavior.",
            "detections": [
                "abnormally_high_number_of_cloud_instances_destroyed",
                "abnormally_high_number_of_cloud_instances_launched",
                "cloud_compute_instance_created_by_previously_unseen_user",
                "cloud_compute_instance_created_in_previously_unused_region",
                "cloud_compute_instance_created_with_previously_unseen_image",
                "cloud_compute_instance_created_with_previously_unseen_instance_type",
                "cloud_compute_instance_started_in_previously_unused_region"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate Security Hub alerts by dest",
                "AWS Investigate User Activities By ARN",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Investigate Cloud Compute Instance Activities",
                "Investigate User Activities In All Cloud Regions",
                "Investigate User Activities In Single Cloud Region",
                "Get EC2 Instance Details by instanceId",
                "Get EC2 Launch Details",
                "Get Notable History",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Investigate AWS activities via region name",
                "Investigate Cloud Compute Instance Activities",
                "Investigate User Activities In All Cloud Regions",
                "Investigate User Activities In Single Cloud Region"
            ],
            "modification_date": "2019-10-02",
            "name": "Cloud Cryptomining",
            "narrative": "Cryptomining is an intentionally difficult, resource-intensive business. Its complexity was designed into the process to ensure that the number of blocks mined each day would remain steady. So, it's par for the course that ambitious, but unscrupulous, miners make amassing the computing power of large enterprises--a practice known as cryptojacking--a top priority. \\\nCryptojacking has attracted an increasing amount of media attention since its explosion in popularity in the fall of 2017. The attacks have moved from in-browser exploits and mobile phones to enterprise cloud services, such as Amazon Web Services (AWS), Google Cloud Platform (GCP), and Azure. It's difficult to determine exactly how widespread the practice has become, since bad actors continually evolve their ability to escape detection, including employing unlisted endpoints, moderating their CPU usage, and hiding the mining pool's IP address behind a free CDN. \\\nWhen malicious miners appropriate a cloud instance, often spinning up hundreds of new instances, the costs can become astronomical for the account holder. So it is critically important to monitor your systems for suspicious activities that could indicate that your network has been infiltrated. \\\nThis Analytic Story is focused on detecting suspicious new instances in your cloud environment to help prevent cryptominers from gaining a foothold. It contains detection searches that will detect when a previously unused instance type or AMI is used. It also contains support searches to build lookup files to ensure proper execution of the detection searches.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf"
            ],
            "responses": [],
            "story_id": "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a",
            "support": [
                "Baseline Of Cloud Instances Destroyed",
                "Baseline Of Cloud Instances Launched",
                "Previously Seen Cloud Compute Creations By User",
                "Previously Seen Cloud Compute Creations By User - Initial",
                "Previously Seen Cloud Compute Creations By User - Update",
                "Previously Seen Cloud Compute Images",
                "Previously Seen Cloud Compute Images - Initial",
                "Previously Seen Cloud Compute Images - Update",
                "Previously Seen Cloud Compute Instance Types",
                "Previously Seen Cloud Compute Instance Types - Initial",
                "Previously Seen Cloud Compute Instance Types - Update",
                "Previously Seen Cloud Regions",
                "Previously Seen Cloud Regions - Initial",
                "Previously Seen Cloud Regions - Update"
            ],
            "type": "ESCU",
            "version": 1
        },
        "3c3835c0-255d-4f9e-ab84-e29ec9ec9b56": {
            "author": "Rico Valdez, Splunk",
            "description": "Attackers often attempt to hide within or otherwise abuse the domain name system (DNS). You can thwart attempts to manipulate this omnipresent protocol by monitoring for these types of abuses.",
            "detections": [
                "clients_connecting_to_multiple_dns_servers",
                "detect_hosts_connecting_to_dynamic_domain_providers",
                "detect_long_dns_txt_record_response",
                "detection_of_dns_tunnels",
                "dns_query_length_outliers_-_mltk",
                "dns_query_length_with_high_standard_deviation",
                "dns_query_requests_resolved_by_unauthorized_dns_servers",
                "excessive_dns_failures"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get DNS traffic ratio",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-09-18",
            "name": "Suspicious DNS Traffic",
            "narrative": "Although DNS is one of the fundamental underlying protocols that make the Internet work, it is often ignored (perhaps because of its complexity and effectiveness).  However, attackers have discovered ways to abuse the protocol to meet their objectives. One potential abuse involves manipulating DNS to hijack traffic and redirect it to an IP address under the attacker's control. This could inadvertently send users intending to visit google.com, for example, to an unrelated malicious website. Another technique involves using the DNS protocol for command-and-control activities with the attacker's malicious code or to covertly exfiltrate data. The searches within this Analytic Story look for these types of abuses.",
            "references": [
                "http://blogs.splunk.com/2015/10/01/random-words-on-entropy-and-dns/",
                "http://www.darkreading.com/analytics/security-monitoring/got-malware-three-signs-revealed-in-dns-traffic/d/d-id/1139680",
                "https://live.paloaltonetworks.com/t5/Threat-Vulnerability-Articles/What-are-suspicious-DNS-queries/ta-p/71454"
            ],
            "responses": [],
            "story_id": "3c3835c0-255d-4f9e-ab84-e29ec9ec9b56",
            "support": [
                "Baseline of DNS Query Length - MLTK"
            ],
            "type": "ESCU",
            "version": 1
        },
        "4d656b2e-d6be-11ea-87d0-0242ac130003": {
            "author": "Shannon Davis, Splunk",
            "description": "Use the searches in this Analytic Story to monitor your GCP Storage buckets for evidence of anomalous activity and suspicious behaviors, such as detecting open storage buckets and buckets being accessed from a new IP. The contextual and investigative searches will give you more information, when required.",
            "detections": [
                "detect_gcp_storage_access_from_a_new_ip",
                "detect_new_open_gcp_storage_buckets"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Get Notable History"
            ],
            "modification_date": "2020-08-05",
            "name": "Suspicious GCP Storage Activities",
            "narrative": "Similar to other cloud providers, GCP operates on a shared responsibility model. This means the end user, you, are responsible for setting appropriate access control lists and permissions on your GCP resources.\\ This Analytics Story concentrates on detecting things like open storage buckets (both read and write) along with storage bucket access from unfamiliar users and IP addresses.",
            "references": [
                "https://cloud.google.com/blog/products/gcp/4-steps-for-hardening-your-cloud-storage-buckets-taking-charge-of-your-security",
                "https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/"
            ],
            "responses": [],
            "story_id": "4d656b2e-d6be-11ea-87d0-0242ac130003",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "4e692b96-de2d-4bd1-9105-37e2368a8db1": {
            "author": "Bhavin Patel, Splunk",
            "description": "Keeping your Splunk deployment up to date is critical and may help you reduce the risk of CVE-2016-4859, an open-redirection vulnerability within some older versions of Splunk Enterprise. The detection search will help ensure that users are being properly authenticated and not being redirected to malicious domains.",
            "detections": [
                "open_redirect_in_splunk_web"
            ],
            "escu_category": [
                "Vulnerability"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint"
            ],
            "modification_date": "2017-09-19",
            "name": "Splunk Enterprise Vulnerability",
            "narrative": "This Analytic Story is associated with CVE-2016-4859, an open-redirect vulnerability in the following versions of Splunk Enterprise:\\\n\\\n1. Splunk Enterprise 6.4.x, prior to 6.4.3\\\n1. Splunk Enterprise 6.3.x, prior to 6.3.6\\\n1. Splunk Enterprise 6.2.x, prior to 6.2.10\\\n1. Splunk Enterprise 6.1.x, prior to 6.1.11\\\n1. Splunk Enterprise 6.0.x, prior to 6.0.12\\\n1. Splunk Enterprise 5.0.x, prior to 5.0.16\\\n1. Splunk Light, prior to 6.4.3CVE-2016-4859 allows attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors. (Credit: Noriaki Iwasaki, Cyber Defense Institute, Inc.).\\\nIt is important to ensure that your Splunk deployment is being kept up to date and is properly configured. This detection search allows analysts to monitor internal logs to ensure users are properly authenticated and cannot be redirected to any malicious third-party websites.",
            "references": [
                "http://www.splunk.com/view/SP-CAAAPQ6#announce",
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4859"
            ],
            "responses": [],
            "story_id": "4e692b96-de2d-4bd1-9105-37e2368a8db1",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "4f6632f5-449c-4686-80df-57625f59bab3": {
            "author": "Bhavin Patel, Splunk",
            "description": "Use the searches in this Analytic Story to help you detect structured query language (SQL) injection attempts characterized by long URLs that contain malicious parameters.",
            "detections": [
                "sql_injection_with_long_urls"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint"
            ],
            "modification_date": "2017-09-19",
            "name": "SQL Injection",
            "narrative": "It is very common for attackers to inject SQL parameters into vulnerable web applications, which then interpret the malicious SQL statements.\\\nThis Analytic Story contains a search designed to identify attempts by attackers to leverage this technique to compromise a host and gain a foothold in the target environment.",
            "references": [
                "https://capec.mitre.org/data/definitions/66.html",
                "https://www.incapsula.com/web-application-security/sql-injection.html"
            ],
            "responses": [],
            "story_id": "4f6632f5-449c-4686-80df-57625f59bab3",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "507edc74-13d5-4339-878e-b9744ded1f35": {
            "author": "Jose Hernandez, Splunk",
            "description": "Leverage searches that allow you to detect and investigate unusual activities that might relate to the Ryuk ransomware, including looking for file writes associated with Ryuk, Stopping Security Access Manager, DisableAntiSpyware registry key modification, suspicious psexec use, and more.",
            "detections": [
                "windows_connhost_exe_started_forcefully",
                "windows_disableantispyware_registry",
                "common_ransomware_notes",
                "ryuk_test_files_detected",
                "spike_in_file_writes",
                "windows_connhost_exe_started_forcefully",
                "windows_disableantispyware_registry",
                "windows_security_account_manager_stopped",
                "spike_in_file_writes",
                "remote_desktop_network_bruteforce",
                "remote_desktop_network_traffic"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Notable History"
            ],
            "modification_date": "2020-11-06",
            "name": "Ryuk Ransomware",
            "narrative": "Cybersecurity Infrastructure Security Agency (CISA) released Alert (AA20-302A) on October 28th called \u201cRansomware Activity Targeting the Healthcare and Public Health Sector.\u201d This alert details TTPs associated with ongoing and possible imminent attacks against the Healthcare sector, and is a joint advisory in coordination with other U.S. Government agencies. The objective of these malicious campaigns is to infiltrate targets in named sectors and to drop ransomware payloads, which will likely cause disruption of service and increase risk of actual harm to the health and safety of patients at hospitals, even with the aggravant of an ongoing COVID-19 pandemic. This document specifically refers to several crimeware exploitation frameworks, emphasizing the use of Ryuk ransomware as payload. The Ryuk ransomware payload is not new. It has been well documented and identified in multiple variants. Payloads need a carrier, and for Ryuk it has often been exploitation frameworks such as Cobalt Strike, or popular crimeware frameworks such as Emotet or Trickbot.",
            "references": [
                "https://www.splunk.com/en_us/blog/security/detecting-ryuk-using-splunk-attack-range.html",
                "https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/",
                "https://us-cert.cisa.gov/ncas/alerts/aa20-302a"
            ],
            "responses": [],
            "story_id": "507edc74-13d5-4339-878e-b9744ded1f35",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "51045ded-1575-4ba6-aef7-af6c73cffd86": {
            "author": "David Dorsey, Splunk",
            "description": "Monitor your cloud infrastructure provisioning activities for behaviors originating from unfamiliar or unusual locations. These behaviors may indicate that malicious activities are occurring somewhere within your cloud environment.",
            "detections": [
                "cloud_provisioning_activity_from_previously_unseen_city",
                "cloud_provisioning_activity_from_previously_unseen_country",
                "cloud_provisioning_activity_from_previously_unseen_ip_address",
                "cloud_provisioning_activity_from_previously_unseen_region"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By Source User",
                "AWS Investigate User Activities By Source User",
                "Get Notable History"
            ],
            "modification_date": "2018-08-20",
            "name": "Suspicious Cloud Provisioning Activities",
            "narrative": "Because most enterprise cloud infrastructure activities originate from familiar geographic locations, monitoring for activity from unknown or unusual regions is an important security measure. This indicator can be especially useful in environments where it is impossible to whitelist specific IPs (because they vary).\\\nThis Analytic Story was designed to provide you with flexibility in the precision you employ in specifying legitimate geographic regions. It can be as specific as an IP address or a city, or as broad as a region (think state) or an entire country. By determining how precise you want your geographical locations to be and monitoring for new locations that haven't previously accessed your environment, you can detect adversaries as they begin to probe your environment. Since there are legitimate reasons for activities from unfamiliar locations, this is not a standalone indicator. Nevertheless, location can be a relevant piece of information that you may wish to investigate further.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf"
            ],
            "responses": [],
            "story_id": "51045ded-1575-4ba6-aef7-af6c73cffd86",
            "support": [
                "Previously Seen Cloud Provisioning Activity Sources - Initial",
                "Previously Seen Cloud Provisioning Activity Sources - Update"
            ],
            "type": "ESCU",
            "version": 1
        },
        "56e24a28-5003-4047-b2db-e8f3c4618064": {
            "author": "David Dorsey, Splunk",
            "description": "Detect tactics used by malware to evade defenses on Windows endpoints. A few of these include suspicious `reg.exe` processes, files hidden with `attrib.exe` and disabling user-account control, among many others ",
            "detections": [
                "reg_exe_used_to_hide_files_directories_via_registry_keys",
                "remote_registry_key_modifications",
                "disabling_remote_user_account_control",
                "hiding_files_and_directories_with_attrib_exe",
                "reg_exe_used_to_hide_files_directories_via_registry_keys",
                "remote_registry_key_modifications",
                "suspicious_reg_exe_process"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-05-31",
            "name": "Windows Defense Evasion Tactics",
            "narrative": "Defense evasion is a tactic--identified in the MITRE ATT&CK framework--that adversaries employ in a variety of ways to bypass or defeat defensive security measures. There are many techniques enumerated by the MITRE ATT&CK framework that are applicable in this context. This Analytic Story includes searches designed to identify the use of such techniques on Windows platforms.",
            "references": [
                "https://attack.mitre.org/wiki/Defense_Evasion"
            ],
            "responses": [],
            "story_id": "56e24a28-5003-4047-b2db-e8f3c4618064",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "57226b40-94f3-4ce5-b101-a75f67759c27": {
            "author": "Splunk Research Team, Splunk",
            "description": "Detect signs of malicious payloads that may indicate that your environment has been breached via a phishing attack.",
            "detections": [
                "detect_oulook_exe_writing_a__zip_file",
                "suspicious_lnk_file_launching_a_process",
                "detect_oulook_exe_writing_a__zip_file"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Parent Process Info"
            ],
            "modification_date": "2019-04-29",
            "name": "Phishing Payloads",
            "narrative": "Despite its simplicity, phishing remains the most pervasive and dangerous cyberthreat. In fact, research shows that as many as [91% of all successful attacks](https://digitalguardian.com/blog/91-percent-cyber-attacks-start-phishing-email-heres-how-protect-against-phishing) are initiated via a phishing email. \\\nAs most people know, these emails use fraudulent domains, [email scraping](https://www.cyberscoop.com/emotet-trojan-phishing-scraping-templates-cofense-geodo/), familiar contact names inserted as senders, and other tactics to lure targets into clicking a malicious link, opening an attachment with a [nefarious payload](https://www.cyberscoop.com/emotet-trojan-phishing-scraping-templates-cofense-geodo/), or entering sensitive personal information that perpetrators may intercept. This attack technique requires a relatively low level of skill and allows adversaries to easily cast a wide net. Worse, because its success relies on the gullibility of humans, it's impossible to completely \"automate\" it out of your environment. However, you can use ES and ESCU to detect and investigate potentially malicious payloads injected into your environment subsequent to a phishing attack. \\\nWhile any kind of file may contain a malicious payload, some are more likely to be perceived as benign (and thus more often escape notice) by the average victim&#151;especially when the attacker sends an email that seems to be from one of their contacts. An example is Microsoft Office files. Most corporate users are familiar with documents with the following suffixes: .doc/.docx (MS Word), .xls/.xlsx (MS Excel), and .ppt/.pptx (MS PowerPoint), so they may click without a second thought, slashing a hole in their organizations' security. \\\nFollowing is a typical series of events, according to an [article by Trend Micro](https://blog.trendmicro.com/trendlabs-security-intelligence/rising-trend-attackers-using-lnk-files-download-malware/):\\\n1. Attacker sends a phishing email. Recipient downloads the attached file, which is typically a .docx or .zip file with an embedded .lnk file\\\n1. The .lnk file executes a PowerShell script\\\n1. Powershell executes a reverse shell, rendering the exploit successful </ol>As a side note, adversaries are likely to use a tool like Empire to craft and obfuscate payloads and their post-injection activities, such as [exfiltration, lateral movement, and persistence](https://github.com/EmpireProject/Empire).\\\nThis Analytic Story focuses on detecting signs that a malicious payload has been injected into your environment. For example, one search detects outlook.exe writing a .zip file. Another looks for suspicious .lnk files launching processes.",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2019/04/spear-phishing-campaign-targets-ukraine-government.html"
            ],
            "responses": [],
            "story_id": "57226b40-94f3-4ce5-b101-a75f67759c27",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "5d14a962-569e-4578-939f-f386feb63ce4": {
            "author": "Rod Soto, Jose Hernandez, Stan Miskowicz, David Dorsey, Shannon Davis Splunk",
            "description": "Uncover activity related to the execution of Zerologon CVE-2020-11472, a technique wherein attackers target a Microsoft Windows Domain Controller to reset its computer account password. The result from this attack is attackers can now provide themselves high privileges and take over Domain Controller. The included searches in this Analytic Story are designed to identify attempts to reset Domain Controller Computer Account via exploit code remotely or via the use of tool Mimikatz as payload carrier.",
            "detections": [
                "detect_mimikatz_using_loaded_images",
                "detect_computer_changed_with_anonymous_account",
                "detect_credential_dumping_through_lsass_access",
                "detect_zerologon_via_zeek"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Notable History"
            ],
            "modification_date": "2020-09-18",
            "name": "Detect Zerologon Attack",
            "narrative": "This attack is a privilege escalation technique, where attacker targets a Netlogon secure channel connection to a domain controller, using Netlogon Remote Protocol (MS-NRPC). This vulnerability exposes vulnerable Windows Domain Controllers to be targeted via unaunthenticated RPC calls which eventually reset Domain Contoller computer account ($) providing the attacker the opportunity to exfil domain controller credential secrets and assign themselve high privileges that can lead to domain controller and potentially complete network takeover. The detection searches in this Analytic Story use Windows Event viewer events and Sysmon events to detect attack execution, these searches monitor access to the Local Security Authority Subsystem Service (LSASS) process which is an indicator of the use of Mimikatz tool which has bee updated to carry this attack payload.",
            "references": [
                "https://attack.mitre.org/wiki/Technique/T1003",
                "https://github.com/SecuraBV/CVE-2020-1472",
                "https://www.secura.com/blog/zero-logon",
                "https://nvd.nist.gov/vuln/detail/CVE-2020-1472"
            ],
            "responses": [],
            "story_id": "5d14a962-569e-4578-939f-f386feb63ce4",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "6380ebbb-55c5-4fce-b754-01fd565fb73c": {
            "author": "Rico Valdez, Splunk",
            "description": "Monitor your cloud authentication events. Searches within this Analytic Story leverage the recent cloud updates to the Authentication data model to help you stay aware of and investigate suspicious login activity. ",
            "detections": [
                "aws_cross_account_activity_from_previously_unseen_account",
                "detect_aws_console_login_by_new_user",
                "detect_aws_console_login_by_user_from_new_city",
                "detect_aws_console_login_by_user_from_new_country",
                "detect_aws_console_login_by_user_from_new_region",
                "detect_new_user_aws_console_login_-_dm"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Get Notable History",
                "Investigate AWS User Activities by user field"
            ],
            "modification_date": "2020-06-04",
            "name": "Suspicious Cloud Authentication Activities",
            "narrative": "It is important to monitor and control who has access to your cloud infrastructure. Detecting suspicious logins will provide good starting points for investigations. Abusive behaviors caused by compromised credentials can lead to direct monetary costs, as you will be billed for any compute activity whether legitimate or otherwise.\\\nThis Analytic Story has data model versions of cloud searches leveraging Authentication data, including those looking for suspicious login activity, and cross-account activity for AWS.",
            "references": [
                "https://aws.amazon.com/blogs/security/aws-cloudtrail-now-tracks-cross-account-activity-to-its-origin/",
                "https://docs.aws.amazon.com/IAM/latest/UserGuide/cloudtrail-integration.html"
            ],
            "responses": [],
            "story_id": "6380ebbb-55c5-4fce-b754-01fd565fb73c",
            "support": [
                "Previously Seen AWS Cross Account Activity - Initial",
                "Previously Seen AWS Cross Account Activity - Update",
                "Previously seen users in CloudTrail - DM",
                "Previously Seen Users in CloudTrail - Initial",
                "Previously Seen Users In CloudTrail - Update",
                "Update previously seen users in CloudTrail - DM"
            ],
            "type": "ESCU",
            "version": 1
        },
        "644e22d3-598a-429c-a007-16fdb802cae5": {
            "author": "David Dorsey, Splunk",
            "description": "Monitor for and investigate activities that may be associated with a Windows privilege-escalation attack, including unusual processes running on endpoints, modified registry keys, and more.",
            "detections": [
                "uncommon_processes_on_endpoint",
                "child_processes_of_spoolsv_exe",
                "overwriting_accessibility_binaries",
                "registry_keys_used_for_privilege_escalation",
                "uncommon_processes_on_endpoint",
                "child_processes_of_spoolsv_exe"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-02-04",
            "name": "Windows Privilege Escalation",
            "narrative": "Privilege escalation is a \"land-and-expand\" technique, wherein an adversary gains an initial foothold on a host and then exploits its weaknesses to increase his privileges. The motivation is simple: certain actions on a Windows machine--such as installing software--may require higher-level privileges than those the attacker initially acquired. By increasing his privilege level, the attacker can gain the control required to carry out his malicious ends. This Analytic Story provides searches to detect and investigate behaviors that attackers may use to elevate their privileges in your environment.",
            "references": [
                "https://attack.mitre.org/tactics/TA0004/"
            ],
            "responses": [],
            "story_id": "644e22d3-598a-429c-a007-16fdb802cae5",
            "support": [],
            "type": "ESCU",
            "version": 2
        },
        "66b0fe0c-1351-11eb-adc1-0242ac120002": {
            "author": "Shannon Davis, Splunk",
            "description": "The stealing of data by an adversary.",
            "detections": [
                "detect_snicat_sni_exfiltration"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Notable History"
            ],
            "modification_date": "2020-10-21",
            "name": "Data Exfiltration",
            "narrative": "Exfiltration comes in many flavors.  Adversaries can collect data over encrypted or non-encrypted channels.  They can utilise Command and Control channels that are already in place to exfiltrate data.  They can use both standard data transfer protocols such as FTP, SCP, etc to exfiltrate data.  Or they can use non-standard protocols such as DNS, ICMP, etc with specially crafted fields to try and circumvent security technologies in place.",
            "references": [
                "https://attack.mitre.org/tactics/TA0010/"
            ],
            "responses": [],
            "story_id": "66b0fe0c-1351-11eb-adc1-0242ac120002",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "6d13121c-90f3-446d-8ac3-27efbbc65218": {
            "author": "Rico Valdez, Splunk",
            "description": "Detect instances of prohibited network traffic allowed in the environment, as well as protocols running on non-standard ports. Both of these types of behaviors typically violate policy and can be leveraged by attackers.",
            "detections": [
                "detect_hosts_connecting_to_dynamic_domain_providers",
                "prohibited_network_traffic_allowed",
                "protocol_or_port_mismatch",
                "tor_traffic"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-09-11",
            "name": "Prohibited Traffic Allowed or Protocol Mismatch",
            "narrative": "A traditional security best practice is to control the ports, protocols, and services allowed within your environment. By limiting the services and protocols to those explicitly approved by policy, administrators can minimize the attack surface. The combined effect allows both network defenders and security controls to focus and not be mired in superfluous traffic or data types. Looking for deviations to policy can identify attacker activity that abuses services and protocols to run on alternate or non-standard ports in the attempt to avoid detection or frustrate forensic analysts.",
            "references": [
                "http://www.novetta.com/2015/02/advanced-methods-to-detect-advanced-cyber-attacks-protocol-abuse/"
            ],
            "responses": [],
            "story_id": "6d13121c-90f3-446d-8ac3-27efbbc65218",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "6d3306f6-bb2b-4219-8609-8efad64032f2": {
            "author": "David Dorsey, Splunk",
            "description": "Assess and mitigate your systems' vulnerability to Spectre and Meltdown exploitation with the searches in this Analytic Story.",
            "detections": [
                "spectre_and_meltdown_vulnerable_systems"
            ],
            "escu_category": [
                "Vulnerability"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table"
            ],
            "modification_date": "2018-01-08",
            "name": "Spectre And Meltdown Vulnerabilities",
            "narrative": "Meltdown and Spectre exploit critical vulnerabilities in modern CPUs that allow unintended access to data in memory. This Analytic Story will help you identify the systems can be patched for these vulnerabilities, as well as those that still need to be patched.",
            "references": [
                "https://meltdownattack.com/"
            ],
            "responses": [],
            "story_id": "6d3306f6-bb2b-4219-8609-8efad64032f2",
            "support": [
                "Systems Ready for Spectre-Meltdown Windows Patch"
            ],
            "type": "ESCU",
            "version": 1
        },
        "6dbd810e-f66d-414b-8dfc-e46de55cbfe2": {
            "author": "Rico Valdez, Splunk",
            "description": "Windows services are often used by attackers for persistence and the ability to load drivers or otherwise interact with the Windows kernel. This Analytic Story helps you monitor your environment for indications that Windows services are being modified or created in a suspicious manner.",
            "detections": [
                "first_time_seen_running_windows_service",
                "reg_exe_manipulating_windows_services_registry_keys",
                "sc_exe_manipulating_windows_services"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-11-02",
            "name": "Windows Service Abuse",
            "narrative": "The Windows operating system uses a services architecture to allow for running code in the background, similar to a UNIX daemon. Attackers will often leverage Windows services for persistence, hiding in plain sight, seeking the ability to run privileged code that can interact with the kernel. In many cases, attackers will create a new service to host their malicious code. Attackers have also been observed modifying unnecessary or unused services to point to their own code, as opposed to what was intended. In these cases, attackers often use tools to create or modify services in ways that are not typical for most environments, providing opportunities for detection.",
            "references": [
                "https://attack.mitre.org/wiki/Technique/T1050",
                "https://attack.mitre.org/wiki/Technique/T1031"
            ],
            "responses": [],
            "story_id": "6dbd810e-f66d-414b-8dfc-e46de55cbfe2",
            "support": [
                "Previously Seen Running Windows Services - Initial",
                "Previously Seen Running Windows Services - Update"
            ],
            "type": "ESCU",
            "version": 3
        },
        "73de57ef-0dfc-411f-b1e7-fa24428aeae0": {
            "author": "David Dorsey, Splunk",
            "description": "Identify unusual changes to your AWS EC2 instances that may indicate malicious activity. Modifications to your EC2 instances by previously unseen users is an example of an activity that may warrant further investigation.",
            "detections": [
                "ec2_instance_modified_with_previously_unseen_user"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "Get EC2 Instance Details by instanceId",
                "Get Notable History"
            ],
            "modification_date": "2018-04-09",
            "name": "Unusual AWS EC2 Modifications",
            "narrative": "A common attack technique is to infiltrate a cloud instance and make modifications. The adversary can then secure access to your infrastructure or hide their activities. So it's important to stay alert to changes that may indicate that your environment has been compromised. \\\n Searches within this Analytic Story can help you detect the presence of a threat by monitoring for EC2 instances that have been created or changed--either by users that have never previously performed these activities or by known users who modify or create instances in a way that have not been done before. This story also provides investigative searches that help you go deeper once you detect suspicious behavior.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf"
            ],
            "responses": [],
            "story_id": "73de57ef-0dfc-411f-b1e7-fa24428aeae0",
            "support": [
                "Previously Seen EC2 Modifications By User"
            ],
            "type": "ESCU",
            "version": 1
        },
        "758196b5-2e21-424f-a50c-6e421ce926c2": {
            "author": "Patrick Bareiss, Splunk",
            "description": "Sunburst is a trojanized updates to SolarWinds Orion IT monitoring and management software. It was discovered by FireEye in December 2020. The actors behind this campaign gained access to numerous public and private organizations around the world.",
            "detections": [
                "detect_prohibited_applications_spawning_cmd_exe",
                "first_time_seen_running_windows_service",
                "malicious_powershell_process_-_encoded_command",
                "sc_exe_manipulating_windows_services",
                "scheduled_task_deleted_or_created_via_cmd",
                "schtasks_scheduling_job_on_remote_system",
                "sunburst_correlation_dll_and_network_event",
                "windows_adfind_exe",
                "detect_outbound_smb_traffic",
                "tor_traffic"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [],
            "modification_date": "2020-12-14",
            "name": "Sunburst Malware",
            "narrative": "This Analytic Story supports you to detect Tactics, Techniques and Procedures (TTPs) from the Sunburst malware. The threat actor behind sunburst compromised the SolarWinds.Orion.Core.BusinessLayer.dll, is a SolarWinds digitally-signed component of the Orion software framework that contains a backdoor that communicates via HTTP to third party servers. The detections in this Analytic Story are focusing on the dll loading events, file create events and network events to detect This malware.",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html",
                "https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/"
            ],
            "responses": [],
            "story_id": "758196b5-2e21-424f-a50c-6e421ce926c2",
            "support": [
                "Previously Seen Running Windows Services - Initial",
                "Previously Seen Running Windows Services - Update"
            ],
            "type": "ESCU",
            "version": 1
        },
        "7678c968-d46e-11ea-87d0-0242ac130003": {
            "author": "Shannon Davis, Splunk",
            "description": "Uncover activity consistent with CVE-2020-5902. Discovered by Positive Technologies researchers, this vulnerability affects F5 BIG-IP, BIG-IQ. and Traffix SDC devices (vulnerable versions in F5 support link below). This vulnerability allows unauthenticated users, along with authenticated users, who have access to the configuration utility to execute system commands, create/delete files, disable services, and/or execute Java code.  This vulnerability can result in full system compromise.",
            "detections": [
                "detect_f5_tmui_rce_cve-2020-5902"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Notable History",
                "Get Notable Info"
            ],
            "modification_date": "2020-08-02",
            "name": "F5 TMUI RCE CVE-2020-5902",
            "narrative": "A client is able to perform a remote code execution on an exposed and vulnerable system. The detection search in this Analytic Story uses syslog to detect the malicious behavior. Syslog is going to be the best detection method, as any systems using SSL to protect their management console will make detection via wire data difficult.  The searches included used Splunk Connect For Syslog (https://splunkbase.splunk.com/app/4740/), and used a custom destination port to help define the data as F5 data (covered in https://splunk-connect-for-syslog.readthedocs.io/en/master/sources/F5/)",
            "references": [
                "https://www.ptsecurity.com/ww-en/about/news/f5-fixes-critical-vulnerability-discovered-by-positive-technologies-in-big-ip-application-delivery-controller/",
                "https://support.f5.com/csp/article/K52145254",
                "https://blog.cloudflare.com/cve-2020-5902-helping-to-protect-against-the-f5-tmui-rce-vulnerability/"
            ],
            "responses": [],
            "story_id": "7678c968-d46e-11ea-87d0-0242ac130003",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "8168ca88-392e-42f4-85a2-767579c660ce": {
            "author": "David Dorsey, Splunk",
            "description": "Monitor your cloud infrastructure provisioning activities for behaviors originating from unfamiliar or unusual locations. These behaviors may indicate that malicious activities are occurring somewhere within your cloud environment.",
            "detections": [
                "abnormally_high_number_of_cloud_instances_destroyed",
                "abnormally_high_number_of_cloud_instances_launched",
                "cloud_instance_modified_by_previously_unseen_user"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "AWS Investigate User Activities By Source User",
                "AWS Investigate User Activities By Source User",
                "Get All AWS Activity From IP Address"
            ],
            "modification_date": "2020-08-25",
            "name": "Suspicious Cloud Instance Activities",
            "narrative": "Monitoring your cloud infrastructure logs allows you enable governance, compliance, and risk auditing. It is crucial for a company to monitor events and actions taken in the their cloud environments to ensure that your instances are not vulnerable to attacks. This Analytic Story identifies suspicious activities in your cloud compute instances and helps you respond and investigate those activities.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf"
            ],
            "responses": [],
            "story_id": "8168ca88-392e-42f4-85a2-767579c660ce",
            "support": [
                "Baseline Of Cloud Instances Destroyed",
                "Baseline Of Cloud Instances Launched",
                "Previously Seen Cloud Instance Modifications By User - Initial",
                "Previously Seen Cloud Instance Modifications By User - Update"
            ],
            "type": "ESCU",
            "version": 1
        },
        "8169f17b-ef68-4b59-aa28-586907301221": {
            "author": "Bhavin Patel, Splunk",
            "description": "Secure your environment against DNS hijacks with searches that help you detect and investigate unauthorized changes to DNS records.",
            "detections": [
                "clients_connecting_to_multiple_dns_servers",
                "detect_hosts_connecting_to_dynamic_domain_providers",
                "dns_query_requests_resolved_by_unauthorized_dns_servers",
                "dns_record_changed"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "DNS Hijack Enrichment",
                "Get DNS Server History for a host"
            ],
            "modification_date": "2020-02-04",
            "name": "DNS Hijacking",
            "narrative": "Dubbed the Achilles heel of the Internet (see https://www.f5.com/labs/articles/threat-intelligence/dns-is-still-the-achilles-heel-of-the-internet-25613), DNS plays a critical role in routing web traffic but is notoriously vulnerable to attack. One reason is its distributed nature. It relies on unstructured connections between millions of clients and servers over inherently insecure protocols.\\\nThe gravity and extent of the importance of securing DNS from attacks is undeniable. The fallout of compromised DNS can be disastrous. Not only can hackers bring down an entire business, they can intercept confidential information, emails, and login credentials, as well. \\\nOn January 22, 2019, the US Department of Homeland Security 2019's Cybersecurity and Infrastructure Security Agency (CISA) raised awareness of some high-profile DNS hijacking attacks against infrastructure, both in the United States and abroad. It issued Emergency Directive 19-01 (see https://cyber.dhs.gov/ed/19-01/), which summarized the activity and required government agencies to take the following four actions, all within 10 days: \\\n1. For all .gov or other agency-managed domains, audit public DNS records on all authoritative and secondary DNS servers, verify that they resolve to the intended location or report them to CISA.\\\n1. Update the passwords for all accounts on systems that can make changes to each agency 2019's DNS records.\\\n1. Implement multi-factor authentication (MFA) for all accounts on systems that can make changes to each agency's 2019 DNS records or, if impossible, provide CISA with the names of systems, the reasons why MFA cannot be enabled within the required timeline, and an ETA for when it can be enabled.\\\n1. CISA will begin regular delivery of newly added certificates to Certificate Transparency (CT) logs for agency domains via the Cyber Hygiene service. Upon receipt, agencies must immediately begin monitoring CT log data for certificates issued that they did not request. If an agency confirms that a certificate was unauthorized, it must report the certificate to the issuing certificate authority and to CISA. Of course, it makes sense to put equivalent actions in place within your environment, as well. \\\nIn DNS hijacking, the attacker assumes control over an account or makes use of a DNS service exploit to make changes to DNS records. Once they gain access, attackers can substitute their own MX records, name-server records, and addresses, redirecting emails and traffic through their infrastructure, where they can read, copy, or modify information seen. They can also generate valid encryption certificates to help them avoid browser-certificate checks. In one notable attack on the Internet service provider, GoDaddy, the hackers altered Sender Policy Framework (SPF) records a relatively minor change that did not inflict excessive damage but allowed for more effective spam campaigns.\\\nThe searches in this Analytic Story help you detect and investigate activities that may indicate that DNS hijacking has taken place within your environment.",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2017/09/apt33-insights-into-iranian-cyber-espionage.html",
                "https://umbrella.cisco.com/blog/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/",
                "http://www.noip.com/blog/2014/07/11/dynamic-dns-can-use-2/",
                "https://www.splunk.com/blog/2015/08/04/detecting-dynamic-dns-domains-in-splunk.html"
            ],
            "responses": [],
            "story_id": "8169f17b-ef68-4b59-aa28-586907301221",
            "support": [
                "Discover DNS records"
            ],
            "type": "ESCU",
            "version": 1
        },
        "8169f17b-ef68-4b59-aae8-586907301221": {
            "author": "Bhavin Patel, Splunk",
            "description": "Detect and investigate hosts in your environment that may be communicating with dynamic domain providers. Attackers may leverage these services to help them avoid firewall blocks and blacklists.",
            "detections": [
                "detect_hosts_connecting_to_dynamic_domain_providers",
                "detect_web_traffic_to_dynamic_domain_providers"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From src ip",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get DNS traffic ratio",
                "Get Notable History",
                "Get Notable Info",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From src ip"
            ],
            "modification_date": "2018-09-06",
            "name": "Dynamic DNS",
            "narrative": "Dynamic DNS services (DDNS) are legitimate low-cost or free services that allow users to rapidly update domain resolutions to IP infrastructure. While their usage can be benign, malicious actors can abuse DDNS to host harmful payloads or interactive-command-and-control infrastructure. These attackers will manually update or automate domain resolution changes by routing dynamic domains to IP addresses that circumvent firewall blocks and blacklists and frustrate a network defender's analytic and investigative processes. These searches will look for DNS queries made from within your infrastructure to suspicious dynamic domains and then investigate more deeply, when appropriate. While this list of top-level dynamic domains is not exhaustive, it can be dynamically updated as new suspicious dynamic domains are identified.",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2017/09/apt33-insights-into-iranian-cyber-espionage.html",
                "https://umbrella.cisco.com/blog/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/",
                "http://www.noip.com/blog/2014/07/11/dynamic-dns-can-use-2/",
                "https://www.splunk.com/blog/2015/08/04/detecting-dynamic-dns-domains-in-splunk.html"
            ],
            "responses": [],
            "story_id": "8169f17b-ef68-4b59-aae8-586907301221",
            "support": [],
            "type": "ESCU",
            "version": 2
        },
        "826e6431-aeef-41b4-9fc0-6d0985d65a21": {
            "author": "Bhavin Patel, Splunk",
            "description": "Leverage searches that detect cleartext network protocols that may leak credentials or should otherwise be encrypted.",
            "detections": [
                "protocols_passing_authentication_in_cleartext"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Notable History",
                "Get Notable Info",
                "Get Process Information For Port Activity",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table"
            ],
            "modification_date": "2017-09-15",
            "name": "Use of Cleartext Protocols",
            "narrative": "Various legacy protocols operate by default in the clear, without the protections of encryption. This potentially leaks sensitive information that can be exploited by passively sniffing network traffic. Depending on the protocol, this information could be highly sensitive, or could allow for session hijacking. In addition, these protocols send authentication information, which would allow for the harvesting of usernames and passwords that could potentially be used to authenticate and compromise secondary systems.",
            "references": [
                "https://www.monkey.org/~dugsong/dsniff/"
            ],
            "responses": [],
            "story_id": "826e6431-aeef-41b4-9fc0-6d0985d65a21",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "854d78bf-d0e2-4f4e-b05c-640905f86d7a": {
            "author": "Rico Valdez, Splunk",
            "description": "Uncover activity consistent with credential dumping, a technique wherein attackers compromise systems and attempt to obtain and exfiltrate passwords. The threat actors use these pilfered credentials to further escalate privileges and spread throughout a target environment. The included searches in this Analytic Story are designed to identify attempts to credential dumping.",
            "detections": [
                "detect_mimikatz_using_loaded_images",
                "unsigned_image_loaded_by_lsass",
                "access_lsass_memory_for_dump_creation",
                "attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass",
                "attempted_credential_dump_from_registry_via_reg_exe",
                "attempted_credential_dump_from_registry_via_reg_exe_-_ssa",
                "create_remote_thread_into_lsass",
                "creation_of_shadow_copy",
                "creation_of_shadow_copy_with_wmic_and_powershell",
                "credential_dumping_via_copy_command_from_shadow_copy",
                "credential_dumping_via_symlink_to_shadow_copy",
                "detect_credential_dumping_through_lsass_access",
                "detect_dump_lsass_memory_using_comsvcs_-_ssa",
                "dump_lsass_via_comsvcs_dll"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Investigate Failed Logins for Multiple Destinations",
                "Investigate Pass the Hash Attempts",
                "Investigate Pass the Ticket Attempts",
                "Investigate Previous Unseen User"
            ],
            "modification_date": "2020-02-04",
            "name": "Credential Dumping",
            "narrative": "Credential dumping&#151;gathering credentials from a target system, often hashed or encrypted&#151;is a common attack technique. Even though the credentials may not be in plain text, an attacker can still exfiltrate the data and set to cracking it offline, on their own systems. The threat actors target a variety of sources to extract them, including the Security Accounts Manager (SAM), Local Security Authority (LSA), NTDS from Domain Controllers, or the Group Policy Preference (GPP) files.\\\nOnce attackers obtain valid credentials, they use them to move throughout a target network with ease, discovering new systems and identifying assets of interest. Credentials obtained in this manner typically include those of privileged users, which may provide access to more sensitive information and system operations.\\\nThe detection searches in this Analytic Story monitor access to the Local Security Authority Subsystem Service (LSASS) process, the usage of shadowcopies for credential dumping and some other techniques for credential dumping.",
            "references": [
                "https://attack.mitre.org/wiki/Technique/T1003",
                "https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for.html"
            ],
            "responses": [],
            "story_id": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "support": [],
            "type": "ESCU",
            "version": 3
        },
        "8892a655-6205-43f7-abba-06460e38c8ae": {
            "author": "David Dorsey, Splunk",
            "description": "Identify and investigate prohibited/unauthorized software or processes that may be concealing malicious behavior within your environment. ",
            "detections": [
                "prohibited_software_on_endpoint",
                "prohibited_software_on_endpoint"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-09-15",
            "name": "Monitor for Unauthorized Software",
            "narrative": "It is critical to identify unauthorized software and processes running on enterprise endpoints and determine whether they are likely to be malicious. This Analytic Story requires the user to populate the Interesting Processes table within Enterprise Security with prohibited processes. An included support search will augment this data, adding information on processes thought to be malicious. This search requires data from endpoint detection-and-response solutions, endpoint data sources (such as Sysmon), or Windows Event Logs--assuming that the Active Directory administrator has enabled process tracking within the System Event Audit Logs.\\\nIt is important to investigate any software identified as suspicious, in order to understand how it was installed or executed. Analyzing authentication logs or any historic notable events might elicit additional investigative leads of interest. For best results, schedule the search to run every two weeks. ",
            "references": [
                "https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/"
            ],
            "responses": [],
            "story_id": "8892a655-6205-43f7-abba-06460e38c8ae",
            "support": [
                "Add Prohibited Processes to Enterprise Security",
                "Add Prohibited Processes to Enterprise Security"
            ],
            "type": "ESCU",
            "version": 1
        },
        "8892a655-6205-55f7-abba-06460e38c8ae": {
            "author": "David Dorsey, Splunk",
            "description": "A common attack technique is to leverage user accounts to gain unauthorized access to the target's network. This Analytic Story minimizes opportunities for attack by helping you actively manage creation/use/dormancy/deletion--the lifecycle of system and application accounts.",
            "detections": [
                "identify_new_user_accounts",
                "detect_excessive_account_lockouts_from_endpoint",
                "detect_excessive_user_account_lockouts",
                "short_lived_windows_accounts"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Excessive Account Lockouts Enrichment And Response",
                "Get Authentication Logs For Endpoint",
                "Get Logon Rights Modifications For Endpoint",
                "Get Logon Rights Modifications For User",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table"
            ],
            "modification_date": "2017-09-06",
            "name": "Account Monitoring and Controls",
            "narrative": "Monitoring user accounts within your enterprise is a critical analytic function that helps ensure that credential and access policies/procedures are properly implemented and are being enforced. Proactive ad-hoc hunting, as well as routine monitoring, can ensure user or system accounts are not being abused by unauthorized individuals or processes. In the event of a network event or breach, user-authentication logs are a key resource in determining if or how an account might have been compromised or co-opted, leading to suspicious or malicious activity.",
            "references": [],
            "responses": [],
            "story_id": "8892a655-6205-55f7-abba-06460e38c8ae",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "8e03c61e-13c4-4dcd-bfbe-5ce5a8dc031a": {
            "author": "Rico Valdez, Splunk",
            "description": "Monitor for and investigate activities--such as suspicious writes to the Windows Recycling Bin or email servers sending high amounts of traffic to specific hosts, for example--that may indicate that an adversary is harvesting and exfiltrating sensitive data. ",
            "detections": [
                "email_files_written_outside_of_the_outlook_directory",
                "email_servers_sending_high_volume_traffic_to_hosts",
                "suspicious_writes_to_system_volume_information",
                "suspicious_writes_to_system_volume_information",
                "suspicious_writes_to_windows_recycle_bin",
                "hosts_receiving_high_volume_of_network_traffic_from_email_server"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-02-03",
            "name": "Collection and Staging",
            "narrative": "A common adversary goal is to identify and exfiltrate data of value from a target organization. This data may include email conversations and addresses, confidential company information, links to network design/infrastructure, important dates, and so on.\\\n Attacks are composed of three activities: identification, collection, and staging data for exfiltration. Identification typically involves scanning systems and observing user activity. Collection can involve the transfer of large amounts of data from various repositories. Staging/preparation includes moving data to a central location and compressing (and optionally encoding and/or encrypting) it. All of these activities provide opportunities for defenders to identify their presence. \\\nUse the searches to detect and monitor suspicious behavior related to these activities.",
            "references": [
                "https://attack.mitre.org/wiki/Collection",
                "https://attack.mitre.org/wiki/Technique/T1074"
            ],
            "responses": [],
            "story_id": "8e03c61e-13c4-4dcd-bfbe-5ce5a8dc031a",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "91c676cf-0b23-438d-abee-f6335e177e77": {
            "author": "Bhavin Patel, Splunk",
            "description": "Validate the security configuration of network infrastructure and verify that only authorized users and systems are accessing critical assets. Core routing and switching infrastructure are common strategic targets for attackers.",
            "detections": [
                "detect_new_login_attempts_to_routers",
                "detect_arp_poisoning",
                "detect_ipv6_network_infrastructure_threats",
                "detect_port_security_violation",
                "detect_rogue_dhcp_server",
                "detect_software_download_to_network_device",
                "detect_traffic_mirroring"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table"
            ],
            "modification_date": "2017-09-12",
            "name": "Router and Infrastructure Security",
            "narrative": "Networking devices, such as routers and switches, are often overlooked as resources that attackers will leverage to subvert an enterprise. Advanced threats actors have shown a proclivity to target these critical assets as a means to siphon and redirect network traffic, flash backdoored operating systems, and implement cryptographic weakened algorithms to more easily decrypt network traffic.\\\nThis Analytic Story helps you gain a better understanding of how your network devices are interacting with your hosts. By compromising your network devices, attackers can obtain direct access to the company's internal infrastructure&#151; effectively increasing the attack surface and accessing private services/data.",
            "references": [
                "https://www.fireeye.com/blog/executive-perspective/2015/09/the_new_route_toper.html",
                "https://www.cisco.com/c/en/us/about/security-center/event-response/synful-knock.html"
            ],
            "responses": [],
            "story_id": "91c676cf-0b23-438d-abee-f6335e177e77",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "91c676cf-0b23-438d-abee-f6335e1fce33": {
            "author": "Bhavin Patel, Splunk",
            "description": "Fortify your data-protection arsenal--while continuing to ensure data confidentiality and integrity--with searches that monitor for and help you investigate possible signs of data exfiltration.",
            "detections": [
                "detect_usb_device_insertion",
                "detect_usb_device_insertion",
                "detect_hosts_connecting_to_dynamic_domain_providers",
                "detection_of_dns_tunnels"
            ],
            "escu_category": [
                "Abuse"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get DNS traffic ratio",
                "Get Notable History",
                "Get Notable Info",
                "Get Process Info",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-09-14",
            "name": "Data Protection",
            "narrative": "Attackers can leverage a variety of resources to compromise or exfiltrate enterprise data. Common exfiltration techniques include remote-access channels via low-risk, high-payoff active-collections operations and close-access operations using insiders and removable media. While this Analytic Story is not a comprehensive listing of all the methods by which attackers can exfiltrate data, it provides a useful starting point.",
            "references": [
                "https://www.cisecurity.org/controls/data-protection/",
                "https://www.sans.org/reading-room/whitepapers/dns/splunk-detect-dns-tunneling-37022",
                "https://umbrella.cisco.com/blog/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/"
            ],
            "responses": [],
            "story_id": "91c676cf-0b23-438d-abee-f6335e1fce33",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "91c676cf-0b23-438d-abee-f6335e1fce77": {
            "author": "Bhavin Patel, Splunk",
            "description": "Keep a careful inventory of every asset on your network to make it easier to detect rogue devices. Unauthorized/unmanaged devices could be an indication of malicious behavior that should be investigated further.",
            "detections": [
                "detect_unauthorized_assets_by_mac_address"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "Get Notable Info",
                "Get First Occurrence and Last Occurrence of a MAC Address",
                "Get Notable History",
                "Get Notable Info"
            ],
            "modification_date": "2017-09-13",
            "name": "Asset Tracking",
            "narrative": "This Analytic Story is designed to help you develop a better understanding of what authorized and unauthorized devices are part of your enterprise. This story can help you better categorize and classify assets, providing critical business context and awareness of their assets during an incident. Information derived from this Analytic Story can be used to better inform and support other analytic stories. For successful detection, you will need to leverage the Assets and Identity Framework from Enterprise Security to populate your known assets.",
            "references": [
                "https://www.cisecurity.org/controls/inventory-of-authorized-and-unauthorized-devices/"
            ],
            "responses": [],
            "story_id": "91c676cf-0b23-438d-abee-f6335e1fce77",
            "support": [
                "Count of assets by category"
            ],
            "type": "ESCU",
            "version": 1
        },
        "91c676cf-0b23-438d-abee-f6335e1fce78": {
            "author": "David Dorsey, Splunk",
            "description": "Detect and investigate activity that may indicate that an adversary is using faux domains to mislead users into interacting with malicious infrastructure. Monitor DNS, email, and web traffic for permutations of your brand name.",
            "detections": [
                "monitor_email_for_brand_abuse",
                "monitor_dns_for_brand_abuse",
                "monitor_web_traffic_for_brand_abuse"
            ],
            "escu_category": [
                "Abuse"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Get Authentication Logs For Endpoint",
                "Get Email Info",
                "Get Emails From Specific Sender",
                "Get Notable History",
                "Get Notable Info",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host"
            ],
            "modification_date": "2017-12-19",
            "name": "Brand Monitoring",
            "narrative": "While you can educate your users and customers about the risks and threats posed by typosquatting, phishing, and corporate espionage, human error is a persistent fact of life. Of course, your adversaries are all too aware of this reality and will happily leverage it for nefarious purposes whenever possible&#51;phishing with lookalike addresses, embedding faux command-and-control domains in malware, and hosting malicious content on domains that closely mimic your corporate servers. This is where brand monitoring comes in.\\\nYou can use our adaptation of `DNSTwist`, together with the support searches in this Analytic Story, to generate permutations of specified brands and external domains. Splunk can monitor email, DNS requests, and web traffic for these permutations and provide you with early warnings and situational awareness--powerful elements of an effective defense.\\\nNotable events will include IP addresses, URLs, and user data. Drilling down can provide you with even more actionable intelligence, including likely geographic information, contextual searches to help you scope the problem, and investigative searches.",
            "references": [
                "https://www.zerofox.com/blog/what-is-digital-risk-monitoring/",
                "https://securingtomorrow.mcafee.com/consumer/family-safety/what-is-typosquatting/",
                "https://blog.malwarebytes.com/cybercrime/2016/06/explained-typosquatting/"
            ],
            "responses": [],
            "story_id": "91c676cf-0b23-438d-abee-f6335e1fce78",
            "support": [
                "DNSTwist Domain Names"
            ],
            "type": "ESCU",
            "version": 1
        },
        "943773c6-c4de-4f38-89a8-0b92f98804d8": {
            "author": "Rico Valdez, Splunk",
            "description": "Detect and investigate tactics, techniques, and procedures leveraged by attackers to establish and operate command and control channels. Implants installed by attackers on compromised endpoints use these channels to receive instructions and send data back to the malicious operators.",
            "detections": [
                "detect_spike_in_blocked_outbound_traffic_from_your_aws",
                "clients_connecting_to_multiple_dns_servers",
                "detect_hosts_connecting_to_dynamic_domain_providers",
                "detect_large_outbound_icmp_packets",
                "detect_long_dns_txt_record_response",
                "detection_of_dns_tunnels",
                "dns_query_length_outliers_-_mltk",
                "dns_query_length_with_high_standard_deviation",
                "dns_query_requests_resolved_by_unauthorized_dns_servers",
                "excessive_dns_failures",
                "prohibited_network_traffic_allowed",
                "protocol_or_port_mismatch",
                "tor_traffic"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "AWS Network ACL Details from ID",
                "AWS Network Interface details via resourceId",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get All AWS Activity From IP Address",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get DNS traffic ratio",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-06-01",
            "name": "Command and Control",
            "narrative": "Threat actors typically architect and implement an infrastructure to use in various ways during the course of their attack campaigns. In some cases, they leverage this infrastructure for scanning and performing reconnaissance activities. In others, they may use this infrastructure to launch actual attacks. One of the most important functions of this infrastructure is to establish servers that will communicate with implants on compromised endpoints. These servers establish a command and control channel that is used to proxy data between the compromised endpoint and the attacker. These channels relay commands from the attacker to the compromised endpoint and the output of those commands back to the attacker.\\\nBecause this communication is so critical for an adversary, they often use techniques designed to hide the true nature of the communications. There are many different techniques used to establish and communicate over these channels. This Analytic Story provides searches that look for a variety of the techniques used for these channels, as well as indications that these channels are active, by examining logs associated with border control devices and network-access control lists.",
            "references": [
                "https://attack.mitre.org/wiki/Command_and_Control",
                "https://searchsecurity.techtarget.com/feature/Command-and-control-servers-The-puppet-masters-that-govern-malware"
            ],
            "responses": [],
            "story_id": "943773c6-c4de-4f38-89a8-0b92f98804d8",
            "support": [
                "Baseline of blocked outbound traffic from AWS",
                "Baseline of DNS Query Length - MLTK"
            ],
            "type": "ESCU",
            "version": 1
        },
        "988C59C5-0A1C-45B6-A555-0C62276E327E": {
            "author": "iDefense Cyber Espionage Team, iDefense",
            "description": "Monitor your environment for suspicious behaviors that resemble the techniques employed by the MUDCARP threat group.",
            "detections": [
                "first_time_seen_command_line_argument",
                "first_time_seen_command_line_argument",
                "malicious_powershell_process_-_connect_to_internet_with_hidden_window",
                "registry_keys_used_for_persistence",
                "unusually_long_command_line",
                "unusually_long_command_line_-_mltk"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-01-22",
            "name": "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
            "narrative": "This story was created as a joint effort between iDefense and Splunk.\\\niDefense analysts have recently discovered a Windows executable file that, upon execution, spoofs a decryption tool and then drops a file that appears to be the custom-built javascript backdoor, \"Orz,\" which is associated with the threat actors known as MUDCARP (as well as \"temp.Periscope\" and \"Leviathan\"). The file is executed using Wscript.\\\nThe MUDCARP techniques include the use of the compressed-folders module from Microsoft, zipfldr.dll, with RouteTheCall export to run the malicious process or command. After a successful reboot, the malware is made persistent by a manipulating `[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]'help'='c:\\\\windows\\\\system32\\\\rundll32.exe c:\\\\windows\\\\system32\\\\zipfldr.dll,RouteTheCall c:\\\\programdata\\\\winapp.exe'`. Though this technique is not exclusive to MUDCARP, it has been spotted in the group's arsenal of advanced techniques seen in the wild.\\\nThis Analytic Story searches for evidence of tactics, techniques, and procedures (TTPs) that allow for the use of a endpoint detection-and-response (EDR) bypass technique to mask the true parent of a malicious process. It can also be set as a registry key for further sandbox evasion and to allow the malware to launch only after reboot.\\\nIf behavioral searches included in this story yield positive hits, iDefense recommends conducting IOC searches for the following:\\\n\\\n1. www.chemscalere[.]com\\\n1. chemscalere[.]com\\\n1. about.chemscalere[.]com\\\n1. autoconfig.chemscalere[.]com\\\n1. autodiscover.chemscalere[.]com\\\n1. catalog.chemscalere[.]com\\\n1. cpanel.chemscalere[.]com\\\n1. db.chemscalere[.]com\\\n1. ftp.chemscalere[.]com\\\n1. mail.chemscalere[.]com\\\n1. news.chemscalere[.]com\\\n1. update.chemscalere[.]com\\\n1. webmail.chemscalere[.]com\\\n1. www.candlelightparty[.]org\\\n1. candlelightparty[.]org\\\n1. newapp.freshasianews[.]comIn addition, iDefense also recommends that organizations review their environments for activity related to the following hashes:\\\n\\\n1. cd195ee448a3657b5c2c2d13e9c7a2e2\\\n1. b43ad826fe6928245d3c02b648296b43\\\n1. 889a9b52566448231f112a5ce9b5dfaf\\\n1. b8ec65dab97cdef3cd256cc4753f0c54\\\n1. 04d83cd3813698de28cfbba326d7647c",
            "references": [
                "https://www.infosecurity-magazine.com/news/scope-of-mudcarp-attacks-highlight-1/",
                "http://blog.amossys.fr/badflick-is-not-so-bad.html"
            ],
            "responses": [],
            "story_id": "988C59C5-0A1C-45B6-A555-0C62276E327E",
            "support": [
                "Baseline of Command Line Length - MLTK",
                "Previously seen command line arguments"
            ],
            "type": "ESCU",
            "version": 1
        },
        "9a64ab44-9214-4639-8163-7eaa2621bd61": {
            "author": "Splunk Research Team, Splunk",
            "description": "Detect DNS and web requests to fake websites generated by the EvilGinx2 toolkit. These websites are designed to fool unwitting users who have clicked on a malicious link in a phishing email. ",
            "detections": [
                "detect_dns_requests_to_phishing_sites_leveraging_evilginx2"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Domain Certificate Investigation",
                "Get Certificate logs for a domain"
            ],
            "modification_date": "2019-04-29",
            "name": "Common Phishing Frameworks",
            "narrative": "As most people know, these emails use fraudulent domains, [email scraping](https://www.cyberscoop.com/emotet-trojan-phishing-scraping-templates-cofense-geodo/), familiar contact names inserted as senders, and other tactics to lure targets into clicking a malicious link, opening an attachment with a [nefarious payload](https://www.cyberscoop.com/emotet-trojan-phishing-scraping-templates-cofense-geodo/), or entering sensitive personal information that perpetrators may intercept. This attack technique requires a relatively low level of skill and allows adversaries to easily cast a wide net. Because phishing is a technique that relies on human psychology, you will never be able to eliminate this vulnerability 100%. But you can use automated detection to significantly reduce the risks.\\\nThis Analytic Story focuses on detecting signs of MiTM attacks enabled by [EvilGinx2](https://github.com/kgretzky/evilginx2), a toolkit that sets up a transparent proxy between the targeted site and the user. In this way, the attacker is able to intercept credentials and two-factor identification tokens. It employs a proxy template to allow a registered domain to impersonate targeted sites, such as Linkedin, Amazon, Okta, Github, Twitter, Instagram, Reddit, Office 365, and others. It can even register SSL certificates and camouflage them via a URL shortener, making them difficult to detect. Searches in this story look for signs of MiTM attacks enabled by EvilGinx2.",
            "references": [
                "https://github.com/kgretzky/evilginx2",
                "https://attack.mitre.org/techniques/T1192/",
                "https://breakdev.org/evilginx-advanced-phishing-with-two-factor-authentication-bypass/"
            ],
            "responses": [],
            "story_id": "9a64ab44-9214-4639-8163-7eaa2621bd61",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "9cbd34af-8f39-4476-a423-bacd126c750b": {
            "author": "Rico Valdez, Splunk",
            "description": "Monitor your Okta environment for suspicious activities. Due to the Covid outbreak, many users are migrating over to leverage cloud services more and more. Okta is a popular tool to manage multiple users and the web-based applications they need to stay productive. The searches in this story will help monitor your Okta environment for suspicious activities and associated user behaviors.",
            "detections": [
                "multiple_okta_users_with_invalid_credentails_from_the_same_ip",
                "okta_account_lockout_events",
                "okta_failed_sso_attempts",
                "okta_user_logins_from_multiple_cities"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Investigate Okta Activity by app",
                "Investigate Okta Activity by IP Address",
                "Investigate User Activities In Okta"
            ],
            "modification_date": "2020-04-02",
            "name": "Suspicious Okta Activity",
            "narrative": "Okta is the leading single sign on (SSO) provider, allowing users to authenticate once to Okta, and from there access a variety of web-based applications. These applications are assigned to users and allow administrators to centrally manage which users are allowed to access which applications. It also provides centralized logging to help understand how the applications are used and by whom. \\\nWhile SSO is a major convenience for users, it also provides attackers with an opportunity. If the attacker can gain access to Okta, they can access a variety of applications. As such monitoring the environment is important. \\\nWith people moving quickly to adopt web-based applications and ways to manage them, many are still struggling to understand how best to monitor these environments. This analytic story provides searches to help monitor this environment, and identify events and activity that warrant further investigation such as credential stuffing or password spraying attacks, and users logging in from multiple locations when travel is disallowed.",
            "references": [
                "https://attack.mitre.org/wiki/Technique/T1078",
                "https://owasp.org/www-community/attacks/Credential_stuffing",
                "https://searchsecurity.techtarget.com/answer/What-is-a-password-spraying-attack-and-how-does-it-work"
            ],
            "responses": [],
            "story_id": "9cbd34af-8f39-4476-a423-bacd126c750b",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "9ef8d677-7b52-4213-a038-99cfc7acc2d8": {
            "author": "Rico Valdez, Splunk",
            "description": "Monitor your enterprise to ensure that your endpoints are being patched and updated. Adversaries notoriously exploit known vulnerabilities that could be mitigated by applying routine security patches.",
            "detections": [
                "no_windows_updates_in_a_time_frame"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint"
            ],
            "modification_date": "2017-09-15",
            "name": "Monitor for Updates",
            "narrative": "It is a common best practice to ensure that endpoints are being patched and updated in a timely manner, in order to reduce the risk of compromise via a publicly disclosed vulnerability. Timely application of updates/patches is important to eliminate known vulnerabilities that may be exploited by various threat actors.\\\nSearches in this analytic story are designed to help analysts monitor endpoints for system patches and/or updates. This helps analysts identify any systems that are not successfully updated in a timely matter.\\\nMicrosoft releases updates for Windows systems on a monthly cadence. They should be installed as soon as possible after following internal testing and validation procedures. Patches and updates for other systems or applications are typically released as needed.",
            "references": [
                "https://learn.cisecurity.org/20-controls-download"
            ],
            "responses": [],
            "story_id": "9ef8d677-7b52-4213-a038-99cfc7acc2d8",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "a9ef59cf-e981-4e66-9eef-bb049f695c09": {
            "author": "Rod Soto, Splunk",
            "description": "This story addresses detection against Kubernetes cluster fingerprint scan and attack by providing information on items such as source ip, user agent, cluster names.",
            "detections": [
                "amazon_eks_kubernetes_cluster_scan_detection",
                "amazon_eks_kubernetes_pod_scan_detection",
                "gcp_kubernetes_cluster_pod_scan_detection",
                "gcp_kubernetes_cluster_scan_detection",
                "kubernetes_azure_pod_scan_fingerprint",
                "kubernetes_azure_scan_fingerprint"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Amazon EKS Kubernetes activity by src ip",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "GCP Kubernetes activity by src ip",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint"
            ],
            "modification_date": "2020-04-15",
            "name": "Kubernetes Scanning Activity",
            "narrative": "Kubernetes is the most used container orchestration platform, this orchestration platform contains sensitve information and management priviledges of production workloads, microservices and applications. These searches allow operator to detect suspicious unauthenticated requests from the internet to kubernetes cluster.",
            "references": [
                "https://github.com/splunk/cloud-datamodel-security-research"
            ],
            "responses": [],
            "story_id": "a9ef59cf-e981-4e66-9eef-bb049f695c09",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "aa0e28b1-0521-4b6f-9d2a-7b87e34af246": {
            "author": "Rod Soto, Rico Valdez, Splunk",
            "description": "Use the searches in this story to monitor your Kubernetes registry repositories for upload, and deployment of potentially vulnerable, backdoor, or implanted containers. These searches provide information on source users, destination path, container names and repository names. The searches provide context to address Mitre T1525 which refers to container implantation upload to a company's repository either in Amazon Elastic Container Registry, Google Container Registry and Azure Container Registry.",
            "detections": [
                "gcp_gcr_container_uploaded",
                "new_container_uploaded_to_aws_ecr"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "Investigate AWS ECR container listing activity",
                "Investigate AWS ECR container listing activity"
            ],
            "modification_date": "2020-02-20",
            "name": "Container Implantation Monitoring and Investigation",
            "narrative": "Container Registrys provide a way for organizations to keep customized images of their development and infrastructure environment in private. However if these repositories are misconfigured or priviledge users credentials are compromise, attackers can potentially upload implanted containers which can be deployed across the organization. These searches allow operator to monitor who, when and what was uploaded to container registry.",
            "references": [
                "https://github.com/splunk/cloud-datamodel-security-research"
            ],
            "responses": [],
            "story_id": "aa0e28b1-0521-4b6f-9d2a-7b87e34af246",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "aa3749a6-49c7-491e-a03f-4eaee5fe0258": {
            "author": "David Dorsey, Splunk",
            "description": "Attackers are using Zoom as an vector to increase privileges on a sytems. This story detects new child processes of zoom and provides investigative actions for this detection.",
            "detections": [
                "detect_prohibited_applications_spawning_cmd_exe",
                "first_time_seen_child_process_of_zoom"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Process Registry Activity",
                "Get Authentication Logs For Endpoint",
                "Get Process File Activity",
                "Get Process Registry Activity"
            ],
            "modification_date": "2020-04-13",
            "name": "Suspicious Zoom Child Processes",
            "narrative": "Zoom is a leader in modern enterprise video communications and its usage has increased dramatically with a large amount of the population under stay-at-home orders due to the COVID-19 pandemic. With increased usage has come increased scrutiny and several security flaws have been found with this application on both Windows and macOS systems.\\\nCurrent detections focus on finding new child processes of this application on a per host basis. Investigative searches are included to gather information needed during an investigation.",
            "references": [
                "https://blog.rapid7.com/2020/04/02/dispelling-zoom-bugbears-what-you-need-to-know-about-the-latest-zoom-vulnerabilities/",
                "https://threatpost.com/two-zoom-zero-day-flaws-uncovered/154337/"
            ],
            "responses": [],
            "story_id": "aa3749a6-49c7-491e-a03f-4eaee5fe0258",
            "support": [
                "Previously Seen Zoom Child Processes - Initial",
                "Previously Seen Zoom Child Processes - Update"
            ],
            "type": "ESCU",
            "version": 1
        },
        "abe807c7-1eb6-4304-ac32-6e7aacdb891d": {
            "author": "David Dorsey, Splunk",
            "description": "Address common concerns when monitoring your backup processes. These searches can help you reduce risks from ransomware, device theft, or denial of physical access to a host by backing up data on endpoints.",
            "detections": [
                "extended_period_without_successful_netbackup_backups",
                "unsuccessful_netbackup_backups",
                "extended_period_without_successful_netbackup_backups",
                "unsuccessful_netbackup_backups"
            ],
            "escu_category": [
                "Best Practices"
            ],
            "investigations": [
                "All backup logs for host",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Notable History",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User"
            ],
            "modification_date": "2017-09-12",
            "name": "Monitor Backup Solution",
            "narrative": "Having backups is a standard best practice that helps ensure continuity of business operations.  Having mature backup processes can also help you reduce the risks of many security-related incidents and streamline your response processes. The detection searches in this Analytic Story will help you identify systems that have backup failures, as well as systems that have not been backed up for an extended period of time. The story will also return the notable event history and all of the backup logs for an endpoint.",
            "references": [
                "https://www.carbonblack.com/2016/03/04/tracking-locky-ransomware-using-carbon-black/"
            ],
            "responses": [],
            "story_id": "abe807c7-1eb6-4304-ac32-6e7aacdb891d",
            "support": [
                "Monitor Successful Backups",
                "Monitor Unsuccessful Backups"
            ],
            "type": "ESCU",
            "version": 1
        },
        "b6db2c60-a281-48b4-95f1-2cd99ed56835": {
            "author": "Rico Valdez, Splunk",
            "description": "Adversaries often try to cover their tracks by manipulating Windows logs. Use these searches to help you monitor for suspicious activity surrounding log files--an essential component of an effective defense.",
            "detections": [
                "deleting_shadow_copies",
                "suspicious_wevtutil_usage",
                "usn_journal_deletion",
                "windows_event_log_cleared"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2017-09-12",
            "name": "Windows Log Manipulation",
            "narrative": "Because attackers often modify system logs to cover their tracks and/or to thwart the investigative process, log monitoring is an industry-recognized best practice. While there are legitimate reasons to manipulate system logs, it is still worthwhile to keep track of who manipulated the logs, when they manipulated them, and in what way they manipulated them (determining which accesses, tools, or utilities were employed). Even if no malicious activity is detected, the knowledge of an attempt to manipulate system logs may be indicative of a broader security risk that should be thoroughly investigated.\\\nThe Analytic Story gives users two different ways to detect manipulation of Windows Event Logs and one way to detect deletion of the Update Sequence Number (USN) Change Journal. The story helps determine the history of the host and the users who have accessed it. Finally, the story aides in investigation by retrieving all the information on the process that caused these events (if the process has been identified).",
            "references": [
                "https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/",
                "https://zeltser.com/security-incident-log-review-checklist/",
                "http://journeyintoir.blogspot.com/2013/01/re-introducing-usnjrnl.html"
            ],
            "responses": [],
            "story_id": "b6db2c60-a281-48b4-95f1-2cd99ed56835",
            "support": [],
            "type": "ESCU",
            "version": 2
        },
        "baf7580b-d4b4-4774-8173-7d198e9da335": {
            "author": "Rico Valdez, Splunk",
            "description": "Monitor for and investigate activities, including the creation or deletion of hidden shares and file writes, that may be evidence of infiltration by North Korean government-sponsored cybercriminals. Details of this activity were reported in DHS Report TA-18-149A.",
            "detections": [
                "first_time_seen_command_line_argument",
                "suspicious_file_write",
                "create_or_delete_windows_shares_using_net_exe",
                "first_time_seen_command_line_argument",
                "remote_desktop_process_running_on_system",
                "suspicious_file_write",
                "remote_desktop_process_running_on_system",
                "detect_outbound_smb_traffic",
                "dns_query_length_outliers_-_mltk",
                "dns_query_length_with_high_standard_deviation",
                "remote_desktop_network_traffic",
                "smb_traffic_spike",
                "smb_traffic_spike_-_mltk"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get DNS Server History for a host",
                "Get DNS traffic ratio",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Outbound Emails to Hidden Cobra Threat Actors",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Process Responsible For The DNS Traffic",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Successful Remote Desktop Authentications",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-01-22",
            "name": "Hidden Cobra Malware",
            "narrative": "North Korea's government-sponsored \"cyber army\" has been slowly building momentum and gaining sophistication over the last 15 years or so. As a result, the group's activity, which the US government refers to as \"Hidden Cobra,\" has surreptitiously crept onto the collective radar as a preeminent global threat.\\\nThese state-sponsored actors are thought to be responsible for everything from a hack on a South Korean nuclear plant to an attack on Sony in anticipation of its release of the movie \"The Interview\" at the end of 2014. They're also notorious for cyberespionage. In recent years, the group seems to be focused on financial crimes, such as cryptojacking.\\\nIn June of 2018, The Department of Homeland Security, together with the FBI and other U.S. government partners, issued Technical Alert (TA-18-149A) to advise the public about two variants of North Korean malware. One variant, dubbed \"Joanap,\" is a multi-stage peer-to-peer botnet that allows North Korean state actors to exfiltrate data, download and execute secondary payloads, and initialize proxy communications. The other variant, \"Brambul,\" is a Windows32 SMB worm that is dropped into a victim network. When executed, the malware attempts to spread laterally within a victim's local subnet, connecting via the SMB protocol and initiating brute-force password attacks. It reports details to the Hidden Cobra actors via email, so they can use the information for secondary remote operations.\\\nAmong other searches in this Analytic Story is a detection search that looks for the creation or deletion of hidden shares, such as, \"adnim$,\" which the Hidden Cobra malware creates on the target system. Another looks for the creation of three malicious files associated with the malware. You can also use a search in this story to investigate activity that indicates that malware is sending email back to the attackers.",
            "references": [
                "https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity",
                "https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Destructive-Malware-Report.pdf"
            ],
            "responses": [],
            "story_id": "baf7580b-d4b4-4774-8173-7d198e9da335",
            "support": [
                "Baseline of DNS Query Length - MLTK",
                "Baseline of SMB Traffic - MLTK",
                "Previously seen command line arguments"
            ],
            "type": "ESCU",
            "version": 2
        },
        "bb9f5ed2-916e-4364-bb6d-91c310efcf52": {
            "author": "Bhavin Patel, Splunk",
            "description": "Detect rarely used executables, specific registry paths that may confer malware survivability and persistence, instances where cmd.exe is used to launch script interpreters, and other indicators that the Emotet financial malware has compromised your environment.",
            "detections": [
                "email_attachments_with_lots_of_spaces",
                "suspicious_email_attachment_extensions",
                "prohibited_software_on_endpoint",
                "detect_rare_executables",
                "detect_use_of_cmd_exe_to_launch_script_interpreters",
                "detection_of_tools_built_by_nirsoft",
                "prohibited_software_on_endpoint",
                "registry_keys_used_for_persistence",
                "detection_of_tools_built_by_nirsoft",
                "smb_traffic_spike",
                "smb_traffic_spike_-_mltk"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-01-27",
            "name": "Emotet Malware  DHS Report TA18-201A ",
            "narrative": "The trojan downloader known as Emotet first surfaced in 2014, when it was discovered targeting the banking industry to steal credentials. However, according to a joint technical alert (TA) issued by three government agencies (https://www.us-cert.gov/ncas/alerts/TA18-201A), Emotet has evolved far beyond those beginnings to become what a ThreatPost article called a threat-delivery service(see https://threatpost.com/emotet-malware-evolves-beyond-banking-to-threat-delivery-service/134342/).  For example, in early 2018, Emotet was found to be using its loader function to spread the Quakbot and Ransomware variants. \\\nAccording to the TA, the the malware continues to be among the most costly and destructive malware affecting the private and public sectors. Researchers have linked it to the threat group Mealybug, which has also been on the security communitys radar since 2014.\\\nThe searches in this Analytic Story will help you find executables that are rarely used in your environment, specific registry paths that malware often uses to ensure survivability and persistence, instances where cmd.exe is used to launch script interpreters, and other indicators that Emotet or other malware has compromised your environment. ",
            "references": [
                "https://www.us-cert.gov/ncas/alerts/TA18-201A",
                "https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf",
                "https://www.vkremez.com/2017/05/emotet-banking-trojan-malware-analysis.html"
            ],
            "responses": [],
            "story_id": "bb9f5ed2-916e-4364-bb6d-91c310efcf52",
            "support": [
                "Add Prohibited Processes to Enterprise Security",
                "Baseline of SMB Traffic - MLTK",
                "Add Prohibited Processes to Enterprise Security"
            ],
            "type": "ESCU",
            "version": 1
        },
        "bb9f5ed2-916e-4364-bb6d-97c370efcf52": {
            "author": "David Dorsey, Splunk",
            "description": "Detect activities and various techniques associated with the Orangeworm Attack Group, a group that frequently targets the healthcare industry.",
            "detections": [
                "first_time_seen_command_line_argument",
                "first_time_seen_command_line_argument",
                "first_time_seen_running_windows_service",
                "sc_exe_manipulating_windows_services"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-01-22",
            "name": "Orangeworm Attack Group",
            "narrative": "In May of 2018, the attack group Orangeworm was implicated for installing a custom backdoor called Trojan.Kwampirs within large international healthcare corporations in the United States, Europe, and Asia. This malware provides the attackers with remote access to the target system, decrypting and extracting a copy of its main DLL payload from its resource section. Before writing the payload to disk, it inserts a randomly generated string into the middle of the decrypted payload in an attempt to evade hash-based detections.\\\nAwareness of the Orangeworm group first surfaced in January, 2015. It has conducted targeted attacks against related industries, as well, such as pharmaceuticals and healthcare IT solution providers.\\\nAlthough the group's motivation is unknown, its goal may be stealing patient information to sell on the black market. Another possible explanation is corporate espionage. \\\nHealthcare may be a promising target, because it is notoriously behind in technology, often using older operating systems and neglecting to patch computers. Even so, the group was able to evade detection for a full three years. Sources say that the malware spread quickly within the target networks, infecting computers used to control medical devices, such as MRI and X-ray machines.\\\nThis Analytic Story is designed to help you detect and investigate suspicious activities that may be indicative of an Orangeworm attack. One detection search looks for command-line arguments. Another monitors for uses of sc.exe, a non-essential Windows file that can manipulate Windows services. One of the investigative searches helps you get more information on web hosts that you suspect have been compromised.",
            "references": [
                "https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia",
                "https://www.infosecurity-magazine.com/news/healthcare-targeted-by-hacker/"
            ],
            "responses": [],
            "story_id": "bb9f5ed2-916e-4364-bb6d-97c370efcf52",
            "support": [
                "Previously seen command line arguments",
                "Previously Seen Running Windows Services - Initial",
                "Previously Seen Running Windows Services - Update"
            ],
            "type": "ESCU",
            "version": 2
        },
        "bd91a2bc-d20b-4f44-a982-1bea98e86390": {
            "author": "Jose Hernandez, Splunk",
            "description": "Leverage searches that allow you to detect and investigate unusual activities that relate to the ColdRoot Remote Access Trojan that affects MacOS. An example of some of these activities are changing sensative binaries in the MacOS sub-system, detecting process names and executables associated with the RAT, detecting when a keyboard tab is installed on a MacOS machine and more.",
            "detections": [
                "osquery_pack_-_coldroot_detection",
                "osquery_pack_-_coldroot_detection",
                "processes_tapping_keyboard_events",
                "processes_tapping_keyboard_events"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From src ip",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Network Traffic From src ip",
                "Investigate Web Activity From src ip"
            ],
            "modification_date": "2019-01-09",
            "name": "ColdRoot MacOS RAT",
            "narrative": "Conventional wisdom holds that Apple's MacOS operating system is significantly less vulnerable to attack than Windows machines. While that point is debatable, it is true that attacks against MacOS systems are much less common. However, this fact does not mean that Macs are impervious to breaches. To the contrary, research has shown that that Mac malware is increasing at an alarming rate. According to AV-test, in 2018, there were 86,865 new MacOS malware variants, up from 27,338 the year before&#151;a 31% increase. In contrast, the independent research firm found that new Windows malware had increased from 65.17M to 76.86M during that same period, less than half the rate of growth. The bottom line is that while the numbers look a lot smaller than Windows, it's definitely time to take Mac security more seriously.\\\nThis Analytic Story addresses the ColdRoot remote access trojan (RAT), which was uploaded to Github in 2016, but was still escaping detection by the first quarter of 2018, when a new, more feature-rich variant was discovered masquerading as an Apple audio driver. Among other capabilities, the Pascal-based ColdRoot can heist passwords from users' keychains and remotely control infected machines without detection. In the initial report of his findings, Patrick Wardle, Chief Research Officer for Digita Security, explained that the new ColdRoot RAT could start and kill processes on the breached system, spawn new remote-desktop sessions, take screen captures and assemble them into a live stream of the victim's desktop, and more.\\\nSearches in this Analytic Story leverage the capabilities of OSquery to address ColdRoot detection from several different angles, such as looking for the existence of associated files and processes, and monitoring for signs of an installed keylogger.",
            "references": [
                "https://www.intego.com/mac-security-blog/osxcoldroot-and-the-rat-invasion/",
                "https://objective-see.com/blog/blog_0x2A.html",
                "https://www.bleepingcomputer.com/news/security/coldroot-rat-still-undetectable-despite-being-uploaded-on-github-two-years-ago/"
            ],
            "responses": [],
            "story_id": "bd91a2bc-d20b-4f44-a982-1bea98e86390",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "c4b89506-fbcf-4cb7-bfd6-527e54789604": {
            "author": "Rico Valdez, Splunk",
            "description": "Leverage searches that allow you to detect and investigate unusual activities that might relate to the SamSam ransomware, including looking for file writes associated with SamSam, RDP brute force attacks, the presence of files with SamSam ransomware extensions, suspicious psexec use, and more.",
            "detections": [
                "prohibited_software_on_endpoint",
                "batch_file_write_to_system32",
                "common_ransomware_extensions",
                "common_ransomware_notes",
                "deleting_shadow_copies",
                "detect_psexec_with_accepteula_flag",
                "file_with_samsam_extension",
                "prohibited_software_on_endpoint",
                "samsam_test_file_write",
                "spike_in_file_writes",
                "spike_in_file_writes",
                "remote_desktop_network_bruteforce",
                "remote_desktop_network_traffic",
                "detect_attackers_scanning_for_vulnerable_jboss_servers",
                "detect_malicious_requests_to_exploit_jboss_servers"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Backup Logs For Endpoint",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Successful Remote Desktop Authentications",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-12-13",
            "name": "SamSam Ransomware",
            "narrative": "The first version of the SamSam ransomware (a.k.a. Samas or SamsamCrypt) was launched in 2015 by a group of Iranian threat actors. The malicious software has affected and continues to affect thousands of victims and has raised almost $6M in ransom.\\\nAlthough categorized under the heading of ransomware, SamSam campaigns have some importance distinguishing characteristics. Most notable is the fact that conventional ransomware is a numbers game. Perpetrators use a \"spray-and-pray\" approach with phishing campaigns or other mechanisms, charging a small ransom (typically under $1,000). The goal is to find a large number of victims willing to pay these mini-ransoms, adding up to a lucrative payday. They use relatively simple methods for infecting systems.\\\nSamSam attacks are different beasts. They have become progressively more targeted and skillful than typical ransomware attacks. First, malicious actors break into a victim's network, surveil it, then run the malware manually. The attacks are tailored to cause maximum damage and the threat actors usually demand amounts in the tens of thousands of dollars.\\\nIn a typical attack on one large healthcare organization in 2018, the company ended up paying a ransom of four Bitcoins, then worth $56,707. Reports showed that access to the company's files was restored within two hours of paying the sum.\\\nAccording to Sophos, SamSam previously leveraged  RDP to gain access to targeted networks via brute force. SamSam is not spread automatically, like other malware. It requires skill because it forces the attacker to adapt their tactics to the individual environment. Next, the actors escalate their privileges to admin level. They scan the networks for worthy targets, using conventional tools, such as PsExec or PaExec, to deploy/execute, quickly encrypting files.\\\nThis Analytic Story includes searches designed to help detect and investigate signs of the SamSam ransomware, such as the creation of fileswrites to system32, writes with tell-tale extensions, batch files written to system32, and evidence of brute-force attacks via RDP.",
            "references": [
                "https://www.crowdstrike.com/blog/an-in-depth-analysis-of-samsam-ransomware-and-boss-spider/",
                "https://nakedsecurity.sophos.com/2018/07/31/samsam-the-almost-6-million-ransomware/",
                "https://thehackernews.com/2018/07/samsam-ransomware-attacks.html"
            ],
            "responses": [],
            "story_id": "c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "support": [
                "Add Prohibited Processes to Enterprise Security",
                "Add Prohibited Processes to Enterprise Security"
            ],
            "type": "ESCU",
            "version": 1
        },
        "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5": {
            "author": "Rico Valdez, Splunk",
            "description": "Attackers are increasingly abusing Windows Management Instrumentation (WMI), a framework and associated utilities available on all modern Windows operating systems. Because WMI can be leveraged to manage both local and remote systems, it is important to identify the processes executed and the user context within which the activity occurred.",
            "detections": [
                "remote_wmi_command_attempt",
                "process_execution_via_wmi",
                "remote_process_instantiation_via_wmi",
                "remote_wmi_command_attempt",
                "script_execution_via_wmi",
                "wmi_permanent_event_subscription",
                "wmi_permanent_event_subscription_-_sysmon",
                "wmi_temporary_event_subscription",
                "wmi_permanent_event_subscription",
                "wmi_temporary_event_subscription"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Sysmon WMI Activity for Host",
                "Get User Information from Identity Table",
                "Process Chain Analysis"
            ],
            "modification_date": "2018-10-23",
            "name": "Suspicious WMI Use",
            "narrative": "WMI is a Microsoft infrastructure for management data and operations on Windows operating systems. It includes of a set of utilities that can be leveraged to manage both local and remote Windows systems. Attackers are increasingly turning to WMI abuse in their efforts to conduct nefarious tasks, such as reconnaissance, detection of antivirus and virtual machines, code execution, lateral movement, persistence, and data exfiltration. \\\nThe detection searches included in this Analytic Story are used to look for suspicious use of WMI commands that attackers may leverage to interact with remote systems. The searches specifically look for the use of WMI to run processes on remote systems.\\\nIn the event that unauthorized WMI execution occurs, it will be important for analysts and investigators to determine the context of the event. These details may provide insights related to how WMI was used and to what end.",
            "references": [
                "https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf",
                "https://www.fireeye.com/blog/threat-research/2017/03/wmimplant_a_wmi_ba.html"
            ],
            "responses": [],
            "story_id": "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "support": [],
            "type": "ESCU",
            "version": 2
        },
        "ced74200-8465-4bc3-bd2c-9a782eec6750": {
            "author": "David Dorsey, Splunk",
            "description": "Monitor your AWS EC2 instances for activities related to cryptojacking/cryptomining. New instances that originate from previously unseen regions, users who launch abnormally high numbers of instances, or EC2 instances started by previously unseen users are just a few examples of potentially malicious behavior.",
            "detections": [
                "abnormally_high_aws_instances_launched_by_user",
                "abnormally_high_aws_instances_launched_by_user_-_mltk",
                "ec2_instance_started_in_previously_unseen_region",
                "ec2_instance_started_with_previously_unseen_ami",
                "ec2_instance_started_with_previously_unseen_instance_type",
                "ec2_instance_started_with_previously_unseen_user"
            ],
            "escu_category": [
                "Cloud Security"
            ],
            "investigations": [
                "AWS Investigate User Activities By ARN",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Get EC2 Instance Details by instanceId",
                "Get EC2 Launch Details",
                "Get Notable History",
                "Get Notable Info",
                "Get User Information from Identity Table",
                "Investigate AWS activities via region name"
            ],
            "modification_date": "2018-03-08",
            "name": "AWS Cryptomining",
            "narrative": "Cryptomining is an intentionally difficult, resource-intensive business. Its complexity was designed into the process to ensure that the number of blocks mined each day would remain steady. So, it's par for the course that ambitious, but unscrupulous, miners make amassing the computing power of large enterprises--a practice known as cryptojacking--a top priority. \\\nCryptojacking has attracted an increasing amount of media attention since its explosion in popularity in the fall of 2017. The attacks have moved from in-browser exploits and mobile phones to enterprise cloud services, such as Amazon Web Services (AWS). It's difficult to determine exactly how widespread the practice has become, since bad actors continually evolve their ability to escape detection, including employing unlisted endpoints, moderating their CPU usage, and hiding the mining pool's IP address behind a free CDN. \\\nWhen malicious miners appropriate a cloud instance, often spinning up hundreds of new instances, the costs can become astronomical for the account holder. So, it is critically important to monitor your systems for suspicious activities that could indicate that your network has been infiltrated. \\\nThis Analytic Story is focused on detecting suspicious new instances in your EC2 environment to help prevent such a disaster. It contains detection searches that will detect when a previously unused instance type or AMI is used. It also contains support searches to build lookup files to ensure proper execution of the detection searches.",
            "references": [
                "https://d0.awsstatic.com/whitepapers/aws-security-best-practices.pdf"
            ],
            "responses": [],
            "story_id": "ced74200-8465-4bc3-bd2c-9a782eec6750",
            "support": [
                "Baseline of Excessive AWS Instances Launched by User - MLTK",
                "Previously Seen AWS Regions",
                "Previously Seen EC2 AMIs",
                "Previously Seen EC2 Instance Types",
                "Previously Seen EC2 Launches By User"
            ],
            "type": "ESCU",
            "version": 1
        },
        "cf309d0d-d4aa-4fbb-963d-1e79febd3756": {
            "author": "David Dorsey, Splunk",
            "description": "Leverage searches that allow you to detect and investigate unusual activities that might relate to ransomware--spikes in SMB traffic, suspicious wevtutil usage, the presence of common ransomware extensions, and system processes run from unexpected locations, and many others.",
            "detections": [
                "scheduled_tasks_used_in_badrabbit_ransomware",
                "common_ransomware_extensions",
                "common_ransomware_notes",
                "deleting_shadow_copies",
                "registry_keys_used_for_persistence",
                "remote_process_instantiation_via_wmi",
                "scheduled_tasks_used_in_badrabbit_ransomware",
                "schtasks_used_for_forcing_a_reboot",
                "spike_in_file_writes",
                "suspicious_wevtutil_usage",
                "system_processes_run_from_unexpected_locations",
                "unusually_long_command_line",
                "unusually_long_command_line_-_mltk",
                "usn_journal_deletion",
                "windows_event_log_cleared",
                "spike_in_file_writes",
                "prohibited_network_traffic_allowed",
                "smb_traffic_spike",
                "smb_traffic_spike_-_mltk",
                "tor_traffic"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Analyze Malicious File",
                "Analyze Malicious File",
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Quarantaine Infected Host",
                "Get Authentication Logs For Endpoint",
                "Get Backup Logs For Endpoint",
                "Get History Of Email Sources",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Process Information For Port Activity",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Sysmon WMI Activity for Host",
                "Get Update Logs For Endpoint",
                "Get User Information from Identity Table",
                "Get Vulnerability Logs For Endpoint",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Quarantaine Infected Host"
            ],
            "modification_date": "2020-02-04",
            "name": "Ransomware",
            "narrative": "Ransomware is an ever-present risk to the enterprise, wherein an infected host encrypts business-critical data, holding it hostage until the victim pays the attacker a ransom. There are many types and varieties of ransomware that can affect an enterprise. Attackers can deploy ransomware to enterprises through spearphishing campaigns and driveby downloads, as well as through traditional remote service-based exploitation. In the case of the WannaCry campaign, there was self-propagating wormable functionality that was used to maximize infection. Fortunately, organizations can apply several techniques--such as those in this Analytic Story--to detect and or mitigate the effects of ransomware.",
            "references": [
                "https://www.carbonblack.com/2017/06/28/carbon-black-threat-research-technical-analysis-petya-notpetya-ransomware/",
                "https://www.splunk.com/blog/2017/06/27/closing-the-detection-to-mitigation-gap-or-to-petya-or-notpetya-whocares-.html"
            ],
            "responses": [],
            "story_id": "cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "support": [
                "Baseline of Command Line Length - MLTK",
                "Baseline of SMB Traffic - MLTK"
            ],
            "type": "ESCU",
            "version": 1
        },
        "e8afd39e-3294-11e6-b39d-a45e60c6700": {
            "author": "Bhavin Patel, Splunk",
            "description": "DNS poses a serious threat as a Denial of Service (DOS) amplifier, if it responds to `ANY` queries. This Analytic Story can help you detect attackers who may be abusing your company's DNS infrastructure to launch amplification attacks, causing Denial of Service to other victims.",
            "detections": [
                "large_volume_of_dns_any_queries"
            ],
            "escu_category": [
                "Abuse"
            ],
            "investigations": [
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get Notable History",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User"
            ],
            "modification_date": "2016-09-13",
            "name": "DNS Amplification Attacks",
            "narrative": "The Domain Name System (DNS) is the protocol used to map domain names to IP addresses. It has been proven to work very well for its intended function. However if DNS is misconfigured, servers can be abused by attackers to levy amplification or redirection attacks against victims. Because DNS responses to `ANY` queries are so much larger than the queries themselves--and can be made with a UDP packet, which does not require a handshake--attackers can spoof the source address of the packet and cause much more data to be sent to the victim than if they sent the traffic themselves. The `ANY` requests are will be larger than normal DNS server requests, due to the fact that the server provides significant details, such as MX records and associated IP addresses. A large volume of this traffic can result in a DOS on the victim's machine. This misconfiguration leads to two possible victims, the first being the DNS servers participating in an attack and the other being the hosts that are the targets of the DOS attack.\\\nThe search in this story can help you to detect if attackers are abusing your company's DNS infrastructure to launch DNS amplification attacks causing Denial of Service to other victims.",
            "references": [
                "https://www.us-cert.gov/ncas/alerts/TA13-088A",
                "https://www.imperva.com/learn/application-security/dns-amplification/"
            ],
            "responses": [],
            "story_id": "e8afd39e-3294-11e6-b39d-a45e60c6700",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "f4368ddf-d59f-4192-84f6-778ac5a3ffc7": {
            "author": "Bhavin Patel, Splunk",
            "description": "Leveraging the Windows command-line interface (CLI) is one of the most common attack techniques--one that is also detailed in the MITRE ATT&CK framework. Use this Analytic Story to help you identify unusual or suspicious use of the CLI on Windows systems.",
            "detections": [
                "first_time_seen_command_line_argument",
                "detect_prohibited_applications_spawning_cmd_exe",
                "detect_use_of_cmd_exe_to_launch_script_interpreters",
                "first_time_seen_command_line_argument",
                "system_processes_run_from_unexpected_locations",
                "unusually_long_command_line",
                "unusually_long_command_line_-_mltk"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Registry Activities",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-02-03",
            "name": "Suspicious Command-Line Executions",
            "narrative": "The ability to execute arbitrary commands via the Windows CLI is a primary goal for the adversary. With access to the shell, an attacker can easily run scripts and interact with the target system. Often, attackers may only have limited access to the shell or may obtain access in unusual ways. In addition, malware may execute and interact with the CLI in ways that would be considered unusual and inconsistent with typical user activity. This provides defenders with opportunities to identify suspicious use and investigate, as appropriate. This Analytic Story contains various searches to help identify this suspicious activity, as well as others to aid you in deeper investigation.",
            "references": [
                "https://attack.mitre.org/wiki/Technique/T1059",
                "https://www.microsoft.com/en-us/wdsi/threats/macro-malware",
                "https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf"
            ],
            "responses": [],
            "story_id": "f4368ddf-d59f-4192-84f6-778ac5a3ffc7",
            "support": [
                "Baseline of Command Line Length - MLTK",
                "Previously seen command line arguments"
            ],
            "type": "ESCU",
            "version": 2
        },
        "f4368e3f-d59f-4192-84f6-748ac5a3ddb6": {
            "author": "Bhavin Patel, Splunk",
            "description": "Quickly identify systems running new or unusual processes in your environment that could be indicators of suspicious activity. Processes run from unusual locations, those with conspicuously long command lines, and rare executables are all examples of activities that may warrant deeper investigation.",
            "detections": [
                "uncommon_processes_on_endpoint",
                "detect_processes_used_for_system_network_configuration_discovery",
                "detect_rare_executables",
                "rundll_loading_dll_by_ordinal",
                "system_processes_run_from_unexpected_locations",
                "uncommon_processes_on_endpoint",
                "unusually_long_command_line",
                "unusually_long_command_line_-_mltk"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-02-04",
            "name": "Unusual Processes",
            "narrative": "Being able to profile a host's processes within your environment can help you more quickly identify processes that seem out of place when compared to the rest of the population of hosts or asset types.\\\nThis Analytic Story lets you identify processes that are either a) not typically seen running or b) have some sort of suspicious command-line arguments associated with them. This Analytic Story will also help you identify the user running these processes and the associated process activity on the host.\\\nIn the event an unusual process is identified, it is imperative to better understand how that process was able to execute on the host, when it first executed, and whether other hosts are affected. This extra information may provide clues that can help the analyst further investigate any suspicious activity.",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2017/08/monitoring-windows-console-activity-part-two.html",
                "https://www.splunk.com/pdfs/technical-briefs/advanced-threat-detection-and-response-tech-brief.pdf",
                "https://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262"
            ],
            "responses": [],
            "story_id": "f4368e3f-d59f-4192-84f6-748ac5a3ddb6",
            "support": [
                "Baseline of Command Line Length - MLTK"
            ],
            "type": "ESCU",
            "version": 2
        },
        "f52f6c43-05f8-4b19-a9d3-5b8c56da91c2": {
            "author": "Rod Soto, David Dorsey, Splunk",
            "description": "Leverage searches that allow you to detect and investigate unusual activities that might relate to ransomware. These searches include cloud related objects that may be targeted by malicious actors via cloud providers own encryption features.",
            "detections": [
                "aws_detect_users_creating_keys_with_encrypt_policy_without_mfa",
                "aws_detect_users_with_kms_keys_performing_encryption_s3"
            ],
            "escu_category": [
                "Malware"
            ],
            "investigations": [
                "Get Notable History"
            ],
            "modification_date": "2020-10-27",
            "name": "Ransomware Cloud",
            "narrative": "Ransomware is an ever-present risk to the enterprise, wherein an infected host encrypts business-critical data, holding it hostage until the victim pays the attacker a ransom. There are many types and varieties of ransomware that can affect an enterprise.Cloud ransomware can be deployed by obtaining high privilege credentials from targeted users or resources.",
            "references": [
                "https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/",
                "https://github.com/d1vious/git-wild-hunt",
                "https://www.youtube.com/watch?v=PgzNib37g0M"
            ],
            "responses": [],
            "story_id": "f52f6c43-05f8-4b19-a9d3-5b8c56da91c2",
            "support": [],
            "type": "ESCU",
            "version": 1
        },
        "fcc27099-46a0-46b0-a271-5c7dab56b6f1": {
            "author": "Rico Valdez, Splunk",
            "description": "Looks for activities and techniques associated with the disabling of security tools on a Windows system, such as suspicious `reg.exe` processes, processes launching netsh, and many others.",
            "detections": [
                "attempt_to_add_certificate_to_untrusted_store",
                "attempt_to_stop_security_service",
                "processes_launching_netsh",
                "sc_exe_manipulating_windows_services",
                "suspicious_reg_exe_process",
                "unload_sysmon_filter_driver"
            ],
            "escu_category": [
                "Adversary Tactics"
            ],
            "investigations": [
                "Get Authentication Logs For Endpoint",
                "Get Notable Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis",
                "Get Authentication Logs For Endpoint",
                "Get Notable History",
                "Get Notable Info",
                "Get Parent Process Info",
                "Get Process Info",
                "Get Risk Modifiers For Endpoint",
                "Get Risk Modifiers For User",
                "Get User Information from Identity Table",
                "Investigate Web Activity From Host",
                "Process Chain Analysis"
            ],
            "modification_date": "2020-02-04",
            "name": "Disabling Security Tools",
            "narrative": "Attackers employ a variety of tactics in order to avoid detection and operate without barriers. This often involves modifying the configuration of security tools to get around them or explicitly disabling them to prevent them from running. This Analytic Story includes searches that look for activity consistent with attackers attempting to disable various security mechanisms. Such activity may involve monitoring for suspicious registry activity, as this is where much of the configuration for Windows and various other programs reside, or explicitly attempting to shut down security-related services. Other times, attackers attempt various tricks to prevent specific programs from running, such as adding the certificates with which the security tools are signed to a blacklist (which would prevent them from running).",
            "references": [
                "https://attack.mitre.org/wiki/Technique/T1089",
                "https://blog.malwarebytes.com/cybercrime/2015/11/vonteera-adware-uses-certificates-to-disable-anti-malware/",
                "https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Tools-Report.pdf"
            ],
            "responses": [],
            "story_id": "fcc27099-46a0-46b0-a271-5c7dab56b6f1",
            "support": [
                "Baseline of SMB Traffic - MLTK",
                "Previously seen command line arguments"
            ],
            "type": "ESCU",
            "version": 2
        }
    },
    "research_version": "3.10.0",
    "roles": {
        "default": {
            "summaries": [
                "detect_new_login_attempts_to_routers",
                "email_attachments_with_lots_of_spaces",
                "email_files_written_outside_of_the_outlook_directory",
                "email_servers_sending_high_volume_traffic_to_hosts",
                "identify_new_user_accounts",
                "monitor_email_for_brand_abuse",
                "multiple_okta_users_with_invalid_credentails_from_the_same_ip",
                "no_windows_updates_in_a_time_frame",
                "okta_account_lockout_events",
                "okta_failed_sso_attempts",
                "okta_user_logins_from_multiple_cities",
                "open_redirect_in_splunk_web",
                "spectre_and_meltdown_vulnerable_systems",
                "splunk_enterprise_information_disclosure",
                "suspicious_email_-_uba_anomaly",
                "suspicious_email_attachment_extensions",
                "suspicious_java_classes",
                "web_servers_executing_suspicious_processes",
                "abnormally_high_aws_instances_launched_by_user",
                "abnormally_high_aws_instances_launched_by_user_-_mltk",
                "abnormally_high_aws_instances_terminated_by_user",
                "abnormally_high_aws_instances_terminated_by_user_-_mltk",
                "abnormally_high_number_of_cloud_instances_destroyed",
                "abnormally_high_number_of_cloud_instances_launched",
                "abnormally_high_number_of_cloud_infrastructure_api_calls",
                "abnormally_high_number_of_cloud_security_group_api_calls",
                "amazon_eks_kubernetes_cluster_scan_detection",
                "amazon_eks_kubernetes_pod_scan_detection",
                "aws_cloud_provisioning_from_previously_unseen_city",
                "aws_cloud_provisioning_from_previously_unseen_country",
                "aws_cloud_provisioning_from_previously_unseen_ip_address",
                "aws_cloud_provisioning_from_previously_unseen_region",
                "aws_cross_account_activity_from_previously_unseen_account",
                "aws_detect_attach_to_role_policy",
                "aws_detect_permanent_key_creation",
                "aws_detect_role_creation",
                "aws_detect_sts_assume_role_abuse",
                "aws_detect_sts_get_session_token_abuse",
                "aws_detect_users_creating_keys_with_encrypt_policy_without_mfa",
                "aws_detect_users_with_kms_keys_performing_encryption_s3",
                "aws_network_access_control_list_created_with_all_open_ports",
                "aws_network_access_control_list_deleted",
                "cloud_api_calls_from_previously_unseen_user_roles",
                "cloud_compute_instance_created_by_previously_unseen_user",
                "cloud_compute_instance_created_in_previously_unused_region",
                "cloud_compute_instance_created_with_previously_unseen_image",
                "cloud_compute_instance_created_with_previously_unseen_instance_type",
                "cloud_compute_instance_started_in_previously_unused_region",
                "cloud_instance_modified_by_previously_unseen_user",
                "cloud_network_access_control_list_deleted",
                "cloud_provisioning_activity_from_previously_unseen_city",
                "cloud_provisioning_activity_from_previously_unseen_country",
                "cloud_provisioning_activity_from_previously_unseen_ip_address",
                "cloud_provisioning_activity_from_previously_unseen_region",
                "detect_api_activity_from_users_without_mfa",
                "detect_aws_api_activities_from_unapproved_accounts",
                "detect_aws_console_login_by_new_user",
                "detect_aws_console_login_by_user_from_new_city",
                "detect_aws_console_login_by_user_from_new_country",
                "detect_aws_console_login_by_user_from_new_region",
                "detect_gcp_storage_access_from_a_new_ip",
                "detect_new_api_calls_from_user_roles",
                "detect_new_open_gcp_storage_buckets",
                "detect_new_open_s3_buckets",
                "detect_new_user_aws_console_login",
                "detect_new_user_aws_console_login_-_dm",
                "detect_s3_access_from_a_new_ip",
                "detect_spike_in_aws_api_activity",
                "detect_spike_in_aws_security_hub_alerts_for_ec2_instance",
                "detect_spike_in_blocked_outbound_traffic_from_your_aws",
                "detect_spike_in_network_acl_activity",
                "detect_spike_in_s3_bucket_deletion",
                "detect_spike_in_security_group_activity",
                "detect_spike_in_aws_security_hub_alerts_for_user",
                "ec2_instance_modified_with_previously_unseen_user",
                "ec2_instance_started_in_previously_unseen_region",
                "ec2_instance_started_with_previously_unseen_ami",
                "ec2_instance_started_with_previously_unseen_instance_type",
                "ec2_instance_started_with_previously_unseen_user",
                "gcp_detect_accounts_with_high_risk_roles_by_project",
                "gcp_detect_gcploit_framework",
                "gcp_detect_high_risk_permissions_by_resource_and_account",
                "gcp_detect_oauth_token_abuse",
                "gcp_gcr_container_uploaded",
                "gcp_kubernetes_cluster_pod_scan_detection",
                "gcp_kubernetes_cluster_scan_detection",
                "high_number_of_login_failures_from_a_single_source",
                "kubernetes_aws_detect_most_active_service_accounts_by_pod",
                "kubernetes_aws_detect_rbac_authorization_by_account",
                "aws_eks_kubernetes_cluster_sensitive_object_access",
                "kubernetes_aws_detect_sensitive_role_access",
                "kubernetes_aws_detect_service_accounts_forbidden_failure_access",
                "kubernetes_aws_detect_suspicious_kubectl_calls",
                "kubernetes_azure_detect_most_active_service_accounts_by_pod_namespace",
                "kubernetes_azure_detect_rbac_authorization_by_account",
                "kubernetes_azure_detect_sensitive_object_access",
                "kubernetes_azure_detect_sensitive_role_access",
                "kubernetes_azure_detect_service_accounts_forbidden_failure_access",
                "kubernetes_azure_detect_suspicious_kubectl_calls",
                "kubernetes_azure_pod_scan_fingerprint",
                "kubernetes_azure_scan_fingerprint",
                "kubernetes_gcp_detect_rbac_authorizations_by_account",
                "kubernetes_gcp_detect_most_active_service_accounts_by_pod",
                "kubernetes_gcp_detect_sensitive_object_access",
                "kubernetes_gcp_detect_sensitive_role_access",
                "kubernetes_gcp_detect_service_accounts_forbidden_failure_access",
                "kubernetes_gcp_detect_suspicious_kubectl_calls",
                "new_container_uploaded_to_aws_ecr",
                "o365_suspicious_admin_email_forwarding",
                "o365_suspicious_rights_delegation",
                "o365_suspicious_user_email_forwarding",
                "detect_mimikatz_using_loaded_images",
                "detect_mimikatz_via_powershell_and_eventcode_4703",
                "detect_usb_device_insertion",
                "execution_of_file_with_spaces_before_extension",
                "extended_period_without_successful_netbackup_backups",
                "first_time_seen_command_line_argument",
                "malicious_powershell_process_-_multiple_suspicious_command-line_arguments",
                "malicious_powershell_process_with_obfuscation_techniques",
                "osquery_pack_-_coldroot_detection",
                "processes_created_by_netsh",
                "prohibited_software_on_endpoint",
                "reg_exe_used_to_hide_files_directories_via_registry_keys",
                "remote_registry_key_modifications",
                "remote_wmi_command_attempt",
                "scheduled_tasks_used_in_badrabbit_ransomware",
                "suspicious_changes_to_file_associations",
                "suspicious_file_write",
                "suspicious_writes_to_system_volume_information",
                "uncommon_processes_on_endpoint",
                "unsigned_image_loaded_by_lsass",
                "unsuccessful_netbackup_backups",
                "windows_connhost_exe_started_forcefully",
                "windows_disableantispyware_registry",
                "windows_hosts_file_modification",
                "access_lsass_memory_for_dump_creation",
                "attempt_to_add_certificate_to_untrusted_store",
                "attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass",
                "attempt_to_stop_security_service",
                "attempted_credential_dump_from_registry_via_reg_exe",
                "batch_file_write_to_system32",
                "child_processes_of_spoolsv_exe",
                "common_ransomware_extensions",
                "common_ransomware_notes",
                "create_local_admin_accounts_using_net_exe",
                "create_or_delete_windows_shares_using_net_exe",
                "create_remote_thread_into_lsass",
                "creation_of_shadow_copy",
                "creation_of_shadow_copy_with_wmic_and_powershell",
                "credential_dumping_via_copy_command_from_shadow_copy",
                "credential_dumping_via_symlink_to_shadow_copy",
                "deleting_shadow_copies",
                "detect_activity_related_to_pass_the_hash_attacks",
                "detect_computer_changed_with_anonymous_account",
                "detect_credential_dumping_through_lsass_access",
                "detect_excessive_account_lockouts_from_endpoint",
                "detect_excessive_user_account_lockouts",
                "detect_mshta_exe_running_scripts_in_command-line_arguments",
                "detect_new_local_admin_account",
                "detect_oulook_exe_writing_a__zip_file",
                "detect_path_interception_by_creation_of_program_exe",
                "detect_processes_used_for_system_network_configuration_discovery",
                "detect_prohibited_applications_spawning_cmd_exe",
                "detect_psexec_with_accepteula_flag",
                "detect_rare_executables",
                "detect_use_of_cmd_exe_to_launch_script_interpreters",
                "detect_windows_dns_sigred_via_splunk_stream",
                "detect_windows_dns_sigred_via_zeek",
                "detection_of_tools_built_by_nirsoft",
                "disabling_remote_user_account_control",
                "dump_lsass_via_comsvcs_dll",
                "execution_of_file_with_multiple_extensions",
                "file_with_samsam_extension",
                "first_time_seen_child_process_of_zoom",
                "first_time_seen_running_windows_service",
                "hiding_files_and_directories_with_attrib_exe",
                "kerberoasting_spn_request_with_rc4_encryption",
                "macos_-_re-opened_applications",
                "malicious_powershell_process_-_connect_to_internet_with_hidden_window",
                "malicious_powershell_process_-_encoded_command",
                "malicious_powershell_process_-_execution_policy_bypass",
                "monitor_registry_keys_for_print_monitors",
                "overwriting_accessibility_binaries",
                "process_execution_via_wmi",
                "processes_launching_netsh",
                "processes_tapping_keyboard_events",
                "reg_exe_manipulating_windows_services_registry_keys",
                "registry_keys_for_creating_shim_databases",
                "registry_keys_used_for_persistence",
                "registry_keys_used_for_privilege_escalation",
                "remote_desktop_process_running_on_system",
                "remote_process_instantiation_via_wmi",
                "rundll_loading_dll_by_ordinal",
                "ryuk_test_files_detected",
                "samsam_test_file_write",
                "sc_exe_manipulating_windows_services",
                "scheduled_task_deleted_or_created_via_cmd",
                "scheduled_task_name_used_by_dragonfly_threat_actors",
                "schtasks_scheduling_job_on_remote_system",
                "schtasks_used_for_forcing_a_reboot",
                "script_execution_via_wmi",
                "shim_database_file_creation",
                "shim_database_installation_with_suspicious_parameters",
                "short_lived_windows_accounts",
                "single_letter_process_on_endpoint",
                "spike_in_file_writes",
                "sunburst_correlation_dll_and_network_event",
                "suspicious_lnk_file_launching_a_process",
                "suspicious_reg_exe_process",
                "suspicious_wevtutil_usage",
                "suspicious_writes_to_windows_recycle_bin",
                "system_information_discovery_detection",
                "system_processes_run_from_unexpected_locations",
                "unload_sysmon_filter_driver",
                "unusually_long_command_line",
                "unusually_long_command_line_-_mltk",
                "unusually_long_content-type_length",
                "usn_journal_deletion",
                "windows_adfind_exe",
                "windows_event_log_cleared",
                "windows_security_account_manager_stopped",
                "wmi_permanent_event_subscription",
                "wmi_permanent_event_subscription_-_sysmon",
                "wmi_temporary_event_subscription",
                "clients_connecting_to_multiple_dns_servers",
                "detect_arp_poisoning",
                "detect_dns_requests_to_phishing_sites_leveraging_evilginx2",
                "detect_hosts_connecting_to_dynamic_domain_providers",
                "detect_ipv6_network_infrastructure_threats",
                "detect_large_outbound_icmp_packets",
                "detect_long_dns_txt_record_response",
                "detect_outbound_smb_traffic",
                "detect_port_security_violation",
                "detect_rogue_dhcp_server",
                "detect_snicat_sni_exfiltration",
                "detect_software_download_to_network_device",
                "detect_traffic_mirroring",
                "detect_unauthorized_assets_by_mac_address",
                "detect_zerologon_via_zeek",
                "detection_of_dns_tunnels",
                "dns_query_length_outliers_-_mltk",
                "dns_query_length_with_high_standard_deviation",
                "dns_query_requests_resolved_by_unauthorized_dns_servers",
                "dns_record_changed",
                "excessive_dns_failures",
                "hosts_receiving_high_volume_of_network_traffic_from_email_server",
                "large_volume_of_dns_any_queries",
                "monitor_dns_for_brand_abuse",
                "prohibited_network_traffic_allowed",
                "protocol_or_port_mismatch",
                "protocols_passing_authentication_in_cleartext",
                "remote_desktop_network_bruteforce",
                "remote_desktop_network_traffic",
                "smb_traffic_spike",
                "smb_traffic_spike_-_mltk",
                "tor_traffic",
                "detect_attackers_scanning_for_vulnerable_jboss_servers",
                "detect_f5_tmui_rce_cve-2020-5902",
                "detect_malicious_requests_to_exploit_jboss_servers",
                "detect_web_traffic_to_dynamic_domain_providers",
                "monitor_web_traffic_for_brand_abuse",
                "sql_injection_with_long_urls",
                "web_fraud_-_account_harvesting",
                "web_fraud_-_anomalous_user_clickspeed",
                "web_fraud_-_password_sharing_across_accounts",
                "aws_cloud_provisioning_activity_from_unusual_country",
                "aws_cloud_provisioning_activity_from_unusual_ip",
                "aws_instance_created_by_unusual_user",
                "aws_instance_modified_by_unusual_user",
                "aws_new_api_call_per_peer_group",
                "aws_new_api_call_per_user",
                "aws_public_bucket",
                "aws_unusual_amount_of_modifications_to_acls",
                "basic_expired_account",
                "basic_malware_outbreak",
                "basic_scanning",
                "large_web_upload",
                "multiple_infections_on_host",
                "new_domain",
                "outdated_malware_definitions",
                "recurring_infection_on_host",
                "uc0020",
                "uc0030",
                "uc0107",
                "uc0108",
                "uc0109",
                "uc0110",
                "uc0111",
                "uc0112",
                "uc0114",
                "uc0115",
                "unusual_aws_regions",
                "update_service",
                "access_inscope_resources",
                "access_inscope_resources_unencrypted",
                "aggregated_risk",
                "badge_reader_swipe_while_vpnd_in",
                "basic_brute_force",
                "basic_gdpr_login_role_check",
                "building_departmental_peer_group",
                "codeword_threshold_departments",
                "first_call_to_foreign_country",
                "flight_risk_email",
                "flight_risk_printing",
                "flight_risk_user_browsing",
                "hr_concerns_for_user",
                "hunting_covid_themed_attacks_with_iocs",
                "integrating_misp_and_splunk_enterprise_security",
                "land_speed_privileged",
                "many_usb_file_copies",
                "new_cloud_provider",
                "new_data_exfil_dlp_alerts",
                "new_privileged_user",
                "old_passwords",
                "outbound_emails_from_scanners",
                "phone_call_flight_risk",
                "potential_day_trading",
                "privileged_acts_unprivileged_users",
                "pull_list_of_privileged_users",
                "risky_events_from_privileged_users",
                "showcase_emails_with_lookalike_domains",
                "showcase_external_emails_with_internal_domain",
                "showcase_first_git",
                "showcase_first_git_peer",
                "showcase_first_logon",
                "showcase_first_logon_jump_server",
                "showcase_first_seen_domain_controller",
                "showcase_first_usb",
                "showcase_git_downloads",
                "showcase_high_entropy_processes",
                "showcase_hosts_where_sourcetypes_go_silent",
                "showcase_hosts_with_many_timestamps",
                "showcase_huge_volume_dns_requests",
                "showcase_huge_volume_dns_volume",
                "showcase_increase_in_interactively_logged_on_users",
                "showcase_increase_in_runas",
                "showcase_increase_interactive_logon",
                "showcase_lookalike_filenames",
                "showcase_many_hosts",
                "showcase_network_dc_dest",
                "showcase_new_ad_domain",
                "showcase_new_host_with_suspicious_cmd_launch",
                "showcase_new_interactive_service_logon",
                "showcase_new_local_admin_account",
                "showcase_new_logon_type",
                "showcase_new_parent_process_for_cmd",
                "showcase_new_path_for_common_filename",
                "showcase_new_path_for_familiar_filename",
                "showcase_new_runas",
                "showcase_new_service_creations",
                "showcase_new_sfdc_clients",
                "showcase_new_sfdc_event_type",
                "showcase_new_sfdc_tables",
                "showcase_new_sfdc_tables_peer",
                "showcase_new_suspicious_exe_launch_for_user",
                "showcase_remote_powershell_launches",
                "showcase_renamed_executables",
                "showcase_series_attacker_tools_filename",
                "showcase_series_attacker_tools_hashes",
                "showcase_series_discovery_tools_filename",
                "showcase_series_discovery_tools_hashes",
                "showcase_short_lived_accounts",
                "showcase_significant_printing",
                "showcase_spike_in_outgoing_email",
                "showcase_spike_in_password_reset_emails",
                "showcase_spike_in_sfdc_document_downloads",
                "showcase_spike_in_sfdc_exports",
                "showcase_unique_patient_records_viewed",
                "showcase_unusual_child_process_for_spoolsv_or_connhost",
                "showcase_unusually_long",
                "splunk_access_provisioning",
                "sse_dyndns",
                "sse_hostnotincmdb",
                "sser_detect_journal_clearing",
                "sser_detect_lateral_movement_with_wmi",
                "sser_detect_log_clearing_with_wevtutil",
                "sser_fake_windows_processes",
                "sser_malicious_command_line_executions",
                "sser_monitor_autorun_registry_keys",
                "sser_monitor_successful_backups",
                "sser_monitor_successful_windows_updates",
                "sser_monitor_unsuccessful_backups",
                "sser_monitor_unsuccessful_windows_updates",
                "sser_ransomware_extensions",
                "sser_ransomware_note_files",
                "sser_ransomware_vulnerabilities",
                "sser_smb_traffic_allowed",
                "sser_spike_in_smb_traffic",
                "sser_tor_traffic",
                "sser_windows_event_log_clearing_events",
                "stale_account_usage",
                "suspicious_container_image_name",
                "unauthorized_foreign_country_call",
                "unauthorized_login_attempt",
                "unauthorized_web_browsing",
                "aws_apis_called_more_often_than_usual_per_account",
                "user_login_local_credentials",
                "user_login_unauthorized_geo",
                "user_many_dlp_events",
                "user_separation_events",
                "image_from_new_repository_detected",
                "sensitive_kubernetes_mount_pod_detected",
                "credentials_in_file_detected",
                "abnormally_high_number_of_endpoint_changes_by_user",
                "abnormally_high_number_of_http_method_events_by_src",
                "account_deleted",
                "activity_from_expired_user_identity",
                "anomalous_audit_trail_activity_detected",
                "anomalous_new_listening_port",
                "anomalous_new_process",
                "anomalous_new_service",
                "asset_ownership_unspecified",
                "brute_force_access_behavior_detected",
                "brute_force_access_behavior_detected_over_one_day",
                "cleartext_password_at_rest_detected",
                "completely_inactive_account",
                "concurrent_login_attempts_detected",
                "default_account_activity_detected",
                "default_account_at_rest_detected",
                "excessive_dns_queries",
                "excessive_failed_logins",
                "excessive_http_failure_responses",
                "expected_host_not_reporting",
                "gdpr_glass_table",
                "gdpr_investigation",
                "geographically_improbable_access_detected",
                "high_number_of_hosts_not_updating_malware_signatures",
                "high_number_of_infected_hosts",
                "high_or_critical_priority_host_with_malware_detected",
                "high_or_critical_priority_individual_logging_into_infected_machine",
                "high_process_count",
                "high_volume_email_activity_to_noncorporate_domains_by_user",
                "high_volume_of_traffic_from_high_or_critical_host_observed",
                "host_sending_excessive_email",
                "host_with_a_recurring_malware_infection",
                "host_with_high_number_of_listening_ports",
                "host_with_high_number_of_services",
                "host_with_multiple_infections",
                "host_with_old_infection_or_potential_reinfection",
                "inactive_account_activity_detected",
                "insecure_or_cleartext_authentication_detected",
                "multiple_primary_functions_detected",
                "network_change_detected",
                "network_device_rebooted",
                "new_user_account_created_on_multiple_hosts",
                "outbreak_detected",
                "personally_identifiable_information_detected",
                "potential_gap_in_data",
                "prohibited_port_activity_detected",
                "prohibited_process_detected",
                "prohibited_service_detected",
                "same_error_on_many_servers_detected",
                "shortlived_account_detected",
                "substantial_increase_in_events",
                "substantial_increase_in_port_activity",
                "threat_activity_detected",
                "unroutable_activity_detected",
                "untriaged_notable_events",
                "unusual_volume_of_network_activity",
                "vulnerability_scanner_detected_by_events",
                "vulnerability_scanner_detected_by_targets",
                "watchlisted_event_observed",
                "web_uploads_to_noncorporate_sites_by_users",
                "phantom_covid_19_indicator_check",
                "phantom_ec2_instance_isolation",
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment",
                "phantom_malware_investigation",
                "phantom_phishing_remediation_investigation",
                "phantom_prompt_and_block_domain",
                "phantom_ransomware_investigate_contain",
                "phantom_threat_hunting",
                "uc0001",
                "uc0002",
                "uc0003",
                "uc0004",
                "uc0005",
                "uc0006",
                "uc0007",
                "uc0008",
                "uc0009",
                "uc0010",
                "uc0012",
                "uc0013",
                "uc0014",
                "uc0015",
                "uc0016",
                "uc0018",
                "uc0019",
                "uc0021",
                "uc0022",
                "uc0023",
                "uc0024",
                "uc0028",
                "uc0029",
                "uc0031",
                "uc0035",
                "uc0036",
                "uc0037",
                "uc0041",
                "uc0042",
                "uc0044",
                "uc0046",
                "uc0049",
                "uc0050",
                "uc0051",
                "uc0052",
                "uc0053",
                "uc0054",
                "uc0055",
                "uc0057",
                "uc0065",
                "uc0071",
                "uc0072",
                "uc0073",
                "uc0074",
                "uc0075",
                "uc0077",
                "uc0079",
                "uc0082",
                "uc0083",
                "uc0084",
                "uc0085",
                "uc0087",
                "uc0088",
                "uc0090",
                "uc0091",
                "uc0092",
                "uc0095",
                "uc0096",
                "uc0097",
                "uc0098",
                "uc0099",
                "uc0100",
                "uc0101",
                "uc0102",
                "uc0103",
                "uc0104",
                "uc0105",
                "uc0106",
                "at01",
                "at02",
                "at03",
                "at04",
                "at05",
                "at06",
                "at07",
                "at08",
                "at09",
                "at10",
                "at11",
                "at12",
                "at13",
                "at14",
                "at15",
                "at16",
                "at17",
                "at18",
                "at19",
                "at20",
                "at21",
                "at22",
                "at23",
                "at24",
                "at25",
                "at26",
                "at27",
                "at28",
                "at29",
                "at30",
                "at31",
                "at32",
                "at33",
                "at34",
                "at35",
                "at36",
                "at37",
                "at38",
                "at39",
                "at40",
                "at41",
                "at42",
                "at43",
                "at44",
                "at45",
                "at46",
                "at47",
                "at48",
                "at49",
                "at50",
                "at51",
                "at52",
                "at53",
                "at54",
                "at55",
                "at56",
                "at57",
                "at58",
                "at59",
                "at60",
                "at61",
                "at62",
                "at63",
                "at64",
                "at65",
                "at66",
                "at67",
                "tt01",
                "tt02",
                "tt03",
                "tt04",
                "tt05",
                "tt06",
                "tt07",
                "tt08",
                "tt09",
                "tt10",
                "tt11",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt16",
                "tt17",
                "tt18",
                "tt19",
                "tt20",
                "tt21",
                "tt22",
                "tt23",
                "tt24",
                "tt25",
                "tt26",
                "tt27",
                "tt28",
                "tt29",
                "tt30",
                "tt31",
                "tt32",
                "tt33",
                "tt34",
                "tt35",
                "blacklisted_application",
                "blacklisted_domain",
                "blacklisted_ip_address",
                "detection_uba_email_anomaly",
                "download_from_internal_server",
                "excessive_data_transmission",
                "external_alarm_activity",
                "external_website_attack",
                "flight_risk_user",
                "land_speed_violation",
                "machine_generated_beacon",
                "malicious_ad_activity",
                "multiple_authentication_failures",
                "multiple_authentications",
                "multiple_box_login_errors",
                "multiple_box_logins",
                "multiple_box_operations",
                "multiple_external_alarms",
                "multiple_logins",
                "multiple_outgoing_connections",
                "period_with_unusual_ad_activity_sequences",
                "potential_webshell_activity",
                "scanning_activity",
                "suspicious_account_lockout",
                "suspicious_box_usage",
                "suspicious_data_movement",
                "suspicious_domain_communication",
                "suspicious_domain_name",
                "suspicious_http_redirects",
                "suspicious_ip_address_communication",
                "suspicious_network_exploration",
                "suspicious_powershell_activity",
                "suspicious_privilege_escalation",
                "unusual_activity_time",
                "unusual_ad_event",
                "unusual_external_alarm",
                "unusual_geolocation_of_communication_destination",
                "unusual_machine_access",
                "unusual_network_activity",
                "unusual_time_of_badge_access",
                "unusual_usb_activity",
                "unusual_vpn_login_geolocation",
                "unusual_web_browser",
                "unusually_long_vpn_session",
                "detection_detect_oulook_exe_writing_a_zip_file",
                "detection_detect_mshta_exe_running_scripts_in_command-line_arguments",
                "detection_first_time_seen_child_process_of_zoom",
                "detection_kerberoasting_spn_request_with_rc4_encryption",
                "detection_abnormally_high_ec2_instances_launched",
                "detection_attackers_scanning_for_vulnerable_jboss_servers",
                "detection_attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass",
                "detection_attrib_to_hide_files",
                "detection_children_of_spoolsv",
                "detection_create_hidden_shares",
                "detection_create_local_admin_via_net",
                "detection_create_or_delete_network_shares",
                "detection_cred_dump_via_reg",
                "detection_cscript_via_cmd",
                "detection_excessive_dns_failures",
                "detection_long_dns_text_response",
                "detection_malicious_powershell_process_obfuscation_techniques",
                "detection_path_interception_program.exe",
                "detection_powershell_read_from_lsass",
                "detection_process_launching_netsh",
                "detection_prohibited_apps_spawning_cmdprompt",
                "detection_reg_manipulating_services",
                "detection_reg_used_to_hide_files",
                "detection_sc_manipulating_services",
                "detection_sql_injection_with_long_urls",
                "detection_suspicious_reg_process"
            ]
        }
    },
    "summaries": {
        "abnormally_high_aws_instances_launched_by_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cryptomining|Suspicious AWS EC2 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_aws_instances_launched_by_user",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for CloudTrail events where a user successfully launches an abnormally high number of instances.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_aws_instances_launched_by_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Many service accounts configured within an AWS infrastructure are known to exhibit this behavior. Please adjust the threshold values and filter out service accounts from the output. Always verify if this search alerted on a human user.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_aws_instances_launched_by_user_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High AWS Instances Launched By User",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` eventName=RunInstances errorCode=success | bucket span=10m _time | stats count AS instances_launched by _time userName | eventstats avg(instances_launched) as total_launched_avg, stdev(instances_launched) as total_launched_stdev | eval threshold_value = 4 | eval isOutlier=if(instances_launched > total_launched_avg+(total_launched_stdev * threshold_value), 1, 0) | search isOutlier=1 AND _time >= relative_time(now(), \"-10m@m\") | eval num_standard_deviations_away = round(abs(instances_launched - total_launched_avg) / total_launched_stdev, 2) | table _time, userName, instances_launched, num_standard_deviations_away, total_launched_avg, total_launched_stdev | `abnormally_high_aws_instances_launched_by_user_filter`",
            "search_name": "ESCU - Abnormally High AWS Instances Launched by User - Rule",
            "story": "ced74200-8465-4bc3-bd2c-9a782eec6750|2e8948a5-5239-406b-b56b-6c50f1268af3",
            "tags": {
                "analytics_story": [
                    "AWS Cryptomining",
                    "Suspicious AWS EC2 Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "userName",
                "risk_object_type": "user",
                "risk_score": 40,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "abnormally_high_aws_instances_launched_by_user_-_mltk": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cryptomining|Suspicious AWS EC2 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Jason Brewer, Splunk",
            "baselines": [
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2019-11-14",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model for how many RunInstances users do in the environment. By default, the search uses the last 90 days of data to build the model. The model created by this search is then used in the corresponding detection search, which identifies subsequent outliers in the number of RunInstances performed by a user in a small time window.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.\\\nIn addition, you must have the Machine Learning Toolkit (MLTK) version >= 4.2 installed, along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 30 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data.\\\nMore information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "fa5634df-fb05-4b4b-aba0-6115138bb1ba",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_excessive_aws_instances_launched_by_user___mltk_filter"
                        }
                    ],
                    "name": "Baseline of Excessive AWS Instances Launched by User - MLTK",
                    "search": "`cloudtrail` eventName=RunInstances errorCode=success `ec2_excessive_runinstances_mltk_input_filter` | bucket span=10m _time | stats count as instances_launched by _time src_user | fit DensityFunction instances_launched threshold=0.0005 into ec2_excessive_runinstances_v1",
                    "tags": {
                        "analytics_story": [
                            "AWS Cryptomining",
                            "Suspicious AWS EC2 Activities"
                        ],
                        "detections": [
                            "Abnormally High AWS Instances Launched by User - MLTK"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_aws_instances_launched_by_user_-_mltk",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for CloudTrail events where a user successfully launches an abnormally high number of instances.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_aws_instances_launched_by_user_-_mltk",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Many service accounts configured within an AWS infrastructure are known to exhibit this behavior. Please adjust the threshold values and filter out service accounts from the output. Always verify if this search alerted on a human user.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_aws_instances_launched_by_user___mltk_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High AWS Instances Launched By User - MLTK",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` eventName=RunInstances errorCode=success `abnormally_high_aws_instances_launched_by_user___mltk_filter` | bucket span=10m _time  | stats count as instances_launched by _time src_user  | apply ec2_excessive_runinstances_v1  | rename \"IsOutlier(instances_launched)\" as isOutlier  | where isOutlier=1",
            "search_name": "ESCU - Abnormally High AWS Instances Launched by User - MLTK - Rule",
            "story": "ced74200-8465-4bc3-bd2c-9a782eec6750|2e8948a5-5239-406b-b56b-6c50f1268af3",
            "tags": {
                "analytics_story": [
                    "AWS Cryptomining",
                    "Suspicious AWS EC2 Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "src_usr",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "abnormally_high_aws_instances_terminated_by_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS EC2 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_aws_instances_terminated_by_user",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for CloudTrail events where an abnormally high number of instances were successfully terminated by a user in a 10-minute window",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_aws_instances_terminated_by_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Many service accounts configured with your AWS infrastructure are known to exhibit this behavior. Please adjust the threshold values and filter out service accounts from the output. Always verify whether this search alerted on a human user.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_aws_instances_terminated_by_user_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High AWS Instances Terminated By User",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` eventName=TerminateInstances errorCode=success | bucket span=10m _time | stats count AS instances_terminated by _time userName | eventstats avg(instances_terminated) as total_terminations_avg, stdev(instances_terminated) as total_terminations_stdev | eval threshold_value = 4 | eval isOutlier=if(instances_terminated > total_terminations_avg+(total_terminations_stdev * threshold_value), 1, 0) | search isOutlier=1 AND _time >= relative_time(now(), \"-10m@m\")| eval num_standard_deviations_away = round(abs(instances_terminated - total_terminations_avg) / total_terminations_stdev, 2) |table _time, userName, instances_terminated, num_standard_deviations_away, total_terminations_avg, total_terminations_stdev | `abnormally_high_aws_instances_terminated_by_user_filter`",
            "search_name": "ESCU - Abnormally High AWS Instances Terminated by User - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50f1268af3",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS EC2 Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "abnormally_high_aws_instances_terminated_by_user_-_mltk": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS EC2 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Jason Brewer, Splunk",
            "baselines": [
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2019-11-14",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model for how many TerminateInstances users do in the environment. By default, the search uses the last 90 days of data to build the model. The model created by this search is then used in the corresponding detection search, which identifies subsequent outliers in the number of TerminateInstances performed by a user in a small time window.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.\\\nIn addition, you must have the Machine Learning Toolkit (MLTK) version >= 4.2 installed, along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 30 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data.\\\nMore information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "b28ed6de-e4ba-40f7-ae0a-93a088c774ab",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_excessive_aws_instances_terminated_by_user___mltk_filter"
                        }
                    ],
                    "name": "Baseline of Excessive AWS Instances Terminated by User - MLTK",
                    "search": "`cloudtrail` eventName=TerminateInstances errorCode=success `ec2_excessive_terminateinstances_mltk_input_filter` | bucket span=10m _time | stats count as instances_terminated by _time src_user | fit DensityFunction instances_terminated threshold=0.0005 into ec2_excessive_terminateinstances_v1",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS EC2 Activities"
                        ],
                        "detections": [
                            "Abnormally High AWS Instances Terminated by User - MLTK"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_aws_instances_terminated_by_user_-_mltk",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for CloudTrail events where a user successfully terminates an abnormally high number of instances.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_aws_instances_terminated_by_user_-_mltk",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Many service accounts configured within an AWS infrastructure are known to exhibit this behavior. Please adjust the threshold values and filter out service accounts from the output. Always verify if this search alerted on a human user.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_aws_instances_terminated_by_user___mltk_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High AWS Instances Terminated By User - MLTK",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` eventName=TerminateInstances errorCode=success `abnormally_high_aws_instances_terminated_by_user___mltk_filter` | bucket span=10m _time  | stats count as instances_terminated by _time src_user  | apply ec2_excessive_terminateinstances_v1  | rename \"IsOutlier(instances_terminated)\" as isOutlier  | where isOutlier=1",
            "search_name": "ESCU - Abnormally High AWS Instances Terminated by User - MLTK - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50f1268af3",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS EC2 Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "abnormally_high_number_of_cloud_infrastructure_api_calls": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud User Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-09-07",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model for how many API calls are performed by each user. By default, the search uses the last 90 days of data to build the model and the model is rebuilt weekly. The model created by this search is then used in the corresponding detection search, which identifies subsequent outliers in the number of instances created in a small time window.",
                    "how_to_implement": "You must have Enterprise Security 6.0 or later, if not you will need to verify that the Machine Learning Toolkit (MLTK) version 4.2 or later is installed, along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 90 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data.",
                    "id": "1da5d5ea-4382-447d-98a9-87c358c95fcb",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_cloud_infrastructure_api_calls_per_user_filter"
                        }
                    ],
                    "name": "Baseline Of Cloud Infrastructure API Calls Per User",
                    "search": "| tstats count as api_calls from datamodel=Change where All_Changes.user!=unknown All_Changes.status=success by All_Changes.user _time span=1h | `drop_dm_object_name(\"All_Changes\")` | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | table _time api_calls, user, HourOfDay, isWeekend | eventstats dc(api_calls) as api_calls by user, HourOfDay, isWeekend | where api_calls >= 1 | fit DensityFunction api_calls by \"user,HourOfDay,isWeekend\" into cloud_excessive_api_calls_v1 dist=norm show_density=true",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud User Activities"
                        ],
                        "deployments": [
                            "Weekly Model Rebuild 90 Day Lookback"
                        ],
                        "detections": [
                            "Abnormally High Number Of Cloud Infrastructure API Calls"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_number_of_cloud_infrastructure_api_calls",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-09-07",
            "description": "This search will detect a spike in the number of API calls made to your cloud infrastructure environment by a user.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Infrastructure API Calls Per User` to create the probability density function.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Infrastructure API Calls Per User` to create the probability density function.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_number_of_cloud_infrastructure_api_calls",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_number_of_cloud_infrastructure_api_calls_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High Number Of Cloud Infrastructure API Calls",
            "references": [],
            "released": "2020-09-07",
            "search": "| tstats count as api_calls values(All_Changes.command) as command from datamodel=Change where All_Changes.user!=unknown All_Changes.status=success by All_Changes.user _time span=1h | `drop_dm_object_name(\"All_Changes\")` | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | join user HourOfDay isWeekend [ summary cloud_excessive_api_calls_v1] | where cardinality >=16 | apply cloud_excessive_api_calls_v1 threshold=0.005 | rename \"IsOutlier(api_calls)\" as isOutlier | where isOutlier=1 | eval expected_upper_threshold = mvindex(split(mvindex(BoundaryRanges, -1), \":\"), 0) | where api_calls > expected_upper_threshold | eval distance_from_threshold = api_calls - expected_upper_threshold | table _time, user, command, api_calls, expected_upper_threshold, distance_from_threshold | `abnormally_high_number_of_cloud_infrastructure_api_calls_filter`",
            "search_name": "ESCU - Abnormally High Number Of Cloud Infrastructure API Calls - Rule",
            "story": "1ed5ce7d-5469-4232-92af-89d1a3595b39",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud User Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.AC"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 25,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "abnormally_high_number_of_cloud_instances_destroyed": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Instance Activities|Cloud Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Cloud Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-08-25",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model for how many instances are destroyed in the environment. By default, the search uses the last 90 days of data to build the model and the model is rebuilt weekly. The model created by this search is then used in the corresponding detection search, which identifies subsequent outliers in the number of instances destroyed in a small time window.",
                    "how_to_implement": "You must have Enterprise Security 6.0 or later, if not you will need to verify that the Machine Learning Toolkit (MLTK) version 4.2 or later is installed, along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 30 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data.\\\nMore information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "a2f701f8-5296-4d74-829c-0b7eb346d549",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_cloud_instances_destroyed_filter"
                        }
                    ],
                    "name": "Baseline Of Cloud Instances Destroyed",
                    "search": "| tstats count as instances_destroyed from datamodel=Change where All_Changes.action=deleted AND All_Changes.status=success AND All_Changes.object_category=instance by _time span=1h | makecontinuous span=1h _time | eval instances_destroyed=coalesce(instances_destroyed, (random()%2)*0.0000000001) | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | table _time instances_destroyed, HourOfDay, isWeekend | fit DensityFunction instances_destroyed by \"HourOfDay,isWeekend\" into cloud_excessive_instances_destroyed_v1 dist=expon show_density=true",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Instance Activities",
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "Weekly Model Rebuild 90 Day Lookback"
                        ],
                        "detections": [
                            "Abnormally High Number Of Cloud Instances Destroyed"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_number_of_cloud_instances_destroyed",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": "",
            "date": "2020-08-21",
            "description": "This search finds for the number successfully destroyed cloud instances for every 4 hour block. This is split up between weekdays and the weekend. It then applies the probability densitiy model previously created and alerts on any outliers.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Instances Destroyed` to create the probability density function.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Instances Destroyed` to create the probability density function.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_number_of_cloud_instances_destroyed",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Many service accounts configured within a cloud infrastructure are known to exhibit this behavior. Please adjust the threshold values and filter out service accounts from the output. Always verify if this search alerted on a human user.",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_number_of_cloud_instances_destroyed_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High Number Of Cloud Instances Destroyed",
            "references": [],
            "released": "2020-08-21",
            "search": "| tstats count as instances_destroyed values(All_Changes.object_id) as object_id from datamodel=Change where All_Changes.action=deleted AND All_Changes.status=success AND All_Changes.object_category=instance by All_Changes.user _time span=1h | `drop_dm_object_name(\"All_Changes\")` | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | join HourOfDay isWeekend [summary cloud_excessive_instances_destroyed_v1] | where cardinality >=16 | apply cloud_excessive_instances_destroyed_v1 threshold=0.005 | rename \"IsOutlier(instances_destroyed)\" as isOutlier | where isOutlier=1 | eval expected_upper_threshold = mvindex(split(mvindex(BoundaryRanges, -1), \":\"), 0) | eval distance_from_threshold = instances_destroyed - expected_upper_threshold | table _time, user, instances_destroyed, expected_upper_threshold, distance_from_threshold, object_id | `abnormally_high_number_of_cloud_instances_destroyed_filter`",
            "search_name": "ESCU - Abnormally High Number Of Cloud Instances Destroyed - Rule",
            "story": "8168ca88-392e-42f4-85a2-767579c660ce|3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Instance Activities",
                    "Cloud Cryptomining"
                ],
                "asset_type": "Cloud Instance",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "Cloud"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "abnormally_high_number_of_cloud_instances_launched": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Cloud Cryptomining|Suspicious Cloud Instance Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Cloud Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-08-14",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model for how many instances are created in the environment. By default, the search uses the last 90 days of data to build the model and the model is rebuilt weekly. The model created by this search is then used in the corresponding detection search, which identifies subsequent outliers in the number of instances created in a small time window.",
                    "how_to_implement": "You must have Enterprise Security 6.0 or later, if not you will need to verify that the Machine Learning Toolkit (MLTK) version 4.2 or later is installed, along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 90 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data.\\\nMore information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "b01bd274-f661-4f9c-bd9f-cf23ff6ae0bc",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_cloud_instances_launched_filter"
                        }
                    ],
                    "name": "Baseline Of Cloud Instances Launched",
                    "search": "| tstats count as instances_launched from datamodel=Change where (All_Changes.action=created) AND All_Changes.status=success AND All_Changes.object_category=instance by _time span=1h | makecontinuous span=1h _time | eval instances_launched=coalesce(instances_launched, (random()%2)*0.0000000001) | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | table _time instances_launched, HourOfDay, isWeekend | fit DensityFunction instances_launched by \"HourOfDay,isWeekend\" into cloud_excessive_instances_created_v1 dist=expon show_density=true",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining",
                            "Suspicious Cloud Instance Activities"
                        ],
                        "deployments": [
                            "Weekly Model Rebuild 90 Day Lookback"
                        ],
                        "detections": [
                            "Abnormally High Number Of Cloud Instances Launched"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_number_of_cloud_instances_launched",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": "",
            "date": "2020-08-21",
            "description": "This search finds for the number successfully created cloud instances for every 4 hour block. This is split up between weekdays and the weekend. It then applies the probability densitiy model previously created and alerts on any outliers.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Instances Launched` to create the probability density function.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Instances Launched` to create the probability density function.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_number_of_cloud_instances_launched",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Many service accounts configured within an AWS infrastructure are known to exhibit this behavior. Please adjust the threshold values and filter out service accounts from the output. Always verify if this search alerted on a human user.",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_number_of_cloud_instances_launched_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High Number Of Cloud Instances Launched",
            "references": [],
            "released": "2020-08-21",
            "search": "| tstats count as instances_launched values(All_Changes.object_id) as object_id from datamodel=Change where (All_Changes.action=created) AND All_Changes.status=success AND All_Changes.object_category=instance by All_Changes.user _time span=1h | `drop_dm_object_name(\"All_Changes\")` | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | join HourOfDay isWeekend [summary cloud_excessive_instances_created_v1] | where cardinality >=16 | apply cloud_excessive_instances_created_v1 threshold=0.005 | rename \"IsOutlier(instances_launched)\" as isOutlier | where isOutlier=1 | eval expected_upper_threshold = mvindex(split(mvindex(BoundaryRanges, -1), \":\"), 0) | eval distance_from_threshold = instances_launched - expected_upper_threshold | table _time, user, instances_launched, expected_upper_threshold, distance_from_threshold, object_id | `abnormally_high_number_of_cloud_instances_launched_filter`",
            "search_name": "ESCU - Abnormally High Number Of Cloud Instances Launched - Rule",
            "story": "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a|8168ca88-392e-42f4-85a2-767579c660ce",
            "tags": {
                "analytics_story": [
                    "Cloud Cryptomining",
                    "Suspicious Cloud Instance Activities"
                ],
                "asset_type": "Cloud Instance",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 40,
                "security_domain": "Cloud"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "abnormally_high_number_of_cloud_security_group_api_calls": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud User Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-09-07",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model for how many API calls for security groups are performed by each user. By default, the search uses the last 90 days of data to build the model and the model is rebuilt weekly.",
                    "how_to_implement": "You must have Enterprise Security 6.0 or later, if not you will need to verify that the Machine Learning Toolkit (MLTK) version 4.2 or later is installed, along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 90 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data.",
                    "id": "67b84d51-8329-4909-849f-8d38ce54260a",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_cloud_security_group_api_calls_per_user_filter"
                        }
                    ],
                    "name": "Baseline Of Cloud Security Group API Calls Per User",
                    "search": "| tstats count as security_group_api_calls from datamodel=Change where All_Changes.object_category=firewall All_Changes.status=success by All_Changes.user _time span=1h | `drop_dm_object_name(\"All_Changes\")` | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | table _time security_group_api_calls, user, HourOfDay, isWeekend | eventstats dc(security_group_api_calls) as security_group_api_calls by user, HourOfDay, isWeekend | where security_group_api_calls >= 1 | fit DensityFunction security_group_api_calls by \"user,HourOfDay,isWeekend\" into cloud_excessive_security_group_api_calls_v1 dist=norm show_density=true",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud User Activities"
                        ],
                        "deployments": [
                            "Weekly Model Rebuild 90 Day Lookback"
                        ],
                        "detections": [
                            "Abnormally High Number Of Cloud Security Group API Calls"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=abnormally_high_number_of_cloud_security_group_api_calls",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-09-07",
            "description": "This search will detect a spike in the number of API calls made to your cloud infrastructure environment about security groups by a user.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Security Group API Calls Per User` to create the probability density function model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs. You also must run the baseline search `Baseline Of Cloud Security Group API Calls Per User` to create the probability density function model.",
            "icon": "ES_Use_Case.png",
            "id": "abnormally_high_number_of_cloud_security_group_api_calls",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "abnormally_high_number_of_cloud_security_group_api_calls_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Abnormally High Number Of Cloud Security Group API Calls",
            "references": [],
            "released": "2020-09-07",
            "search": "| tstats count as security_group_api_calls values(All_Changes.command) as command from datamodel=Change where All_Changes.object_category=firewall AND All_Changes.status=success by All_Changes.user _time span=1h | `drop_dm_object_name(\"All_Changes\")` | eval HourOfDay=strftime(_time, \"%H\") | eval HourOfDay=floor(HourOfDay/4)*4 | eval DayOfWeek=strftime(_time, \"%w\") | eval isWeekend=if(DayOfWeek >= 1 AND DayOfWeek <= 5, 0, 1) | join user HourOfDay isWeekend [ summary cloud_excessive_security_group_api_calls_v1] | where cardinality >=16 | apply cloud_excessive_security_group_api_calls_v1 threshold=0.005 | rename \"IsOutlier(security_group_api_calls)\" as isOutlier | where isOutlier=1 | eval expected_upper_threshold = mvindex(split(mvindex(BoundaryRanges, -1), \":\"), 0) | where security_group_api_calls > expected_upper_threshold | eval distance_from_threshold = security_group_api_calls - expected_upper_threshold | table _time, user, command, security_group_api_calls, expected_upper_threshold, distance_from_threshold | `abnormally_high_number_of_cloud_security_group_api_calls_filter`",
            "search_name": "ESCU - Abnormally High Number Of Cloud Security Group API Calls - Rule",
            "story": "1ed5ce7d-5469-4232-92af-89d1a3595b39",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud User Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.AC"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 25,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "abnormally_high_number_of_endpoint_changes_by_user": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Detects an abnormally high number of endpoint changes by user account, as they relate to restarts, audits, filesystem, user, and registry modifications.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_sub_technique": "T1543.003",
            "mitre_tactic": "|TA0003|TA0005",
            "mitre_technique": "|T1031|T1112|T1222",
            "name": "Abnormally High Number of Endpoint Changes By User",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_ransomware_investigate_contain"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Change - Abnormally High Number of Endpoint Changes By User - Rule",
            "usecase": "Advanced Threat Detection"
        },
        "abnormally_high_number_of_http_method_events_by_src": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Web Attack",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Alerts when a host has an abnormally high number of HTTP requests by http method.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0001|TA0006",
            "mitre_technique": "|T1190|T1110",
            "name": "Abnormally High Number of HTTP Method Events By Src",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain"
            ],
            "relatedUseCases": [
                ""
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Web - Abnormally High Number of HTTP Method Events By Src - Rule",
            "usecase": "Application Security|Advanced Threat Detection"
        },
        "access_inscope_resources": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Access to Inscope Resources GDPR - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01RequestedWebAppAware",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Visibility into who is accessing in-scope resources is key to your GDPR efforts. Splunk allows easy analysis of that information.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Access to Inscope Resources GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Access to Inscope Resources GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Impact:</h4><p>Along with authorization and legitimate reason for use, accessing resources requires an audit trail that helps identify whether a user accessed a critical asset, and whether that user\u2019s activity during the login session included viewing sensitive data.</p><p>Within a GDPR context, in-scope applications will store and process personal data. Organizations must ensure that access to those applications is not only authorized and motivated by a legitimate reason to access / handle / process the associated personal data, but also maintain a record of which users accessed those in-scope applications, and whether personal data was viewed. Maintaining such an audit trail is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58) \u2013 in such a scenario, it is critical to be able to show evidence of the actual scope of impact from any successful attempt(s) to access or handle personal data. If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). Capability to demonstrate that best practice was adhered to \u2013 that is, that an audit trail was recorded of any given user\u2019s login activity to an in-scope application, and whether they viewed personal data \u2013 can help mitigate potential impact to the organization.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone uses Workday. Our live search looks for the same behavior using the standardized sourcetypes for Palo Alto Networks or the Common Information Model, and you can look for any destination where you have sensitive data including your cloud providers, databases, and more.",
            "highlight": "Yes",
            "howToImplement": "Implementation of this capability will vary from system to sytem. Tracking access via firewall connections is a popular approach, though you could also use application logs which would provide more granular access. Splunk recommends working with you auditor, and Splunk Professional Services for any complicated situations.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "knownFP": "No known false positives at this time.",
            "mitre": "",
            "mitre_notes": "Cyber hygiene to keep data segregated",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Access to In-scope Resources",
            "operationalize": "This search is typically used to track access, rather than something that would be sent directly to anyone to review.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/access_to_in_scope_resources.png",
            "released": "2.1.0",
            "searchKeywords": "login log in logon log on sign",
            "similarUseCases": [
                "access_inscope_resources_unencrypted"
            ],
            "usecase": "Compliance",
            "visualizations": [
                {
                    "dashboard": "General Windows and Linux Posture",
                    "header": "Broken",
                    "panel": "row1cell2",
                    "search": "| `Load_Sample_Log_Data(Sample Firewall Data)` | search app=workday* | chart count over user by app",
                    "title": "Access Types by Users",
                    "type": "viz",
                    "vizParameters": {
                        "resizable": true
                    },
                    "vizType": "TableElement"
                }
            ]
        },
        "access_inscope_resources_unencrypted": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Access to Inscope Resources Unencrypted GDPR - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01RequestedWebAppAware",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Unencrypted communications leaves you vulnerable to a data breach -- when users access PII data, ensure that all connections are encrypted.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Access to Inscope Resources Unencrypted GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Access to Inscope Resources Unencrypted GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Impact:</h4><p>Access to critical resources should only be made over an encrypted connection. Especially in the context of a compliance mandate, encryption should be used for any channel to access in-scope resources. Detecting when this is not the case, where instead unencrypted connections are being used to access in-scope resources, can help determine potential misuse or unauthorized access, and potentially a deeper issue such as compromised host or network device.</p><p>Within a GDPR context, in-scope assets and applications will store and process personal data. Ensuring that only encrypted connections are being used to access those assets is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). Capability to demonstrate that best practice was adhered to \u2013 that is, that only encrypted connections were used for accessing personal data -- can help mitigate potential impact to the organization.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone uses Workday to download data over an unencrypted connection. Our live search looks for the same behavior using the standardized sourcetypes for Palo Alto Networks or the Common Information Model, and you can look for any destination where you have sensitive data including your cloud providers, databases, and more.",
            "highlight": "Yes",
            "howToImplement": "Implementation of this capability will vary from system to system. Tracking access via firewall connections is a popular approach, though you could also use application logs which would provide more granular access. Ensure that all data flows (e.g., backups, remote management, etc.) are all encrypted. Splunk recommends working with you auditor, and Splunk Professional Services for any complicated situations.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "knownFP": "No known false positives at this time.",
            "mitre": "",
            "mitre_notes": "Cyber hygiene to keep data segregated",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Access to In-Scope Unencrypted Resources",
            "operationalize": "Understand why and how this application was accessed over an insecure connection. For in-house apps, this can be tracking down configuration settings. For SaaS apps, this usually understands analyzing your communication paths for a proxy that sends in cleartext (or potentially noting a major bug in a SaaS provider, which is unusual).",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/access_to_in_scope_unencrypted_resources.png",
            "released": "2.1.0",
            "searchKeywords": "",
            "similarUseCases": [
                "access_inscope_resources"
            ],
            "usecase": "Compliance",
            "visualizations": [
                {
                    "dashboard": "General Windows and Linux Posture",
                    "header": "Broken",
                    "panel": "row1cell1",
                    "search": "| `Load_Sample_Log_Data(Sample Firewall Data)` | search app=workday* | eval encrypted=if(dest_port=443, \"Yes\", \"No\") | stats count by encrypted",
                    "title": "Percentage of Connections That Are Encrypted",
                    "type": "viz",
                    "vizParameters": {
                        "charting.chart": "pie",
                        "resizable": true
                    },
                    "vizType": "ChartElement"
                }
            ]
        },
        "access_lsass_memory_for_dump_creation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=access_lsass_memory_for_dump_creation",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-06",
            "description": "Detect memory dumping of the LSASS process.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 6|CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search requires Sysmon Logs and a Sysmon configuration, which includes EventCode 10 for lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "highlight": "No",
            "how_to_implement": "This search requires Sysmon Logs and a Sysmon configuration, which includes EventCode 10 for lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "icon": "ES_Use_Case.png",
            "id": "access_lsass_memory_for_dump_creation",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Administrators can create memory dumps for debugging purposes, but memory dumps of the LSASS process would be unusual.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "access_lsass_memory_for_dump_creation_filter"
                }
            ],
            "mitre_sub_technique": "T1003.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Sandworm Team|Whitefly|Blue Mockingbird|Silence|Threat Group-3390|Leviathan|APT41|Soft Cell|TEMP.Veles|APT33|APT39|Stolen Pencil|APT32|Lazarus Group|Leafminer|Magic Hound|MuddyWater|PLATINUM|FIN8|BRONZE BUTLER|OilRig|FIN6|APT3|APT28|APT1|Ke3chang|Cleaver",
            "name": "Access LSASS Memory For Dump Creation",
            "references": [
                "https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf"
            ],
            "released": "2019-12-06",
            "search": "`sysmon` EventCode=10 TargetImage=*lsass.exe CallTrace=*dbgcore.dll* OR CallTrace=*dbghelp.dll* | stats count min(_time) as firstTime max(_time) as lastTime by Computer, TargetImage, TargetProcessId, SourceImage, SourceProcessId | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `access_lsass_memory_for_dump_creation_filter` ",
            "search_name": "ESCU - Access LSASS Memory for Dump Creation - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 6",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Whitefly",
                    "Blue Mockingbird",
                    "Silence",
                    "Threat Group-3390",
                    "Leviathan",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Stolen Pencil",
                    "APT32",
                    "Lazarus Group",
                    "Leafminer",
                    "Magic Hound",
                    "MuddyWater",
                    "PLATINUM",
                    "FIN8",
                    "BRONZE BUTLER",
                    "OilRig",
                    "FIN6",
                    "APT3",
                    "APT28",
                    "APT1",
                    "Ke3chang",
                    "Cleaver"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "LSASS Memory"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "account_deleted": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Lateral Movement",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS006UserActivity-ET05Delete",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "Detects user and computer account deletion",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0005",
            "mitre_technique": "|T1070",
            "name": "Account Deleted",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Account Deleted - Rule",
            "usecase": "Security Monitoring"
        },
        "activity_from_expired_user_identity": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Insider Threat",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Alerts when an event is discovered from a user associated with identity that is now expired (that is, the end date of the identity has been passed).",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Identity",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0001|TA0003",
            "mitre_technique": "|T1078",
            "name": "Activity from Expired User Identity",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Identity - Activity from Expired User Identity - Rule",
            "similarUseCases": [
                "UC0014",
                "Basic_Expired_Account"
            ],
            "usecase": "Insider Threat|Security Monitoring"
        },
        "aggregated_risk": {
            "SPLEase": "Medium",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|Account Sharing",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Aggregated Risk by Domains - Demo",
            "data_source_categories": "DS013TicketManagement-ET02LowLevelEvents",
            "deprecated_not_used_anymore_datasource": "Ticketing System",
            "description": "Detect low and slow activities and complex insider threat patterns by finding users with concentrations of risky activities.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Threat",
            "examples": [
                {
                    "label": "Demo Data - By Count",
                    "name": "Aggregated Risk by Domains - Demo"
                },
                {
                    "label": "Live Data - By Count",
                    "name": "Aggregated Risk by Domains - Live"
                },
                {
                    "label": "Demo Data - By Score",
                    "name": "Aggregated Risk by Score - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "Live Data - By Score",
                    "name": "Aggregated Risk by Score - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of events from the risk index of a demo environment for Splunk Enterprise Security. The risk index provides a way to track \"risky\" events that aren't necessarily significant enough to send to a SOC analyst (along with aggregating the overall volume of events for a given user). Our live search looks for the same behavior using the standard sourcetypes. See How to Implement if you do not use Enterprise Security.",
            "highlight": "Yes",
            "howToImplement": "You can use almost anything to generate a list of risky events -- in fact that's the desired intent for most medium-or-higher alert volume searches in Splunk Security Essentials! Most customers who go down this path will use the Enterprise Security Risk Framework to aggregate these events, though you can also 'roll your own' risk framework with Summary Indexing.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "This search can inherently generate false positives because it opens the door to alerting on low confidence events. You will need to tune the underlying searches, or potentially filter for a certain risk score to manage false positives.",
            "mitre": "",
            "mitre_sub_technique": "T1021.006|T1021.001",
            "mitre_tactic": "|TA0003|TA0004|TA0008",
            "mitre_technique": "|T1078|T1076|T1028|T1021",
            "name": "Aggregate Risky Events",
            "operationalize": "See the response guidance for the underlying searches that generate the original events.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aggregated_risk.png",
            "released": "2.2.0",
            "relevance": "A constant dilemma in the SIEM space is handling events that are potentially risky but not so risky that you want to send it directly to the SOC. There are a variety of different methods for responding these, including the high powered capabilities of Splunk UBA (graph mining, machine learning, looking over all time? oh my!), but those just starting down this path will find success even with simpler technological approaches with the Splunk ES Risk Framework. Here we look at two methods -- the first is to alert on any users for whom the number of searches in a short period is above a threshold, or if searches from multiple security domains fire in a short period of time. The second is to leverage just the numerical risk scores defined in the Risk Framework to show users who have bursty recent risk scores or consistent long term risk. These will detect users who have a large volume of suspicious behavior even in scenarios where there's not enough immediate risk to generate an alert to the SOC, preventing a slow and low threat from bypassing your detections.",
            "searchKeywords": "",
            "usecase": "Insider Threat|Advanced Threat Detection"
        },
        "amazon_eks_kubernetes_cluster_scan_detection": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Scanning Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Amazon EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=amazon_eks_kubernetes_cluster_scan_detection",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-04-15",
            "description": "This search provides information of unauthenticated requests via user agent, and authentication data against Kubernetes cluster in AWS",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudWatch EKS Logs inputs.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudWatch EKS Logs inputs.",
            "icon": "ES_Use_Case.png",
            "id": "amazon_eks_kubernetes_cluster_scan_detection",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Reconnaissance",
            "known_false_positives": "Not all unauthenticated requests are malicious, but frequency, UA and source IPs will provide context.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "amazon_eks_kubernetes_cluster_scan_detection_filter"
                }
            ],
            "mitre_sub_technique": "T1526",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1526",
            "mitre_threat_groups": "no",
            "name": "Amazon EKS Kubernetes Cluster Scan Detection",
            "references": [],
            "released": "2020-04-15",
            "search": "`aws_cloudwatchlogs_eks` \"user.username\"=\"system:anonymous\" userAgent!=\"AWS Security Scanner\" | rename sourceIPs{} as src_ip | stats count min(_time) as firstTime max(_time) as lastTime values(responseStatus.reason) values(source) as cluster_name values(responseStatus.code) values(userAgent) as http_user_agent values(verb) values(requestURI) by src_ip user.username user.groups{} | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` |`amazon_eks_kubernetes_cluster_scan_detection_filter` ",
            "search_name": "ESCU - Amazon EKS Kubernetes cluster scan detection - Rule",
            "story": "a9ef59cf-e981-4e66-9eef-bb049f695c09",
            "tags": {
                "analytics_story": [
                    "Kubernetes Scanning Activity"
                ],
                "asset_type": "Amazon EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Reconnaissance"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1526"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "Cloud Service Discovery"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "amazon_eks_kubernetes_pod_scan_detection": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Scanning Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Amazon EKS Kubernetes cluster Pod",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=amazon_eks_kubernetes_pod_scan_detection",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-04-15",
            "description": "This search provides detection information on unauthenticated requests against Kubernetes' Pods API",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on forAWS (version 4.4.0 or later), then configure your AWS CloudWatch EKS Logs.Please also customize the `kubernetes_pods_aws_scan_fingerprint_detection` macro to filter out the false positives.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on forAWS (version 4.4.0 or later), then configure your AWS CloudWatch EKS Logs.Please also customize the `kubernetes_pods_aws_scan_fingerprint_detection` macro to filter out the false positives.",
            "icon": "ES_Use_Case.png",
            "id": "amazon_eks_kubernetes_pod_scan_detection",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Reconnaissance",
            "known_false_positives": "Not all unauthenticated requests are malicious, but frequency, UA and source IPs and direct request to API provide context.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "amazon_eks_kubernetes_pod_scan_detection_filter"
                }
            ],
            "mitre_sub_technique": "T1526",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1526",
            "mitre_threat_groups": "no",
            "name": "Amazon EKS Kubernetes Pod Scan Detection",
            "references": [],
            "released": "2020-04-15",
            "search": "`aws_cloudwatchlogs_eks` \"user.username\"=\"system:anonymous\" verb=list objectRef.resource=pods requestURI=\"/api/v1/pods\" | rename source as cluster_name sourceIPs{} as src_ip | stats count min(_time) as firstTime max(_time) as lastTime values(responseStatus.reason) values(responseStatus.code) values(userAgent) values(verb) values(requestURI) by src_ip cluster_name user.username user.groups{} | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `amazon_eks_kubernetes_pod_scan_detection_filter` ",
            "search_name": "ESCU - Amazon EKS Kubernetes Pod scan detection - Rule",
            "story": "a9ef59cf-e981-4e66-9eef-bb049f695c09",
            "tags": {
                "analytics_story": [
                    "Kubernetes Scanning Activity"
                ],
                "asset_type": "Amazon EKS Kubernetes cluster Pod",
                "kill_chain_phases": [
                    "Reconnaissance"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1526"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "Cloud Service Discovery"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "anomalous_audit_trail_activity_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Insider Threat",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Discovers anomalous activity such as the deletion of or clearing of log files. Attackers oftentimes clear the log files in order to hide their actions, therefore, this may indicate that the system has been compromised.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Audit",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_sub_technique": "T1070.004|T1070.003",
            "mitre_tactic": "|TA0005",
            "mitre_technique": "|T1070|T1146|T1107",
            "name": "Anomalous Audit Trail Activity Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Audit - Anomalous Audit Trail Activity Detected - Rule",
            "usecase": "Security Monitoring|Insider Threat"
        },
        "anomalous_new_listening_port": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Unauthorized Software|Lateral Movement",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET06ListeningPorts",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts a series of hosts begin listening on a new port within 24 hours. This may be an indication that the devices have been compromised or have had new (and potentially vulnerable) software installed.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1065|T1043",
            "name": "Anomalous New Listening Port",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Anomalous New Listening Port - Rule",
            "usecase": "Advanced Threat Detection"
        },
        "anomalous_new_process": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Unauthorized Software",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts when an anomalous number hosts are detected with a new process.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_sub_technique": "T1569.002",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|T1035|TA0002",
            "name": "Anomalous New Process",
            "relatedUseCases": [
                "showcase_new_interactive_service_logon",
                "anomalous_new_service"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "search_name": "Endpoint - Anomalous New Processes - Rule",
            "usecase": "Advanced Threat Detection"
        },
        "anomalous_new_service": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Unauthorized Software|Privilege Escalation",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts when an anomalous number hosts are detected with a new service.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_sub_technique": "T1543.003",
            "mitre_tactic": "|TA0004|TA0003",
            "mitre_technique": "|T1050",
            "name": "Anomalous New Service",
            "relatedUseCases": [
                "showcase_new_interactive_service_logon",
                "anomalous_new_process"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "search_name": "Endpoint - Anomalous New Services - Rule",
            "usecase": "Advanced Threat Detection"
        },
        "asset_ownership_unspecified": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS015ConfigurationManagement-ET01General",
            "deprecated_not_used_anymore_datasource": "Configuration Management",
            "description": "Alerts when there are assets that define a specific priority and category but do not have an assigned owner.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Identity",
            "gdprtext": "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "Cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Asset Ownership Unspecified",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Asset - Asset Ownership Unspecified - Rule",
            "usecase": "Compliance"
        },
        "at01": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence|Unauthorized Software|Operations",
            "contributes_to_threats": [
                "tt01",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt17",
                "tt18",
                "tt26",
                "tt28",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch",
            "description": "Triggered when an application is executed on an endpoint or server. Blacklisted applications are pre-defined in UBA and updated on a regular basis.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS009EndPointIntel-ET01ProcessLaunch"
                    ],
                    "description": "Checks application launches in Windows Event Log against a predefined list of known bad applications. ",
                    "id": "DM07",
                    "internal_id": "Blacklisted_Application",
                    "name": "Blacklisted Application"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at01",
            "includeSSE": "Yes",
            "internal_id": "Blacklisted_Application",
            "journey": "Stage_4",
            "long_description": "Triggered when an application is executed on an endpoint or server. Blacklisted applications are pre-defined in UBA and updated on a regular basis.",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|TA0002",
            "name": "Blacklisted Application",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at02": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "contributes_to_threats": [
                "tt01",
                "tt12",
                "tt13",
                "tt15",
                "tt18",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "description": "Triggered off of DNS and/or HTTP data, this anomaly compares domains that are visted against the internal UBA blacklist. If sites match, the anomaly is created.",
            "detections": [
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "UBA ships with a list of predefined Domains and IPs that are known bad. This will identify when a user visits a URL or IP that has been blacklisted by UBA. Custom domains and IPs can be added.",
                    "id": "DM08",
                    "internal_id": "Blacklisted_Domain",
                    "name": "Blacklisted Domain"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at02",
            "includeSSE": "Yes",
            "internal_id": "Blacklisted_Domain",
            "journey": "Stage_4",
            "long_description": "Triggered off of DNS and/or HTTP data, this anomaly compares domains that are visted against the internal UBA blacklist. If sites match, the anomaly is created.",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1095|T1071",
            "name": "Blacklisted Domain",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection"
        },
        "at03": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "contributes_to_threats": [
                "tt01",
                "tt12",
                "tt13",
                "tt15",
                "tt18",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "description": "Trigerred off of core network traffic, this anomaly compares IP addresses that are visted agains the internal UBA IP Address blacklist. If IPs match, the anomaly is created.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "UBA ships with a list of predefined Domains and IPs that are known bad. This will identify when a user visits a URL or IP that has been blacklisted by UBA. Custom domains and IPs can be added.",
                    "id": "DM09",
                    "internal_id": "Blacklisted_IP_Address",
                    "name": "Blacklisted IP Address"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at03",
            "includeSSE": "Yes",
            "internal_id": "Blacklisted_IP_Address",
            "journey": "Stage_4",
            "long_description": "Trigerred off of core network traffic, this anomaly compares IP addresses that are visted agains the internal UBA IP Address blacklist. If IPs match, the anomaly is created.",
            "mitre_tactic": "|TA0011|TA0010",
            "mitre_technique": "|T1094|T1095|T1071|T1048|T1041",
            "name": "Blacklisted IP Address",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection"
        },
        "at04": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|IAM Analytics",
            "contributes_to_threats": [],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success",
            "description": "Triggered off of authentication attempts and/or number of devices a user has access to over time. Identifies possible brute force attacks inside of an environment.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Identifies users who have an increasing number of devices accessed over time.",
                    "id": "DM10",
                    "internal_id": "Brute_Force_Attack__Login_failures_for_multiple_accounts",
                    "name": "Brute Force Attack _Login failures for multiple accounts"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Identifies possible attempts of brute force by looking at failed and successful login attempts. Failed and successful login attempts are defined by specific event codes from Windows event logs. ",
                    "id": "DM78",
                    "internal_id": "Password_spraying",
                    "name": "Password spraying"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at04",
            "includeSSE": "Yes",
            "internal_id": "Brute_Force_Attack",
            "journey": "Stage_4",
            "long_description": "Triggered off of authentication attempts and/or number of devices a user has access to over time. Identifies possible brute force attacks inside of an environment.",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Brute Force Attack",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "at05": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Account Compromise",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt05",
                "tt09",
                "tt13",
                "tt15",
                "tt21",
                "tt26",
                "tt28",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "description": "Triggered off of accounting information from firewall data (bytes in/out) to determine an unusually high volume of downloaded data per user from UBA defined internal servers.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects outliers of downloaded bytes per user from internal servers. This requires internal network traffic to be ingested into UBA.",
                    "id": "DM25",
                    "internal_id": "Download_from_Internal_Server",
                    "name": "Download from Internal Server"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at05",
            "includeSSE": "Yes",
            "internal_id": "Download_from_Internal_Server",
            "journey": "Stage_4",
            "long_description": "Triggered off of accounting information from firewall data (bytes in/out) to determine an unusually high volume of downloaded data per user from UBA defined internal servers.",
            "mitre_tactic": "|TA0009",
            "mitre_technique": "|T1039|T1213",
            "name": "Download from Internal Server",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "at06": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Insider Threat",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt05",
                "tt06",
                "tt07",
                "tt08",
                "tt09",
                "tt10",
                "tt11",
                "tt12",
                "tt13",
                "tt15",
                "tt20",
                "tt26",
                "tt28",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware",
            "description": "Triggered when there is more than expected data transfer for a user or device. This anomaly will often be included in a data exfiltration attempt.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "This detection looks at a historical baseline of data transfer by device. This type of information typically comes from the accounting information (bytes in/bytes out or packets in/packets out) from either a firewall or proxy. It only looks at connections that behave as file transfers and not other connections (web browsing/video chat). ",
                    "id": "DM18",
                    "internal_id": "Data_uploads_to_external_destination_by_a_device_using_signal_intelligence",
                    "name": "Data uploads to external destination by a device using signal intelligence"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "This detection looks at a historical baseline of data transfer by user. This type of information typically comes from the accounting information (bytes in/bytes out or packets in/packets out) from either a firewall or proxy. It only looks at connections that behave as file transfers and not other connections (web browsing/video chat). ",
                    "id": "DM19",
                    "internal_id": "Data_uploads_to_external_destination_by_a_user_using_signal_intelligence",
                    "name": "Data uploads to external destination by a user using signal intelligence"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Detects outliers in the outgoing bytes transmission by each user.",
                    "id": "DM29",
                    "internal_id": "Excessive_amount_of_data_transmission_by_user",
                    "name": "Excessive amount of data transmission by user"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Detects outliers in the traffic volume over VPN per user.",
                    "id": "DM30",
                    "internal_id": "Excessive_data_downloaded_to_workstation_while_on_VPN",
                    "name": "Excessive data downloaded to workstation while on VPN"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Detects outliers based on historical baseline by looking at bytes in/out to detect unusual data movement. UBA looks at this data per application.",
                    "id": "DM31",
                    "internal_id": "Excessive_data_transmission_by_a_device_using_specific_application",
                    "name": "Excessive data transmission by a device using specific application"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at06",
            "includeSSE": "Yes",
            "internal_id": "Excessive_Data_Transmission",
            "journey": "Stage_6",
            "long_description": "This is a collection of anomalies that all share data exfiltration as the ultimate goal. This anomaly contains both excessive data transmission from a user and a device perspective, looking at both network and firewall data and connection profiling. The baseline is per user or per device.",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1048|T1041",
            "name": "Excessive Data Transmission",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "at07": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Network Attack",
            "contributes_to_threats": [
                "tt01",
                "tt04",
                "tt10",
                "tt14",
                "tt16",
                "tt18",
                "tt25",
                "tt28",
                "tt31"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This is a generic catch all anomaly that can hold alarms generated by 3rd party systems like firewall, IDS/IPS, Enterprise Security, etc.",
            "detections": [
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Looks at external alarms from outside systems (IDS, IPS, DLP, etc) and determines the risk of entities in UBA based on those external alarms.",
                    "id": "DM05",
                    "internal_id": "Analysis_&_prioritization_of_security_alerts_from_other_tools",
                    "name": "Analysis & prioritization of security alerts from other tools"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at07",
            "includeSSE": "Yes",
            "internal_id": "External_Alarm_Activity",
            "journey": "Stage_4",
            "long_description": "This is a generic catch all anomaly that can hold alarms generated by 3rd party systems like firewall, IDS/IPS, Enterprise Security, etc. Most common use case of this anomaly is bringing in ES Notable Events to add to users' profiles. Additionally, this model classifies these external alarms into categories so that threat models can leverage them against a kill chain phase or MITRE tactic.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "External Alarm Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at08": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Web Attack",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt05",
                "tt11",
                "tt12",
                "tt13",
                "tt15",
                "tt24",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "description": "This anomaly detects malicious incoming traffic on websites (e.g., SQL injection).",
            "detections": [
                {
                    "data_source": [
                        "DS014WebServer-ET01Access"
                    ],
                    "description": "Raises anomalies when there are suspicious patterns in incoming web traffic.",
                    "id": "DM143",
                    "internal_id": "SQL_Injection",
                    "name": "SQL Injection"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at08",
            "includeSSE": "Yes",
            "internal_id": "External_Website_Attack",
            "journey": "Stage_4",
            "long_description": "This anomaly detects malicious incoming traffic on websites (e.g., SQL injection).",
            "mitre_tactic": "TA0001",
            "mitre_technique": "|T1190",
            "name": "External Website Attack",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Application Security"
        },
        "at09": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "contributes_to_threats": [
                "tt19",
                "tt25",
                "tt27"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "Trigged when acess to a badge panel (door or otherwise) is denied because the badge is disabled. Disabled doe not neceissarly mean terminated.",
            "detections": [
                {
                    "data_source": [
                        "DS017PhysicalSecurity-ET01Access"
                    ],
                    "description": "Detects a door access attempt from a badge that has been disabled",
                    "id": "DM95",
                    "internal_id": "Rare_badge_location_by_a_user",
                    "name": "Rare badge location by a user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at09",
            "includeSSE": "Yes",
            "internal_id": "Failed_Access_by_Disabled_Badge",
            "journey": "Stage_4",
            "long_description": "Trigged when acess to a badge panel (door or otherwise) is denied because the badge is disabled. Disabled doe not neceissarly mean terminated.",
            "mitre_sub_technique": "T1591.001",
            "mitre_tactic": "|TA0043",
            "mitre_technique": "T1591",
            "name": "Failed Access by Disabled Badge",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "at10": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "contributes_to_threats": [
                "tt19",
                "tt25",
                "tt27"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "Triggered by multiple failed access attempts at multiple physical locations.",
            "detections": [
                {
                    "data_source": [
                        "DS017PhysicalSecurity-ET01Access"
                    ],
                    "description": "Detects multiple failed badge-in attempts with a disabled badge. Disabled badges have been disabled in the badge system. This does not necessarily identify a terminated user.",
                    "id": "DM33",
                    "internal_id": "Failed_badge_attempt_from_a_disabled_badge",
                    "name": "Failed badge attempt from a disabled badge"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at10",
            "includeSSE": "Yes",
            "internal_id": "Failed_Badge_Accesses_on_Multiple_Doors",
            "journey": "Stage_4",
            "long_description": "Similar to \"Failed Access by Disabled Badge\" - this anomaly detects multiple failed access attempts at multiple physical locations. Disabled badges are set disabled in the badge system. This doesn't not necessarily mean that the user has been terminated.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Failed Badge Accesses on Multiple Doors",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at11": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "contributes_to_threats": [
                "tt20",
                "tt21",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send|DS005WebProxyRequest-ET01Requested",
            "description": "Triggered when a user exhibits behavior that indicates that the user may be a flight risk (risk to leave the company).",
            "detections": [
                {
                    "data_source": [
                        "DS001MAIL-ET03Send"
                    ],
                    "description": "Identifies emails to competitors. Competitors are provided during setup and can be added or deleted at any time in UBA setup.",
                    "id": "DM26",
                    "internal_id": "Email_to_competitor",
                    "name": "Email to competitor"
                },
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies users who visit job listing sites several times a day. This list is pre-populated and updated with every content update of UBA.",
                    "id": "DM163",
                    "internal_id": "User_browsing_job_sites_flight_risk_user",
                    "name": "User browsing job sites_flight risk user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at11",
            "includeSSE": "Yes",
            "internal_id": "Flight_Risk_User",
            "journey": "Stage_4",
            "long_description": "This anomaly identifies two actions that may be taken by a user. In the first instance, a user sends an email to a competitive entity. These competitors are identified during configuration of UBA. The second case involves browsing pre-defined job sites (e.g., monster, dice, indeed.) This anomaly will trigger when one of or both actions occur.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Flight Risk User",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "at12": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Account Sharing",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt04",
                "tt07",
                "tt11",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt18",
                "tt22",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "description": "Triggered by users logging into VPN session from multiple locations within a short amount of time.",
            "detections": [
                {
                    "data_source": [
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Identifies users who login to VPN from multiple geographical locations in a short amount of time.",
                    "id": "DM55",
                    "internal_id": "Landspeed_violation/Login_from_distinct_geolocations_in_short_span",
                    "name": "Landspeed violation/Login from distinct geolocations in short span"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at12",
            "includeSSE": "Yes",
            "internal_id": "Land_Speed_Violation",
            "journey": "Stage_4",
            "long_description": "Triggered by users logging into VPN session from multiple locations within a short amount of time.",
            "mitre_tactic": "|TA0001|TA0003",
            "mitre_technique": "|T1078",
            "name": "Land Speed Violation",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Security Monitoring"
        },
        "at13": {
            "alertvolume": "Very Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Privilege Escalation",
            "contributes_to_threats": [
                "tt03",
                "tt04",
                "tt10",
                "tt14",
                "tt16",
                "tt18",
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "description": "Triggered when an account is created on a workstation or endpoint. This is a local Windows account when the machine is joined to a domain.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Identifies any local account creation at the workstation/endpoint level. This requires endpoint data being ingested into UBA.",
                    "id": "DM58",
                    "internal_id": "Local_account_creation",
                    "name": "Local account creation"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at13",
            "includeSSE": "Yes",
            "internal_id": "Local_Account_Creation",
            "journey": "Stage_1",
            "long_description": "Triggered when an account is created on a workstation or endpoint. This is a local Windows account when the machine is joined to a domain.",
            "mitre_tactic": "|TA0003",
            "mitre_technique": "|T1136",
            "name": "Local Account Creation",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Security Monitoring"
        },
        "at14": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt12",
                "tt13",
                "tt15",
                "tt18",
                "tt26",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "description": "Triggered by devices that have recurring machine generated traffic. Looking at both web and network traffic.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies suspicious beaconing activity by looking at network traffic for systematic or repeating traffic.",
                    "id": "DM60",
                    "internal_id": "Machine_Generated_Beacon",
                    "name": "Machine Generated Beacon"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at14",
            "includeSSE": "Yes",
            "internal_id": "Machine_Generated_Beacon",
            "journey": "Stage_6",
            "long_description": "Triggered by devices that have recurring machine generated traffic. Looking at both web and network traffic.",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1071|T1095",
            "name": "Machine Generated Beacon",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection"
        },
        "at15": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt03",
                "tt10",
                "tt14",
                "tt16",
                "tt17",
                "tt18",
                "tt22",
                "tt25",
                "tt28",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success",
            "description": "This anomaly contains multiple detection methods that look at Windows Event Logs for malicious activity (e.g., clearning audit logs). Check associated detection methods for an exhastive list of what triggers this anomaly.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Any activity by an inactive user. An inactive user in UBA is any user that is marked \"InActive\" in the HR data ingestion process. User status could be different from account status, if the user has multiple accounts.",
                    "id": "DM03",
                    "internal_id": "Activity_by_terminated_user",
                    "name": "Activity by terminated user"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Identifies actions in Active Directory where an user performs an administrative change on his own account.",
                    "id": "DM04",
                    "internal_id": "Administrative_changes_on_one's_own_account",
                    "name": "Administrative changes on one's own account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "identifies use of audit log clearing in a Windows environment. This detection method looks for event code 1102.",
                    "id": "DM11",
                    "internal_id": "Clearing_audit_logs",
                    "name": "Clearing audit logs"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects possible golden ticket attacks by identifying events in Windows Security Logs.",
                    "id": "DM38",
                    "internal_id": "Golden_ticket_detection",
                    "name": "Golden ticket detection"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Identifies accounts where operations are performed upon itself (e.g., Self elevation).",
                    "id": "DM76",
                    "internal_id": "Operations_to_self",
                    "name": "Operations to self"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects any usage of the KRBTGT account ( https://blogs.technet.microsoft.com/janelewis/2006/12/19/the-krbtgt-account-what-is-it/ )",
                    "id": "DM161",
                    "internal_id": "Usage_of_recovery_account",
                    "name": "Usage of recovery account"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at15",
            "includeSSE": "Yes",
            "internal_id": "Malicious_AD_Activity",
            "journey": "Stage_4",
            "long_description": "This anomaly contains multiple detection methods that look at Windows Event Logs for malicious activity (e.g., clearning audit logs). Check associated detection methods for an exhastive list of what triggers this anomaly.",
            "mitre_tactic": "|TA0003|TA0004|TA0001|TA0008",
            "mitre_technique": "|T1078|T1097",
            "name": "Malicious AD Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "at16": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET02Failure",
            "description": "Triggered when a user fails authentication multiple times. This anomaly is only  triggered when the number of authentication failures exceeds the enterprise average.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET02Failure"
                    ],
                    "description": "Detects an abnormally high volume of authentication failures for a user. This is based on enterprise average.",
                    "id": "DM45",
                    "internal_id": "High_volume_of_authentication_failures_for_a_given_user",
                    "name": "High volume of authentication failures for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at16",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Authentication_Failures",
            "journey": "Stage_4",
            "long_description": "Triggered when a user fails authentication multiple times. This anomaly is only  triggered when the number of authentication failures exceeds the enterprise average.",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Multiple Authentication Failures",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "at17": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt12",
                "tt13",
                "tt15",
                "tt25",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET02Failure",
            "description": "Triggered on outliers of number of successes and failures per user authenticating against services or machines.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET02Failure"
                    ],
                    "description": "Outlier detection of login failures per user.",
                    "id": "DM50",
                    "internal_id": "High_volume_of_login_failures_for_a_given_user",
                    "name": "High volume of login failures for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at17",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Authentications",
            "journey": "Stage_4",
            "long_description": "Triggered on outliers of number of successes and failures per user authenticating against services or machines.",
            "mitre_tactic": "|TA0001|TA0006",
            "mitre_technique": "|T1078|T1110",
            "name": "Multiple Authentications",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "at18": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "contributes_to_threats": [
                "tt15",
                "tt25",
                "tt27"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "Triggered by number of badge accesses per user per day based on historical baseline.",
            "detections": [
                {
                    "data_source": [
                        "DS017PhysicalSecurity-ET01Access"
                    ],
                    "description": "Detects an abnormally high number of attempts to use a badge for a user. This is based on enterprise average.",
                    "id": "DM46",
                    "internal_id": "High_volume_of_badge_attempts_for_a_given_user",
                    "name": "High volume of badge attempts for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at18",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Badge_Accesses",
            "journey": "Stage_4",
            "long_description": "Triggered by number of badge accesses per user per day based on historical baseline.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple Badge Accesses",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at19": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt03",
                "tt08"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "description": "Triggered by multiple login errors against Box authentication. This is for failed logins only. Similar to the \"Multiple Box Logins\" anomaly.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Outlier detection of box failed logins per user.",
                    "id": "DM49",
                    "internal_id": "High_volume_of_login_errors_on_box_for_a_given_user",
                    "name": "High volume of login errors on box for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at19",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Box_login_errors",
            "journey": "Stage_3",
            "long_description": "Triggered by multiple login errors against Box authentication. This is for failed logins only. Similar to the \"Multiple Box Logins\" anomaly.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple Box login errors",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at20": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt08"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "description": "Triggered by the total number of  Box logins per user per day based on historical baseline. These are successful logins only.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Outlier detection of box logins per user.",
                    "id": "DM52",
                    "internal_id": "High_volume_of_logins_on_box_for_a_given_user",
                    "name": "High volume of logins on box for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at20",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Box_logins",
            "journey": "Stage_3",
            "long_description": "Triggered by the total number of  Box logins per user per day based on historical baseline. These are successful logins only.",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1078",
            "name": "Multiple Box logins",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at21": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise",
            "contributes_to_threats": [
                "tt02",
                "tt03",
                "tt09",
                "tt13",
                "tt15",
                "tt21",
                "tt26",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "description": "Triggered by a high volume of box operations by user. The number of operations  is compared to the enterprise average.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Detects an abnormally high number of box operations for a user. This is based on enterprise average.",
                    "id": "DM47",
                    "internal_id": "High_volume_of_box_operations_for_a_given_user",
                    "name": "High volume of box operations for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at21",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Box_operations",
            "journey": "Stage_3",
            "long_description": "Triggered by a high volume of box operations by user. The number of operations  is compared to the enterprise average.",
            "mitre_tactic": "|TA0009",
            "mitre_technique": "|TA0009",
            "name": "Multiple Box operations",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at22": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Network Attack",
            "contributes_to_threats": [
                "tt31"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection",
            "description": "Triggered when the number of external alarms from external tools (IDS, IPS, DLP) is higher for a specific user when compared to the enterprise average.",
            "detections": [
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection"
                    ],
                    "description": "Detects an abnormally high number of events from an external security tool for a device. This is based on enterprise average.",
                    "id": "DM44",
                    "internal_id": "High_volume_of_alerts_from_other_security_tools_on_a_given_device",
                    "name": "High volume of alerts from other security tools on a given device"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at22",
            "includeSSE": "Yes",
            "internal_id": "Multiple_External_Alarms",
            "journey": "Stage_5",
            "long_description": "Triggered when the number of external alarms from external tools (IDS, IPS, DLP) is higher for a specific user when compared to the enterprise average.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple External Alarms",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at23": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "contributes_to_threats": [
                "tt25",
                "tt27"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "Triggered when multiple users fail to badge in at a single badge-in access point. This could be used to detect both a physical brute force attack or faulty hardware.",
            "detections": [
                {
                    "data_source": [
                        "DS017PhysicalSecurity-ET01Access"
                    ],
                    "description": "Detects multiple failures by multiple users at a single badge-in station. This could be used to detect faulty hardware of the badge detector or a physical brute force attack.",
                    "id": "DM34",
                    "internal_id": "Failed_badge_attempts_from_multiple_users_at_same_door",
                    "name": "Failed badge attempts from multiple users at same door"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at23",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Failed_Badge_Access_Attempts",
            "journey": "Stage_4",
            "long_description": "Triggered when multiple users fail to badge in at a single badge-in access point. This could be used to detect both a physical brute force attack or faulty hardware.",
            "mitre_sub_technique": "T1591.001",
            "mitre_tactic": "|TA0043",
            "mitre_technique": "T1591",
            "name": "Multiple Failed Badge Access Attempts",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at24": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt01",
                "tt01",
                "tt02",
                "tt10",
                "tt13",
                "tt15",
                "tt16",
                "tt25",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success",
            "description": "Triggered when the number of successful logins by a user is higher than the enterprise average. This anomaly could point to a number of things, including lateral movement, account takeover, or just general suspicious behavior.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Outlier detection of logins per user.",
                    "id": "DM51",
                    "internal_id": "High_volume_of_logins_for_a_given_user",
                    "name": "High volume of logins for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at24",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Logins",
            "journey": "Stage_4",
            "long_description": "Triggered when the number of successful logins by a user is higher than the enterprise average. This anomaly could point to a number of things, including lateral movement, account takeover, or just general suspicious behavior.",
            "mitre_tactic": "|TA0001|TA0008",
            "mitre_technique": "|T1078|T1028",
            "name": "Multiple Logins",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "at25": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Network Attack",
            "contributes_to_threats": [
                "tt10",
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01TrafficAppAware",
            "description": "Triggered when there is more than expected traffic destined for a single device. Most typically this anomaly is seen with DDOS behavior or something similar.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Detects a DDOS attempt by identifying unwanted traffic destined for a host.",
                    "id": "DM20",
                    "internal_id": "DDOS_amplification",
                    "name": "DDOS amplification"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at25",
            "includeSSE": "Yes",
            "internal_id": "Network_Protocol_Violation",
            "journey": "Stage_2",
            "long_description": "Triggered when there is more than expected traffic destined for a single device. Most typically this anomaly is seen with DDOS behavior or something similar.",
            "mitre_tactic": "|TA0040",
            "mitre_technique": "|T1499",
            "name": "Network Protocol Violation",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Security Monitoring"
        },
        "at26": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt03",
                "tt04",
                "tt10",
                "tt12",
                "tt14",
                "tt15",
                "tt16",
                "tt17",
                "tt18",
                "tt22",
                "tt25",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "description": "Triggered when Windows events occur outside of the normal baseline for a user. ",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Correlates the rate of behavioral changes in Active Directory actions for each account. The correlation happens with: (a) each account's historic profile, and (b) with the activity of other accounts in the enterprise.",
                    "id": "DM158",
                    "internal_id": "Unusual_Windows_Security_Event_Sequences",
                    "name": "Unusual Windows Security Event Sequences"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at26",
            "includeSSE": "Yes",
            "internal_id": "Period_with_Unusual_Windows_Security_Event_Sequences",
            "journey": "Stage_6",
            "long_description": "Triggered when a sequence of events within the Windows Security Event log is outside of the norm. Normal behavior is baselined from the users' past behavior but also from the enterprise. (e.g., 98% of the time after login, users open Outlook. It would be unusual then, for a user to login, create a new user, elevate that user to admin, etc.)",
            "mitre_tactic": "|TA0003|TA0004|TA0001",
            "mitre_technique": "|T1078",
            "name": "Period with Unusual Windows Security Event Sequences",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "at27": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Phishing",
            "contributes_to_threats": [
                "tt22",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET02Receive",
            "description": "Triggered by external email monitoring tools when a specific user or group is a possible target of a spear phishing campaign.",
            "detections": [
                {
                    "data_source": [
                        "DS001MAIL-ET02Receive"
                    ],
                    "description": "Uses external notifications from an existing email monitoring tool to identify incoming spear phishing email that has been targeting a specific department in the organization.",
                    "id": "DM139",
                    "internal_id": "Spear_phishing",
                    "name": "Spear phishing"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at27",
            "includeSSE": "Yes",
            "internal_id": "Possible_Phishing_Attempt",
            "journey": "Stage_4",
            "long_description": "Triggered by external email monitoring tools when a specific user or group is a possible target of a spear phishing campaign.",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1193|T1192",
            "name": "Possible Phishing Attempt",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection"
        },
        "at28": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Web Attack",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt05",
                "tt11",
                "tt12",
                "tt13",
                "tt15",
                "tt26",
                "tt35"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "description": "Triggered when an internal webserver is accessed from an outside source.",
            "detections": [
                {
                    "data_source": [
                        "DS014WebServer-ET01Access"
                    ],
                    "description": "Detects external access to internal web servers as possible webshell activity.",
                    "id": "DM83",
                    "internal_id": "Potential_webshell_activity",
                    "name": "Potential webshell activity"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at28",
            "includeSSE": "Yes",
            "internal_id": "Potential_Webshell_Activity",
            "journey": "Stage_4",
            "long_description": "Triggered when an internal webserver is accessed from an outside source.",
            "mitre_tactic": "|TA0003",
            "mitre_technique": "|T1100",
            "name": "Potential Webshell Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Application Security"
        },
        "at29": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt03",
                "tt04",
                "tt13",
                "tt15",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "description": "Triggers when a device exhibits either horizontal/vertical scanning patterns or appears to be sending data to a large number of ports per destination device.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies devices that exhibit suspicious vertical/horizontal scanning patterns.",
                    "id": "DM53",
                    "internal_id": "Host_Scan",
                    "name": "Host Scan"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies devices correlated to suspicious vertical and horizontal scanning patterns.",
                    "id": "DM138",
                    "internal_id": "Service/Port_Scan",
                    "name": "Service/Port Scan"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at29",
            "includeSSE": "Yes",
            "internal_id": "Scanning_Activity",
            "journey": "Stage_6",
            "long_description": "Triggers when a device exhibits either horizontal/vertical scanning patterns or appears to be sending data to a large number of ports per destination device.",
            "mitre_tactic": "|TA0007",
            "mitre_technique": "|T1046",
            "name": "Scanning Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at30": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt10",
                "tt14",
                "tt16",
                "tt17",
                "tt18",
                "tt22",
                "tt25",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS001MAIL-ET03Send|DS003Authentication-ET01Success",
            "description": "This anomaly contains multiple detection methods that look at account events for suspcious activity (e.g., activity by an expired user). Check the associated detection methods for an exhaustive list of what triggers this anomaly.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects any account that has been created or deleted in the past 24 hour time period. This detection method looks at both local and domain accounts.",
                    "id": "DM02",
                    "internal_id": "Account_created_and_deleted_in_a_short_span",
                    "name": "Account created and deleted in a short span"
                },
                {
                    "data_source": [
                        "DS001MAIL-ET03Send"
                    ],
                    "description": "Identifies users who email to themselves outside of the organization. This uses logic based on collected HR data to determine if a user internally is the same as an external email. Example, John Smith to jsmith@gmail.com would create an anomaly. John Smith to bjones@gmail.com would not.\n",
                    "id": "DM27",
                    "internal_id": "Email_to_self",
                    "name": "Email to self"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Identifies successful/unsuccessful interactive logins by service accounts. Service accounts are identified during HR data ingestion into UBA.",
                    "id": "DM54",
                    "internal_id": "Interactive_logins_by_service_accounts",
                    "name": "Interactive logins by service accounts"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Identifies accounts that have tried to login, but were rejected by the domain controller because the account is disabled in AD.",
                    "id": "DM59",
                    "internal_id": "Login_attempts_from_disabled_account",
                    "name": "Login attempts from disabled account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects when a user is added and removed from a group in the same day.",
                    "id": "DM64",
                    "internal_id": "Member_added_and_removed_from_a_security_enabled_group_in_a_short_span",
                    "name": "Member added and removed from a security enabled group in a short span"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects when any new accounts are created. This looks at both domain and local accounts.",
                    "id": "DM73",
                    "internal_id": "New_account_created",
                    "name": "New account created"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Performs peer group analysis of Unusual AD Event codes and then identifies if there are any event codes that have been triggered by a person and not by any other members in the peer group.",
                    "id": "DM81",
                    "internal_id": "Peer_group_outlier_of_Windows_security_event",
                    "name": "Peer group outlier of Windows security event"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Detects activity from a terminated user. Terminated users are users who are marked inactive/disabled in the HR data ingest process.",
                    "id": "DM152",
                    "internal_id": "Terminated_user_activity",
                    "name": "Terminated user activity"
                },
                {
                    "data_source": [
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Identifies VPN traffic by a service account. Service accounts are identified in HR data ingest in UBA.",
                    "id": "DM170",
                    "internal_id": "VPN_login_using_service_account",
                    "name": "VPN login using service account"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at30",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Account_Activity",
            "journey": "Stage_6",
            "long_description": "This anomaly contains multiple detection methods that look at account events for suspcious activity (e.g., activity by an expired user). Check the associated detection methods for an exhaustive list of what triggers this anomaly.",
            "mitre_tactic": "|TA0003|TA0001|TA0004",
            "mitre_technique": "|T1136|T1078",
            "name": "Suspicious Account Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at31": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt04",
                "tt12",
                "tt13",
                "tt15",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "description": "Triggered when an account lockout occurs without any corresponding cause (e.g., password change, password reset, etc.) ",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Looks for suspicious account lockouts that do not have any associations with password changes, password resets, password expiry within a specific time interval in and around the lockout period.",
                    "id": "DM145",
                    "internal_id": "Suspicious_account_lockouts",
                    "name": "Suspicious account lockouts"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at31",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Account_Lockout",
            "journey": "Stage_4",
            "long_description": "Triggered when an account lockout occurs without any corresponding cause (e.g., password change, password reset, etc.) ",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Suspicious Account Lockout",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "at32": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "contributes_to_threats": [
                "tt03",
                "tt04",
                "tt07",
                "tt08",
                "tt09",
                "tt20",
                "tt21",
                "tt29",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This anomaly contains a number of detection methods surrounding box usage and malicious intent (e.g., file relay through box). Check the associated detection methods for a comprehensive list of what triggers this anomaly.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Looks for a specific set of Box commands that indicates data collection.",
                    "id": "DM12",
                    "internal_id": "Data_collection_from_box",
                    "name": "Data collection from box"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM91",
                    "internal_id": "Rare_alert_signature_for_a_given_user",
                    "name": "Rare alert signature for a given user"
                },
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Identifies users uploading data from one location and then downloading the same data from a new, different location.",
                    "id": "DM36",
                    "internal_id": "File_relay_on_multiple_devices_using_box",
                    "name": "File relay on multiple devices using box"
                },
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Identifies users whose number of collaboration acceptances is outside the normal baseline. ",
                    "id": "DM39",
                    "internal_id": "High_number_of_collaboration_accepts_on_box",
                    "name": "High number of collaboration accepts on box"
                },
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Looks for specific set of box commands that indicate a malicious publication with the intent of leaking the data",
                    "id": "DM61",
                    "internal_id": "Malicious_publication_-_Data_leakage_through_box",
                    "name": "Malicious publication - Data leakage through box"
                },
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Detects upload policy violation in box.",
                    "id": "DM15",
                    "internal_id": "Data_theft_-_Policy_violation",
                    "name": "Data theft - Policy violation"
                },
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Looks for specific set of box commands that indicate a malicious publication with the intent of publishing a malicious file or exploit",
                    "id": "DM62",
                    "internal_id": "Malicious_publication_-_watering_hole_attack",
                    "name": "Malicious publication - watering hole attack"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at32",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Box_Usage",
            "journey": "Stage_4",
            "long_description": "This anomaly contains a number of detection methods surrounding box usage and malicious intent (e.g., file relay through box). Check the associated detection methods for a comprehensive list of what triggers this anomaly.",
            "mitre_tactic": "|TA0010|TA0005",
            "mitre_technique": "|T1011|T1102|TA0010",
            "name": "Suspicious Box Usage",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection"
        },
        "at33": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Endpoint Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt03",
                "tt05",
                "tt06",
                "tt07",
                "tt08",
                "tt10",
                "tt11",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt17",
                "tt18",
                "tt20",
                "tt22",
                "tt26",
                "tt29",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware",
            "description": "This anomaly contains multiple detection methods surrounding suspicious data movement (e.g., sending email to self, external DLP alarms, etc.)",
            "detections": [
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Identifies external DLP events where a file includes both social security numbers and a credit card in the same file. This file must trigger the external DLP system's policy. ",
                    "id": "DM22",
                    "internal_id": "DLP_alarms_detecting_SSN_&_CC_together_in_same_file",
                    "name": "DLP alarms detecting SSN & CC together in same file"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Identifies external DLP events where a file's name is changed while copying. This requires external DLP functionality.",
                    "id": "DM21",
                    "internal_id": "DLP_alarm_representing_a_change_of_name_while_copying",
                    "name": "DLP alarm representing a change of name while copying"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Identifies external DLP alarms (from DLP system) that show users printing documents that violate multiple DLP policies. An external DLP system must be in place for this anomaly to fire.",
                    "id": "DM35",
                    "internal_id": "File_print_violating_multiple_DLP_policies",
                    "name": "File print violating multiple DLP policies"
                },
                {
                    "data_source": [
                        "DS001MAIL-ET03Send"
                    ],
                    "description": "Identifies users sending emails to external domains that contains a resume as one of the attachments.",
                    "id": "DM133",
                    "internal_id": "Resume_sent_externally",
                    "name": "Resume sent externally"
                },
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
                        "DS016DataLossPrevention-ET01Violation",
                        "DS005WebProxyRequest-ET01Requested",
                        "DS001MAIL-ET03Send"
                    ],
                    "description": "Detects attempt of transferring a file across multiple channels(USB,CD/DVD,HTTP,Email,Print etc.).",
                    "id": "DM134",
                    "internal_id": "Same_file_being_attempted_to_transfer_across_multiple_egress_channels",
                    "name": "Same file being attempted to transfer across multiple egress channels"
                },
                {
                    "data_source": [
                        "DS001MAIL-ET03Send"
                    ],
                    "description": "Detects sensitive data being sent and/or posted to personal email accounts or personal file sharing sites. This uses logic based on collected HR data to determine if a user internally is the same as an external email. Example, John Smith to jsmith@gmail.com would create an anomaly. John Smith to bjones@gmail.com would not.",
                    "id": "DM137",
                    "internal_id": "Sensitive_data_violating_DLP_policies_transfer_to_personal_sites/mail",
                    "name": "Sensitive data_violating DLP policies transfer to personal sites/mail"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Detected suspicious file transfer or shell communication from user to an external domain / IP address. The suspiciousness is determined by the URL categorization of the destination.",
                    "id": "DM148",
                    "internal_id": "Suspicious_file_transfer_or_SSH_connections_to_external_domains_/_IP_addresses",
                    "name": "Suspicious file transfer or SSH connections to external domains / IP addresses"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Identifies a user who transferred multiple files out of organization triggering DLP alarms. An external DLP system must be in place for this detection method to work.",
                    "id": "DM166",
                    "internal_id": "User_triggering_DLP_alarms_across_multiple_files",
                    "name": "User triggering DLP alarms across multiple files"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Identifies users who tried to copy data out of organization across multiple channels triggering DLP alerts. An external DLP system must be in place for this detection method to work.",
                    "id": "DM167",
                    "internal_id": "user_triggering_multiple_types_of_DLP_alarms",
                    "name": "user triggering multiple types of DLP alarms"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Detects outliers in the traffic volume over VPN per user per destination zone",
                    "id": "DM32",
                    "internal_id": "Excessive_data_transmission_outbound_going_through_a_different_destinationZone",
                    "name": "Excessive data transmission outbound going through a different destinationZone"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Detects outliers based on historical baseline by looking at bytes in/out to detect unusual data movement. UBA looks at this data per application.",
                    "id": "DM31",
                    "internal_id": "Excessive_data_transmission_by_a_device_using_specific_application",
                    "name": "Excessive data transmission by a device using specific application"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Analyzes different types of data transfers per account, both LAN and WAN, to identify unusual data movements using various countries.",
                    "id": "DM164",
                    "internal_id": "User_transmitting_excessive_data_for_a_application",
                    "name": "User transmitting excessive data for a application"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Analyzes different types of data transfers per account, both LAN and WAN, to identify unusual data movements to different countries.",
                    "id": "DM165",
                    "internal_id": "User_transmitting_excessive_data_for_a_country",
                    "name": "User transmitting excessive data for a country"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "This detection method looks at DLP alarms and access of the file(s) in question. If the user or user peer group has never accessed that file, an anomaly is raised.",
                    "id": "DM17",
                    "internal_id": "Data_transmission_attempt_of_a_sensitive_document_violated_DLP_policies_that_was_never_accessed_by_the_user_or_by_the_members_in_the_same_department",
                    "name": "Data transmission attempt of a sensitive document_violated DLP policies that was never accessed by the user or by the members in the same department"
                },
                {
                    "data_source": [
                        "DS001MAIL-ET03Send"
                    ],
                    "description": "Identifies users who send a higher volume of data via email. This is based on individual users.",
                    "id": "DM48",
                    "internal_id": "High_volume_of_data_sent_over_email",
                    "name": "High volume of data sent over email"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Detects deviation in number of DLP matches across DLP alarms raised by a user. This detection identifies the average number of DLP matches on any given day in the past and verifies if the current day significantly exceeds the prior baseline.",
                    "id": "DM140",
                    "internal_id": "Spike_in_DLP_matches",
                    "name": "Spike in DLP matches"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Detects deviation in number of prints across DLP alarms raised by a user. This detection identifies the average number of prints on any given day in the past and verifies if the current day significantly exceeds the prior baseline.",
                    "id": "DM141",
                    "internal_id": "Spike_in_DLP_prints",
                    "name": "Spike in DLP prints"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Detects deviation in number of DLP alerts for a given user where the user has transferred files. This detection identifies the average number of DLP alarms on any given day in the past and verifies if the current day significantly exceeds the prior baseline. This detection does not cover any HTTP based DLP alerts.",
                    "id": "DM142",
                    "internal_id": "Spike_in_number_of_DLP_alerts_where_file_s_has_been_transferred_out_of_the_organization",
                    "name": "Spike in number of DLP alerts where file_s has been transferred out of the organization"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Performs peer group analysis on DLP data to identify anomalous users. This is used to detect a data transmission attempt that violated DLP policies on a channel that was never been used by the members in the same peer group. Requires external DLP information.",
                    "id": "DM160",
                    "internal_id": "Usage_of_data_transmission_channel_that_was_never_used_by_the_members_in_the_same_department",
                    "name": "Usage of data transmission channel that was never used by the members in the same department"
                },
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies upload/transfer of data to external file sharing sites. This categorization is provided by proxy or NGFW logs.",
                    "id": "DM16",
                    "internal_id": "Data_transfer/upload_to_storage_sites",
                    "name": "Data transfer/upload to storage sites"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at33",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Data_Movement",
            "journey": "Stage_6",
            "long_description": "This anomaly contains multiple detection methods surrounding suspicious data movement (e.g., sending email to self, external DLP alarms, etc.) Check the associated detection methods for a comprehensive list of possible triggers for this anomaly.",
            "mitre_tactic": "|TA0009|TA0010",
            "mitre_technique": "|T1213|T1039|T1041|T1048|TA0010|T1011|TA0009",
            "name": "Suspicious Data Movement",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "at34": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt17",
                "tt18",
                "tt22",
                "tt26",
                "tt28",
                "tt30",
                "tt33"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "description": "Triggered when a user visits a malicious or suspicious site. This classification is determined by NGFW categories.",
            "detections": [
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies users who visit a malicious URI. This categorization comes from proxy or NGFW categorization.",
                    "id": "DM168",
                    "internal_id": "User_visiting_malicious_URI",
                    "name": "User visiting malicious URI"
                },
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies users who visit suspicious URI such as adult/spyware/adware sites. This categorization comes from proxy or NGFW categorization.",
                    "id": "DM169",
                    "internal_id": "Users_visiting_suspicious_URI",
                    "name": "Users visiting suspicious URI"
                },
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies users who visited malicious URI based on the categorization from next gen firewalls that have that classification.",
                    "id": "DM146",
                    "internal_id": "Suspicious_Domain_Communication",
                    "name": "Suspicious Domain Communication"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at34",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Domain_Communication",
            "journey": "Stage_6",
            "long_description": "Triggered when a user visits a malicious or suspicious site. This classification is determined by NGFW categories.",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1071|T1095",
            "name": "Suspicious Domain Communication",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at35": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt01",
                "tt13",
                "tt14",
                "tt15",
                "tt26",
                "tt28",
                "tt30"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|DS002DNS-ET01Query",
            "description": "Triggered when a user visits a suspicious domain name that appears to be algorithmically generated. ",
            "detections": [
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested",
                        "DS002DNS-ET01Query"
                    ],
                    "description": "Detects covert and malicious communication patterns in network traffic.",
                    "id": "DM147",
                    "internal_id": "Suspicious_Domain_Name/Algorithmically_generated_domain",
                    "name": "Suspicious Domain Name/Algorithmically generated domain"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at35",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Domain_Name",
            "journey": "Stage_6",
            "long_description": "Triggered when a user visits a suspicious domain name that appears to be algorithmically generated. ",
            "mitre_sub_technique": "|T1568.002|T1598.003",
            "mitre_tactic": "|TA0043|TA0001|TA0011",
            "mitre_technique": "|T1568|T1598|T1192|T1043|T1071",
            "name": "Suspicious Domain Name",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at36": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Malware",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt11",
                "tt13",
                "tt15",
                "tt17",
                "tt22",
                "tt26",
                "tt28",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "description": "Triggered by detecting sequences in HTTP requests that signify a possible exploit.",
            "detections": [
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Detects sequences of HTTP requests within a short period of time that suggests infection has taken place.",
                    "id": "DM82",
                    "internal_id": "Potential_Exploit_Chain",
                    "name": "Potential Exploit Chain"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at36",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_HTTP_Redirects",
            "journey": "Stage_2",
            "long_description": "Triggered by detecting sequences in HTTP requests that signify a possible exploit.",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1189",
            "name": "Suspicious HTTP Redirects",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at37": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Command and Control",
            "contributes_to_threats": [
                "tt07",
                "tt08",
                "tt14",
                "tt17",
                "tt18",
                "tt25",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
            "description": "This anomaly contains multiple detections that inspect network traffic and look for suspicious activity (e.g., DNS data exfiltration). Check the associated detection methods for a comprehensive list of possible triggers for this anomaly.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies possible DNS exfiltration by inspecting firewall traffic.",
                    "id": "DM23",
                    "internal_id": "DNS_Data_Transfer",
                    "name": "DNS Data Transfer"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Looks at network traffic to determine if DNS is used to transfer data.",
                    "id": "DM151",
                    "internal_id": "TCP_DNS_Data_Transfer",
                    "name": "TCP DNS Data Transfer"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects attempted data exfiltration through NTP by examining firewall traffic.",
                    "id": "DM74",
                    "internal_id": "NTP_Data_Transfer",
                    "name": "NTP Data Transfer"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Determines SCP/SFTP type traffic from internal hosts to an external host.",
                    "id": "DM136",
                    "internal_id": "Secure_Copy_to_External_Host",
                    "name": "Secure Copy to External Host"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Determines SCP/SFTP type traffic from external hosts to an internal host.",
                    "id": "DM135",
                    "internal_id": "Secure_Copy_from_External_Host",
                    "name": "Secure Copy from External Host"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies larger than normal traffic following a traditional DNS request before the server responds.",
                    "id": "DM24",
                    "internal_id": "DNS_Protocol_Anomaly",
                    "name": "DNS Protocol Anomaly"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies larger than normal traffic following a traditional NTP request before the server responds.",
                    "id": "DM75",
                    "internal_id": "NTP_Protocol_Anomaly",
                    "name": "NTP Protocol Anomaly"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects anomalies based on the properties of network connections. Creates an anomaly when network traffic looks like an SSH reverse shell.",
                    "id": "DM144",
                    "internal_id": "SSH_Reverse_Shell",
                    "name": "SSH Reverse Shell"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at37",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Network_Connection",
            "journey": "Stage_3",
            "long_description": "This anomaly contains multiple detections that inspect network traffic and look for suspicious activity (e.g., DNS data exfiltration). Check the associated detection methods for a comprehensive list of possible triggers for this anomaly.",
            "mitre_tactic": "|TA0008|TA0010",
            "mitre_technique": "|T1021|T1105|T1041|T1011|T1048",
            "name": "Suspicious Network Connection",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at38": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt03",
                "tt04",
                "tt10",
                "tt12",
                "tt13",
                "tt15",
                "tt16",
                "tt25",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success",
            "description": "Triggered when a user accesses a number of systems and that number increases systematically over time. This is a lead indicator of a possible lateral movement threat.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Identifies users whose number of devices accessed has systematically increased.",
                    "id": "DM56",
                    "internal_id": "Lateral_Movement__accessing_more_devices",
                    "name": "Lateral Movement _accessing more devices"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at38",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Network_Exploration",
            "journey": "Stage_4",
            "long_description": "Triggered when a user accesses a number of systems and that number increases systematically over time. This is a lead indicator of a possible lateral movement threat.",
            "mitre_tactic": "|TA0001|TA0008",
            "mitre_technique": "|T1078|TA0008|T1021|T1105",
            "name": "Suspicious Network Exploration",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring"
        },
        "at39": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|Lateral Movement|IAM Analytics",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt13",
                "tt15",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "description": "Triggered when a user accesses a box resource for the first time. This anomaly is based on an individual user's baseline. ",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Identifies when a user access a box resource for the first time. This is based on individual user baseline.",
                    "id": "DM77",
                    "internal_id": "Out_of_profile_box_accesses",
                    "name": "Out of profile box accesses"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at39",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_New_Access",
            "journey": "Stage_6",
            "long_description": "Triggered when a user accesses a box resource for the first time. This anomaly is based on an individual user's baseline. ",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1011",
            "name": "Suspicious New Access",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at40": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Endpoint Compromise",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt03",
                "tt04",
                "tt11",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt18",
                "tt22",
                "tt23",
                "tt26",
                "tt28",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec-powershell",
            "description": "Triggered when a possible malicious powershell command is executed. This anomaly contains detection methods that inspect endpoint and Windows event logs looking for suspicious commands (e.g., base64 encoded powershell commands).",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec-powershell"
                    ],
                    "description": "Identifies possible malicious powershell based attacks or commands. This detection method looks at endpoint and Windows event log data.",
                    "id": "DM85",
                    "internal_id": "Potentially_risky_powershell_commands",
                    "name": "Potentially risky powershell commands"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec-powershell"
                    ],
                    "description": "Looks at Windows Security Events and Endpoint data to determine possible suspicious powershell. ",
                    "id": "DM149",
                    "internal_id": "Suspicious_powershell_commands_including_encoded_strings,_entropy_of_commands",
                    "name": "Suspicious powershell commands including encoded strings, entropy of commands"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at40",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Powershell_Activity",
            "journey": "Stage_6",
            "long_description": "Triggered when a possible malicious powershell command is executed. This anomaly contains detection methods that inspect endpoint and Windows event logs looking for suspicious commands (e.g., base64 encoded powershell commands).",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|T1086",
            "name": "Suspicious Powershell Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at41": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Endpoint Compromise",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt10",
                "tt13",
                "tt15",
                "tt16",
                "tt23",
                "tt25",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "description": "Triggered when an account with administrator privledges logs in (event code 4672) and is associated with another user logging in within the same time period.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects suspicious privilege escalation by correlating login and privilege escalation events.",
                    "id": "DM150",
                    "internal_id": "Suspicious_Privilege_Escalation",
                    "name": "Suspicious Privilege Escalation"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at41",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Privilege_Escalation",
            "journey": "Stage_6",
            "long_description": "Triggered when an account with administrator privledges logs in (event code 4672) and is associated with another user logging in within the same time period.",
            "mitre_tactic": "|TA0002|TA0004",
            "mitre_technique": "|T1086|T1078",
            "name": "Suspicious Privilege Escalation",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at42": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt03",
                "tt04",
                "tt08",
                "tt10",
                "tt12",
                "tt14",
                "tt15",
                "tt16",
                "tt17",
                "tt18",
                "tt22",
                "tt25",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success",
            "description": "Triggered when a user has an abnormal login time of day or day of week. This is based on the user's rolling baseline.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Detects unusual day of the week for login attempts based on users behavior profile.",
                    "id": "DM155",
                    "internal_id": "Unusual_login_day_of_the_week",
                    "name": "Unusual login day of the week"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Detects unusual time of day for login attempts based on user behavior profile.",
                    "id": "DM156",
                    "internal_id": "Unusual_login_time_of_the_day",
                    "name": "Unusual login time of the day"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at42",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Activity_Time",
            "journey": "Stage_6",
            "long_description": "Triggered when a user has an abnormal login time of day or day of week. This is based on the user's rolling baseline.",
            "mitre_tactic": "|TA0003|TA0001",
            "mitre_technique": "|T1078",
            "name": "Unusual Activity Time",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at43": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt12",
                "tt15",
                "tt19",
                "tt25",
                "tt27"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "Triggered when a badge attempts to access a badge reader that it has historically not accessed. This is based on location and the badge (or user) baseline history.",
            "detections": [
                {
                    "data_source": [
                        "DS017PhysicalSecurity-ET01Access"
                    ],
                    "description": "Detects rare badge reader access by location.",
                    "id": "DM96",
                    "internal_id": "Rare_badge-in_location_by_a_user",
                    "name": "Rare badge-in location by a user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at43",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Badge_Reader_Access",
            "journey": "Stage_4",
            "long_description": "Triggered when a badge attempts to access a badge reader that it has historically not accessed. This is based on location and the badge (or user) baseline history.",
            "mitre_sub_technique": "T1591.001",
            "mitre_tactic": "|TA0043",
            "mitre_technique": "T1591",
            "name": "Unusual Badge Reader Access",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "at44": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|Ransomware|IAM Analytics",
            "contributes_to_threats": [
                "tt10",
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "description": "Triggered on a large number of deletes from a cloud file storage system. This anomaly looks at the enterprise average for a historical baseline.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Identifies a large number of files/folders deleted in a cloud system. This is an outlier detection based on the enterprise baseline.",
                    "id": "DM40",
                    "internal_id": "High_number_of_deletes_on_a_cloud_repository",
                    "name": "High number of deletes on a cloud repository"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at44",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Cloud_Storage_Deletions",
            "journey": "Stage_4",
            "long_description": "Triggered on a large number of deletes from a cloud file storage system. This anomaly looks at the enterprise average for a historical baseline.",
            "mitre_tactic": "|TA0040",
            "mitre_technique": "|T1485",
            "name": "Unusual Cloud Storage Deletions",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "at45": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise",
            "contributes_to_threats": [
                "tt09",
                "tt21",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "description": "Triggered on a large number of file/directory downloads from a cloud file storage system. This is specifically the number of downloads not the size of the downloads. This anomaly looks at the enterprise afverage for a historical baseline.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Identifies a user who has a large volume of downloads from a cloud system. This is an outlier based on the enterprise baseline.",
                    "id": "DM41",
                    "internal_id": "High_number_of_file_downloads_from_a_cloud_repository",
                    "name": "High number of file downloads from a cloud repository"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at45",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Cloud_Storage_Downloads",
            "journey": "Stage_4",
            "long_description": "Triggered on a large number of file/directory downloads from a cloud file storage system. This is specifically the number of downloads not the size of the downloads. This anomaly looks at the enterprise afverage for a historical baseline.",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1011",
            "name": "Unusual Cloud Storage Downloads",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring|Advanced Threat Detection"
        },
        "at46": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Network Attack",
            "contributes_to_threats": [
                "tt03",
                "tt14",
                "tt17",
                "tt18",
                "tt22",
                "tt30",
                "tt31",
                "tt32",
                "tt33",
                "tt34",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This is a catch all anomaly for any external alarm that is created by a third party system (e.g., IDS, IPS, DLP, NGFW). These anomalies are useful for increasing the users risk profile and add context to threats inside of UBA.",
            "detections": [
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM103",
                    "internal_id": "Rare_externalAction_for_a_given_user",
                    "name": "Rare externalAction for a given user"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM122",
                    "internal_id": "Rare_riskClassification_for_a_given_user",
                    "name": "Rare riskClassification for a given user"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM89",
                    "internal_id": "Rare_alert_from_a_vendor_for_a_given_user",
                    "name": "Rare alert from a vendor for a given user"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM91",
                    "internal_id": "Rare_alert_signature_for_a_given_user",
                    "name": "Rare alert signature for a given user"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM88",
                    "internal_id": "Rare_alarmCategory_for_a_given_user",
                    "name": "Rare alarmCategory for a given user"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM92",
                    "internal_id": "Rare_alert_signature_for_a_peer_group_department",
                    "name": "Rare alert signature for a peer group_department"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation",
                        "DS020HostIntrustionDetection-ET01SigDetected",
                        "DS012NetworkIntrusionDetection-ET01SigDetection",
                        "DS004EndPointAntiMalware-ET01SigDetected"
                    ],
                    "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
                    "id": "DM90",
                    "internal_id": "Rare_alert_from_a_vendor_for_a_peer_group_department",
                    "name": "Rare alert from a vendor for a peer group_department"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at46",
            "includeSSE": "Yes",
            "internal_id": "Unusual_External_Alarm",
            "journey": "Stage_6",
            "long_description": "This is a catch all anomaly for any external alarm that is created by a third party system (e.g., IDS, IPS, DLP, NGFW). These anomalies are useful for increasing the users risk profile and add context to threats inside of UBA.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Unusual External Alarm",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at47": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Malware",
            "contributes_to_threats": [],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "description": "Triggered when a user accesses a new file type or extension. This is based on a user's previous history and/or peer group activity.",
            "detections": [
                {
                    "data_source": [
                        "DS009EndPointIntel-ET01ObjectChange"
                    ],
                    "description": "Identifies users who use a new file type or extension. This usage is based on previous user or peer group baseline.",
                    "id": "DM37",
                    "internal_id": "First_time_accessing_a_file_extension",
                    "name": "First time accessing a file extension"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at47",
            "includeSSE": "Yes",
            "internal_id": "Unusual_File_Extension",
            "journey": "Stage_3",
            "long_description": "Triggered when a user accesses a new file type or extension. This is based on a user's previous history and/or peer group activity.",
            "mitre_tactic": "|TA0040|TA0001",
            "mitre_technique": "|T1486|T1193",
            "name": "Unusual File Extension",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at48": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt05",
                "tt14",
                "tt17",
                "tt18",
                "tt26",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "description": "Triggered when an organziation, user, device, or peer group generates network traffic destined for a rare or unique Country destination. This anomaly requires destinationCountry (or similar) to be populated.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any network events with a Rare Country destination for the organization. This requires destinationCountry to be populated.",
                    "id": "DM65",
                    "internal_id": "Network_communication_going_to_rare_destination_country_across_organization",
                    "name": "Network communication going to rare destination country across organization"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any network events with a Rare Country destination by peer group. This requires destinationCountry to be populated.",
                    "id": "DM66",
                    "internal_id": "Network_communication_going_to_rare_destination_country_for_a_given_peer_group_department",
                    "name": "Network communication going to rare destination country for a given peer group_department"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any network events with a Rare Country destination by device. This requires destinationCountry to be populated.",
                    "id": "DM67",
                    "internal_id": "Network_communication_going_to_rare_destination_country_for_a_given_source_device",
                    "name": "Network communication going to rare destination country for a given source device"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any network events with a Rare Country destination by user. This requires destinationCountry to be populated.",
                    "id": "DM68",
                    "internal_id": "Network_communication_going_to_rare_destination_country_for_a_given_user",
                    "name": "Network communication going to rare destination country for a given user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at48",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Geolocation_of_Communication_Destination",
            "journey": "Stage_4",
            "long_description": "Triggered when an organziation, user, device, or peer group generates network traffic destined for a rare or unique Country destination. This anomaly requires destinationCountry (or similar) to be populated.",
            "mitre_tactic": "|TA0011|TA0010",
            "mitre_technique": "|T1071|T1095|T1094|T1048|T1041",
            "name": "Unusual Geolocation of Communication Destination",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at49": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt03",
                "tt04",
                "tt08",
                "tt10",
                "tt13",
                "tt14",
                "tt15",
                "tt16",
                "tt17",
                "tt18",
                "tt22",
                "tt22",
                "tt25",
                "tt26",
                "tt28",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "description": "This anomaly contains a large number of detections for rare or unusual machine access.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM87",
                    "internal_id": "Rare_account_login_on_a_given_machine",
                    "name": "Rare account login on a given machine"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM115",
                    "internal_id": "Rare_machine_access_by_a_given_account",
                    "name": "Rare machine access by a given account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM108",
                    "internal_id": "Rare_login_failure_return_code_for_a_given_targetAccount",
                    "name": "Rare login failure return code for a given targetAccount"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM109",
                    "internal_id": "Rare_login_failure_return_code_on_a_given_machine",
                    "name": "Rare login failure return code on a given machine"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM106",
                    "internal_id": "Rare_login_domain_for_a_given_user",
                    "name": "Rare login domain for a given user"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM116",
                    "internal_id": "Rare_machine_access_for_a_given_peer_group_department",
                    "name": "Rare machine access for a given peer group_department"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM86",
                    "internal_id": "Rare_account_logging_on_a_given_device_peer_group",
                    "name": "Rare account logging on a given device peer group"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM87",
                    "internal_id": "Rare_account_login_on_a_given_machine",
                    "name": "Rare account login on a given machine"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM115",
                    "internal_id": "Rare_machine_access_by_a_given_account",
                    "name": "Rare machine access by a given account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM111",
                    "internal_id": "Rare_login_type_on_a_given_machine",
                    "name": "Rare login type on a given machine"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM110",
                    "internal_id": "Rare_login_type_for_a_given_account",
                    "name": "Rare login type for a given account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM114",
                    "internal_id": "Rare_logon_process_on_a_given_machine",
                    "name": "Rare logon process on a given machine"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM113",
                    "internal_id": "Rare_logon_process_for_a_given_user",
                    "name": "Rare logon process for a given user"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM119",
                    "internal_id": "Rare_processName_for_a_given_logon_process",
                    "name": "Rare processName for a given logon process"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM107",
                    "internal_id": "Rare_login_failure_return_code_for_a_given_account",
                    "name": "Rare login failure return code for a given account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM109",
                    "internal_id": "Rare_login_failure_return_code_on_a_given_machine",
                    "name": "Rare login failure return code on a given machine"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM105",
                    "internal_id": "Rare_login_domain_for_a_given_account",
                    "name": "Rare login domain for a given account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM112",
                    "internal_id": "Rare_logon_process_for_a_given_combination_of_account_and_machine",
                    "name": "Rare logon process for a given combination of account and machine"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM116",
                    "internal_id": "Rare_machine_access_for_a_given_peer_group_department",
                    "name": "Rare machine access for a given peer group_department"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare device accesses in Microsoft Windows logs.",
                    "id": "DM86",
                    "internal_id": "Rare_account_logging_on_a_given_device_peer_group",
                    "name": "Rare account logging on a given device peer group"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at49",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Machine_Access",
            "journey": "Stage_6",
            "long_description": "This anomaly contains a large number of detections for rare or unusual machine access. It looks at user interaction with devices only and detects rare access to devices. Examples include: failed login on a new device, accessing a device for the first time, successful login on a new devices, etc. ",
            "mitre_tactic": "|TA0001|TA0004",
            "mitre_technique": "|T1078",
            "name": "Unusual Machine Access",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "at50": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt04",
                "tt10",
                "tt16",
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
            "description": "This anomaly contains a large number of detections for rare or unusual network interaction.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM126",
                    "internal_id": "Rare_usage_of_a_port_across_environment",
                    "name": "Rare usage of a port across environment"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM93",
                    "internal_id": "Rare_application_across_environment",
                    "name": "Rare application across environment"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM94",
                    "internal_id": "Rare_application_for_a_given_server_port",
                    "name": "Rare application for a given server port"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01TrafficAppAware"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM117",
                    "internal_id": "Rare_port_for_a_given_application",
                    "name": "Rare port for a given application"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM125",
                    "internal_id": "Rare_sourceZone_in_the_environment",
                    "name": "Rare sourceZone in the environment"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM99",
                    "internal_id": "Rare_destinationZone_in_the_environment",
                    "name": "Rare destinationZone in the environment"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM124",
                    "internal_id": "Rare_sourceZone_for_a_given_destinationZone",
                    "name": "Rare sourceZone for a given destinationZone"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM98",
                    "internal_id": "Rare_destinationZone_for_a_given_sourceZone",
                    "name": "Rare destinationZone for a given sourceZone"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM97",
                    "internal_id": "Rare_destinationZone_for_a_given_source_device",
                    "name": "Rare destinationZone for a given source device"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detects events that have rare combination of port/application in firewall data.",
                    "id": "DM123",
                    "internal_id": "Rare_sourceZone_for_a_given_destination_device",
                    "name": "Rare sourceZone for a given destination device"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at50",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Network_Activity",
            "journey": "Stage_4",
            "long_description": "This anomaly contains a large number of detections for rare or unusual network interaction. It looks at user interactions with the network and detects rare or suspicious traffic. Examples include: rare destinationZone in traffic, rare port in a request, rare port for a given application, etc.",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1024|T1094|T1065",
            "name": "Unusual Network Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring"
        },
        "at51": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Data Exfiltration",
            "contributes_to_threats": [
                "tt09",
                "tt20",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS034ApplicationLogs-ET01General",
            "description": "This anomaly looks at different aspects of print jobs from a peer group or user baseline, as well as looking at the extensions of the files that are printed.",
            "detections": [
                {
                    "data_source": [
                        "DS034ApplicationLogs-ET01General"
                    ],
                    "description": "Identifies potentially confidential data being leaked via printer. These files are considered confidential based on predefined keywords in UBA. This detection method does not require an external DLP system.",
                    "id": "DM84",
                    "internal_id": "Potentially_confidential_documents_printed",
                    "name": "Potentially confidential documents printed"
                },
                {
                    "data_source": [
                        "DS034ApplicationLogs-ET01General"
                    ],
                    "description": "Identifies users who are printing file extensions that have not been printed recently by their peer group.",
                    "id": "DM79",
                    "internal_id": "Peer_group_analysis_on_file_extensions_that_are_printed",
                    "name": "Peer group analysis on file extensions that are printed"
                },
                {
                    "data_source": [
                        "DS034ApplicationLogs-ET01General"
                    ],
                    "description": "Identifies users who have a larger number of print jobs than their peers. ",
                    "id": "DM80",
                    "internal_id": "Peer_group_analysis_on_number_of_print_jobs",
                    "name": "Peer group analysis on number of print jobs"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at51",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Printer_Usage",
            "journey": "Stage_4",
            "long_description": "This anomaly looks at different aspects of print jobs from a peer group or user baseline. Based on user history or peer group history, this anomaly will be triggered when a user prints a larger number of print jobs than their baseline or peer group baseline. It also checks file extensions that the user and peer group have printed. Finally, this anomaly can be triggered by printing of confidential data. This anomaly does not require an external DLP platform.",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1052",
            "name": "Unusual Printer Usage",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "at52": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "contributes_to_threats": [
                "tt12",
                "tt15",
                "tt19",
                "tt25",
                "tt27"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "Triggered by badge access that is outside the normal user's baseline. This can be either failed or successful badge-in attempts outside of the normal baseline.",
            "detections": [
                {
                    "data_source": [
                        "DS017PhysicalSecurity-ET01Access"
                    ],
                    "description": "Detects unusual time of badge access based on user behavior profile.",
                    "id": "DM157",
                    "internal_id": "Unusual_time_of_badge_access",
                    "name": "Unusual time of badge access"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at52",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Time_of_Badge_Access",
            "journey": "Stage_6",
            "long_description": "Triggered by badge access that is outside the normal user's baseline. This can be either failed or successful badge-in attempts outside of the normal baseline.",
            "mitre_sub_technique": "T1591.001",
            "mitre_tactic": "|TA0043",
            "mitre_technique": "T1591",
            "name": "Unusual Time of Badge Access",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "at53": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Unauthorized Software",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt06",
                "tt10",
                "tt11",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt18",
                "tt20",
                "tt26",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "description": "This anomaly contains a number of detection methods surrounding USB usage in the enterprise.",
            "detections": [
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Generates anomalies for unusual transfers to/from USB devices. It also tracks the first time an account uses a USB and the first time a different type (e.g., vendor) of USB is used in the enterprise.",
                    "id": "DM130",
                    "internal_id": "Rare_USB_injection_on_a_device",
                    "name": "Rare USB injection on a device"
                },
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Generates anomalies for unusual transfers to/from USB devices. It also tracks the first time an account uses a USB and the first time a different type (e.g., vendor) of USB is used in the enterprise.",
                    "id": "DM129",
                    "internal_id": "Rare_USB_injection_by_a_user",
                    "name": "Rare USB injection by a user"
                },
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Generates anomalies for unusual transfers to/from USB devices. It also tracks the first time an device uses a USB and the first time a different type (e.g., vendor) of USB is used in the enterprise.",
                    "id": "DM128",
                    "internal_id": "Rare_USB_device_by_deviceid",
                    "name": "Rare USB device_by deviceid"
                },
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Identifies a user who performs a write to USB of a large number of business files. This is an outlier detection based on the individual user baseline. The detection also ignores images, videos, etc.",
                    "id": "DM42",
                    "internal_id": "High_number_of_file_writes_to_USB",
                    "name": "High number of file writes to USB"
                },
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Detects outliers in user behavior baseline of allowed data transfer (bytes) to external USB devices.",
                    "id": "DM153",
                    "internal_id": "Unusual_high_amount_of_data_transferred_to_USB",
                    "name": "Unusual high amount of data transferred to USB"
                },
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Detects outliers in user behavior baseline of number of blocked USB connect attempts.",
                    "id": "DM154",
                    "internal_id": "Unusual_high_number_of_USB_denials",
                    "name": "Unusual high number of USB denials"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at53",
            "includeSSE": "Yes",
            "internal_id": "Unusual_USB_Activity",
            "journey": "Stage_4",
            "long_description": "This anomaly contains a number of detection methods surrounding USB usage in the enterprise. Examples include: first time a USB device is plugged in by a user or device, number of file copies by a user based on baseline, etc. Please see the associated detection methods for a comprehensive list of the events that trigger this anomaly.",
            "mitre_tactic": "|TA0010|TA0001",
            "mitre_technique": "|T1052|T1091|T1200",
            "name": "Unusual USB Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "at54": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Data Exfiltration|Malware",
            "contributes_to_threats": [
                "tt09",
                "tt20",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "description": "Triggered when a user uses a USB device (plugging into a computer) for the first time. This anomaly is based on the user's historical information.",
            "detections": [
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Identifies users who use an USB device that they haven't used in the recent past.",
                    "id": "DM162",
                    "internal_id": "USB_device_that_was_never_plugged_in_Rare_USB_plugged_in",
                    "name": "USB device that was never plugged in_Rare USB plugged in"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at54",
            "includeSSE": "Yes",
            "internal_id": "Unusual_USB_Device_Plugged_In",
            "journey": "Stage_3",
            "long_description": "Triggered when a user uses a USB device (plugging into a computer) for the first time. This anomaly is based on the user's historical information.",
            "mitre_tactic": "|TA0008|TA0010",
            "mitre_technique": "|T1091|T1052",
            "name": "Unusual USB Device Plugged In",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "at55": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Account Sharing",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt04",
                "tt07",
                "tt11",
                "tt12",
                "tt14",
                "tt15",
                "tt17",
                "tt18",
                "tt22",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "description": "Triggered when traffic is destined from a rare sourceCountry for an organziation, user, device, or peer group. This anomaly requires sourceCountry (or similar) to be populated.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any VPN traffic with a Rare Country source for the organization. This requires sourceCountry to be populated.",
                    "id": "DM69",
                    "internal_id": "Network_communication_originating_from_a_rare_country_across_organization",
                    "name": "Network communication originating from a rare country across organization"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any VPN traffic with a Rare Country source for the user. This requires sourceCountry to be populated.",
                    "id": "DM72",
                    "internal_id": "Network_communication_originating_from_a_rare_country_for_a_given_user",
                    "name": "Network communication originating from a rare country for a given user"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any VPN traffic with a Rare Country source for the device. This requires sourceCountry to be populated.",
                    "id": "DM71",
                    "internal_id": "Network_communication_originating_from_a_rare_country_for_a_given_source_device",
                    "name": "Network communication originating from a rare country for a given source device"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies any VPN traffic with a Rare Country source for the peer group. This requires sourceCountry to be populated.",
                    "id": "DM70",
                    "internal_id": "Network_communication_originating_from_a_rare_country_for_a_given_peer_group_department",
                    "name": "Network communication originating from a rare country for a given peer group_department"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at55",
            "includeSSE": "Yes",
            "internal_id": "Unusual_VPN_Login_Geolocation",
            "journey": "Stage_4",
            "long_description": "Triggered when traffic is destined from a rare sourceCountry for an organziation, user, device, or peer group. This anomaly requires sourceCountry (or similar) to be populated.",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1078",
            "name": "Unusual VPN Login Geolocation",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at56": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Unauthorized Software",
            "contributes_to_threats": [],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "description": "Triggered when either a user or device exhibits a rare browser user agent string (e.g., iexplorer.exe instead of iexplore.exe).",
            "detections": [
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Detects rare events for user agent string, device, and username in outbound HTTP data.",
                    "id": "DM131",
                    "internal_id": "Rare_userAgentString",
                    "name": "Rare userAgentString"
                },
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Detects rare events for user agent string, device, and username in outbound HTTP data.",
                    "id": "DM132",
                    "internal_id": "Rare_userAgentString_for_a_given_sourceDevice",
                    "name": "Rare userAgentString for a given sourceDevice"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at56",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Web_Browser",
            "journey": "Stage_4",
            "long_description": "Triggered when either a user or device exhibits a rare browser user agent string (e.g., iexplorer.exe instead of iexplore.exe).",
            "mitre_tactic": "|TA0011|TA0010",
            "mitre_technique": "|T1071|T1041|T1043",
            "name": "Unusual Web Browser",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "at57": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Malware|Lateral Movement|Endpoint Compromise",
            "contributes_to_threats": [
                "tt10",
                "tt16",
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "description": "This is a catch all anomaly for unusal Windows Security Events. This can contain things like: rare process, rare resource, or even a rare process name for a given process. This anomaly is based on user baseline and enterprise baseline.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM127",
                    "internal_id": "Rare_usage_of_a_process_across_organization",
                    "name": "Rare usage of a process across organization"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM101",
                    "internal_id": "Rare_event_execution_on_windows_across_organization",
                    "name": "Rare event execution on windows across organization"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM118",
                    "internal_id": "Rare_process_path_for_a_given_process_name/Process_executing_from_a_rare_location_across_organization",
                    "name": "Rare process path for a given process name/Process executing from a rare location across organization"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM104",
                    "internal_id": "Rare_failure_return_code_for_a_given_eventname/eventid_across_organization",
                    "name": "Rare failure return code for a given eventname/eventid across organization"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM102",
                    "internal_id": "Rare_event_for_a_given_account",
                    "name": "Rare event for a given account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM121",
                    "internal_id": "Rare_resource_type_for_given_process_name",
                    "name": "Rare resource type for given process name"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM120",
                    "internal_id": "Rare_resource_type_for_a_given_account",
                    "name": "Rare resource type for a given account"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare events in Microsoft Windows logs.",
                    "id": "DM100",
                    "internal_id": "Rare_event_execution_for_a_given_peer_group_department",
                    "name": "Rare event execution for a given peer group_department"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Detects rare access to entities based on peer group behavior.",
                    "id": "DM01",
                    "internal_id": "Access_to_a_resource_type_which_is_rare_for_a_given_peer_group",
                    "name": "Access to a resource type which is rare for a given peer group"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "at57",
            "includeSSE": "Yes",
            "internal_id": "Unusual_Windows_Security_Event_(Unusual_-_Event_Code,_Process,_Directory,_LoginType,_ReturnCode,_Domain)",
            "journey": "Stage_4",
            "long_description": "This is a catch all anomaly for unusal Windows Security Events. This can contain things like: rare process, rare resource, or even a rare process name for a given process. This anomaly is based on user baseline and enterprise baseline.",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|TA0002",
            "name": "Unusual Windows Security Event (Unusual - Event Code, Process, Directory, LoginType, ReturnCode, Domain)",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at58": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt02",
                "tt11",
                "tt12",
                "tt15",
                "tt26"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET03UserAware",
            "description": "Triggered when a VPN session extends past the normal time period. This time period is determined by both the user's individual baseline as well as the enterprise average.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Detects unusually long VPN sessions based on the user's behavioral baseline as well as the baseline of the overall enterprise.",
                    "id": "DM159",
                    "internal_id": "Unusually_long_VPN_session",
                    "name": "Unusually long VPN session"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at58",
            "includeSSE": "Yes",
            "internal_id": "Unusually_Long_VPN_Session",
            "journey": "Stage_4",
            "long_description": "Triggered when a VPN session extends past the normal time period. This time period is determined by both the user's individual baseline as well as the enterprise average.",
            "mitre_tactic": "|TA0010|TA0003",
            "mitre_technique": "|T1048|T1108",
            "name": "Unusually Long VPN Session",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at59": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Data Exfiltration",
            "contributes_to_threats": [
                "tt09",
                "tt20",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "description": "Triggered when the number of physical USB attach and detach actions exceed the idividual's historical baseline.",
            "detections": [
                {
                    "data_source": [
                        "DS009EndPointIntel-ET05ObjectChangeRemovableStorage"
                    ],
                    "description": "Identifies a larger than normal number of USB plugins. This is an outlier detection based on a user's individual baseline.",
                    "id": "DM43",
                    "internal_id": "High_number_of_USB_plugins",
                    "name": "High number of USB plugins"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at59",
            "includeSSE": "Yes",
            "internal_id": "USB_storage_attached_an_unusually_high_number_of_times",
            "journey": "Stage_3",
            "long_description": "Triggered when the number of physical USB attach and detach actions exceed the idividual's historical baseline.",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1052",
            "name": "USB storage attached an unusually high number of times",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "at60": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Account Compromise|Adversary Tactics",
            "contributes_to_threats": [
                "tt05",
                "tt09",
                "tt21",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET03UserAware",
            "description": "Triggered when an excessive amount of data is uploaded or stored onto an internal server or cloud storage system. This anomaly is often a pre-cursor to a flight risk threat or data exfiltration threat. ",
            "detections": [
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies upload/transfer of data to external file sharing sites. This categorization is provided by proxy or NGFW logs.",
                    "id": "DM16",
                    "internal_id": "Data_transfer/upload_to_storage_sites",
                    "name": "Data transfer/upload to storage sites"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Detects outliers in the outgoing bytes transmission by each user.",
                    "id": "DM29",
                    "internal_id": "Excessive_amount_of_data_transmission_by_user",
                    "name": "Excessive amount of data transmission by user"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at60",
            "includeSSE": "Yes",
            "internal_id": "Data_Staging",
            "journey": "Stage_6",
            "long_description": "Triggered when an excessive amount of data is uploaded or stored onto an internal server or cloud storage system. This anomaly is often a pre-cursor to a flight risk threat or data exfiltration threat. ",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1011|T1048",
            "name": "Data Staging",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at61": {
            "alertvolume": "High",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|IAM Analytics",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt03",
                "tt04",
                "tt08",
                "tt12",
                "tt13",
                "tt15",
                "tt25",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET02Failure|DS003Authentication-ET01Success",
            "description": "Triggered when the number of failed logins by a user is higher than the enterprise average. This anomaly could point to a number of things, including a brute force attack, password spraying, or just general suspicious behavior.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET02Failure"
                    ],
                    "description": "Outlier detection of login failures per user.",
                    "id": "DM50",
                    "internal_id": "High_volume_of_login_failures_for_a_given_user",
                    "name": "High volume of login failures for a given user"
                },
                {
                    "data_source": [
                        "VendorSpecific-winsec",
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Identifies users who have an increasing number of devices accessed over time.",
                    "id": "DM10",
                    "internal_id": "Brute_Force_Attack__Login_failures_for_multiple_accounts",
                    "name": "Brute Force Attack _Login failures for multiple accounts"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at61",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Login_Errors",
            "journey": "Stage_6",
            "long_description": "Triggered when the number of failed logins by a user is higher than the enterprise average. This anomaly could point to a number of things, including a brute force attack, password spraying, or just general suspicious behavior.",
            "mitre_tactic": "|TA0001|TA0004|TA0003|TA0006",
            "mitre_technique": "|T1078|T1110",
            "name": "Multiple Login Errors",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Security Monitoring"
        },
        "at62": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt09",
                "tt21",
                "tt26",
                "tt28",
                "tt29"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "description": "Triggered when a user has a higher than normal number of downloads from a Box data source",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Identifies a user who has a large volume of downloads from a cloud system. This is an outlier based on the enterprise baseline.",
                    "id": "DM41",
                    "internal_id": "High_number_of_file_downloads_from_a_cloud_repository",
                    "name": "High number of file downloads from a cloud repository"
                },
                {
                    "data_source": [
                        "VendorSpecific-Box"
                    ],
                    "description": "Looks for a specific set of Box commands that indicates data collection.",
                    "id": "DM12",
                    "internal_id": "Data_collection_from_box",
                    "name": "Data collection from box"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at62",
            "includeSSE": "Yes",
            "internal_id": "Excessive_Box_Downloads",
            "journey": "Stage_3",
            "long_description": "Triggered when a user has a higher than normal number of downloads from a Box data source. Actual size of downloads do not matter for this anomaly. The normal number of downloads is determined by both the user's historical baseline as well as the enterprise average.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Excessive Box Downloads",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at63": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt01",
                "tt12",
                "tt13",
                "tt14",
                "tt15",
                "tt17",
                "tt22",
                "tt26",
                "tt28",
                "tt30",
                "tt32",
                "tt33",
                "tt34"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic",
            "description": "Triggered when a user visits a malicious or suspicious site by IP directly.",
            "detections": [
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies users who visit a malicious URI. This categorization comes from proxy or NGFW categorization.",
                    "id": "DM168",
                    "internal_id": "User_visiting_malicious_URI",
                    "name": "User visiting malicious URI"
                },
                {
                    "data_source": [
                        "DS005WebProxyRequest-ET01Requested"
                    ],
                    "description": "Identifies users who visit suspicious URI such as adult/spyware/adware sites. This categorization comes from proxy or NGFW categorization.",
                    "id": "DM169",
                    "internal_id": "Users_visiting_suspicious_URI",
                    "name": "Users visiting suspicious URI"
                },
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Identifies users who visited malicious URI based on the categorization from next gen firewalls that have that classification.",
                    "id": "DM171",
                    "internal_id": "Suspicious_IP_Address_Communication",
                    "name": "Suspicious IP Address Communication"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at63",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_IP_Address_Communication",
            "journey": "Stage_6",
            "long_description": "Triggered when a user visits a malicious or suspicious site. This classification is determined by NGFW categories. This anomaly is similar to the Suspicious Domain Communication but is only applicable to IP address traffic (when no domain name is provided).",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1071|T1095",
            "name": "Suspicious IP Address Communication",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "at64": {
            "alertvolume": "Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Data Exfiltration",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt06",
                "tt10",
                "tt11",
                "tt12",
                "tt13",
                "tt15",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation",
            "description": "This is a subset of the Unusual Printer Usage anomaly that looks only at number of print jobs, increased number of print jobs, or volume of data printed. It's based on individual user baseline as well as the enterprise average.",
            "detections": [
                {
                    "data_source": [
                        "DS034ApplicationLogs-ET01General"
                    ],
                    "description": "Identifies users who have a larger number of print jobs than their peers. ",
                    "id": "DM80",
                    "internal_id": "Peer_group_analysis_on_number_of_print_jobs",
                    "name": "Peer group analysis on number of print jobs"
                },
                {
                    "data_source": [
                        "DS016DataLossPrevention-ET01Violation"
                    ],
                    "description": "Detects deviation in number of prints across DLP alarms raised by a user. This detection identifies the average number of prints on any given day in the past and verifies if the current day significantly exceeds the prior baseline.",
                    "id": "DM141",
                    "internal_id": "Spike_in_DLP_prints",
                    "name": "Spike in DLP prints"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at64",
            "includeSSE": "Yes",
            "internal_id": "Excessive_Data_Printed",
            "journey": "Stage_3",
            "long_description": "This is a subset of the Unusual Printer Usage anomaly that looks only at number of print jobs, increased number of print jobs, or volume of data printed. It's based on individual user baseline as well as the enterprise average.",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1052",
            "name": "Excessive Data Printed",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "at65": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Data Exfiltration|Account Compromise",
            "contributes_to_threats": [
                "tt01",
                "tt02",
                "tt06",
                "tt10",
                "tt11",
                "tt12",
                "tt13",
                "tt15",
                "tt26",
                "tt28"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET03UserAware",
            "description": "This is a subset of the Excessive Data Transmission anomaly that looks only at volume of downloaded data while on VPN.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET03UserAware"
                    ],
                    "description": "Detects outliers in the traffic volume over VPN per user.",
                    "id": "DM30",
                    "internal_id": "Excessive_data_downloaded_to_workstation_while_on_VPN",
                    "name": "Excessive data downloaded to workstation while on VPN"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at65",
            "includeSSE": "Yes",
            "internal_id": "Excessive_Downloads_via_VPN",
            "journey": "Stage_3",
            "long_description": "This is a subset of the Excessive Data Transmission anomaly that looks only at volume of downloaded data while on VPN. This is a separate anomnaly due to the fact that most critical assets often require VPN to access them, therefore creating a higher risk to the organization if there is a large amount of data downloaded.",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1011",
            "name": "Excessive Downloads via VPN",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at66": {
            "alertvolume": "",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Data Exfiltration",
            "contributes_to_threats": [
                "tt10",
                "tt16",
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "description": "Triggered when the number of outgoing connections is greater than the user's historical baseline or the enterprise average.",
            "detections": [
                {
                    "data_source": [
                        "DS010NetworkCommunication-ET01Traffic"
                    ],
                    "description": "Detections outlers in the number of average outgoing connections. Based on previous user baseline, peer group, and enterprise.",
                    "id": "DM172",
                    "internal_id": "High_Number_of_Outgoing_Connections",
                    "name": "High Number of Outgoing Connections"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at66",
            "includeSSE": "Yes",
            "internal_id": "Multiple_Outgoing_Connections",
            "journey": "Stage_4",
            "long_description": "Triggered when the number of outgoing connections is greater than the user's historical baseline or the enterprise average.",
            "mitre_tactic": "|TA0010|TA0011",
            "mitre_technique": "|T1041|T1048|T1094|T1095|T1032|T1104",
            "name": "Multiple Outgoing Connections",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "at67": {
            "alertvolume": "Very Low",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|Best Practices",
            "contributes_to_threats": [
                "tt10",
                "tt16",
                "tt25"
            ],
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success",
            "description": "Triggered when a service account either logs in via VPN or interactively on a device. Does not trigger for normal service account activity.",
            "detections": [
                {
                    "data_source": [
                        "VendorSpecific-winsec"
                    ],
                    "description": "Identifies successful/unsuccessful interactive logins by service accounts. Service accounts are identified during HR data ingestion into UBA.",
                    "id": "DM54",
                    "internal_id": "Interactive_logins_by_service_accounts",
                    "name": "Interactive logins by service accounts"
                },
                {
                    "data_source": [
                        "DS003Authentication-ET01Success"
                    ],
                    "description": "Identifies VPN traffic by a service account. Service accounts are identified in HR data ingest in UBA.",
                    "id": "DM170",
                    "internal_id": "VPN_login_using_service_account",
                    "name": "VPN login using service account"
                }
            ],
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "at67",
            "includeSSE": "Yes",
            "internal_id": "Service_Account_Login",
            "journey": "Stage_4",
            "long_description": "Triggered when a service account either logs in via VPN or interactively on a device. Does not trigger for normal service account activity.",
            "mitre_tactic": "|TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Service Account Login",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "attempt_to_add_certificate_to_untrusted_store": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Disabling Security Tools",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=attempt_to_add_certificate_to_untrusted_store",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1553.004/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-03",
            "description": "Attempt to add a certificate to the certificate store",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "attempt_to_add_certificate_to_untrusted_store",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "known_false_positives": "There may be legitimate reasons for administrators to add a certificate to the untrusted certificate store. In such cases, this will typically be done on a large number of systems.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "attempt_to_add_certificate_to_untrusted_store_filter"
                }
            ],
            "mitre_sub_technique": "T1553.004",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1553",
            "mitre_threat_groups": "no",
            "name": "Attempt To Add Certificate To Untrusted Store",
            "references": [],
            "released": "2020-11-03",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=*certutil* (Processes.process=*-addstore*) by Processes.parent_process Processes.process_name Processes.user | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `attempt_to_add_certificate_to_untrusted_store_filter`",
            "search_name": "ESCU - Attempt To Add Certificate To Untrusted Store - Rule",
            "story": "fcc27099-46a0-46b0-a271-5c7dab56b6f1",
            "tags": {
                "analytics_story": [
                    "Disabling Security Tools"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1553.004/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1553"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Install Root Certificate"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 6
        },
        "attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Malicious PowerShell|Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Registry",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_execution_policy/windows-sysmon.log"
            ],
            "date": "2020-11-06",
            "description": "Monitor for changes of the ExecutionPolicy in the registry to the values \"unrestricted\" or \"bypass,\" which allows the execution of malicious scripts.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Registry node. You must also be ingesting logs with the fields registry_path, registry_key_name, and registry_value_name from your endpoints.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Registry node. You must also be ingesting logs with the fields registry_path, registry_key_name, and registry_value_name from your endpoints.",
            "icon": "ES_Use_Case.png",
            "id": "attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "known_false_positives": "Administrators may attempt to change the default execution policy on a system for a variety of reasons. However, setting the policy to \"unrestricted\" or \"bypass\" as this search is designed to identify, would be unusual. Hits should be reviewed and investigated as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass_filter"
                }
            ],
            "mitre_sub_technique": "T1059.001",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1059",
            "mitre_threat_groups": "Blue Mockingbird|APT39|DarkVishnya|Molerats|Wizard Spider|Frankenstein|Inception|Silence|APT41|Kimsuky|Soft Cell|TA505|WIRTE|TEMP.Veles|APT33|Gallmaker|Turla|APT19|DarkHydrus|APT28|Thrip|Gorgon Group|Cobalt Group|Dragonfly 2.0|Leviathan|TA459|FIN8|MuddyWater|Magic Hound|OilRig|BRONZE BUTLER|CopyKittens|APT32|FIN7|FIN10|Threat Group-3390|menuPass|Patchwork|Stealth Falcon|FIN6|Poseidon Group|APT3|APT29|Deep Panda",
            "name": "Attempt To Set Default Powershell Execution Policy To Unrestricted Or Bypass",
            "references": [],
            "released": "2020-11-06",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Registry where Registry.registry_path=*Software\\\\Microsoft\\\\Powershell\\\\1\\\\ShellIds\\\\Microsoft.PowerShell* Registry.registry_key_name=ExecutionPolicy (Registry.registry_value_name=Unrestricted OR Registry.registry_value_name=Bypass) by Registry.registry_path Registry.registry_key_name Registry.registry_value_name Registry.dest | `drop_dm_object_name(Registry)` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | `attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass_filter`",
            "search_name": "ESCU - Attempt To Set Default PowerShell Execution Policy To Unrestricted or Bypass - Rule",
            "story": "2c8ff66e-0b57-42af-8ad7-912438a403fc|854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Malicious PowerShell",
                    "Credential Dumping"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_execution_policy/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "DarkVishnya",
                    "Molerats",
                    "Wizard Spider",
                    "Frankenstein",
                    "Inception",
                    "Silence",
                    "APT41",
                    "Kimsuky",
                    "Soft Cell",
                    "TA505",
                    "WIRTE",
                    "TEMP.Veles",
                    "APT33",
                    "Gallmaker",
                    "Turla",
                    "APT19",
                    "DarkHydrus",
                    "APT28",
                    "Thrip",
                    "Gorgon Group",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "Leviathan",
                    "TA459",
                    "FIN8",
                    "MuddyWater",
                    "Magic Hound",
                    "OilRig",
                    "BRONZE BUTLER",
                    "CopyKittens",
                    "APT32",
                    "FIN7",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Patchwork",
                    "Stealth Falcon",
                    "FIN6",
                    "Poseidon Group",
                    "APT3",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "PowerShell"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 6
        },
        "attempt_to_stop_security_service": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Disabling Security Tools",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=attempt_to_stop_security_service",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for attempts to stop security-related services on the endpoint.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data. The search is shipped with a lookup file, `security_services.csv`, that can be edited to update the list of services to monitor. This lookup file can be edited directly where it lives in `$SPLUNK_HOME/etc/apps/DA-ESS-ContentUpdate/lookups`, or via the Splunk console. You should add the names of services an attacker might use on the command line and surround with asterisks (*****), so that they work properly when searching the command line. The file should be updated with the names of any services you would like to monitor for attempts to stop the service.,",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data. The search is shipped with a lookup file, `security_services.csv`, that can be edited to update the list of services to monitor. This lookup file can be edited directly where it lives in `$SPLUNK_HOME/etc/apps/DA-ESS-ContentUpdate/lookups`, or via the Splunk console. You should add the names of services an attacker might use on the command line and surround with asterisks (*****), so that they work properly when searching the command line. The file should be updated with the names of any services you would like to monitor for attempts to stop the service.,",
            "icon": "ES_Use_Case.png",
            "id": "attempt_to_stop_security_service",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "known_false_positives": "None identified. Attempts to disable security-related services should be identified and understood.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "attempt_to_stop_security_service_filter"
                }
            ],
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1562",
            "mitre_threat_groups": "Gamaredon Group|BRONZE BUTLER|Rocke|Kimsuky|Turla|Night Dragon|Gorgon Group|Lazarus Group|Putter Panda",
            "name": "Attempt To Stop Security Service",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name = net.exe OR  Processes.process_name = sc.exe) Processes.process=\"* stop *\" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` |lookup security_services_lookup service as process OUTPUTNEW category, description | search category=security | `attempt_to_stop_security_service_filter`",
            "search_name": "ESCU - Attempt To Stop Security Service - Rule",
            "story": "fcc27099-46a0-46b0-a271-5c7dab56b6f1",
            "tags": {
                "analytics_story": [
                    "Disabling Security Tools"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "BRONZE BUTLER",
                    "Rocke",
                    "Kimsuky",
                    "Turla",
                    "Night Dragon",
                    "Gorgon Group",
                    "Lazarus Group",
                    "Putter Panda"
                ],
                "mitre_attack_id": [
                    "T1562"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Disable or Modify Tools"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "attempted_credential_dump_from_registry_via_reg_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=attempted_credential_dump_from_registry_via_reg_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.002/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-02",
            "description": "Monitor for execution of reg.exe with parameters specifying an export of keys that contain hashed credentials that attackers may try to crack offline.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "attempted_credential_dump_from_registry_via_reg_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "None identified.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "attempted_credential_dump_from_registry_via_reg_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1003.002",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Threat Group-3390|Ke3chang|Soft Cell|Night Dragon|Dragonfly 2.0|menuPass",
            "name": "Attempted Credential Dump From Registry Via Reg Exe",
            "references": [],
            "released": "2019-12-02",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=reg.exe OR Processes.process_name=cmd.exe) Processes.process=*save* (Processes.process=*HKEY_LOCAL_MACHINE\\\\Security* OR Processes.process=*HKEY_LOCAL_MACHINE\\\\SAM* OR Processes.process=*HKEY_LOCAL_MACHINE\\\\System* OR Processes.process=*HKLM\\\\Security* OR Processes.process=*HKLM\\\\System* OR Processes.process=*HKLM\\\\SAM*) by Processes.user Processes.process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `attempted_credential_dump_from_registry_via_reg_exe_filter`",
            "search_name": "ESCU - Attempted Credential Dump From Registry via Reg exe - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.002/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Threat Group-3390",
                    "Ke3chang",
                    "Soft Cell",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "menuPass"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "Security Account Manager"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "aws_apis_called_more_often_than_usual_per_account": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|SaaS|Cloud Security",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=AWS APIs Called More Often Than Usual Per Account - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Builds a per-user baseline for how many API calls is normal, and then alerts for deviations.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS APIs Called More Often Than Usual Per Account - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS APIs Called More Often Than Usual Per Account - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP APIs Called More Often Than Usual Per Account - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure APIs Called More Often Than Usual Per Account - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect Spikes search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, GCP and Azure Audit, as detailed in How to Implement.",
            "highlight": "No",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
            "mitre": "Execution",
            "mitre_notes": "",
            "mitre_tactic": "TA0007",
            "mitre_technique": "T1526|T1580",
            "name": "Cloud APIs Called More Often Than Usual Per User",
            "operationalize": "When this alert fires, you should look at what APIs were called. We've excluded some of the basic inaction ones (such as DescribeInstances), but the severity of the event will vary based on the severity of the API calls. The natural next step is to call a user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_apis_more_often_per_user.png",
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of an existing cloud account, where it all of a sudden begins taking new actions that it hasn't before. This could mean that the credentials for that account have been compromised, and are in control of an adversary, potentially resulting in data leakage, data deletion, or cost run-up.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection"
        },
        "aws_cloud_provisioning_activity_from_unusual_country": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|Account Sharing|SaaS|Insider Threat|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=AWS Cloud Provisioning Activity from Unusual Country - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for IaaS Provisioning activities that occur from new IPs, using GeoIP to resolve the Country.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS Cloud Provisioning Activity from Unusual Country - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS Cloud Provisioning Activity from Unusual Country - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP Cloud Provisioning Activity from Unusual Country - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure Cloud Provisioning Activity from Unusual Country - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, GCP, or Azure, as detailed in How to Implement.",
            "highlight": "Yes",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data. If your organization pays for the more accurate version of MaxMind's GeoIP Database (usually only common with organizations that have a strong footprint in small countries), consider adding that into Splunk to provide more accurate country resolution.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>This use case will fire any time a new Country is seen in the GeoIP database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of MaxMind GeoIP that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.</p>",
            "mitre": "Credential Access",
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Cloud Provisioning Activity from Unusual Country",
            "operationalize": "For organizations that have strict allowed countries for cloud orchestration, you may opt to use Splunk's Adaptive Response Actions to automatically disable an account that is doing provisioning from a new country. More commonly, the concern is account compromise so it is prudent to immediately call the user and find out if they intended to take those actions.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_provisioning_unusual_country.png",
            "relatedUseCases": [
                "AWS_Instance_Created_by_Unusual_User",
                "AWS_New_API_Call_Per_User",
                "AWS_Unusual_Amount_of_Modifications_to_ACLs"
            ],
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of an IaaS environment, where all of a sudden provisioning occurs in countries that have not been seen before (a very rudimentary baseline detection). Assuming that the user is not traveling, and that new orchestration tools are not being used (and admittedly, that the GeoIP is not wrong), this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "aws_cloud_provisioning_activity_from_unusual_ip": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|Account Sharing|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=AWS Cloud Provisioning Activity from Unusual IP - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for Cloud Provisioning activities that occur from new IPs (for organizations with strict IP controls).",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS Cloud Provisioning Activity from Unusual IP - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS Cloud Provisioning Activity from Unusual IP - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP Cloud Provisioning Activity from Unusual IP - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure Cloud Provisioning Activity from Unusual IP - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, Azure and GCP Audit, as detailed in How to Implement.",
            "highlight": "No",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>For most organizations, this search is not going to be useful apart from contextual data (i.e., when we are analyzing another alert related to account compromise, we can also see that this user logged in from an unusual IP). The reason is that most organizations don't apply strict controls to what IPs are allowed to reach out to their Cloud orchestration environments. However, if your organization does have strict controls, and all of a sudden a new IP shows up, that could be very noteworthy. </p>",
            "mitre": "",
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "|TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Cloud Provisioning Activity from Unusual IP",
            "operationalize": "For organizations that have strict allowed IPs for cloud orchestration, you may opt to use Splunk's Adaptive Response Actions to automatically disable an account that is doing provisioning from a new IP. More commonly, the concern is account compromise so it is prudent to immediately call the user and find out if they intended to take those actions.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_provisioning_unusual_ip.png",
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of a cloud environment, where all of a sudden provisioning occurs from IP Addresses that have not been seen before (only applicable for organizations that have strict policies around IP Addresses for access). Assuming that the user is not traveling, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection"
        },
        "aws_cloud_provisioning_from_previously_unseen_city": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Suspicious Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-16",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "ac88e6a0-4fba-4dfd-b7b9-8964df7d1aee",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_provisioning_activity_sources_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Provisioning Activity Sources",
                    "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Suspicious Provisioning Activities"
                        ],
                        "detections": [
                            "AWS Cloud Provisioning From Previously Unseen IP Address",
                            "AWS Cloud Provisioning From Previously Unseen City",
                            "AWS Cloud Provisioning From Previously Unseen Country",
                            "AWS Cloud Provisioning From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=aws_cloud_provisioning_from_previously_unseen_city",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-03-16",
            "description": "This search looks for AWS provisioning activities from previously unseen cities.  Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\" ",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "icon": "ES_Use_Case.png",
            "id": "aws_cloud_provisioning_from_previously_unseen_city",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching within, plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new city is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your city, there should be few false positives. If you are located in countries where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_cloud_provisioning_from_previously_unseen_city_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "AWS Cloud Provisioning From Previously Unseen City",
            "references": [],
            "released": "2018-03-16",
            "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search City=* [search `cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search City=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by City | eval newCity=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newCity=1 | table City] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, City, eventName, errorCode | `aws_cloud_provisioning_from_previously_unseen_city_filter`",
            "search_name": "ESCU - AWS Cloud Provisioning From Previously Unseen City - Rule",
            "story": "3338b567-3804-4261-9889-cf0ca4753c7f",
            "tags": {
                "analytics_story": [
                    "AWS Suspicious Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 25,
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "aws_cloud_provisioning_from_previously_unseen_country": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Suspicious Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-16",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "ac88e6a0-4fba-4dfd-b7b9-8964df7d1aee",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_provisioning_activity_sources_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Provisioning Activity Sources",
                    "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Suspicious Provisioning Activities"
                        ],
                        "detections": [
                            "AWS Cloud Provisioning From Previously Unseen IP Address",
                            "AWS Cloud Provisioning From Previously Unseen City",
                            "AWS Cloud Provisioning From Previously Unseen Country",
                            "AWS Cloud Provisioning From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=aws_cloud_provisioning_from_previously_unseen_country",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-03-16",
            "description": "This search looks for AWS provisioning activities from previously unseen countries. Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\" ",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "icon": "ES_Use_Case.png",
            "id": "aws_cloud_provisioning_from_previously_unseen_country",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new country is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_cloud_provisioning_from_previously_unseen_country_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "AWS Cloud Provisioning From Previously Unseen Country",
            "references": [],
            "released": "2018-03-16",
            "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Country=* [search `cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Country=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by Country | eval newCountry=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newCountry=1 | table Country] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, Country, eventName, errorCode | `aws_cloud_provisioning_from_previously_unseen_country_filter`",
            "search_name": "ESCU - AWS Cloud Provisioning From Previously Unseen Country - Rule",
            "story": "3338b567-3804-4261-9889-cf0ca4753c7f",
            "tags": {
                "analytics_story": [
                    "AWS Suspicious Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "ID.AM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "aws_cloud_provisioning_from_previously_unseen_ip_address": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Suspicious Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-16",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "ac88e6a0-4fba-4dfd-b7b9-8964df7d1aee",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_provisioning_activity_sources_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Provisioning Activity Sources",
                    "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Suspicious Provisioning Activities"
                        ],
                        "detections": [
                            "AWS Cloud Provisioning From Previously Unseen IP Address",
                            "AWS Cloud Provisioning From Previously Unseen City",
                            "AWS Cloud Provisioning From Previously Unseen Country",
                            "AWS Cloud Provisioning From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=aws_cloud_provisioning_from_previously_unseen_ip_address",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-03-16",
            "description": "This search looks for AWS provisioning activities from previously unseen IP addresses. Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\" ",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "icon": "ES_Use_Case.png",
            "id": "aws_cloud_provisioning_from_previously_unseen_ip_address",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching within, plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new IP address is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_cloud_provisioning_from_previously_unseen_ip_address_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "AWS Cloud Provisioning From Previously Unseen IP Address",
            "references": [],
            "released": "2018-03-16",
            "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) [search `cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Country=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress | eval newIP=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newIP=1 | table sourceIPAddress] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, eventName, errorCode | `aws_cloud_provisioning_from_previously_unseen_ip_address_filter`",
            "search_name": "ESCU - AWS Cloud Provisioning From Previously Unseen IP Address - Rule",
            "security_domain": "endpoint",
            "story": "3338b567-3804-4261-9889-cf0ca4753c7f",
            "tags": {
                "analytics_story": [
                    "AWS Suspicious Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "aws_cloud_provisioning_from_previously_unseen_region": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Suspicious Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-16",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "ac88e6a0-4fba-4dfd-b7b9-8964df7d1aee",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_provisioning_activity_sources_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Provisioning Activity Sources",
                    "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Suspicious Provisioning Activities"
                        ],
                        "detections": [
                            "AWS Cloud Provisioning From Previously Unseen IP Address",
                            "AWS Cloud Provisioning From Previously Unseen City",
                            "AWS Cloud Provisioning From Previously Unseen Country",
                            "AWS Cloud Provisioning From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=aws_cloud_provisioning_from_previously_unseen_region",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-03-16",
            "description": "This search looks for AWS provisioning activities from previously unseen regions. Region in this context is similar to a state in the United States. Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\"",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen AWS Provisioning Activity Sources\" support search once to create a history of previously seen locations that have provisioned AWS resources.",
            "icon": "ES_Use_Case.png",
            "id": "aws_cloud_provisioning_from_previously_unseen_region",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching within, plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new region is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your region, there should be few false positives. If you are located in regions where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_cloud_provisioning_from_previously_unseen_region_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "AWS Cloud Provisioning From Previously Unseen Region",
            "references": [],
            "released": "2018-03-16",
            "search": "`cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Region=* [search `cloudtrail` (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Region=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by Region | eval newRegion=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newRegion=1 | table Region] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, Region, eventName, errorCode | `aws_cloud_provisioning_from_previously_unseen_region_filter`",
            "search_name": "ESCU - AWS Cloud Provisioning From Previously Unseen Region - Rule",
            "story": "3338b567-3804-4261-9889-cf0ca4753c7f",
            "tags": {
                "analytics_story": [
                    "AWS Suspicious Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "ID.AM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "aws_cross_account_activity_from_previously_unseen_account": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Authentication Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-06-04",
                    "description": "This search looks for **AssumeRole** events where the requesting account differs from the requested account, then writes these relationships to a lookup file.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Validate the user name entries in `previously_seen_aws_cross_account_activity.csv`, a lookup file created by this support search.",
                    "id": "1cc22b09-c867-416e-a511-cb36ac44aee2",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/previously_seen_aws_cross_account_activity.csv",
                            "description": "A placeholder for a list of AWS accounts and assumed roles",
                            "filename": "previously_seen_aws_cross_account_activity.csv",
                            "name": "previously_seen_aws_cross_account_activity"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_cross_account_activity_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Cross Account Activity",
                    "search": "`cloudtrail` eventName=AssumeRole | spath output=requestingAccountId path=userIdentity.accountId | spath output=requestedAccountId path=resources{}.accountId | search requestingAccountId=* | where requestingAccountId!=requestedAccountId | stats earliest(_time) as firstTime latest(_time) as lastTime by requestingAccountId, requestedAccountId | outputlookup previously_seen_aws_cross_account_activity | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Cross Account Activity"
                        ],
                        "detections": [
                            "AWS Cross Account Activity From Previously Unseen Account"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-15",
                    "description": "This search looks for **AssumeRole** events where the requesting account differs from the requested account, then writes these relationships to a lookup file.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later)and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_aws_cross_account_activity.csv`, a lookup file created by this support search.",
                    "id": "82af2ed9-8f4b-4785-a152-ba61e6a23bbf",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/previously_seen_aws_cross_account_activity.csv",
                            "description": "A placeholder for a list of AWS accounts and assumed roles",
                            "filename": "previously_seen_aws_cross_account_activity.csv",
                            "name": "previously_seen_aws_cross_account_activity"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_cross_account_activity___initial_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Cross Account Activity - Initial",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=AssumeRole by Authentication.vendor_account Authentication.user Authentication.src Authentication.user_role |  `drop_dm_object_name(Authentication)` | rex field=user_role \"arn:aws:sts:*:(?<dest_account>.*):\" |  where  vendor_account != dest_account | rename vendor_account as requestingAccountId dest_account as requestedAccountId | table requestingAccountId requestedAccountId firstTime lastTime | outputlookup previously_seen_aws_cross_account_activity",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "AWS Cross Account Activity From Previously Unseen Account"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-15",
                    "description": "This search looks for **AssumeRole** events where the requesting account differs from the requested account, then writes these relationships to a lookup file.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_aws_cross_account_activity.csv`, a lookup file created by this support search.",
                    "id": "dd6fb3a9-4906-48cb-8626-c88a25a056c3",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/previously_seen_aws_cross_account_activity.csv",
                            "description": "A placeholder for a list of AWS accounts and assumed roles",
                            "filename": "previously_seen_aws_cross_account_activity.csv",
                            "name": "previously_seen_aws_cross_account_activity"
                        },
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/previously_seen_aws_cross_account_activity.csv",
                            "description": "A placeholder for a list of AWS accounts and assumed roles",
                            "filename": "previously_seen_aws_cross_account_activity.csv",
                            "name": "previously_seen_aws_cross_account_activity"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_cross_account_activity___update_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Cross Account Activity - Update",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=AssumeRole by Authentication.vendor_account Authentication.user Authentication.src Authentication.user_role | `drop_dm_object_name(Authentication)` | rex field=user_role \"arn:aws:sts:*:(?<dest_account>.*):\" | where vendor_account != dest_account | rename vendor_account as requestingAccountId dest_account as requestedAccountId | inputlookup append=t previously_seen_aws_cross_account_activity | stats min(firstTime) as firstTime max(lastTime) as lastTime by requestingAccountId requestedAccountId | outputlookup previously_seen_aws_cross_account_activity",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "AWS Cross Account Activity From Previously Unseen Account"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=aws_cross_account_activity_from_previously_unseen_account",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "Authentication",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-05-28",
            "description": "This search looks for AssumeRole events where an IAM role in a different account is requested for the first time.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "PR.AC|PR.DS|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen AWS Cross Account Activity - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen AWS Cross Account Activity - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `aws_cross_account_activity_from_previously_unseen_account_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen AWS Cross Account Activity - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen AWS Cross Account Activity - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `aws_cross_account_activity_from_previously_unseen_account_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "aws_cross_account_activity_from_previously_unseen_account",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Using multiple AWS accounts and roles is perfectly valid behavior. It's suspicious when an account requests privileges of an account it hasn't before. You should validate with the account owner that this is a legitimate request.",
            "lookups": [
                {
                    "description": "A placeholder for a list of AWS accounts and assumed roles",
                    "filename": "previously_seen_aws_cross_account_activity.csv",
                    "name": "previously_seen_aws_cross_account_activity"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_cross_account_activity_from_previously_unseen_account_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "AWS Cross Account Activity From Previously Unseen Account",
            "references": [],
            "released": "2020-05-28",
            "search": "| tstats min(_time) as firstTime max(_time) as lastTime from datamodel=Authentication where Authentication.signature=AssumeRole by Authentication.vendor_account Authentication.user Authentication.src Authentication.user_role | `drop_dm_object_name(Authentication)` | rex field=user_role \"arn:aws:sts:*:(?<dest_account>.*):\" | where vendor_account != dest_account | rename vendor_account as requestingAccountId dest_account as requestedAccountId | lookup previously_seen_aws_cross_account_activity requestingAccountId, requestedAccountId, OUTPUTNEW firstTime | eval status = if(firstTime > relative_time(now(), \"-24h@h\"),\"New Cross Account Activity\",\"Previously Seen\") |  where status = \"New Cross Account Activity\" | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `aws_cross_account_activity_from_previously_unseen_account_filter`",
            "search_name": "ESCU - AWS Cross Account Activity From Previously Unseen Account - Rule",
            "security_domain": "network",
            "story": "6380ebbb-55c5-4fce-b754-01fd565fb73c",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Authentication Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.AC",
                    "PR.DS",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 15,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "aws_detect_attach_to_role_policy": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_detect_attach_to_role_policy",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-27",
            "description": "This search provides detection of an user attaching itself to a different role trust policy. This can be used for lateral movement and escalation of privileges.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add-on and Splunk App for AWS. This search works with cloudwatch logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add-on and Splunk App for AWS. This search works with cloudwatch logs",
            "icon": "ES_Use_Case.png",
            "id": "aws_detect_attach_to_role_policy",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Attach to policy can create a lot of noise. This search can be adjusted to provide specific values to identify cases of abuse (i.e status=failure). The search can provide context for common users attaching themselves to higher privilege policies or even newly created policies.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_detect_attach_to_role_policy_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "AWS Detect Attach To Role Policy",
            "references": [],
            "released": "2020-07-27",
            "search": "`aws_cloudwatchlogs_eks` attach policy| spath requestParameters.policyArn | table sourceIPAddress user_access_key userIdentity.arn userIdentity.sessionContext.sessionIssuer.arn eventName errorCode errorMessage status action requestParameters.policyArn userIdentity.sessionContext.attributes.mfaAuthenticated userIdentity.sessionContext.attributes.creationDate  | `aws_detect_attach_to_role_policy_filter`",
            "search_name": "ESCU - aws detect attach to role policy - Rule",
            "story": "2f2f610a-d64d-48c2-b57c-967a2b49ab5a",
            "tags": {
                "analytics_story": [
                    "AWS Cross Account Activity"
                ],
                "asset_type": "AWS Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_detect_permanent_key_creation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_detect_permanent_key_creation",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-27",
            "description": "This search provides detection of accounts creating permanent keys. Permanent keys are not created by default and they are only needed for programmatic calls. Creation of Permanent key is an important event to monitor.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs",
            "icon": "ES_Use_Case.png",
            "id": "aws_detect_permanent_key_creation",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all permanent key creations are malicious. If there is a policy of rotating keys this search can be adjusted to provide better context.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_detect_permanent_key_creation_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "AWS Detect Permanent Key Creation",
            "references": [],
            "released": "2020-07-27",
            "search": "`aws_cloudwatchlogs_eks` CreateAccessKey | spath eventName | search eventName=CreateAccessKey \"userIdentity.type\"=IAMUser | table sourceIPAddress userName userIdentity.type userAgent action status responseElements.accessKey.createDate responseElements.accessKey.status responseElements.accessKey.accessKeyId |`aws_detect_permanent_key_creation_filter`",
            "search_name": "ESCU - aws detect permanent key creation - Rule",
            "story": "2f2f610a-d64d-48c2-b57c-967a2b49ab5a",
            "tags": {
                "analytics_story": [
                    "AWS Cross Account Activity"
                ],
                "asset_type": "AWS Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_detect_role_creation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_detect_role_creation",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-27",
            "description": "This search provides detection of role creation by IAM users. Role creation is an event by itself if user is creating a new role with trust policies different than the available in AWS and it can be used for lateral movement and escalation of privileges.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add-on and Splunk App for AWS. This search works with cloudwatch logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add-on and Splunk App for AWS. This search works with cloudwatch logs",
            "icon": "ES_Use_Case.png",
            "id": "aws_detect_role_creation",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "CreateRole is not very common in common users. This search can be adjusted to provide specific values to identify cases of abuse. In general AWS provides plenty of trust policies that fit most use cases.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_detect_role_creation_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "AWS Detect Role Creation",
            "references": [],
            "released": "2020-07-27",
            "search": "`aws_cloudwatchlogs_eks` event_name=CreateRole action=created userIdentity.type=AssumedRole requestParameters.description=Allows* | table sourceIPAddress userIdentity.principalId userIdentity.arn action event_name awsRegion http_user_agent mfa_auth msg requestParameters.roleName requestParameters.description responseElements.role.arn responseElements.role.createDate | `aws_detect_role_creation_filter`",
            "search_name": "ESCU - aws detect role creation - Rule",
            "story": "2f2f610a-d64d-48c2-b57c-967a2b49ab5a",
            "tags": {
                "analytics_story": [
                    "AWS Cross Account Activity"
                ],
                "asset_type": "AWS Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_detect_sts_assume_role_abuse": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_detect_sts_assume_role_abuse",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-27",
            "description": "This search provides detection of suspicious use of sts:AssumeRole. These tokens can be created on the go and used by attackers to move laterally and escalate privileges.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudtrail logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudtrail logs",
            "icon": "ES_Use_Case.png",
            "id": "aws_detect_sts_assume_role_abuse",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sts:AssumeRole can be very noisy as it is a standard mechanism to provide cross account and cross resources access. This search can be adjusted to provide specific values to identify cases of abuse.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_detect_sts_assume_role_abuse_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "AWS Detect Sts Assume Role Abuse",
            "references": [],
            "released": "2020-07-27",
            "search": "`cloudtrail` user_type=AssumedRole userIdentity.sessionContext.sessionIssuer.type=Role | table sourceIPAddress userIdentity.arn user_agent user_access_key status action requestParameters.roleName responseElements.role.roleName responseElements.role.createDate | `aws_detect_sts_assume_role_abuse_filter`",
            "search_name": "ESCU - aws detect sts assume role abuse - Rule",
            "story": "2f2f610a-d64d-48c2-b57c-967a2b49ab5a",
            "tags": {
                "analytics_story": [
                    "AWS Cross Account Activity"
                ],
                "asset_type": "AWS Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_detect_sts_get_session_token_abuse": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_detect_sts_get_session_token_abuse",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-27",
            "description": "This search provides detection of suspicious use of sts:GetSessionToken. These tokens can be created on the go and used by attackers to move laterally and escalate privileges.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add-on and Splunk App for AWS. This search works with cloudwatch logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add-on and Splunk App for AWS. This search works with cloudwatch logs",
            "icon": "ES_Use_Case.png",
            "id": "aws_detect_sts_get_session_token_abuse",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sts:GetSessionToken can be very noisy as in certain environments numerous calls of this type can be executed. This search can be adjusted to provide specific values to identify cases of abuse. In specific environments the use of field requestParameters.serialNumber will need to be used.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_detect_sts_get_session_token_abuse_filter"
                }
            ],
            "mitre_sub_technique": "T1550",
            "mitre_tactic": "TA0005|TA0008",
            "mitre_tactic_display": "Defense Evasion|Lateral Movement",
            "mitre_technique": "T1550",
            "mitre_threat_groups": "no",
            "name": "AWS Detect Sts Get Session Token Abuse",
            "references": [],
            "released": "2020-07-27",
            "search": "`aws_cloudwatchlogs_eks` ASIA  userIdentity.type=IAMUser| spath eventName | search eventName=GetSessionToken | table sourceIPAddress eventTime userIdentity.arn userName userAgent user_type status region | `aws_detect_sts_get_session_token_abuse_filter`",
            "search_name": "ESCU - aws detect sts get session token abuse - Rule",
            "story": "2f2f610a-d64d-48c2-b57c-967a2b49ab5a",
            "tags": {
                "analytics_story": [
                    "AWS Cross Account Activity"
                ],
                "asset_type": "AWS Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1550"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "Use Alternate Authentication Material"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_detect_users_creating_keys_with_encrypt_policy_without_mfa": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ransomware Cloud",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_detect_users_creating_keys_with_encrypt_policy_without_mfa",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-27",
            "description": "This search provides detection of accounts creating KMS with encrypt policy and without using MFA.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudtrail logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudtrail logs",
            "icon": "ES_Use_Case.png",
            "id": "aws_detect_users_creating_keys_with_encrypt_policy_without_mfa",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all KMS key creations are malicious. Particulary look for kms:Encrypt only policy. It is very unusual to create a key to encrypt only and not to decrypt.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_detect_users_creating_keys_with_encrypt_policy_without_mfa_filter"
                }
            ],
            "mitre_sub_technique": "T1486",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1486",
            "mitre_threat_groups": "APT41|TA505|APT38",
            "name": "AWS Detect Users Creating Keys With Encrypt Policy Without Mfa",
            "references": [
                "https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/",
                "https://github.com/d1vious/git-wild-hunt",
                "https://www.youtube.com/watch?v=PgzNib37g0M"
            ],
            "released": "2020-10-27",
            "search": "`cloudtrail` eventName=CreateKey userIdentity.sessionContext.attributes.mfaAuthenticated=false (requestParameters.policy = \"*kms:Encrypt*\" AND requestParameters.policy != \"*kms:Decrypt*\") eventSource=\"kms.amazonaws.com\" | table userIdentity.sessionContext.attributes.creationDate userIdentity.sessionContext.attributes.mfaAuthenticated user user_access_key requestParameters.keyUsage responseElements.keyMetadata.arn |`aws_detect_users_creating_keys_with_encrypt_policy_without_mfa_filter`",
            "search_name": "ESCU - AWS Detect Users creating keys with encrypt policy without MFA - Rule",
            "story": "f52f6c43-05f8-4b19-a9d3-5b8c56da91c2",
            "tags": {
                "analytics_story": [
                    "Ransomware Cloud"
                ],
                "asset_type": "AWS Account",
                "mitre_attack_groups": [
                    "APT41",
                    "TA505",
                    "APT38"
                ],
                "mitre_attack_id": [
                    "T1486"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Data Encrypted for Impact"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_detect_users_with_kms_keys_performing_encryption_s3": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ransomware Cloud",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "S3 Bucket",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_detect_users_with_kms_keys_performing_encryption_s3",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-27",
            "description": "This search provides detection of users with KMS keys performing encryption specifically against S3 buckets.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudtrail logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudtrail logs",
            "icon": "ES_Use_Case.png",
            "id": "aws_detect_users_with_kms_keys_performing_encryption_s3",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all operations with KMS keys are malicious.  It is very unusual to create a key to encrypt only and not to decrypt. This search compliments the creation of KMS keys with encrypt policy.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_detect_users_with_kms_keys_performing_encryption_s3_filter"
                }
            ],
            "mitre_sub_technique": "T1486",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1486",
            "mitre_threat_groups": "APT41|TA505|APT38",
            "name": "AWS Detect Users With Kms Keys Performing Encryption S3",
            "references": [
                "https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/",
                "https://github.com/d1vious/git-wild-hunt",
                "https://www.youtube.com/watch?v=PgzNib37g0M"
            ],
            "released": "2020-10-27",
            "search": "`cloudtrail` eventName = CopyObject requestParameters.x-amz-server-side-encryption = \"aws:kms\" | stats count min(_time) as firstTime max(_time) as lastTime values(bucket_name) values(object_path) by eventName http_user_agent user vendor_region requestParameters.x-amz-server-side-encryption-aws-kms-key-id | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`|`aws_detect_users_with_kms_keys_performing_encryption_s3_filter`",
            "search_name": "ESCU - AWS Detect Users with KMS keys performing encryption S3 - Rule",
            "story": "f52f6c43-05f8-4b19-a9d3-5b8c56da91c2",
            "tags": {
                "analytics_story": [
                    "Ransomware Cloud"
                ],
                "asset_type": "S3 Bucket",
                "mitre_attack_groups": [
                    "APT41",
                    "TA505",
                    "APT38"
                ],
                "mitre_attack_id": [
                    "T1486"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Data Encrypted for Impact"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_eks_kubernetes_cluster_sensitive_object_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=aws_eks_kubernetes_cluster_sensitive_object_access",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-06-23",
            "description": "This search provides information on Kubernetes accounts accessing sensitve objects such as configmaps or secrets",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install Splunk Add-on for Amazon Web Services and Splunk App for AWS. This search works with cloudwatch logs.",
            "highlight": "No",
            "how_to_implement": "You must install Splunk Add-on for Amazon Web Services and Splunk App for AWS. This search works with cloudwatch logs.",
            "icon": "ES_Use_Case.png",
            "id": "aws_eks_kubernetes_cluster_sensitive_object_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sensitive object access is not necessarily malicious but user and object context can provide guidance for detection.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_eks_kubernetes_cluster_sensitive_object_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "AWS EKS Kubernetes Cluster Sensitive Object Access",
            "references": [],
            "released": "2020-06-23",
            "search": "`aws_cloudwatchlogs_eks` objectRef.resource=secrets OR configmaps sourceIPs{}!=::1 sourceIPs{}!=127.0.0.1  |table sourceIPs{} user.username user.groups{} objectRef.resource objectRef.namespace objectRef.name annotations.authorization.k8s.io/reason |dedup user.username user.groups{} |`aws_eks_kubernetes_cluster_sensitive_object_access_filter`",
            "search_name": "ESCU - AWS EKS Kubernetes cluster sensitive object access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "AWS EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "aws_instance_created_by_unusual_user": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=AWS Instance Created by Unusual User - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects the first time a user creates a new instance.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS Instance Created by Unusual User - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS Instance Created by Unusual User - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP Instance Created by Unusual User - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure Instance Created by Unusual User - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, GCP, or Azure, as detailed in How to Implement.",
            "highlight": "Yes",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>For this use case, you probably don't care every time a new user starts creating instances in a large environment, but you may care when they change resources in sensitive environments. Smaller organizations with a limited number of admins would likely care the minute that a new account is created. For all organizations, having this data around for context or to aggregate risk is extremely useful!",
            "mitre": "Credential Access",
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Instance Created by Unusual User",
            "operationalize": "When this alert fires, call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ec2_instance_isolation",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_instance_created_unusual_user.png",
            "relatedUseCases": [
                "AWS_Cloud_Provisioning_Activity_from_Unusual_Country",
                "AWS_New_API_Call_Per_User",
                "AWS_Unusual_Amount_of_Modifications_to_ACLs"
            ],
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of an IaaS environment, where all of a sudden instance creation occurs from a user that isn't known to provision accounts. Assuming that the user has not changed roles, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential cost run-up or other activities.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection"
        },
        "aws_instance_modified_by_unusual_user": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=AWS Instance Modified by Unusual User - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects the first time a user modifies an existing instance.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS Instance Modified by Unusual User - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS Instance Modified by Unusual User - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP Instance Modified by Unusual User - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure Instance Modified by Unusual User - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, GCP and Azure audit, as detailed in How to Implement.",
            "highlight": "No",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>For this use case, you probably don't care every time a new user starts modifying instances in a large environment, but you may care when they change resources in sensitive VPCs. Smaller organizations with a limited number of admins would likely care the minute that a new account is created. For all organizations, having this data around for context or to aggregate risk is extremely useful!</p>",
            "mitre": "",
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "|TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Instance Modified by Unusual User",
            "operationalize": "When this alert fires, call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ec2_instance_isolation",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_modified_unusual_user.png",
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of an IaaS environment, where all of a sudden instance modification occurs by a user that isn't known to modify instances. Assuming that the user has not changed roles, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
            "searchKeywords": "cloudtrail",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection"
        },
        "aws_network_access_control_list_created_with_all_open_ports": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Network ACL Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=aws_network_access_control_list_created_with_all_open_ports",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2017-01-10",
            "description": "The search looks for CloudTrail events to detect if any network ACLs were created with all the ports open to a specified CIDR.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 11",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS, version 4.4.0 or later, and configure your CloudTrail inputs.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS, version 4.4.0 or later, and configure your CloudTrail inputs.",
            "icon": "ES_Use_Case.png",
            "id": "aws_network_access_control_list_created_with_all_open_ports",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It's possible that an admin has created this ACL with all ports open for some legitimate purpose however, this should be scoped and not allowed in production environment.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_network_access_control_list_created_with_all_open_ports_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "AWS Network Access Control List Created With All Open Ports",
            "references": [],
            "released": "2017-01-10",
            "search": "`cloudtrail` eventName=CreateNetworkAclEntry | mvexpand requestParameters | mvexpand responseElements | search requestParameters.portRange.from=1024 requestParameters.portRange.to=65535 requestParameters.ruleAction=allow | rename userIdentity.arn as arn | rename requestParameters.networkAclId as networkAclId | table _time aws_account_id src userName arn networkAclId requestParameters.* responseElements.* | `aws_network_access_control_list_created_with_all_open_ports_filter`",
            "search_name": "ESCU - AWS Network Access Control List Created with All Open Ports - Rule",
            "security_domain": "network",
            "story": "2e8948a5-5239-406b-b56b-6c50ff268af4",
            "tags": {
                "analytics_story": [
                    "AWS Network ACL Activity"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "userName",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "aws_network_access_control_list_deleted": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Network ACL Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=aws_network_access_control_list_deleted",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2017-01-10",
            "description": "Enforcing network-access controls is one of the defensive mechanisms used by cloud administrators to restrict access to a cloud instance. After the attacker has gained control of the AWS console by compromising an admin account, they can delete a network ACL and gain access to the instance from anywhere. This search will query the CloudTrail logs to detect users deleting network ACLs.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 11",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs.",
            "icon": "ES_Use_Case.png",
            "id": "aws_network_access_control_list_deleted",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It's possible that a user has legitimately deleted a network ACL.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "aws_network_access_control_list_deleted_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "AWS Network Access Control List Deleted",
            "references": [],
            "released": "2017-01-10",
            "search": "`cloudtrail` eventName=DeleteNetworkAcl|rename userIdentity.arn as arn  | stats count min(_time) as firstTime max(_time) as lastTime values(errorMessage) values(errorCode) values(userAgent) values(userIdentity.*) by src userName arn eventName | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `aws_network_access_control_list_deleted_filter`",
            "search_name": "ESCU - AWS Network Access Control List Deleted - Rule",
            "security_domain": "network",
            "story": "2e8948a5-5239-406b-b56b-6c50ff268af4",
            "tags": {
                "analytics_story": [
                    "AWS Network ACL Activity"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "userName",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "aws_new_api_call_per_peer_group": {
            "SPLEase": "Advanced",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|Insider Threat|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=AWS New API Call Per Peer Group - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for users that are using APIs that neither they, nor their team has ever used before.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS New API Call Per Peer Group - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS New API Call Per Peer Group - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP New API Call Per Peer Group - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure New API Call Per Peer Group - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, GCP and Azure Audit, as detailed in How to Implement.",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple, though the peer group makes things slightly more complicated.<ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this base search should work automatically for you without issue.</li><li>Save the search.</li></ul></p><p>To configure the Peer Group:<ol><li>Start with a data source that gives you visibility into the peer group -- easiest is usually querying Active Directory via the <a href=\"https://splunkbase.splunk.com/app/1151/\">SA-ldapsearch add-on</a>, but you could get lists of users and their teams / departments / etc from any source you have.</li><li>Next you will need to convert that log source into a format that this lookup is expecting, which is as follows:<table class=\"table\" style=\"width: 300px\"><tr><td>user</td><td>peergroup (order not important)</td></tr><tr><td>john</td><td>john|sarah</td></tr><tr><td>sarah</td><td>john|sarah</td></tr><tr><td>mark</td><td>mark</td></tr></table>The easiest way to do this is with a search like <span class=\"spl\">| inputlookup LDAPSearch.csv | stats values(user) as user by department | eval peergroup=mvjoin(user, \"|\") | mvexpand user</span></li></ol></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache drop-down below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise (even though the peer groups help manage noise).</p><p>Specifically for Cloud Platforms, they have many APIs (and create new ones regularly!), so it's generally best to tune over time for which APIs you actually want to be emailed about, leave the rest for context, or to aggregate risk.</p>",
            "mitre": "Credential Access",
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "New Cloud API Call Per Peer Group",
            "operationalize": "When this alert fires, you should look at what APIs were called. We've excluded some of the basic inaction ones (such as DescribeInstances), but the severity of the event will vary based on the severity of the API calls. The natural next step is to call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_new_api_peer_group.png",
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of an cloud environment, where all of a sudden an account starts accessing APIs that they haven't normally before (such as creating keys, creating AMIs, changing ACLs, etc.). Because this also looks on a peer level, it won't flag for new users or users who have moved teams (provided the peer list is up to date). This firing could suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "aws_new_api_call_per_user": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|Insider Threat|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=AWS New API Call Per User - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for users that are using IaaS APIs that they've never used before.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS New API Call Per User - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS New API Call Per User - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP New API Call Per User - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure New API Call Per User - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, GCP and Azure Audit, as detailed in How to Implement.",
            "highlight": "Yes",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>Specifically for IaaS, these vendors have many APIs (and create new ones regularly!), so it's generally best to tune over time for which APIs you actually want to be emailed about. Leave the rest for context, or to aggregate risk.</p>",
            "mitre": "Execution|Credential Access|Collection|Exfiltration",
            "mitre_tactic": "TA0002|TA0006|TA0009|TA0010|TA0007",
            "mitre_technique": "T1580|T1526",
            "name": "New IaaS API Call Per User",
            "operationalize": "When this alert fires, you should look at what APIs were called. We've excluded some of the basic inaction ones (such as DescribeInstances), but the severity of the event will vary based on the severity of the API calls. The natural next step is to call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_api_per_user.png",
            "relatedUseCases": [
                "AWS_Cloud_Provisioning_Activity_from_Unusual_Country",
                "AWS_Instance_Created_by_Unusual_User",
                "AWS_Unusual_Amount_of_Modifications_to_ACLs"
            ],
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of an IaaS environment, where all of a sudden an account starts accessing APIs that they haven't normally before (such as creating keys, creating AMIs, changing ACLs, etc.). Assuming that the user has not changed roles, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "aws_public_bucket": {
            "SPLEase": "Medium",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|SaaS|Cloud Security",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=AWS Public Bucket - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects when new or existing public storage (e.g., an S3 Bucket) is set to public.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS Public Bucket - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS Public Bucket - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP Public Storage - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure Public Blob - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search Assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, where someone creates a public storage. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, GCP and Azure Audit, as detailed in How to Implement.",
            "highlight": "Yes",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "knownFP": "There are two types of undesired alerts that can occur from this search. One is when someone intentionally creates a public storage -- you may wish to whitelist marketing employees that do this on a regular basis, or create a policy for how to create a public storage, so that you can exclude it. The other is when someone creates a bucket that is public momentarily, but then they switch it back to private (discussed more in How To Respond).",
            "mitre": "",
            "mitre_notes": "Cyber hygiene to prevent data exposure",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Public Cloud Storage (Bucket)",
            "operationalize": "When this alert fires, there are three questions that should be asked -- is it still public, are the files public, and what is in it. The first is easy to detect -- just search your logs for the bucket name to see any subsequent ACL changes. The second and third are trickier, and require that server access logging is turned on for the bucket (not done by default, and pretty inconvenient, so don't bet on it). ",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/public_s3_bucket_in_aws.png",
            "released": "2.1.0",
            "relevance": "Open Cloud Storage (such as an S3 Buckets or Azure blob) are an extremely common way for breaches to occur these days. People host files for quick transfer but forget to take them down, or use storage for backups of sensitive data but inadvertently mess up permissions. Newly created storage should be monitored and data quickly pulled. If you have a corporate cloud environment, you should prioritize analyzing any open storage. You may even wish to automate the remediation of them through AWS functions (<a target=\"_blank\" href=\"https://aws.amazon.com/blogs/security/how-to-detect-and-automatically-remediate-unintended-permissions-in-amazon-s3-object-acls-with-cloudwatch-events/\">link</a>) or Splunk Phantom.",
            "searchKeywords": "cloudtrail aws azure google gcp bucket blob ",
            "split_multiple_examples": true,
            "usecase": "Security Monitoring|Advanced Threat Detection"
        },
        "aws_unusual_amount_of_modifications_to_acls": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|IAM Analytics|Data Exfiltration|Network Attack|SaaS|Cloud Security",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=AWS Unusual Amount of Modifications to ACLs - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for a large number of Security Group ACL changes in a short period of time for a user.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "AWS Unusual Amount of Modifications to ACLs - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS Unusual Amount of Modifications to ACLs - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP Unusual Amount of Modifications to ACLs - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure Unusual Amount of Modifications to ACLs - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect Spikes search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, GCP and Azure Audit, as detailed in How to Implement.",
            "highlight": "Yes",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts. If your orchestration tools will perform these actions, and they aren't a part of the baseline (or they're very rare in the baseline), those could create false positives. You might opt to whitelist those tools, or alternatively to make a part of the response verifying in your change management whether those tools were scheduled.</p>",
            "mitre": "Persistence|Credential Access",
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Unusual Number of Modifications to Cloud ACLs",
            "operationalize": "When this alert fires, you should call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred. In particular, look to see what the ACL changes were, to see what new access has been allowed. Check your VPC Flow logs to see if data was sent over those newly allowed connections.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_acl_modification.png",
            "relatedUseCases": [
                "AWS_Cloud_Provisioning_Activity_from_Unusual_Country",
                "AWS_Instance_Created_by_Unusual_User",
                "AWS_New_API_Call_Per_User"
            ],
            "released": "2.0.0",
            "relevance": "The risk that this detection intends to reduce is the compromise of an IaaS environment, where all of a sudden Security Group (Firewall) ACLs that have existed to protect an environment are thrown open, allowing either outside connections in, allowing data exfiltration, or allowing lateral movement from one group to another.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "split_multiple_examples": true,
            "usecase": "Advanced Threat Detection"
        },
        "badge_reader_swipe_while_vpnd_in": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|Account Sharing",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Badge Reader and VPN - Demo",
            "deprecated_not_used_anymore_datasource": "VPN|Physical Security",
            "description": "<p>Detect user accounts who are logging in remotely while their assigned badge is physically in the office, indicating account sharing or account compromise.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Badge Reader and VPN - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Badge Reader and VPN - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Badge Reader and VPN - Accelerated"
                }
            ],
            "hasSearch": "No",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of VPN and Badge Reader Logs. For this analysis, we are looking for times when a user VPNs in, doing a GeoIP to determine the source location. We then pull the recorded location of the badge reader swipe, and do a distance check to see how far apart those locations are.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>This search is relatively tricky to implement primarily because of the difficulty of ingesting badge reader logs (not to mention getting the correct locations of those badge readers). If you're pulling badge reader logs into Splunk, most organizations will end up with a CSV/excel file with the physical location for each badge reader, though some badge reader systems will blessedly track that in their logs. Once you have this file, you can configure the lookup in Splunk so that you will know the latitude and longitude for each badge swipe.</p><p>Once you have that data in place, the rest is typically easy. Most Splunk customers already have their VPN logs ingested and compliant with the common information model, which grants us the src_ip field. The iplocation search command will do the GeoIP and then we just have to calculate the distance. There are a few options for calculating distance, but for most purposes using the slightly less accurate calculation that we show here is generally sufficient.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "",
            "knownFP": "<p>There are two big buckets for false positives. One is where the geoip is unreliable -- particularly outside of major economic areas (e.g., US, larger countries in Western Europe), the free MaxMind GeoIP that ships with Splunk Enterprise tends to be less accurate, causing some customers to add the paid version in their Splunk installations. The other big categories is where IPs are centralized, such as someone in the US using a Korean VPN service, or using a networking service that originates nation-wide traffic from the same set of IPs (for example, years ago all traffic from a major US cellular carrier originated from the same IP space that was geolocated to Ohio).</p>",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Badge Swipe While Using VPN",
            "operationalize": "<p>When this alert fires, the pot</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_ip_investigate_report"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/badge_reader_swipe_while_VPNd_in.png",
            "released": "2.2.0",
            "relevance": "<p>When an account is logging in from a distant location via the VPN while their badge is being physically used in the office, that can indicate account sharing or account compromise. Account sharing would occur if a user gives their username / password with another user. This frequently occurs with executives and their assistants, but can occur in all manner of scenarios (and would show up when one of the employees travels, logging in or swiping their badge in a distant location). Account compromise will manifest similarly, but with the assumption that the remote user doesn't legitimately have access to the credentials (or badge).</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat|Compliance"
        },
        "basic_brute_force": {
            "SPLEase": "Basic",
            "advancedtags": "Autobahn",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|Scanning",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Basic Brute Force - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|DS003Authentication-ET02Failure|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Uses a simple threshold for Windows Security Logs to alert if there are a large number of failed logins, and at least one successful login from the same source.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Basic Brute Force - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Basic Brute Force - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Basic Brute Force - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
            "highlight": "Yes",
            "howToImplement": "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Defense|Construction|Energy|Aerospace|Healthcare",
            "journey": "Stage_1",
            "knownFP": "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
            "mitre": "Credential Access",
            "mitre_tactic": "TA0006",
            "mitre_technique": "|T1110",
            "name": "Basic Brute Force Detection",
            "operationalize": "When this search fires, the immediate concern is that the brute force search was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/basic_brute_force.png",
            "relatedUseCases": [
                "Basic_Scanning",
                "detection_excessive_user_account_lockouts",
                "showcase_many_hosts",
                "detection_excessive_lockouts_from_endpoint"
            ],
            "released": "2.0.0",
            "relevance": "Discovering real credentials is a key component for any attacker. While there are many approaches for doing that, a time honored way is to find weak passwords by just trying hundreds of common passwords. Particularly as most environments use Active Directory as their central storage respository for credentials, looking for brute force activity in Windows Security logs should be a component of any security strategy.",
            "searchKeywords": "login log in logon log on sign",
            "similarUseCases": [
                "brute_force_access_behavior_detected",
                "brute_force_access_behavior_detected_over_one_day",
                "excessive_failed_logins",
                "UC0099",
                "UC0108",
                "UC0109"
            ],
            "usecase": "Security Monitoring"
        },
        "basic_expired_account": {
            "SPLEase": "Basic",
            "advancedtags": "Autobahn",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Basic Expired Account - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "You shouldn't see any successful authentication activity on the accounts of former employees. Track this easily in Splunk.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Basic Expired Account - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Basic Expired Account - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Windows Authentication logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standard sourcetypes.",
            "highlight": "Yes",
            "howToImplement": "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "If your organization doesn't actually disable or remove accounts, then this search may not be actionable. If this is you, consider creating some boundaries around this behavior by specifying systems that \"acceptable\" post-termination activity can be expected on, such as the email environment. Also put a detective control in place to ensure that passwords are changed when an employee goes from active to not, and try to limit the usage of accounts after the employee leaves.",
            "mitre": "Privilege Escalation|Credential Access",
            "mitre_tactic": "TA0004|TA0006",
            "mitre_technique": "|T1078|T1098",
            "name": "Successful Login of Account for Former Employee",
            "operationalize": "The first thing to understand after this alert fires is whether this was some continuation of normal system operations (e.g., the desktop under their desk was still logged in, or iPhone account still active) versus a deliberate action. Obviously success or failure also carries weight. Finally, particularly for sysadmin type employees in less structured organizations, it's important to make sure that there are no services or scheduled jobs running under that account where disabling the account outright might impact operations.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/successful_login_former_employee.png",
            "released": "2.0.0",
            "relevance": "Users who have left your organization should generally not be logging in. It could mean that their credentials were compromised earlier, or it could mean that they are trying to log in to take some inappropriate actions. Either way, this is something you want to detect.",
            "searchKeywords": "login log in logon log on sign",
            "similarUseCases": [
                "activity_from_expired_user_identity",
                "UC0014"
            ],
            "usecase": "Security Monitoring|Insider Threat"
        },
        "basic_gdpr_login_role_check": {
            "SPLEase": "Basic",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|IAM Analytics|Lateral Movement|Operations",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Login to New System GDPR - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "Follow your GDPR requirement and action your data mapping exercise by tracking employee/vendor/supplier access to systems, to ensure that they are authorized to view the data present on any systems they log into.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Login to New System GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Login to New System GDPR - Live"
                }
            ],
            "gdpr": "15|28",
            "gdprtext": "<h4>Problem:</h4><p>Under the GDPR, organizations are required to maintain a complete audit trail about the authorized access of employees/vendors/suppliers to systems and applications that process personal data. </p><h4>Impact:</h4><p>Per GDPR Article 15, individuals have the right to ask an organization where their data is stored. In order to fulfill such a request, an organization will need to identify which vendors and processors have accessed the personal data in question, and also identify and report on which other services the personal data in question is processed regularly. When processing personal data on behalf of a controller - there will also be a requirement to prove that only authorized individuals have accessed the data in question (Article 28). If there is an audit trail that shows unauthorized access, then this will need to be documented and reported to the data privacy authorities.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone logs into a new system. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
            "highlight": "Yes",
            "howToImplement": "First, use the results of the data mapping exercise from your data privacy officer to build a lookup that associates systems to the GDPR category. Then do the same for users. Use your data mapping results to build a lookup that associates systems to their GDPR category, and the same for users. At that point, as long as you have the data onboarded with common information model compliance, everything should go smoothly!",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "This will fire when someone is not in the documented list, so the most common scenario is that the documented list is just old. You can think about automating the update of the authorized user list and pull it from the source where you DPO holds the definitive record of authorized users. Another option is to generalize and enrich the information to departments who are allowed access by enriching the username with the department names.",
            "mitre": "Credential Access|Privilege Escalation",
            "mitre_tactic": "TA0006|TA0004|TA0009",
            "mitre_technique": "|T1078|T1213|T1098",
            "name": "User Logged into In-Scope System They Should Not Have",
            "operationalize": "The most likely scenario when this alert fires is that the documentation is simply out of date. Look for indications that someone should be added to the documentation or removed, but validate with your data protection officer or their team before doing so.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_user_logged_in.png",
            "released": "2.0.0",
            "relevance": "GDPR gives the right to individuals that they can ask an organization where their data is stored (Article 15) - through data mapping reinforced by controls to detect violation, an organization can identify which vendors/processors accessed the data and might store it and in which other services the data is processed regularly. If you're processing on behalf of a controller data - this search can prove that only authorized individuals have accessed it (Article 28).",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Insider Threat|Compliance"
        },
        "basic_malware_outbreak": {
            "SPLEase": "Basic",
            "advancedtags": "Autobahn",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Basic Malware Outbreak - Demo",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Looks for the same malware occurring on multiple systems in a short period of time.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Basic Malware Outbreak - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Basic Malware Outbreak - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Basic Malware Outbreak - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "With Symantec Endpoint Protection logs onboard, these searches should work easily. If you have a different Anti-Virus product, they should be very easy to adapt to the field names and sourcetypes for that product -- particularly if you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Government|Defense|Media|Technology|Travel|Telecommunications|Energy|Aerospace|Legal|Finance|Chemical|Healthcare",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "knownFP": "No known false positives at this time.",
            "mitre": "Initial Access|Execution|Privilege Escalation",
            "mitre_sub_technique": "T1566.001|T1566.002",
            "mitre_tactic": "TA0001|TA0002|TA0004",
            "mitre_technique": "|T1189|T1193|T1192|T1204|T1068|T1566",
            "name": "Basic Malware Outbreak",
            "operationalize": "When you see the same malware occurring on multiple systems, the most important thing to understand is how the malware is spreading, so that you can stop the spread. For example, WannaCry spreading via unpatched SMB vulnerabilities would require a network or patching response, a phishing campaign would require that you remove those messages from mailboxes and perform filtering, a drive by download response would require an entirely different set of actions. Additionally, perform all standard malware incident response actions, such as updating definitions, reimaging systems, etc.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/basic_malware_outbreak.png",
            "relatedUseCases": [
                "showcase_first_usb",
                "unusual_usb_activity",
                "outbreak_detected",
                "UC0029"
            ],
            "released": "2.0.0",
            "relevance": "When the same malware occurs on multiple systems, you may be on the brink of a major incident as has been seen frequently with worms, ransomware, and broad phishing campaigns. Find out about these before they become a big deal!",
            "searchKeywords": "",
            "similarUseCases": [
                "Recurring_Infection_on_Host",
                "high_number_of_infected_hosts",
                "host_with_a_recurring_malware_infection",
                "host_with_multiple_infections",
                "UC0029",
                "UC0028",
                "UC0075",
                "UC0065"
            ],
            "usecase": "Security Monitoring"
        },
        "basic_scanning": {
            "SPLEase": "Basic",
            "advancedtags": "Autobahn",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Scanning",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Basic Scanning - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Looks for hosts that reach out to more than 500 hosts, or more than 500 ports in a short period of time, indicating scanning.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Basic Scanning - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Basic Scanning - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Basic Scanning - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Palo Alto Networks logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for PAN or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "This search should work out of the box with Palo Alto Networks firewalls, and with any other device that uses the Splunk common information model. Just make sure you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!)",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Travel|Healthcare",
            "journey": "Stage_1",
            "killchain": "Reconnaissance",
            "knownFP": "The greatest source of false positives for this example are not really false positives. If you have external logs where hosts on the internet are port scanning your public infrastructure, it is definitely scanning, but it's not something you can actually do anything about. Many environments will add the following to their search strings: <pre>| search src_ip = 10.0.0.0/8 OR src_ip=172.16.0.0/12 OR src_ip=192.168.0.0/16 OR [your public ranges]</pre> You will also likely benefit from excluding any vulnerability scanners in your environment, as you pay them to scan the network.",
            "mitre": "Discovery",
            "mitre_tactic": "TA0007",
            "mitre_technique": "|T1046|T1018",
            "name": "Basic Scanning",
            "operationalize": "When scanning is occurring from an internal source, it's usually an indication that a host is infected and you need to start an incident response response to understand how and with what. When scanning occurs from outside sources, you probably don't care at all, because it's so difficult to do any meaningful response -- many people will add a filter to this search to exclude those (see Known False Positives).",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/basic_scanning.png",
            "relatedUseCases": [
                "basic_brute_force",
                "detection_excessive_user_account_lockouts",
                "showcase_many_hosts",
                "detection_excessive_lockouts_from_endpoint"
            ],
            "released": "2.0.0",
            "relevance": "Scanning is a way for attackers to discover the attack surface of your organization (effectively, perform discovery), so they can prepare for an attack, or prepare for the next phase of an attack. It should only ever happen from authorized sources (e.g., vulnerability scanners) internally, and if someone else is doing scanning, you should know about it!",
            "searchKeywords": "",
            "similarUseCases": [
                "showcase_network_dc_dest",
                "vulnerability_scanner_detected_by_events",
                "vulnerability_scanner_detected_by_targets"
            ],
            "usecase": "Security Monitoring"
        },
        "batch_file_write_to_system32": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=batch_file_write_to_system32",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1204.002/batch_file_in_system32/windows-sysmon.log"
            ],
            "date": "2018-12-14",
            "description": "The search looks for a batch file (.bat) written to the Windows system directory tree.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "batch_file_write_to_system32",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery",
            "known_false_positives": "It is possible for this search to generate a notable event for a batch file write to a path that includes the string \"system32\", but is not the actual Windows system directory. As such, you should confirm the path of the batch file identified by the search. In addition, a false positive may be generated by an administrator copying a legitimate batch file in this directory tree. You should confirm that the activity is legitimate and modify the search to add exclusions, as necessary.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "batch_file_write_to_system32_filter"
                }
            ],
            "mitre_sub_technique": "T1204.002",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1204",
            "mitre_threat_groups": "Magic Hound|Windshift|APT33|Sandworm Team|Naikon|Whitefly|Tropic Trooper|Gamaredon Group|Sharpshooter|Molerats|Wizard Spider|Mofang|Frankenstein|RTM|Inception|BlackTech|APT-C-36|Machete|admin@338|APT12|TA505|Silence|The White Company|APT39|FIN4|Darkhotel|Gallmaker|APT19|Dragonfly 2.0|BRONZE BUTLER|Cobalt Group|DarkHydrus|Gorgon Group|Patchwork|OilRig|Dark Caracal|MuddyWater|Lazarus Group|FIN7|APT32|Rancor|APT37|FIN8|APT28|Elderwood|TA459|APT29|Leviathan|menuPass|PLATINUM",
            "name": "Batch File Write To System32",
            "references": [],
            "released": "2018-12-14",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.dest) as dest values(Filesystem.file_name) as file_name values(Filesystem.user) as user from datamodel=Endpoint.Filesystem by Filesystem.file_path | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`| rex field=file_name \"(?<file_extension>\\.[^\\.]+)$\" | search file_path=*system32* AND file_extension=.bat | `batch_file_write_to_system32_filter`",
            "search_name": "ESCU - Batch File Write to System32 - Rule",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1204.002/batch_file_in_system32/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "Magic Hound",
                    "Windshift",
                    "APT33",
                    "Sandworm Team",
                    "Naikon",
                    "Whitefly",
                    "Tropic Trooper",
                    "Gamaredon Group",
                    "Sharpshooter",
                    "Molerats",
                    "Wizard Spider",
                    "Mofang",
                    "Frankenstein",
                    "RTM",
                    "Inception",
                    "BlackTech",
                    "APT-C-36",
                    "Machete",
                    "admin@338",
                    "APT12",
                    "TA505",
                    "Silence",
                    "The White Company",
                    "APT39",
                    "FIN4",
                    "Darkhotel",
                    "Gallmaker",
                    "APT19",
                    "Dragonfly 2.0",
                    "BRONZE BUTLER",
                    "Cobalt Group",
                    "DarkHydrus",
                    "Gorgon Group",
                    "Patchwork",
                    "OilRig",
                    "Dark Caracal",
                    "MuddyWater",
                    "Lazarus Group",
                    "FIN7",
                    "APT32",
                    "Rancor",
                    "APT37",
                    "FIN8",
                    "APT28",
                    "Elderwood",
                    "TA459",
                    "APT29",
                    "Leviathan",
                    "menuPass",
                    "PLATINUM"
                ],
                "mitre_attack_id": [
                    "T1204"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Malicious File"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "blacklisted_application": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence|Unauthorized Software|Operations",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Raises anomalies when the input data matches a set of predefined patterns in Microsoft Windows logs.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "broad",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Blacklisted Application",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "blacklisted_domain": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS002DNS-ET01QueryRequest",
            "deprecated_not_used_anymore_datasource": "DNS",
            "description": "Generates anomalies for traffic that goes to Blacklisted Domains.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1032|T1095",
            "name": "Blacklisted Domain",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "blacklisted_ip_address": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Generates anomalies for traffic that goes to Blacklisted IPs",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0011|TA0010",
            "mitre_technique": "|T1094|T1095|T1071|T1048|T1041",
            "name": "Blacklisted IP Address",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "brute_force_access_behavior_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Lateral Movement|IAM Analytics",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|DS003Authentication-ET02Failure",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects excessive number of failed login attempts along with a successful attempt (this could indicate a successful brute force attack)",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Brute Force Access Behavior Detected",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "search_name": "Access - Brute Force Access Behavior Detected - Rule",
            "similarUseCases": [
                "basic_brute_force",
                "brute_force_access_behavior_detected_over_one_day",
                "excessive_failed_logins",
                "UC0099",
                "UC0108",
                "UC0109"
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "brute_force_access_behavior_detected_over_one_day": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Lateral Movement|IAM Analytics",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|DS003Authentication-ET02Failure",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects an excessive number of failed login attempts, along with a successful attempt, over a one day period (this could indicate a successful brute force attack)",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Brute Force Access Behavior Detected Over One Day",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "search_name": "Access - Brute Force Access Behavior Detected Over 1d - Rule",
            "similarUseCases": [
                "basic_brute_force",
                "brute_force_access_behavior_detected",
                "excessive_failed_logins",
                "UC0099",
                "UC0108",
                "UC0109"
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "building_departmental_peer_group": {
            "SPLEase": "Medium",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|Compliance",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Build Departmental Peer Group - Demo",
            "data_source_categories": "VendorSpecific-winsec-domaincontroller",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Build a departmental peer group that can be used by the detections in Splunk Security Essentials.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Build Departmental Peer Group - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Build Departmental Peer Group - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is the output of an LDAP Search, which we are transforming into a departmental peer group that we can use in our other detections.</p>",
            "highlight": "No",
            "howToImplement": "<p>There are multiple approaches for pulling Active Directory data:<ul><li>Using the Supporting Add-on for Active Directory (aka SA-ldapsearch) which provides the ldapsearch command -- recommended for on premises installations in organizations with fewer than 50,000 users (<a href=\"https://splunkbase.splunk.com/app/1151/\" target=\"_blank\">app link</a>, <a href=\"http://docs.splunk.com/Documentation/SA-LdapSearch/2.1.6/User/AbouttheSplunkSupportingAdd-onforActiveDirectory\" target=\"_blank\">docs link</a>).</li><li>Using data from AD Monitor, which is the Splunk Universal Forwarder's ability to monitor Active Directory for changes -- recommended for large organizations, and for Cloud environments (<a href=\"http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorActiveDirectory\" target=\"_blank\">doc link</a>).</li><li>Using a Powershell script to query Active Directory for this data (<a href=\"https://gallery.technet.microsoft.com/scriptcenter/Powershell-script-to-5edcdaea\" target=\"_blank\">link</a>).</li></ul></p><p>Once the AD data is ingested, running through the search is straightforward you should be good to go.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "<p>Not Applicable</p>",
            "mitre": "",
            "mitre_notes": "Not an attacker technique",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Building a Departmental Peer Group",
            "operationalize": "<p>No alerts will be generated by this search.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/building_departmental_peer_group.png",
            "released": "2.2.0",
            "relevance": "<p>In order to do peer group analysis, you must first build out departmental peer groups. This search will convert a peer group into the format that the searches in this app expect.</p>",
            "searchKeywords": "",
            "usecase": "Compliance|Insider Threat"
        },
        "child_processes_of_spoolsv_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Privilege Escalation",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=child_processes_of_spoolsv_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-03-16",
            "description": "This search looks for child processes of spoolsv.exe. This activity is associated with a POC privilege-escalation exploit associated with CVE-2018-8440. Spoolsv.exe is the process associated with the Print Spooler service in Windows and typically runs as SYSTEM.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 5|CIS 8",
            "escu_nist": "PR.AC|PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. Update the `children_of_spoolsv_filter` macro to filter out legitimate child processes spawned by spoolsv.exe.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. Update the `children_of_spoolsv_filter` macro to filter out legitimate child processes spawned by spoolsv.exe.",
            "icon": "ES_Use_Case.png",
            "id": "child_processes_of_spoolsv_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Some legitimate printer-related processes may show up as children of spoolsv.exe. You should confirm that any activity as legitimate and may be added as exclusions in the search.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "child_processes_of_spoolsv_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1068",
            "mitre_tactic": "TA0004",
            "mitre_tactic_display": "Privilege Escalation",
            "mitre_technique": "T1068",
            "mitre_threat_groups": "Whitefly|APT33|Cobalt Group|PLATINUM|FIN8|APT32|Threat Group-3390|FIN6|APT28",
            "name": "Child Processes Of Spoolsv Exe",
            "references": [],
            "released": "2020-03-16",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process_name) as process_name values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process_name=spoolsv.exe AND Processes.process_name!=regsvr32.exe by Processes.dest Processes.parent_process Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `child_processes_of_spoolsv_exe_filter` ",
            "search_name": "ESCU - Child Processes of Spoolsv exe - Rule",
            "story": "644e22d3-598a-429c-a007-16fdb802cae5",
            "tags": {
                "analytics_story": [
                    "Windows Privilege Escalation"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 5",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "Whitefly",
                    "APT33",
                    "Cobalt Group",
                    "PLATINUM",
                    "FIN8",
                    "APT32",
                    "Threat Group-3390",
                    "FIN6",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1068"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Exploitation for Privilege Escalation"
                ],
                "nist": [
                    "PR.AC",
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "cleartext_password_at_rest_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS015ConfigurationManagement-ET01General",
            "deprecated_not_used_anymore_datasource": "Configuration Management",
            "description": "Detects cleartext passwords being stored at rest (such as in the Unix passwd file)",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Cleartext Password At Rest Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Cleartext Password At Rest - Rule",
            "usecase": "Compliance"
        },
        "clients_connecting_to_multiple_dns_servers": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DNS Hijacking|Command and Control|Suspicious DNS Traffic|Host Redirection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Command and Control",
            "dashboard": "showcase_security_content?showcaseId=clients_connecting_to_multiple_dns_servers",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search allows you to identify the endpoints that have connected to more than five DNS servers and made DNS Queries over the time frame of the search.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 9|CIS 12|CIS 13",
            "escu_nist": "PR.PT|DE.AE|PR.DS",
            "hasSearch": "Yes",
            "help": "This search requires that DNS data is being ingested and populating the `Network_Resolution` data model. This data can come from DNS logs or from solutions that parse network traffic for this data, such as Splunk Stream or Bro.\\\nThis search produces fields (`dest_count`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** Distinct DNS Connections, **Field:** dest_count\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "This search requires that DNS data is being ingested and populating the `Network_Resolution` data model. This data can come from DNS logs or from solutions that parse network traffic for this data, such as Splunk Stream or Bro.\\\nThis search produces fields (`dest_count`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** Distinct DNS Connections, **Field:** dest_count\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "clients_connecting_to_multiple_dns_servers",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "It's possible that an enterprise has more than five DNS servers that are configured in a round-robin rotation. Please customize the search, as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "clients_connecting_to_multiple_dns_servers_filter"
                }
            ],
            "mitre_sub_technique": "T1048.003",
            "mitre_tactic": "TA0010",
            "mitre_tactic_display": "Exfiltration",
            "mitre_technique": "T1048",
            "mitre_threat_groups": "APT32|APT33|Thrip|FIN8|OilRig|Lazarus Group",
            "name": "Clients Connecting To Multiple DNS Servers",
            "references": "",
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count, values(DNS.dest) AS dest dc(DNS.dest) as dest_count from datamodel=Network_Resolution where DNS.message_type=QUERY by DNS.src | `drop_dm_object_name(\"Network_Resolution\")` |where dest_count > 5 | `clients_connecting_to_multiple_dns_servers_filter` ",
            "search_name": "ESCU - Clients Connecting to Multiple DNS Servers - Rule",
            "story": "8169f17b-ef68-4b59-aa28-586907301221|943773c6-c4de-4f38-89a8-0b92f98804d8|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56|2e8948a5-5239-406b-b56b-6c50fe268af4",
            "tags": {
                "analytics_story": [
                    "DNS Hijacking",
                    "Command and Control",
                    "Suspicious DNS Traffic",
                    "Host Redirection"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 9",
                    "CIS 12",
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT32",
                    "APT33",
                    "Thrip",
                    "FIN8",
                    "OilRig",
                    "Lazarus Group"
                ],
                "mitre_attack_id": [
                    "T1048"
                ],
                "mitre_attack_tactics": [
                    "Exfiltration"
                ],
                "mitre_attack_technique": [
                    "Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"
                ],
                "nist": [
                    "PR.PT",
                    "DE.AE",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "cloud_api_calls_from_previously_unseen_user_roles": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud User Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-09-03",
                    "description": "This search builds a table of the first and last times seen for every user role and command combination. This is broadly defined as any event that runs or creates something. This table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "69d75f4b-b794-4a66-a777-730357b886b4",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_api_calls_per_user_role",
                            "description": "A table of users, commands, and the first and last time that they have been seen",
                            "fields_list": "_key, user, command, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_api_calls_per_user_role"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_api_calls_per_user_role___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud API Calls Per User Role - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.user_type=AssumedRole AND All_Changes.status=success by All_Changes.user, All_Changes.command | `drop_dm_object_name(\"All_Changes\")` | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table user, command, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_api_calls_per_user_role",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud User Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud API Calls From Previously Unseen User Roles"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-09-03",
                    "description": "This search updates the table of the first and last times seen for every user role and command combination.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "c4b760a0-6a97-47e9-b089-8ae9e57f210e",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_api_calls_per_user_role",
                            "description": "A table of users, commands, and the first and last time that they have been seen",
                            "fields_list": "_key, user, command, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_api_calls_per_user_role"
                        },
                        {
                            "collection": "previously_seen_cloud_api_calls_per_user_role",
                            "description": "A table of users, commands, and the first and last time that they have been seen",
                            "fields_list": "_key, user, command, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_api_calls_per_user_role"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_api_calls_per_user_role___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud API Calls Per User Role - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.user_type=AssumedRole AND All_Changes.status=success by All_Changes.user, All_Changes.command | `drop_dm_object_name(\"All_Changes\")` | table user, command, firstTimeSeen, lastTimeSeen | inputlookup previously_seen_cloud_api_calls_per_user_role append=t | stats min(firstTimeSeen) as firstTimeSeen, max(lastTimeSeen) as lastTimeSeen by user, command | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_api_calls_per_user_role_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table user, command, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_api_calls_per_user_role",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud User Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud API Calls From Previously Unseen User Roles"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_api_calls_from_previously_unseen_user_roles",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-09-04",
            "description": "This search looks for new commands from each user role.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud API Calls Per User Role - Initial` to build the initial table of user roles, commands, and times. You must also enable the second baseline search `Previously Seen Cloud API Calls Per User Role - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `cloud_api_calls_from_previously_unseen_user_roles_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_api_calls_from_previously_unseen_user_roles_filter`",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud API Calls Per User Role - Initial` to build the initial table of user roles, commands, and times. You must also enable the second baseline search `Previously Seen Cloud API Calls Per User Role - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `cloud_api_calls_from_previously_unseen_user_roles_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_api_calls_from_previously_unseen_user_roles_filter`",
            "icon": "ES_Use_Case.png",
            "id": "cloud_api_calls_from_previously_unseen_user_roles",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": ".",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_api_calls_per_user_role",
                    "description": "A table of users, commands, and the first and last time that they have been seen",
                    "fields_list": "_key, user, command, firstTimeSeen, lastTimeSeen, enough_data",
                    "name": "previously_seen_cloud_api_calls_per_user_role"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_api_calls_from_previously_unseen_user_roles_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "Cloud API Calls From Previously Unseen User Roles",
            "references": [],
            "released": "2020-09-04",
            "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Change where All_Changes.user_type=AssumedRole AND All_Changes.status=success by All_Changes.user, All_Changes.command All_Changes.object | `drop_dm_object_name(\"All_Changes\")` | lookup previously_seen_cloud_api_calls_per_user_role user as user, command as command OUTPUT firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenUserApiCall=min(firstTimeSeen) | where isnull(firstTimeSeenUserApiCall) OR firstTimeSeenUserApiCall > relative_time(now(),\"-24h@h\") | table firstTime, user, object, command |`security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `cloud_api_calls_from_previously_unseen_user_roles_filter`",
            "search_name": "ESCU - Cloud API Calls From Previously Unseen User Roles - Rule",
            "story": "1ed5ce7d-5469-4232-92af-89d1a3595b39",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud User Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 25,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_compute_instance_created_by_previously_unseen_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Cloud Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Cloud Compute Instance",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-15",
                    "description": "This search builds a table of previously seen users that have launched a cloud compute instance.",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the Security Research cloud data model installed.",
                    "id": "9fa1c205-4e08-4681-bb1b-d0943e734b85",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_creations_by_user",
                            "description": "A table of previously seen users creating cloud instances",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                            "name": "previously_seen_cloud_compute_creations_by_user"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_creations_by_user_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Creations By User",
                    "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Cloud_Infrastructure.Compute where Compute.action=run `previously_seen_cloud_compute_creations_by_user_input_filter` by Compute.src_user | `drop_dm_object_name(\"Compute\")` | outputlookup previously_seen_cloud_compute_creations_by_user | stats count",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created By Previously Unseen User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-15",
                    "description": "This search builds a table of previously seen users that have launched a cloud compute instance.",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the proper TAs installed.",
                    "id": "dd4ced8a-15a9-4285-94ac-7e4134673bf8",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_creations_by_user",
                            "description": "A table of previously seen users creating cloud instances",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                            "name": "previously_seen_cloud_compute_creations_by_user"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_creations_by_user___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Creations By User - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created AND All_Changes.object_category=instance by All_Changes.user | `drop_dm_object_name(\"All_Changes\")` | outputlookup previously_seen_cloud_compute_creations_by_user | stats count",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "Hourly Cache Updates"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created By Previously Unseen User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-15",
                    "description": "This search builds a table of previously seen users that have launched a cloud compute instance.",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the proper TAs installed.",
                    "id": "6bf75d69-7766-47bc-8097-e41696807a6f",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_creations_by_user",
                            "description": "A table of previously seen users creating cloud instances",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                            "name": "previously_seen_cloud_compute_creations_by_user"
                        },
                        {
                            "collection": "previously_seen_cloud_compute_creations_by_user",
                            "description": "A table of previously seen users creating cloud instances",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                            "name": "previously_seen_cloud_compute_creations_by_user"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_creations_by_user___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Creations By User - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created AND All_Changes.object_category=instance by All_Changes.user| `drop_dm_object_name(\"All_Changes\")` | inputlookup append=t previously_seen_cloud_compute_creations_by_user | stats min(firstTimeSeen) as firstTimeSeen max(lastTimeSeen) as lastTimeSeen by user | where lastTimeSeen > relative_time(now(), \"-90d@d\") | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | outputlookup previously_seen_cloud_compute_creations_by_user",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created By Previously Unseen User"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=cloud_compute_instance_created_by_previously_unseen_user",
            "data_source_categories": "DS036CloudInfrastructure-ET01Compute",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-08-21",
            "description": "This search looks for cloud compute instances created by users who have not created them before.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting the appropriate cloud-infrastructure logs Run the \"Previously Seen Cloud Compute Creations By User\" support search to create of baseline of previously seen users.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting the appropriate cloud-infrastructure logs Run the \"Previously Seen Cloud Compute Creations By User\" support search to create of baseline of previously seen users.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_compute_instance_created_by_previously_unseen_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "It's possible that a user will start to create compute instances for the first time, for any number of reasons. Verify with the user launching instances that this is the intended behavior.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_compute_creations_by_user",
                    "description": "A table of previously seen users creating cloud instances",
                    "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                    "name": "previously_seen_cloud_compute_creations_by_user"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_compute_instance_created_by_previously_unseen_user_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Cloud Compute Instance Created By Previously Unseen User",
            "references": [],
            "released": "2020-08-21",
            "search": "| tstats `security_content_summariesonly` count earliest(_time) as firstTime, latest(_time) as lastTime values(All_Changes.object) as dest from datamodel=Change where All_Changes.action=created by All_Changes.user All_Changes.vendor_region | `drop_dm_object_name(\"All_Changes\")` | lookup previously_seen_cloud_compute_creations_by_user user as user OUTPUTNEW firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenUser=min(firstTimeSeen) | where isnull(firstTimeSeenUser) OR firstTimeSeenUser > relative_time(now(), \"-24h@h\") | table firstTime, user, dest, count vendor_region | `security_content_ctime(firstTime)` | `cloud_compute_instance_created_by_previously_unseen_user_filter`",
            "search_name": "ESCU - Cloud Compute Instance Created By Previously Unseen User - Rule",
            "story": "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a",
            "tags": {
                "analytics_story": [
                    "Cloud Cryptomining"
                ],
                "asset_type": "Cloud Compute Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 20,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_compute_instance_created_in_previously_unused_region": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Cloud Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Cloud Compute Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-09-02",
                    "description": "This search looks for cloud compute events where a compute instance is started and creates a baseline of most recent time, `lastTime` and the first time `firstTime` we've seen this region in our dataset grouped by the region for the last 30 days",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the Security Research cloud data model installed.",
                    "id": "b5e232db-dec6-4db8-aaa1-dd5474521e40",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_regions",
                            "description": "A table of vendor_region values and the first and last time that they have been observed in cloud provisioning activities",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, vendor_region, enough_data",
                            "name": "previously_seen_cloud_regions"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_regions___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Regions - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created by All_Changes.vendor_region | `drop_dm_object_name(\"All_Changes\")` | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-14d@d\"), 1, 0) | outputlookup previously_seen_cloud_regions",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created In Previously Unused Region"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-09-02",
                    "description": "This search looks for cloud compute events where a compute instance is started and creates a baseline of most recent time, `lastTime` and the first time `firstTime` we've seen this region in our dataset grouped by the region for the last 30 days",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the Security Research cloud data model installed.",
                    "id": "512f928a-a461-41b4-8984-db4dd2c472e4",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_regions",
                            "description": "A table of vendor_region values and the first and last time that they have been observed in cloud provisioning activities",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, vendor_region, enough_data",
                            "name": "previously_seen_cloud_regions"
                        },
                        {
                            "collection": "previously_seen_cloud_regions",
                            "description": "A table of vendor_region values and the first and last time that they have been observed in cloud provisioning activities",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, vendor_region, enough_data",
                            "name": "previously_seen_cloud_regions"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_regions___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Regions - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created by All_Changes.vendor_region | `drop_dm_object_name(\"All_Changes\")` | inputlookup append=t previously_seen_cloud_regions | stats min(firstTimeSeen) as firstTimeSeen max(lastTimeSeen) as lastTimeSeen by vendor_region | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_region_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-14d@d\"), 1, 0) | outputlookup previously_seen_cloud_regions | stats count",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created In Previously Unused Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_compute_instance_created_in_previously_unused_region",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-09-02",
            "description": "This search looks at cloud-infrastructure events where an instance is created in any region within the last hour and then compares it to a lookup file of previously seen regions where instances have been created.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 12",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen Cloud Regions - Initial` to build the initial table of images observed and times. You must also enable the second baseline search `Previously Seen Cloud Regions - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `cloud_compute_instance_created_in_previously_unused_region_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen Cloud Regions - Initial` to build the initial table of images observed and times. You must also enable the second baseline search `Previously Seen Cloud Regions - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `cloud_compute_instance_created_in_previously_unused_region_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_compute_instance_created_in_previously_unused_region",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "It's possible that a user has unknowingly started an instance in a new region. Please verify that this activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_regions",
                    "description": "A table of vendor_region values and the first and last time that they have been observed in cloud provisioning activities",
                    "fields_list": "_key, firstTimeSeen, lastTimeSeen, vendor_region, enough_data",
                    "name": "previously_seen_cloud_regions"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_compute_instance_created_in_previously_unused_region_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "Cloud Compute Instance Created In Previously Unused Region",
            "references": [],
            "released": "2020-09-02",
            "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime values(All_Changes.object_id) as dest, count from datamodel=Change where All_Changes.action=created by All_Changes.vendor_region, All_Changes.user | `drop_dm_object_name(\"All_Changes\")` | lookup previously_seen_cloud_regions vendor_region as vendor_region OUTPUTNEW firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenRegion=min(firstTimeSeen) | where isnull(firstTimeSeenRegion) OR firstTimeSeenRegion > relative_time(now(), \"-24h@h\") | table firstTime, user, dest, count , vendor_region | `security_content_ctime(firstTime)` | `cloud_compute_instance_created_in_previously_unused_region_filter`",
            "search_name": "ESCU - Cloud Compute Instance Created In Previously Unused Region - Rule",
            "story": "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a",
            "tags": {
                "analytics_story": [
                    "Cloud Cryptomining"
                ],
                "asset_type": "Cloud Compute Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 12"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 20,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_compute_instance_created_with_previously_unseen_image": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Cloud Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Cloud Compute Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-12",
                    "description": "This search builds a table of previously seen images used to launch cloud compute instances",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the Security Research cloud data model installed.",
                    "id": "3782ad10-5ce2-46e2-b9c4-1de9ecd3aecc",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_images",
                            "description": "A table of previously seen Cloud image IDs",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, image_id, enough_data",
                            "name": "previously_seen_cloud_compute_images"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_images_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Images",
                    "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Cloud_Infrastructure.Compute where Compute.action=run `previously_seen_cloud_compute_image_input_filter` by Compute.image_id | `drop_dm_object_name(\"Compute\")` | outputlookup previously_seen_cloud_compute_images | stats count",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created With Previously Unseen Image"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-10-08",
                    "description": "This search builds a table of previously seen images used to launch cloud compute instances",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the latest Change Datamodel accelerated",
                    "id": "7744597f-d07a-4cea-94a7-e0f8aaebc410",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_images",
                            "description": "A table of previously seen Cloud image IDs",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, image_id, enough_data",
                            "name": "previously_seen_cloud_compute_images"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_images___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Images - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created  by All_Changes.Instance_Changes.image_id | `drop_dm_object_name(\"All_Changes\")` | `drop_dm_object_name(\"Instance_Changes\")` | where image_id != \"unknown\" | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | outputlookup previously_seen_cloud_compute_images",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created With Previously Unseen Image"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-08-12",
                    "description": "This search builds a table of previously seen images used to launch cloud compute instances",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs",
                    "id": "6f1ca5dc-e445-401c-9845-a96d2b6ba184",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_images",
                            "description": "A table of previously seen Cloud image IDs",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, image_id, enough_data",
                            "name": "previously_seen_cloud_compute_images"
                        },
                        {
                            "collection": "previously_seen_cloud_compute_images",
                            "description": "A table of previously seen Cloud image IDs",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, image_id, enough_data",
                            "name": "previously_seen_cloud_compute_images"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_images___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Images - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created by All_Changes.Instance_Changes.image_id | `drop_dm_object_name(\"All_Changes\")` | `drop_dm_object_name(\"Instance_Changes\")` | where image_id != \"unknown\" | inputlookup append=t previously_seen_cloud_compute_images | stats min(firstTimeSeen) as firstTimeSeen max(lastTimeSeen) as lastTimeSeen by image_id | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_compute_images_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | outputlookup previously_seen_cloud_compute_images",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created With Previously Unseen Image"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=cloud_compute_instance_created_with_previously_unseen_image",
            "data_source_categories": "DS036CloudInfrastructure-ET01Compute",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2018-10-12",
            "description": "This search looks for cloud compute instances being created with previously unseen image IDs.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen Cloud Compute Images - Initial` to build the initial table of images observed and times. You must also enable the second baseline search `Previously Seen Cloud Compute Images - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `cloud_compute_instance_created_with_previously_unseen_image_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen Cloud Compute Images - Initial` to build the initial table of images observed and times. You must also enable the second baseline search `Previously Seen Cloud Compute Images - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `cloud_compute_instance_created_with_previously_unseen_image_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_compute_instance_created_with_previously_unseen_image",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "After a new image is created, the first systems created with that image will cause this alert to fire.  Verify that the image being used was created by a legitimate user.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_compute_images",
                    "description": "A table of previously seen Cloud image IDs",
                    "fields_list": "_key, firstTimeSeen, lastTimeSeen, image_id, enough_data",
                    "name": "previously_seen_cloud_compute_images"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_compute_instance_created_with_previously_unseen_image_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Cloud Compute Instance Created With Previously Unseen Image",
            "references": [],
            "released": "2018-10-12",
            "search": "| tstats count earliest(_time) as firstTime, latest(_time) as lastTime values(All_Changes.object_id) as dest from datamodel=Change where All_Changes.action=created by All_Changes.Instance_Changes.image_id, All_Changes.user | `drop_dm_object_name(\"All_Changes\")` | `drop_dm_object_name(\"Instance_Changes\")` | where image_id != \"unknown\" | lookup previously_seen_cloud_compute_images image_id as image_id OUTPUT firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenImage=min(firstTimeSeen) | where isnull(firstTimeSeenImage) OR firstTimeSeenImage > relative_time(now(), \"-24h@h\") | table firstTime, user, image_id, count, dest | `security_content_ctime(firstTime)` | `cloud_compute_instance_created_with_previously_unseen_image_filter`",
            "search_name": "ESCU - Cloud Compute Instance Created With Previously Unseen Image - Rule",
            "security_domain": "endpoint",
            "story": "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a",
            "tags": {
                "analytics_story": [
                    "Cloud Cryptomining"
                ],
                "asset_type": "Cloud Compute Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 20,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_compute_instance_created_with_previously_unseen_instance_type": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Cloud Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Cloud Compute Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2019-10-03",
                    "description": "This search builds a table of previously seen cloud compute instance types",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the Security Research cloud data model installed.",
                    "id": "0ef13d46-164e-4cf5-816e-b3c0df170d00",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_instance_types",
                            "description": "A place holder for a list of used cloud compute instance types",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, instance_type, enough_data",
                            "name": "previously_seen_cloud_compute_instance_types"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_instance_types_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Instance Types",
                    "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Cloud_Infrastructure.Compute where Compute.action=run `previously_seen_cloud_compute_instance_types_input_filter` by Compute.instance_type | `drop_dm_object_name(\"Compute\")` | outputlookup previously_seen_cloud_compute_instance_types | stats count",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created With Previously Unseen Instance Type"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-9-03",
                    "description": "This search builds a table of previously seen cloud compute instance types",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the Security Research cloud data model installed.",
                    "id": "3c78025c-1ffe-4976-a640-75ef604842be",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_instance_types",
                            "description": "A place holder for a list of used cloud compute instance types",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, instance_type, enough_data",
                            "name": "previously_seen_cloud_compute_instance_types"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_instance_types___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Instance Types - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created by All_Changes.Instance_Changes.instance_type | `drop_dm_object_name(\"All_Changes.Instance_Changes\")` | where instance_type != \"unknown\" | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-14d@d\"), 1, 0) | outputlookup previously_seen_cloud_compute_instance_types",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created With Previously Unseen Instance Type"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-9-03",
                    "description": "This search builds a table of previously seen cloud compute instance types",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs",
                    "id": "7b7ef9ab-acb9-4e07-af76-4cf1e722885c",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_compute_instance_types",
                            "description": "A place holder for a list of used cloud compute instance types",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, instance_type, enough_data",
                            "name": "previously_seen_cloud_compute_instance_types"
                        },
                        {
                            "collection": "previously_seen_cloud_compute_instance_types",
                            "description": "A place holder for a list of used cloud compute instance types",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, instance_type, enough_data",
                            "name": "previously_seen_cloud_compute_instance_types"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_compute_instance_types___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Compute Instance Types - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=created by All_Changes.Instance_Changes.instance_type | `drop_dm_object_name(\"All_Changes.Instance_Changes\")` | where instance_type != \"unknown\" | inputlookup append=t previously_seen_cloud_compute_instance_types | stats min(firstTimeSeen) as firstTimeSeen max(lastTimeSeen) as lastTimeSeen by instance_type | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_compute_instance_type_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-14d@d\"), 1, 0) | outputlookup previously_seen_cloud_compute_instance_types",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Compute Instance Created With Previously Unseen Instance Type"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=cloud_compute_instance_created_with_previously_unseen_instance_type",
            "data_source_categories": "DS036CloudInfrastructure-ET01Compute",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-09-12",
            "description": "Find EC2 instances being created with previously unseen instance types.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen Cloud Compute Instance Types - Initial` to build the initial table of instance types observed and times. You must also enable the second baseline search `Previously Seen Cloud Compute Instance Types - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `cloud_compute_instance_created_with_previously_unseen_instance_type_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously Seen Cloud Compute Instance Types - Initial` to build the initial table of instance types observed and times. You must also enable the second baseline search `Previously Seen Cloud Compute Instance Types - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `cloud_compute_instance_created_with_previously_unseen_instance_type_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_compute_instance_created_with_previously_unseen_instance_type",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "It is possible that an admin will create a new system using a new instance type that has never been used before. Verify with the creator that they intended to create the system with the new instance type.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_compute_instance_types",
                    "description": "A place holder for a list of used cloud compute instance types",
                    "fields_list": "_key, firstTimeSeen, lastTimeSeen, instance_type, enough_data",
                    "name": "previously_seen_cloud_compute_instance_types"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_compute_instance_created_with_previously_unseen_instance_type_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Cloud Compute Instance Created With Previously Unseen Instance Type",
            "references": [],
            "released": "2020-09-12",
            "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime values(All_Changes.object_id) as dest, count from datamodel=Change where All_Changes.action=created by All_Changes.Instance_Changes.instance_type, All_Changes.user | `drop_dm_object_name(\"All_Changes\")` | `drop_dm_object_name(\"Instance_Changes\")` | where instance_type != \"unknown\" | lookup previously_seen_cloud_compute_instance_types instance_type as instance_type OUTPUTNEW firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenInstanceType=min(firstTimeSeen) | where isnull(firstTimeSeenInstanceType) OR firstTimeSeenInstanceType > relative_time(now(), \"-24h@h\") | table firstTime, user, dest, count, instance_type | `security_content_ctime(firstTime)` | `cloud_compute_instance_created_with_previously_unseen_instance_type_filter`",
            "search_name": "ESCU - Cloud Compute Instance Created With Previously Unseen Instance Type - Rule",
            "security_domain": "endpoint",
            "story": "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a",
            "tags": {
                "analytics_story": [
                    "Cloud Cryptomining"
                ],
                "asset_type": "Cloud Compute Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 20,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_compute_instance_started_in_previously_unused_region": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Cloud Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Cloud Compute Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2019-10-02",
                    "description": "This search looks for cloud compute events where a compute instance is started and creates a baseline of most recent time, `lastTime` and the first time `firstTime` we've seen this region in our dataset grouped by the region for the last 30 days",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the Security Research cloud data model installed.",
                    "id": "b5e232db-dec6-4db8-aaa1-dd5474521e40",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_regions",
                            "description": "A table of vendor_region values and the first and last time that they have been observed in cloud provisioning activities",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, vendor_region, enough_data",
                            "name": "previously_seen_cloud_regions"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_regions_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Regions",
                    "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Cloud_Infrastructure.Compute where Compute.action=start `previously_seen_cloud_regions_input_filter` by Compute.region | `drop_dm_object_name(\"Compute\")` | outputlookup previously_seen_cloud_regions | stats count",
                    "tags": {
                        "analytics_story": [
                            "Cloud Cryptomining"
                        ],
                        "detections": [
                            "Cloud Compute Instance Started In Previously Unused Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=cloud_compute_instance_started_in_previously_unused_region",
            "data_source_categories": "DS036CloudInfrastructure-ET01Compute",
            "datamodel": "Cloud_Infrastructure.Compute",
            "dataset": "",
            "date": "2019-10-02",
            "description": "This search looks at cloud-infrastructure events where an instance is created in any region within the last hour and then compares it to a lookup file of previously seen regions where instances have been created.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 12",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting the appropriate cloud-infrastructure logs and have the Security Research cloud data model (https://github.com/splunk/cloud-datamodel-security-research/) installed. Run the \\\"Previously Seen Cloud Compute Instance Types\\\" support search to create a baseline of previously seen regions.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting the appropriate cloud-infrastructure logs and have the Security Research cloud data model (https://github.com/splunk/cloud-datamodel-security-research/) installed. Run the \\\"Previously Seen Cloud Compute Instance Types\\\" support search to create a baseline of previously seen regions.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_compute_instance_started_in_previously_unused_region",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It's possible that a user has unknowingly started an instance in a new region. Please verify that this activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_regions",
                    "description": "A table of vendor_region values and the first and last time that they have been observed in cloud provisioning activities",
                    "fields_list": "_key, firstTimeSeen, lastTimeSeen, vendor_region, enough_data",
                    "name": "previously_seen_cloud_regions"
                }
            ],
            "macros": [
                {
                    "definition": "\"-70m@m\"",
                    "description": "Use this macro to determine how far into the past the window should be to determine if the region is new or not",
                    "name": "previously_seen_cloud_regions_search_window_begin_offset"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_compute_instance_started_in_previously_unused_region_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "Cloud Compute Instance Started In Previously Unused Region",
            "references": [],
            "released": "2019-10-02",
            "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime values(Compute.dest) as dest from datamodel=Cloud_Infrastructure.Compute where Compute.event_name=RunInstances `cloud_compute_instance_started_in_previously_unused_region_filter` by Compute.region, Compute.src_user | `drop_dm_object_name(\"Compute\")` | inputlookup append=t previously_seen_cloud_regions | stats min(firstTime) as firstTime max(lastTime) as lastTime, values(dest) as dest by region, src_user | multireport [| table region, firstTime, lastTime | outputlookup previously_seen_cloud_regions | where fact=fiction][| eval new_region=if(firstTime >= relative_time(now(), `previously_seen_cloud_regions_search_window_begin_offset`), 1, 0) | where new_region=1 | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`] | table region, dest, src_user, firstTime, lastTime",
            "search_name": "ESCU - Cloud Compute Instance Started In Previously Unused Region - Rule",
            "story": "3b96d13c-fdc7-45dd-b3ad-c132b31cdd2a",
            "tags": {
                "analytics_story": [
                    "Cloud Cryptomining"
                ],
                "asset_type": "Cloud Compute Instance",
                "cis20": [
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_instance_modified_by_previously_unseen_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Instance Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-07-29",
                    "description": "This search builds a table of previously seen users that have modified a cloud instance.",
                    "how_to_implement": "You must be ingesting the approrpiate cloud infrastructure logs and have the latest Change Datamodel accelerated.",
                    "id": "f36dc403-739d-42f3-83a3-49237d8654c5",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_instance_modifications_by_user",
                            "description": "A table of users seen making instance modifications, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                            "name": "previously_seen_cloud_instance_modifications_by_user"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_instance_modifications_by_user___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Instance Modifications By User - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=modified All_Changes.change_type=EC2 All_Changes.status=success by All_Changes.user | `drop_dm_object_name(\"All_Changes\")` | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | outputlookup previously_seen_cloud_instance_modifications_by_user",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Instance Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Instance Modified By Previously Unseen User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-07-29",
                    "description": "This search updates a table of previously seen Cloud Instance modifications that have been made by a user",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs. To add or remove APIs that modify an EC2 instance, edit the macro `ec2_modification_api_calls`.",
                    "id": "534b7d30-7b0c-4510-8f55-65439850d58d",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_instance_modifications_by_user",
                            "description": "A table of users seen making instance modifications, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                            "name": "previously_seen_cloud_instance_modifications_by_user"
                        },
                        {
                            "collection": "previously_seen_cloud_instance_modifications_by_user",
                            "description": "A table of users seen making instance modifications, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                            "name": "previously_seen_cloud_instance_modifications_by_user"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_instance_modifications_by_user___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Instance Modifications By User - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where All_Changes.action=modified All_Changes.change_type=EC2 All_Changes.status=success by All_Changes.user | `drop_dm_object_name(\"All_Changes\")` | inputlookup append=t previously_seen_cloud_instance_modifications_by_user | stats min(firstTimeSeen) as firstTimeSeen max(lastTimeSeen) as lastTimeSeen by user | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_compute_images_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | outputlookup previously_seen_cloud_instance_modifications_by_user",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Instance Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Instance Modified By Previously Unseen User"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_instance_modified_by_previously_unseen_user",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-07-29",
            "description": "This search looks for cloud instances being modified by users who have not previously modified them.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "This search has a dependency on other searches to create and update a baseline of users observed to be associated with this activity. The search \"Previously Seen Cloud Instance Modifications By User - Update\" should be enabled for this detection to properly work.",
            "highlight": "No",
            "how_to_implement": "This search has a dependency on other searches to create and update a baseline of users observed to be associated with this activity. The search \"Previously Seen Cloud Instance Modifications By User - Update\" should be enabled for this detection to properly work.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_instance_modified_by_previously_unseen_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "It's possible that a new user will start to modify EC2 instances when they haven't before for any number of reasons. Verify with the user that is modifying instances that this is the intended behavior.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_instance_modifications_by_user",
                    "description": "A table of users seen making instance modifications, and the first and last time that the activity was observed",
                    "fields_list": "_key, firstTimeSeen, lastTimeSeen, user, enough_data",
                    "name": "previously_seen_cloud_instance_modifications_by_user"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_instance_modified_by_previously_unseen_user_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Cloud Instance Modified By Previously Unseen User",
            "references": [],
            "released": "2020-07-29",
            "search": "| tstats `security_content_summariesonly` count earliest(_time) as firstTime, latest(_time) as lastTime values(All_Changes.object_id) as object_id values(All_Changes.command) as command from datamodel=Change where All_Changes.action=modified All_Changes.change_type=EC2 All_Changes.status=success by All_Changes.user | `drop_dm_object_name(\"All_Changes\")` | lookup previously_seen_cloud_instance_modifications_by_user user as user OUTPUTNEW firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenUser=min(firstTimeSeen) | where isnull(firstTimeSeenUser) OR firstTimeSeenUser > relative_time(now(), \"-24h@h\") | table firstTime user command object_id count | `security_content_ctime(firstTime)` | `cloud_instance_modified_by_previously_unseen_user_filter`",
            "search_name": "ESCU - Cloud Instance Modified By Previously Unseen User - Rule",
            "story": "8168ca88-392e-42f4-85a2-767579c660ce",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Instance Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_network_access_control_list_deleted": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Cloud Network ACL Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Instance",
            "author": "Peter Gael, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_network_access_control_list_deleted",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-09-08",
            "description": "Enforcing network-access controls is one of the defensive mechanisms used by cloud administrators to restrict access to a cloud instance. After the attacker has gained control of the console by compromising an admin account, they can delete a network ACL and gain access to the instance from anywhere. This search will query the Change datamodel to detect users deleting network ACLs.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 11",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You can also provide additional filtering for this search by customizing the `cloud_network_access_control_list_deleted_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You can also provide additional filtering for this search by customizing the `cloud_network_access_control_list_deleted_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_network_access_control_list_deleted",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "It's possible that a user has legitimately deleted a network ACL.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_network_access_control_list_deleted_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Cloud Network Access Control List Deleted",
            "references": [],
            "released": "2020-09-08",
            "search": "`cloudtrail` eventName=DeleteNetworkAcl|rename userIdentity.arn as arn  | stats count min(_time) as firstTime max(_time) as lastTime values(errorMessage) values(errorCode) values(userAgent) values(userIdentity.*) by src userName arn eventName | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `cloud_network_access_control_list_deleted_filter`",
            "search_name": "ESCU - Cloud Network Access Control List Deleted - Rule",
            "security_domain": "network",
            "story": "",
            "tags": {
                "analytics_story": [
                    "Cloud Network ACL Activity"
                ],
                "asset_type": "Instance",
                "cis20": [
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_provisioning_activity_from_previously_unseen_city": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-19",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something. This table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "4ce865fc-f43e-4521-a8ed-ab8af99052d7",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-08-20",
                    "description": "This returns the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity within the last day. Cloud provisioning is broadly defined as any event that runs or creates something.  It then updates this information with historical data and filters out locations that have not been seen within the specified time window. This updated table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "9830abb9-be80-4563-b232-09bf1f628cf3",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        },
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | table src, firstTimeSeen, lastTimeSeen, City, Country, Region | inputlookup previously_seen_cloud_provisioning_activity_sources append=t | stats min(firstTimeSeen) as firstTimeSeen, max(lastTimeSeen) as lastTimeSeen by src, City, Country, Region | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_provisioning_activity_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_provisioning_activity_from_previously_unseen_city",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-10-09",
            "description": "This search looks for cloud provisioning activities from previously unseen cities. Provisioning activities are defined broadly as any event that runs or creates something.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_city_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_city_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_provisioning_activity_from_previously_unseen_city",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching within, plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new IP address is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_provisioning_activity_sources",
                    "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                    "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                    "name": "previously_seen_cloud_provisioning_activity_sources"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "\"-70m@m\"",
                    "description": "Use this macro to determine how far back you should be checking for new provisioning activities",
                    "name": "previously_unseen_cloud_provisioning_activity_window"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_provisioning_activity_from_previously_unseen_city_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "Cloud Provisioning Activity From Previously Unseen City",
            "references": [],
            "released": "2020-10-09",
            "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src, All_Changes.user, All_Changes.object, All_Changes.command | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(City) | lookup previously_seen_cloud_provisioning_activity_sources City as City OUTPUT firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenCity=min(firstTimeSeen) | where isnull(firstTimeSeenCity) OR firstTimeSeenCity > relative_time(now(), `previously_unseen_cloud_provisioning_activity_window`) | table firstTime, src, City, user, object, command | `cloud_provisioning_activity_from_previously_unseen_city_filter` | `security_content_ctime(firstTime)`",
            "search_name": "ESCU - Cloud Provisioning Activity From Previously Unseen City - Rule",
            "story": "51045ded-1575-4ba6-aef7-af6c73cffd86",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_provisioning_activity_from_previously_unseen_country": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-19",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something. This table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "4ce865fc-f43e-4521-a8ed-ab8af99052d7",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-08-20",
                    "description": "This returns the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity within the last day. Cloud provisioning is broadly defined as any event that runs or creates something.  It then updates this information with historical data and filters out locations that have not been seen within the specified time window. This updated table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "9830abb9-be80-4563-b232-09bf1f628cf3",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        },
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | table src, firstTimeSeen, lastTimeSeen, City, Country, Region | inputlookup previously_seen_cloud_provisioning_activity_sources append=t | stats min(firstTimeSeen) as firstTimeSeen, max(lastTimeSeen) as lastTimeSeen by src, City, Country, Region | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_provisioning_activity_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_provisioning_activity_from_previously_unseen_country",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-10-09",
            "description": "This search looks for cloud provisioning activities from previously unseen countries. Provisioning activities are defined broadly as any event that runs or creates something.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_country_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_country_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_provisioning_activity_from_previously_unseen_country",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching within, plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new IP address is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_provisioning_activity_sources",
                    "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                    "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                    "name": "previously_seen_cloud_provisioning_activity_sources"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_provisioning_activity_from_previously_unseen_country_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "Cloud Provisioning Activity From Previously Unseen Country",
            "references": [],
            "released": "2020-10-09",
            "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src, All_Changes.user, All_Changes.object, All_Changes.command | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | lookup previously_seen_cloud_provisioning_activity_sources Country as Country OUTPUT firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenCountry=min(firstTimeSeen) | where isnull(firstTimeSeenCountry) OR firstTimeSeenCountry > relative_time(now(), \"-24h@h\") | table firstTime, src, Country, user, object, command | `cloud_provisioning_activity_from_previously_unseen_country_filter` | `security_content_ctime(firstTime)`",
            "search_name": "ESCU - Cloud Provisioning Activity From Previously Unseen Country - Rule",
            "story": "51045ded-1575-4ba6-aef7-af6c73cffd86",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_provisioning_activity_from_previously_unseen_ip_address": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-19",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something. This table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "4ce865fc-f43e-4521-a8ed-ab8af99052d7",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-08-20",
                    "description": "This returns the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity within the last day. Cloud provisioning is broadly defined as any event that runs or creates something.  It then updates this information with historical data and filters out locations that have not been seen within the specified time window. This updated table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "9830abb9-be80-4563-b232-09bf1f628cf3",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        },
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | table src, firstTimeSeen, lastTimeSeen, City, Country, Region | inputlookup previously_seen_cloud_provisioning_activity_sources append=t | stats min(firstTimeSeen) as firstTimeSeen, max(lastTimeSeen) as lastTimeSeen by src, City, Country, Region | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_provisioning_activity_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_provisioning_activity_from_previously_unseen_ip_address",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-08-16",
            "description": "This search looks for cloud provisioning activities from previously unseen IP addresses. Provisioning activities are defined broadly as any event that runs or creates something.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_ip_address_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_ip_address_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_provisioning_activity_from_previously_unseen_ip_address",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching within, plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new IP address is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_provisioning_activity_sources",
                    "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                    "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                    "name": "previously_seen_cloud_provisioning_activity_sources"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "\"-70m@m\"",
                    "description": "Use this macro to determine how far back you should be checking for new provisioning activities",
                    "name": "previously_unseen_cloud_provisioning_activity_window"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_provisioning_activity_from_previously_unseen_ip_address_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "Cloud Provisioning Activity From Previously Unseen IP Address",
            "references": [],
            "released": "2020-08-16",
            "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime, values(All_Changes.object_id) as object_id from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src, All_Changes.user, All_Changes.command | `drop_dm_object_name(\"All_Changes\")` | lookup previously_seen_cloud_provisioning_activity_sources src as src OUTPUT firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenSrc=min(firstTimeSeen) | where isnull(firstTimeSeenSrc) OR firstTimeSeenSrc > relative_time(now(), `previously_unseen_cloud_provisioning_activity_window`) | table firstTime, src, user, object_id, command | `cloud_provisioning_activity_from_previously_unseen_ip_address_filter` | `security_content_ctime(firstTime)`",
            "search_name": "ESCU - Cloud Provisioning Activity From Previously Unseen IP Address - Rule",
            "story": "51045ded-1575-4ba6-aef7-af6c73cffd86",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "cloud_provisioning_activity_from_previously_unseen_region": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Provisioning Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-08-19",
                    "description": "This search builds a table of the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity. This is broadly defined as any event that runs or creates something. This table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "4ce865fc-f43e-4521-a8ed-ab8af99052d7",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Initial",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-08-20",
                    "description": "This returns the first and last times seen for every IP address (along with its physical location) previously associated with cloud-provisioning activity within the last day. Cloud provisioning is broadly defined as any event that runs or creates something.  It then updates this information with historical data and filters out locations that have not been seen within the specified time window. This updated table is then cached.",
                    "how_to_implement": "You must be ingesting Cloud infrastructure logs from your cloud provider.",
                    "id": "9830abb9-be80-4563-b232-09bf1f628cf3",
                    "lookups": [
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        },
                        {
                            "collection": "previously_seen_cloud_provisioning_activity_sources",
                            "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                            "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                            "name": "previously_seen_cloud_provisioning_activity_sources"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_cloud_provisioning_activity_sources___update_filter"
                        }
                    ],
                    "name": "Previously Seen Cloud Provisioning Activity Sources - Update",
                    "search": "| tstats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Country) | table src, firstTimeSeen, lastTimeSeen, City, Country, Region | inputlookup previously_seen_cloud_provisioning_activity_sources append=t | stats min(firstTimeSeen) as firstTimeSeen, max(lastTimeSeen) as lastTimeSeen by src, City, Country, Region | where lastTimeSeen > relative_time(now(), `previously_seen_cloud_provisioning_activity_forget_window`) | eventstats min(firstTimeSeen) as globalFirstTime | eval enough_data = if(globalFirstTime <= relative_time(now(), \"-7d@d\"), 1, 0) | table src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data | outputlookup previously_seen_cloud_provisioning_activity_sources",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Provisioning Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Cloud Provisioning Activity From Previously Unseen IP Address",
                            "Cloud Provisioning Activity From Previously Unseen City",
                            "Cloud Provisioning Activity From Previously Unseen Country",
                            "Cloud Provisioning Activity From Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=cloud_provisioning_activity_from_previously_unseen_region",
            "data_source_categories": "Other",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-08-16",
            "description": "This search looks for cloud provisioning activities from previously unseen regions. Provisioning activities are defined broadly as any event that runs or creates something.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_region_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider.  You should run the baseline search `Previously Seen Cloud Provisioning Activity Sources - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen Cloud Provisioning Activity Sources - Update` to keep this table up to date and to age out old data. You can adjust the time window for this search by updating the `previously_unseen_cloud_provisioning_activity_window` macro. You can also provide additional filtering for this search by customizing the `cloud_provisioning_activity_from_previously_unseen_region_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "cloud_provisioning_activity_from_previously_unseen_region",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching within, plus what is stored in the cache feature. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.\\\n This search will fire any time a new IP address is seen in the **GeoIP** database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of **MaxMind GeoIP** that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.",
            "lookups": [
                {
                    "collection": "previously_seen_cloud_provisioning_activity_sources",
                    "description": "A table of source IPs, geographic locations, and the first and last time that they have that done cloud provisioning activities",
                    "fields_list": "_key, src, City, Country, Region, firstTimeSeen, lastTimeSeen, enough_data",
                    "name": "previously_seen_cloud_provisioning_activity_sources"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "\"-70m@m\"",
                    "description": "Use this macro to determine how far back you should be checking for new provisioning activities",
                    "name": "previously_unseen_cloud_provisioning_activity_window"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "cloud_provisioning_activity_from_previously_unseen_region_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "Cloud Provisioning Activity From Previously Unseen Region",
            "references": [],
            "released": "2020-08-16",
            "search": "| tstats earliest(_time) as firstTime, latest(_time) as lastTime from datamodel=Change where (All_Changes.action=started OR All_Changes.action=created) All_Changes.status=success by All_Changes.src, All_Changes.user, All_Changes.object, All_Changes.command | `drop_dm_object_name(\"All_Changes\")` | iplocation src | where isnotnull(Region) | lookup previously_seen_cloud_provisioning_activity_sources Region as Region OUTPUT firstTimeSeen, enough_data | eventstats max(enough_data) as enough_data | where enough_data=1 | eval firstTimeSeenRegion=min(firstTimeSeen) | where isnull(firstTimeSeenRegion) OR firstTimeSeenRegion > relative_time(now(), `previously_unseen_cloud_provisioning_activity_window`) | table firstTime, src, Region, user, object, command | `cloud_provisioning_activity_from_previously_unseen_region_filter` | `security_content_ctime(firstTime)`",
            "search_name": "ESCU - Cloud Provisioning Activity From Previously Unseen Region - Rule",
            "story": "51045ded-1575-4ba6-aef7-af6c73cffd86",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Provisioning Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 1"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "codeword_threshold_departments": {
            "SPLEase": "Medium",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Codeword Threshold Departments - Demo",
            "data_source_categories": "DS014WebServer-ET02InternalKnowledgeManagement",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "<p>Find users trying to collect and analyze internal projects from across multiple departments by analyzing their search logs on company wiki software.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Codeword Threshold Departments - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Codeword Threshold Departments - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Confluence (an internal wiki software) logs centered around a few users for two months.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>There are two key components of implementing this particular detection. First, you need to make sure that you have the right Confluence logs -- run the base search, or look for confluence logs in your environment by searching for something like dositesearch (that's how I found them!) and record the index and sourcetype. If you use a different internal wiki (like Sharepoint), then you will need to alter the search to pull the search logs for that system. The second piece is harder -- in order to find project code names being searched in your logs, you have to know what those code names are (and for this detection, what department they belong to). You will have to reach out to different departments in your organization to find this knowledge, but once you have it you can mirror the format of the sample sse_project_codenames lookup.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "Because we're using a static threshold here for the number of different departments, you would need to adjust this threshold to suit your organization. Because these types of events are inherently fairly bursty (someone catches up on their email, someone switches into a project management role, etc.) it's difficult to use ML to solve for it but relatively easy to understand it given business context. This alert, in isolation, is often benign for exactly the reasons listed above. ",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213",
            "name": "User Finding Project Code Names from Many Departments",
            "operationalize": "Because these activities can be benign (see Known False Positives), look for other indications of suspicious behavior with this user, or validate with their management or HR that the behavior is expected.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/codeword_threshold_departments.png",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "common_ransomware_extensions": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware|Ryuk Ransonware|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=common_ransomware_extensions",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/ransomware_extensions/windows-sysmon.log"
            ],
            "date": "2020-11-09",
            "description": "The search looks for file modifications with extensions commonly used by Ransomware",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.\\\nThis search produces fields (`query`,`query_length`,`count`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** Name, **Field:** Name\\\n1. \\\n1. **Label:** File Extension, **Field:** file_extension\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.\\\nThis search produces fields (`query`,`query_length`,`count`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** Name, **Field:** Name\\\n1. \\\n1. **Label:** File Extension, **Field:** file_extension\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "common_ransomware_extensions",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It is possible for a legitimate file with these extensions to be created. If this is a true ransomware attack, there will be a large number of files created with these extensions.",
            "lookups": "",
            "macros": [
                {
                    "definition": "lookup update=true ransomware_extensions_lookup Extensions AS file_extension OUTPUT Name | search Name !=False",
                    "description": "This macro limits the output to files that have extensions associated with ransomware",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/ransomware_extensions.csv",
                            "default_match": "false",
                            "description": "A list of file extensions that are associated with ransomware",
                            "filename": "ransomware_extensions.csv",
                            "min_matches": 1,
                            "name": "ransomware_extensions_lookup"
                        }
                    ],
                    "name": "ransomware_extensions"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "common_ransomware_extensions_filter"
                }
            ],
            "mitre_sub_technique": "T1485",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1485",
            "mitre_threat_groups": "Sandworm Team|Lazarus Group|APT38",
            "name": "Common Ransomware Extensions",
            "references": [],
            "released": "2020-11-09",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`| rex field=file_name \"(?<file_extension>\\.[^\\.]+)$\" | `ransomware_extensions` | `common_ransomware_extensions_filter`",
            "search_name": "ESCU - Common Ransomware Extensions - Rule",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware",
                    "Ryuk Ransonware",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/ransomware_extensions/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Lazarus Group",
                    "APT38"
                ],
                "mitre_attack_id": [
                    "T1485"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Data Destruction"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "common_ransomware_notes": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware|Ransomware|Ryuk Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=common_ransomware_notes",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/ransomware_notes/windows-sysmon.log"
            ],
            "date": "2020-11-09",
            "description": "The search looks for files created with names matching those typically used in ransomware notes that tell the victim how to get their data back.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records file-system activity from your hosts to populate the Endpoint Filesystem data-model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file-system reads and writes.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records file-system activity from your hosts to populate the Endpoint Filesystem data-model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file-system reads and writes.",
            "icon": "ES_Use_Case.png",
            "id": "common_ransomware_notes",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It's possible that a legitimate file could be created with the same name used by ransomware note files.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "lookup ransomware_notes_lookup ransomware_notes as file_name OUTPUT status as \"Known Ransomware Notes\" | search \"Known Ransomware Notes\"=True",
                    "description": "This macro limits the output to files that have been identified as a ransomware note",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/ransomware_notes.csv",
                            "default_match": "false",
                            "description": "A list of file names that are ransomware note files",
                            "filename": "ransomware_notes.csv",
                            "match_type": "WILDCARD(ransomware_notes)",
                            "min_matches": 1,
                            "name": "ransomware_notes_lookup"
                        }
                    ],
                    "name": "ransomware_notes"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "common_ransomware_notes_filter"
                }
            ],
            "mitre_sub_technique": "T1485",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1485",
            "mitre_threat_groups": "Sandworm Team|Lazarus Group|APT38",
            "name": "Common Ransomware Notes",
            "references": [],
            "released": "2020-11-09",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `ransomware_notes` | `common_ransomware_notes_filter`",
            "search_name": "ESCU - Common Ransomware Notes - Rule",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604|cf309d0d-d4aa-4fbb-963d-1e79febd3756|507edc74-13d5-4339-878e-b9744ded1f35",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware",
                    "Ransomware",
                    "Ryuk Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/ransomware_notes/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Lazarus Group",
                    "APT38"
                ],
                "mitre_attack_id": [
                    "T1485"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Data Destruction"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "completely_inactive_account": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Discovers accounts that are no longer used. Unused accounts should be disabled and are oftentimes used by attackers to gain unauthorized access.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0001|TA0004|TA0003",
            "mitre_technique": "|T1078",
            "name": "Completely Inactive Account",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Completely Inactive Account - Rule",
            "usecase": "Compliance|Security Monitoring"
        },
        "concurrent_login_attempts_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics|Account Sharing|Account Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Alerts on concurrent access attempts to an app from different hosts. These are good indicators of shared passwords and potential misuse.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0001|TA0004",
            "mitre_technique": "|T1078",
            "name": "Concurrent Login Attempts Detected",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "search_name": "Access - Concurrent App Accesses - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "create_local_admin_accounts_using_net_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=create_local_admin_accounts_using_net_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-security.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-system.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for the creation of local administrator accounts using net.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "create_local_admin_accounts_using_net_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Administrators often leverage net.exe to create admin accounts.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "create_local_admin_accounts_using_net_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1136.001",
            "mitre_tactic": "TA0003",
            "mitre_tactic_display": "Persistence",
            "mitre_technique": "T1136",
            "mitre_threat_groups": "APT39|APT41|Dragonfly 2.0|Leafminer|APT3",
            "name": "Create Local Admin Accounts Using Net Exe",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Processes.user) as user values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=net.exe OR Processes.process_name=net1.exe) AND (Processes.process=*localgroup* OR Processes.process=*/add* OR Processes.process=*user*) by Processes.process Processes.process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` |`create_local_admin_accounts_using_net_exe_filter` ",
            "search_name": "ESCU - Create local admin accounts using net exe - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-security.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-system.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "APT41",
                    "Dragonfly 2.0",
                    "Leafminer",
                    "APT3"
                ],
                "mitre_attack_id": [
                    "T1136"
                ],
                "mitre_attack_tactics": [
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Local Account"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "create_or_delete_windows_shares_using_net_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Hidden Cobra Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=create_or_delete_windows_shares_using_net_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.005/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for the creation or deletion of hidden shares using net.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "create_or_delete_windows_shares_using_net_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Administrators often leverage net.exe to create or delete network shares. You should verify that the activity was intentional and is legitimate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "create_or_delete_windows_shares_using_net_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1070.005",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1070",
            "mitre_threat_groups": "Threat Group-3390",
            "name": "Create Or Delete Windows Shares Using Net Exe",
            "references": [
                "https://attack.mitre.org/techniques/T1070/005"
            ],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Processes.user) as user values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processs.process_name=net.exe OR Processes.process_name=net1.exe) by Processes.process Processes.process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search process=*share* | `create_or_delete_windows_shares_using_net_exe_filter` ",
            "search_name": "ESCU - Create or delete windows shares using net exe - Rule",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335",
            "tags": {
                "analytics_story": [
                    "Hidden Cobra Malware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.005/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Threat Group-3390"
                ],
                "mitre_attack_id": [
                    "T1070"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Network Share Connection Removal"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 5
        },
        "create_remote_thread_into_lsass": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=create_remote_thread_into_lsass",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-06",
            "description": "Detect remote thread creation into LSASS consistent with credential dumping.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search needs Sysmon Logs with a Sysmon configuration, which includes EventCode 8 with lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "highlight": "No",
            "how_to_implement": "This search needs Sysmon Logs with a Sysmon configuration, which includes EventCode 8 with lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "icon": "ES_Use_Case.png",
            "id": "create_remote_thread_into_lsass",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Other tools can access LSASS for legitimate reasons and generate an event. In these cases, tweaking the search may help eliminate noise.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "create_remote_thread_into_lsass_filter"
                }
            ],
            "mitre_sub_technique": "T1003.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Sandworm Team|Whitefly|Blue Mockingbird|Silence|Threat Group-3390|Leviathan|APT41|Soft Cell|TEMP.Veles|APT33|APT39|Stolen Pencil|APT32|Lazarus Group|Leafminer|Magic Hound|MuddyWater|PLATINUM|FIN8|BRONZE BUTLER|OilRig|FIN6|APT3|APT28|APT1|Ke3chang|Cleaver",
            "name": "Create Remote Thread Into LSASS",
            "references": [
                "https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf"
            ],
            "released": "2019-12-06",
            "search": "`sysmon` EventID=8 TargetImage=*lsass.exe | stats count min(_time) as firstTime max(_time) as lastTime by Computer, EventCode, TargetImage, TargetProcessId | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `create_remote_thread_into_lsass_filter`",
            "search_name": "ESCU - Create Remote Thread into LSASS - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Whitefly",
                    "Blue Mockingbird",
                    "Silence",
                    "Threat Group-3390",
                    "Leviathan",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Stolen Pencil",
                    "APT32",
                    "Lazarus Group",
                    "Leafminer",
                    "Magic Hound",
                    "MuddyWater",
                    "PLATINUM",
                    "FIN8",
                    "BRONZE BUTLER",
                    "OilRig",
                    "FIN6",
                    "APT3",
                    "APT28",
                    "APT1",
                    "Ke3chang",
                    "Cleaver"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "LSASS Memory"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "creation_of_shadow_copy": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=creation_of_shadow_copy",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "hhttps://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-10",
            "description": "Monitor for signs that Ntdsutil, Vssadmin, or Wmic has been used to create a shadow copy.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "creation_of_shadow_copy",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Legtimate administrator usage of Ntdsutil, Vssadmin, or Wmic will create false positives.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "creation_of_shadow_copy_filter"
                }
            ],
            "mitre_sub_technique": "T1003.003",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "FIN6|Dragonfly 2.0",
            "name": "Creation Of Shadow Copy",
            "references": [
                "https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf"
            ],
            "released": "2019-12-10",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=ntdsutil.exe Processes.process=*ntds* Processes.process=*create*) OR (Processes.process_name=vssadmin.exe Processes.process=*create* Processes.process=*shadow*) OR (Processes.process_name=wmic.exe Processes.process=*shadowcopy* Processes.process=*create*) by Processes.dest Processes.user Processes.process_name Processes.process  Processes.parent_process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `creation_of_shadow_copy_filter`",
            "search_name": "ESCU - Creation of Shadow Copy - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "dataset": [
                    "hhttps://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "FIN6",
                    "Dragonfly 2.0"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "NTDS"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "creation_of_shadow_copy_with_wmic_and_powershell": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=creation_of_shadow_copy_with_wmic_and_powershell",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-10",
            "description": "This search detects the use of wmic and Powershell to create a shadow copy.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "creation_of_shadow_copy_with_wmic_and_powershell",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Legtimate administrator usage of wmic to create a shadow copy.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "creation_of_shadow_copy_with_wmic_and_powershell_filter"
                }
            ],
            "mitre_sub_technique": "T1003.003",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "FIN6|Dragonfly 2.0",
            "name": "Creation Of Shadow Copy With Wmic And Powershell",
            "references": [
                "https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf"
            ],
            "released": "2019-12-10",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=wmic* OR Processes.process_name=powershell* Processes.process=*shadowcopy* Processes.process=*create* by Processes.user Processes.process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `creation_of_shadow_copy_with_wmic_and_powershell_filter`",
            "search_name": "ESCU - Creation of Shadow Copy with wmic and powershell - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "FIN6",
                    "Dragonfly 2.0"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "NTDS"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "credential_dumping_via_copy_command_from_shadow_copy": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=credential_dumping_via_copy_command_from_shadow_copy",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-10",
            "description": "This search detects credential dumping using copy command from a shadow copy.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "credential_dumping_via_copy_command_from_shadow_copy",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "credential_dumping_via_copy_command_from_shadow_copy_filter"
                }
            ],
            "mitre_sub_technique": "T1003.003",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "FIN6|Dragonfly 2.0",
            "name": "Credential Dumping Via Copy Command From Shadow Copy",
            "references": [
                "https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf"
            ],
            "released": "2019-12-10",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe (Processes.process=*\\\\system32\\\\config\\\\sam* OR Processes.process=*\\\\system32\\\\config\\\\security* OR Processes.process=*\\\\system32\\\\config\\\\system* OR Processes.process=*\\\\windows\\\\ntds\\\\ntds.dit*) by Processes.dest Processes.user Processes.process_name Processes.process  Processes.parent_process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `credential_dumping_via_copy_command_from_shadow_copy_filter` ",
            "search_name": "ESCU - Credential Dumping via Copy Command from Shadow Copy - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "FIN6",
                    "Dragonfly 2.0"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "NTDS"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "credential_dumping_via_symlink_to_shadow_copy": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=credential_dumping_via_symlink_to_shadow_copy",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-10",
            "description": "This search detects the creation of a symlink to a shadow copy.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "credential_dumping_via_symlink_to_shadow_copy",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "credential_dumping_via_symlink_to_shadow_copy_filter"
                }
            ],
            "mitre_sub_technique": "T1003.003",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "FIN6|Dragonfly 2.0",
            "name": "Credential Dumping Via Symlink To Shadow Copy",
            "references": [
                "https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf"
            ],
            "released": "2019-12-10",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe Processes.process=*mklink* Processes.process=*HarddiskVolumeShadowCopy* by Processes.dest Processes.user Processes.process_name Processes.process  Processes.parent_process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `credential_dumping_via_symlink_to_shadow_copy_filter` ",
            "search_name": "ESCU - Credential Dumping via Symlink to Shadow Copy - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "FIN6",
                    "Dragonfly 2.0"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "NTDS"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "credentials_in_file_detected": {
            "SPLEase": "Hard",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Compliance|Data Exfiltration",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Credentials%20In%20File%20Detected%20-%20Live",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "description": "<p>Adversaries may dump credentials into local files using OS Credential Dumping or credentials might have been left in files by mistake. In cloud environments, authenticated user credentials are often stored in local configuration and credential files. This search looks for common credential patterns in log files in Splunk using a list of regexes in a lookup file. </p><p><b>Alert:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data|Endpoint",
            "examples": [
                {
                    "is_live_version": true,
                    "label": "Live Data",
                    "live_split_eligible": true,
                    "name": "Credentials In File Detected - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>The basic idea behind this search is to take a set of known credential patterns from a lookup file (credential_patterns.csv) and dynamically build up a statement for the rex command. This is a little known technique with SPL and has wide ranging applicability beyond this detection search.  If a match is found an additional round of matching occurs to find in which field you found the offending value. The last lines of the search is there to make it easy to read for the analyst. </p>",
            "highlight": "Yes",
            "howToImplement": "<p>By default this search looks for known log file dump locations but you might ewant to include or exclude certain location before deploying. You can also add/modify/disable the regex patterns in the lookup file credential_patterns.csv in order to get a better coverage or exclude false positive matches. Not that this search is very resource heavy and will run very slow. If you enable this search make sure that you keep the time window short or the schedule to be infrequent.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "<p>This search could trigger false positive if some of the credentials patterns match other strings that might exist in the files. If that is the case in your environment you can modify the lookup with the patterns to include or exclude certain patterns.</p>",
            "mitre": "Credential Access",
            "mitre_sub_technique": "T1552.001|T1552.004",
            "mitre_tactic": "TA0006",
            "mitre_technique": "T1552|T1212",
            "name": "Credentials In File Detected",
            "operationalize": "<p>This alert triggers when clear text credentials are found inside Splunk. It might indicate a mistake or an adversary performing credential dumping activities. Recommended next steps are to investigate why the credentials are in the file and how the file ended up in Splunk. </p>",
            "released": "3.2.0",
            "relevance": "Adversaries may dump credentials into local files using OS Credential Dumping or credentials might have been left in files by mistake. In cloud environments, authenticated user credentials are often stored in local configuration and credential files. This search looks for common credential patterns in log files in Splunk using a list of regexes in a lookup file. ",
            "searchKeywords": "credential|password|keys|rsa|token",
            "usecase": "Security Monitoring|Compliance"
        },
        "default_account_activity_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics|Endpoint Compromise|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Discovers use of default accounts (such as admin, administrator, etc.). Default accounts have default passwords and are therefore commonly targeted by attackers using brute force attack tools.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "gdprtext": "<h4>Problem:</h4><p>Default user accounts are often targeted for exploitation since they have administrative privileges on the host system, thereby enabling an attacker who gains access to the default account to use system resources how they see fit. Depending on the environment, default accounts may not be able to be deleted, and depending on corporate IT policy may have a no-use or limited-use restriction.</p><h4>Impact:</h4><p>The use of default accounts is often out of corporate IT compliance as in most cases no individual can be assigned to the activity happened. Using individual user accounts with administrator privileges in larger organizations with multiple system administrators, is a security best practice and service accounts should rarely be used. </p><p>Specific to GDPR, monitoring and demonstrating that security controls are effective is required by Article 32, therefore immediate awareness of any default account activity is critical to maintaining compliance posture and documenting such activity and remedial actions is required in order to prove compliance for data privacy audits initiated by data privacy authorities (Article 58) and also to help counteract compensation claims (Article 82).</p><h4>Resolution Path:</h4><p>Analyze default user accounts for activity that could be security issues \u2013 for example, creation of new accounts, modification in account or file privileges, or other unauthorized configuration changes that could indicate a threat. This helps maintain security posture, compliance, and provide early warning of a larger potential issue. </p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Default Account Activity Detected",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Default Account Usage - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "default_account_at_rest_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS015ConfigurationManagement-ET01General",
            "deprecated_not_used_anymore_datasource": "Configuration Management",
            "description": "Discovers the presence of default accounts even if they are not being used. Default accounts should be disabled in order to prevent an attacker from using them to gain unauthorized access to remote hosts.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "Cyber hygiene to clean up default accounts",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Default Account At Rest Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Default Accounts At Rest - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "deleting_shadow_copies": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Log Manipulation|SamSam Ransomware|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=deleting_shadow_copies",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1490/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-09",
            "description": "The vssadmin.exe utility is used to interact with the Volume Shadow Copy Service.  Wmic is an interface to the Windows Management Instrumentation.  This search looks for either of these tools being used to delete shadow copies.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 10",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "deleting_shadow_copies",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "vssadmin.exe and wmic.exe are standard applications shipped with modern versions of windows. They may be used by administrators to legitimately delete old backup copies, although this is typically rare.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "deleting_shadow_copies_filter"
                }
            ],
            "mitre_sub_technique": "T1490",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1490",
            "mitre_threat_groups": "no",
            "name": "Deleting Shadow Copies",
            "references": [],
            "released": "2020-11-09",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=vssadmin.exe OR Processes.process_name=wmic.exe) Processes.process=*delete* Processes.process=*shadow* by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `deleting_shadow_copies_filter`",
            "search_name": "ESCU - Deleting Shadow Copies - Rule",
            "story": "b6db2c60-a281-48b4-95f1-2cd99ed56835|c4b89506-fbcf-4cb7-bfd6-527e54789604|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Windows Log Manipulation",
                    "SamSam Ransomware",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 10"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1490/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1490"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Inhibit System Recovery"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "detect_activity_related_to_pass_the_hash_attacks": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Lateral Movement",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Lateral Movement",
            "dashboard": "showcase_security_content?showcaseId=detect_activity_related_to_pass_the_hash_attacks",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1550.002/atomic_red_team/windows-security.log"
            ],
            "date": "2020-10-15",
            "description": "This search looks for specific authentication events from the Windows Security Event logs to detect potential attempts at using the Pass-the-Hash technique.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 16",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must ingest your Windows Security Event logs and leverage the latest TA for Windows.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must ingest your Windows Security Event logs and leverage the latest TA for Windows.",
            "icon": "ES_Use_Case.png",
            "id": "detect_activity_related_to_pass_the_hash_attacks",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Legitimate logon activity by authorized NTLM systems may be detected by this search. Please investigate as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "eventtype=wineventlog_security",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_security"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_activity_related_to_pass_the_hash_attacks_filter"
                }
            ],
            "mitre_sub_technique": "T1550.002",
            "mitre_tactic": "TA0005|TA0008",
            "mitre_tactic_display": "Defense Evasion|Lateral Movement",
            "mitre_technique": "T1550",
            "mitre_threat_groups": "Soft Cell|APT32|Night Dragon|APT28|APT1",
            "name": "Detect Activity Related To Pass The Hash Attacks",
            "references": [],
            "released": "2020-10-15",
            "search": "`wineventlog_security` EventCode=4624 (Logon_Type=3 Logon_Process=NtLmSsp WorkstationName=WORKSTATION NOT AccountName=\"ANONYMOUS LOGON\") OR (Logon_Type=9 Logon_Process=seclogo) | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by EventCode, Logon_Type, WorkstationName, user, dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_activity_related_to_pass_the_hash_attacks_filter` ",
            "search_name": "ESCU - Detect Activity Related to Pass the Hash Attacks - Rule",
            "story": "399d65dc-1f08-499b-a259-aad9051f38ad",
            "tags": {
                "analytics_story": [
                    "Lateral Movement"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1550.002/atomic_red_team/windows-security.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Soft Cell",
                    "APT32",
                    "Night Dragon",
                    "APT28",
                    "APT1"
                ],
                "mitre_attack_id": [
                    "T1550"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "Pass the Hash"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "access"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "detect_api_activity_from_users_without_mfa": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS User Monitoring",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_api_activity_from_users_without_mfa",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-05-17",
            "description": "This search looks for CloudTrail events where a user logged into the AWS account, is making API calls and has not enabled Multi Factor authentication. Multi factor authentication adds a layer of security by forcing the users to type a unique authentication code from an approved authentication device when they access AWS websites or services. AWS Best Practices recommend that you enable MFA for privileged IAM users.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|PR.AC",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Leverage the support search `Create a list of approved AWS service accounts`: run it once every 30 days to create a list of service accounts and validate them.\\\nThis search produces fields (`eventName`,`userIdentity.type`,`userIdentity.arn`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** AWS Event Name, **Field:** eventName\\\n1. \\\n1. **Label:** AWS User ARN, **Field:** userIdentity.arn\\\n1. \\\n1. **Label:** AWS User Type, **Field:** userIdentity.type\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Leverage the support search `Create a list of approved AWS service accounts`: run it once every 30 days to create a list of service accounts and validate them.\\\nThis search produces fields (`eventName`,`userIdentity.type`,`userIdentity.arn`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** AWS Event Name, **Field:** eventName\\\n1. \\\n1. **Label:** AWS User ARN, **Field:** userIdentity.arn\\\n1. \\\n1. **Label:** AWS User Type, **Field:** userIdentity.type\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "detect_api_activity_from_users_without_mfa",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "Many service accounts configured within an AWS infrastructure do not have multi factor authentication enabled. Please ignore the service accounts, if triggered and instead add them to the aws_service_accounts.csv file to fine tune the detection. It is also possible that the search detects users in your environment using Single Sign-On systems, since the MFA is not handled by AWS.",
            "lookups": [
                {
                    "description": "A lookup file that will contain AWS Service accounts",
                    "filename": "aws_service_accounts.csv",
                    "name": "aws_service_accounts"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_api_activity_from_users_without_mfa_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect API Activity From Users Without Mfa",
            "references": [],
            "released": "2018-05-17",
            "search": "`cloudtrail` userIdentity.sessionContext.attributes.mfaAuthenticated=false | search NOT [| inputlookup aws_service_accounts | fields identity | rename identity as user]| stats  count min(_time) as firstTime max(_time) as lastTime values(eventName) as eventName by userIdentity.arn userIdentity.type user | `security_content_ctime(firstTime)`  | `security_content_ctime(lastTime)` | `detect_api_activity_from_users_without_mfa_filter`",
            "search_name": "ESCU - Detect API activity from users without MFA - Rule",
            "security_domain": "network",
            "story": "2e8948a5-5239-406b-b56b-6c50f1269af3",
            "tags": {
                "analytics_story": [
                    "AWS User Monitoring"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 16"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "PR.AC"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_arp_poisoning": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Router and Infrastructure Security",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Mikael Bjerkeland, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_arp_poisoning",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2020-08-11",
            "description": "By enabling Dynamic ARP Inspection as a Layer 2 Security measure on the organization's network devices, we will be able to detect ARP Poisoning attacks in the Infrastructure.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 11",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with DHCP Snooping (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960x/software/15-0_2_EX/security/configuration_guide/b_sec_152ex_2960-x_cg/b_sec_152ex_2960-x_cg_chapter_01101.html) and Dynamic ARP Inspection (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960x/software/15-2_2_e/security/configuration_guide/b_sec_1522e_2960x_cg/b_sec_1522e_2960x_cg_chapter_01111.html) and log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "highlight": "No",
            "how_to_implement": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with DHCP Snooping (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960x/software/15-0_2_EX/security/configuration_guide/b_sec_152ex_2960-x_cg/b_sec_152ex_2960-x_cg_chapter_01101.html) and Dynamic ARP Inspection (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960x/software/15-2_2_e/security/configuration_guide/b_sec_1522e_2960x_cg/b_sec_1522e_2960x_cg_chapter_01111.html) and log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "icon": "ES_Use_Case.png",
            "id": "detect_arp_poisoning",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "",
            "known_false_positives": "This search might be prone to high false positives if DHCP Snooping or ARP inspection has been incorrectly configured, or if a device normally sends many ARP packets (unlikely).",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=cisco_ios",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cisco_networks"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_arp_poisoning_filter"
                }
            ],
            "mitre_sub_technique": "T1200|T1498|T1557.002",
            "mitre_tactic": "TA0001|TA0040",
            "mitre_tactic_display": "Initial Access|Impact",
            "mitre_technique": "T1200|T1498|T1557",
            "mitre_threat_groups": "DarkVishnya|no",
            "name": "Detect Arp Poisoning",
            "references": [],
            "released": "2020-08-11",
            "search": "`cisco_networks` facility=\"PM\" mnemonic=\"ERR_DISABLE\" disable_cause=\"arp-inspection\" | eval src_interface=src_int_prefix_long+src_int_suffix | stats min(_time) AS firstTime max(_time) AS lastTime count BY host src_interface | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`| `detect_arp_poisoning_filter`",
            "search_name": "ESCU - Detect ARP Poisoning - Rule",
            "story": "91c676cf-0b23-438d-abee-f6335e177e77",
            "tags": {
                "analytics_story": [
                    "Router and Infrastructure Security"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 1",
                    "CIS 11"
                ],
                "detection_name": "Detect ARP Poisoning",
                "kill_chain_phases": [
                    "Reconnaissance",
                    "Delivery",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "DarkVishnya",
                    "no"
                ],
                "mitre_attack_id": [
                    "T1200",
                    "T1498",
                    "T1557"
                ],
                "mitre_attack_tactics": [
                    "Initial Access",
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Hardware Additions",
                    "Network Denial of Service"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_attackers_scanning_for_vulnerable_jboss_servers": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "JBoss Vulnerability|SamSam Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Web Server",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Scanning",
            "dashboard": "showcase_security_content?showcaseId=detect_attackers_scanning_for_vulnerable_jboss_servers",
            "data_source_categories": "DS014WebServer-ET01Access",
            "datamodel": "Web",
            "dataset": "",
            "date": "2017-09-23",
            "description": "This search looks for specific GET or HEAD requests to web servers that are indicative of reconnaissance attempts to identify vulnerable JBoss servers. JexBoss is described as the exploit tool of choice for this malicious activity.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must be ingesting data from the web server or network traffic that contains web specific information, and populating the Web data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data from the web server or network traffic that contains web specific information, and populating the Web data model.",
            "icon": "ES_Use_Case.png",
            "id": "detect_attackers_scanning_for_vulnerable_jboss_servers",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Reconnaissance",
            "known_false_positives": "It's possible for legitimate HTTP requests to be made to URLs containing the suspicious paths.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_attackers_scanning_for_vulnerable_jboss_servers_filter"
                }
            ],
            "mitre_sub_technique": "T1082",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1082",
            "mitre_threat_groups": "Rocke|Sandworm Team|Blue Mockingbird|Tropic Trooper|Frankenstein|Inception|Kimsuky|Darkhotel|MuddyWater|APT18|Honeybee|APT19|APT37|APT32|Magic Hound|OilRig|APT3|Sowbug|Gamaredon Group|Patchwork|Stealth Falcon|Lazarus Group|admin@338|Turla|Ke3chang",
            "name": "Detect Attackers Scanning For Vulnerable Jboss Servers",
            "references": [],
            "released": "2017-09-23",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where (Web.http_method=\"GET\" OR Web.http_method=\"HEAD\") AND (Web.url=\"*/web-console/ServerInfo.jsp*\" OR Web.url=\"*web-console*\" OR Web.url=\"*jmx-console*\" OR Web.url = \"*invoker*\") by Web.http_method, Web.url, Web.src, Web.dest | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `detect_attackers_scanning_for_vulnerable_jboss_servers_filter`",
            "search_name": "ESCU - Detect attackers scanning for vulnerable JBoss servers - Rule",
            "story": "1f5294cb-b85f-4c2d-9c58-ffcf248f52bd|c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "tags": {
                "analytics_story": [
                    "JBoss Vulnerability",
                    "SamSam Ransomware"
                ],
                "asset_type": "Web Server",
                "kill_chain_phases": [
                    "Reconnaissance"
                ],
                "mitre_attack_groups": [
                    "Rocke",
                    "Sandworm Team",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "Inception",
                    "Kimsuky",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "Honeybee",
                    "APT19",
                    "APT37",
                    "APT32",
                    "Magic Hound",
                    "OilRig",
                    "APT3",
                    "Sowbug",
                    "Gamaredon Group",
                    "Patchwork",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "admin@338",
                    "Turla",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1082"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "System Information Discovery"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_aws_api_activities_from_unapproved_accounts": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS User Monitoring",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-12-03",
                    "description": "This search looks for successful API activity in CloudTrail within the last 30 days, filters out known users from the identity table, and outputs values of users into `aws_service_accounts.csv` lookup file.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the service account entires in `aws_service_accounts.csv`, which is a lookup file created as a result of running this support search. Please remove the entries of service accounts that are not legitimate.",
                    "id": "fc0edc95-ff2b-48b1-5f6f-63ga3789fd43",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/aws_service_accounts.csv",
                            "description": "A lookup file that will contain AWS Service accounts",
                            "filename": "aws_service_accounts.csv",
                            "name": "aws_service_accounts"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "create_a_list_of_approved_aws_service_accounts_filter"
                        }
                    ],
                    "name": "Create a list of approved AWS service accounts",
                    "search": "`cloudtrail` errorCode=success | rename userName as identity | search NOT [inputlookup identity_lookup_expanded | fields identity] | stats count by identity | table identity | outputlookup aws_service_accounts | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS User Monitoring"
                        ],
                        "detections": [
                            "Detect AWS API Activities From Unapproved Accounts"
                        ]
                    },
                    "version": 2
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_aws_api_activities_from_unapproved_accounts",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for successful CloudTrail activity by user accounts that are not listed in the identity table or `aws_service_accounts.csv`. It returns event names and count, as well as the first and last time a specific user or service is detected, grouped by users.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.CM|PR.AC|ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You must also populate the `identity_lookup_expanded` lookup shipped with the Asset and Identity framework to be able to look up users in your identity table in Enterprise Security (ES). Leverage the support search called \"Create a list of approved AWS service accounts\": run it once every 30 days to create and validate a list of service accounts.\\\nThis search produces fields (`eventName`,`firstTime`,`lastTime`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** AWS Event Name, **Field:** eventName\\\n1. \\\n1. **Label:** First Time, **Field:** firstTime\\\n1. \\\n1. **Label:** Last Time, **Field:** lastTime\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You must also populate the `identity_lookup_expanded` lookup shipped with the Asset and Identity framework to be able to look up users in your identity table in Enterprise Security (ES). Leverage the support search called \"Create a list of approved AWS service accounts\": run it once every 30 days to create and validate a list of service accounts.\\\nThis search produces fields (`eventName`,`firstTime`,`lastTime`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** AWS Event Name, **Field:** eventName\\\n1. \\\n1. **Label:** First Time, **Field:** firstTime\\\n1. \\\n1. **Label:** Last Time, **Field:** lastTime\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "detect_aws_api_activities_from_unapproved_accounts",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It's likely that you'll find activity detected by users/service accounts that are not listed in the `identity_lookup_expanded` or ` aws_service_accounts.csv` file. If the user is a legitimate service account, update the `aws_service_accounts.csv` table with that entry.",
            "lookups": [
                {
                    "description": "A lookup file that will contain AWS Service accounts",
                    "filename": "aws_service_accounts.csv",
                    "name": "aws_service_accounts"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_aws_api_activities_from_unapproved_accounts_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Detect AWS API Activities From Unapproved Accounts",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` errorCode=success | rename userName as identity | search NOT [| inputlookup identity_lookup_expanded | fields identity] | search NOT [| inputlookup aws_service_accounts | fields identity] | rename identity as user | stats count min(_time) as firstTime max(_time) as lastTime values(eventName) as eventName by user | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `detect_aws_api_activities_from_unapproved_accounts_filter`",
            "search_name": "ESCU - Detect AWS API Activities From Unapproved Accounts - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50f1269af3",
            "tags": {
                "analytics_story": [
                    "AWS User Monitoring"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.AC",
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 15,
                "security_domain": "access"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_aws_console_login_by_new_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Authentication Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Users in CloudTrail - Initial",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___update_filter"
                        }
                    ],
                    "name": "Previously Seen Users In CloudTrail - Update",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_aws_console_login_by_new_user",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "Authentication",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-05-28",
            "description": "This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Run the `Previously Seen Users in CloudTrail` support search only once to create a baseline of previously seen IAM users within the last 30 days. Run `Update previously seen users in CloudTrail` hourly (or more frequently depending on how often you run the detection searches) to refresh the baselines.",
            "highlight": "No",
            "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Run the `Previously Seen Users in CloudTrail` support search only once to create a baseline of previously seen IAM users within the last 30 days. Run `Update previously seen users in CloudTrail` hourly (or more frequently depending on how often you run the detection searches) to refresh the baselines.",
            "icon": "ES_Use_Case.png",
            "id": "detect_aws_console_login_by_new_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "When a legitimate new user logins for the first time, this activity will be detected. Check how old the account is and verify that the user activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_users_console_logins",
                    "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                    "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                    "name": "previously_seen_users_console_logins"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_aws_console_login_by_new_user_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect AWS Console Login By New User",
            "references": "",
            "released": "2020-05-28",
            "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user | `drop_dm_object_name(Authentication)` | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user | eval userStatus=if(firstTime >=relative_time(now(),\"-24h@h\"), \"First Time Logging into AWS Console\", \"Previously Seen User\") |where userStatus=\"First Time Logging into AWS Console\" |  `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `detect_aws_console_login_by_new_user_filter`",
            "search_name": "ESCU - Detect AWS Console Login by New User - Rule",
            "security_domain": "network",
            "story": "6380ebbb-55c5-4fce-b754-01fd565fb73c",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Authentication Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 30,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_aws_console_login_by_user_from_new_city": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS Login Activities|Suspicious Cloud Authentication Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last 30 days.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "fc0edc95-ff2b-48b0-9f6f-63da3789fd03",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) as firstTime latest(_time) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Users in CloudTrail - Initial",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___update_filter"
                        }
                    ],
                    "name": "Previously Seen Users In CloudTrail - Update",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last hour.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "06c036e6-d6d7-4daa-bd76-411c3d356031",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) AS firstTime latest(_time) AS lastTime by user src City Region Country | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authenticaiton.src | iplocation Authentication.src | rename Authentication.user as user Authentciation.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins.csv",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_aws_console_login_by_user_from_new_city",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "Authentication",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-10-07",
            "description": "This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously seen users in CloudTrail - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen users in Cloudtrail - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `detect_aws_console_login_by_user_from_new_city_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously seen users in CloudTrail - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen users in Cloudtrail - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `detect_aws_console_login_by_user_from_new_city_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "detect_aws_console_login_by_user_from_new_city",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "When a legitimate new user logins for the first time, this activity will be detected. Check how old the account is and verify that the user activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_users_console_logins",
                    "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                    "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                    "name": "previously_seen_users_console_logins"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_aws_console_login_by_user_from_new_city_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "Detect AWS Console Login By User From New City",
            "references": "",
            "released": "2020-10-07",
            "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | `drop_dm_object_name(Authentication)` | table firstTime lastTime user City | join user  type=outer [| inputlookup previously_seen_users_console_logins | stats earliest(firstTime) AS earliestseen by user City | fields earliestseen user City] | eval userCity=if(firstTime >= relative_time(now(), \"-24h@h\"), \"New City\",\"Previously Seen City\") | eval userStatus=if(earliestseen >= relative_time(now(), \"-24h@h\") OR isnull(earliestseen), \"New User\",\"Old User\") | where userCity = \"New City\" AND userStatus != \"Old User\" | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table firstTime lastTime user City  userStatus userCity  | `detect_aws_console_login_by_user_from_new_city_filter`",
            "search_name": "ESCU - Detect AWS Console Login by User from New City - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c59f1268af3|6380ebbb-55c5-4fce-b754-01fd565fb73c",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS Login Activities",
                    "Suspicious Cloud Authentication Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_aws_console_login_by_user_from_new_country": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS Login Activities|Suspicious Cloud Authentication Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last 30 days.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "fc0edc95-ff2b-48b0-9f6f-63da3789fd03",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) as firstTime latest(_time) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Users in CloudTrail - Initial",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___update_filter"
                        }
                    ],
                    "name": "Previously Seen Users In CloudTrail - Update",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last hour.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "06c036e6-d6d7-4daa-bd76-411c3d356031",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) AS firstTime latest(_time) AS lastTime by user src City Region Country | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authenticaiton.src | iplocation Authentication.src | rename Authentication.user as user Authentciation.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins.csv",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_aws_console_login_by_user_from_new_country",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "Authentication",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-10-07",
            "description": "This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously seen users in CloudTrail - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen users in Cloudtrail - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `detect_aws_console_login_by_user_from_new_country_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously seen users in CloudTrail - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen users in Cloudtrail - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `detect_aws_console_login_by_user_from_new_country_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "detect_aws_console_login_by_user_from_new_country",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "When a legitimate new user logins for the first time, this activity will be detected. Check how old the account is and verify that the user activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_users_console_logins",
                    "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                    "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                    "name": "previously_seen_users_console_logins"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_aws_console_login_by_user_from_new_country_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "Detect AWS Console Login By User From New Country",
            "references": "",
            "released": "2020-10-07",
            "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | `drop_dm_object_name(Authentication)` | table firstTime lastTime user Country | join user  type=outer [| inputlookup previously_seen_users_console_logins | stats earliest(firstTime) AS earliestseen by user Country | fields earliestseen user Country] | eval userCountry=if(firstTime >= relative_time(now(), \"-24h@h\"), \"New Country\",\"Previously Seen Country\") | eval userStatus=if(earliestseen >= relative_time(now(),\"-24h@h\") OR isnull(earliestseen), \"New User\",\"Old User\") | where userCountry = \"New Country\" AND userStatus != \"Old User\" | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table firstTime lastTime user Country  userStatus userCountry  | `detect_aws_console_login_by_user_from_new_country_filter`",
            "search_name": "ESCU - Detect AWS Console Login by User from New Country - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c59f1268af3|6380ebbb-55c5-4fce-b754-01fd565fb73c",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS Login Activities",
                    "Suspicious Cloud Authentication Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_aws_console_login_by_user_from_new_region": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS Login Activities|Suspicious Cloud Authentication Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last 30 days.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "fc0edc95-ff2b-48b0-9f6f-63da3789fd03",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) as firstTime latest(_time) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Users in CloudTrail - Initial",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___update_filter"
                        }
                    ],
                    "name": "Previously Seen Users In CloudTrail - Update",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "deployments": [
                            "Daily Cache Updates"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect AWS Console Login by New User"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last hour.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "06c036e6-d6d7-4daa-bd76-411c3d356031",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) AS firstTime latest(_time) AS lastTime by user src City Region Country | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authenticaiton.src | iplocation Authentication.src | rename Authentication.user as user Authentciation.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins.csv",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_aws_console_login_by_user_from_new_region",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "Authentication",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
            ],
            "date": "2020-10-07",
            "description": "This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously seen users in CloudTrail - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen users in Cloudtrail - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `detect_aws_console_login_by_user_from_new_region_filter` macro.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting your cloud infrastructure logs from your cloud provider. You should run the baseline search `Previously seen users in CloudTrail - Initial` to build the initial table of source IP address, geographic locations, and times. You must also enable the second baseline search `Previously Seen users in Cloudtrail - Update` to keep this table up to date and to age out old data. You can also provide additional filtering for this search by customizing the `detect_aws_console_login_by_user_from_new_region_filter` macro.",
            "icon": "ES_Use_Case.png",
            "id": "detect_aws_console_login_by_user_from_new_region",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "When a legitimate new user logins for the first time, this activity will be detected. Check how old the account is and verify that the user activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_users_console_logins",
                    "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                    "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                    "name": "previously_seen_users_console_logins"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_aws_console_login_by_user_from_new_region_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "Detect AWS Console Login By User From New Region",
            "references": "",
            "released": "2020-10-07",
            "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | `drop_dm_object_name(Authentication)` | table firstTime lastTime user Region | join user  type=outer [| inputlookup previously_seen_users_console_logins | stats earliest(firstTime) AS earliestseen by user Region | fields earliestseen user Region] | eval userRegion=if(firstTime >= relative_time(now(), \"-24h@h\"), \"New Region\",\"Previously Seen Region\") | eval userStatus=if(earliestseen >= relative_time(now(), \"-24h@h\") OR isnull(earliestseen), \"New User\",\"Old User\") | where userRegion = \"New Region\" AND userStatus != \"Old User\" | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table firstTime lastTime user Region  userStatus userRegion  | `detect_aws_console_login_by_user_from_new_region_filter`",
            "search_name": "ESCU - Detect AWS Console Login by User from New Region - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c59f1268af3|6380ebbb-55c5-4fce-b754-01fd565fb73c",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS Login Activities",
                    "Suspicious Cloud Authentication Activities"
                ],
                "asset_type": "AWS Instance",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_computer_changed_with_anonymous_account": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Detect Zerologon Attack",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Rod Soto, Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_computer_changed_with_anonymous_account",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": "",
            "date": "2020-09-18",
            "description": "This search looks for Event Code 4742 (Computer Change) or EventCode 4624 (An account was successfully logged on) with an anonymous account.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 6|CIS 8",
            "escu_nist": "DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "This search requires audit computer account management to be enabled on the system in order to generate Event ID 4742. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Event Logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "highlight": "No",
            "how_to_implement": "This search requires audit computer account management to be enabled on the system in order to generate Event ID 4742. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Event Logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "icon": "ES_Use_Case.png",
            "id": "detect_computer_changed_with_anonymous_account",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "known_false_positives": "None thus far found",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=wineventlog_security",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_security"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_computer_changed_with_anonymous_account_filter"
                }
            ],
            "mitre_sub_technique": "T1210",
            "mitre_tactic": "TA0008",
            "mitre_tactic_display": "Lateral Movement",
            "mitre_technique": "T1210",
            "mitre_threat_groups": "Threat Group-3390|APT28",
            "name": "Detect Computer Changed With Anonymous Account",
            "references": [
                "https://www.lares.com/blog/from-lares-labs-defensive-guidance-for-zerologon-cve-2020-1472/"
            ],
            "released": "2020-09-18",
            "search": "`wineventlog_security` EventCode=4624 OR EventCode=4742 TargetUserName=\"ANONYMOUS LOGON\" LogonType=3 | stats count values(host) as host, values(TargetDomainName) as Domain, values(user) as user | `detect_computer_changed_with_anonymous_account_filter`",
            "search_name": "ESCU - Detect Computer Changed with Anonymous Account - Rule",
            "story": "5d14a962-569e-4578-939f-f386feb63ce4",
            "tags": {
                "analytics_story": [
                    "Detect Zerologon Attack"
                ],
                "asset_type": "Windows",
                "cis20": [
                    "CIS 6",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Threat Group-3390",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1210"
                ],
                "mitre_attack_tactics": [
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "Exploitation of Remote Services"
                ],
                "nist": [
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_credential_dumping_through_lsass_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping|Detect Zerologon Attack",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=detect_credential_dumping_through_lsass_access",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2019-12-03",
            "description": "This search looks for reading lsass memory consistent with credential dumping.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 16",
            "escu_nist": "PR.IP|PR.AC|DE.CM",
            "hasSearch": "Yes",
            "help": "This search needs Sysmon Logs and a sysmon configuration, which includes EventCode 10 with lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "highlight": "No",
            "how_to_implement": "This search needs Sysmon Logs and a sysmon configuration, which includes EventCode 10 with lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "icon": "ES_Use_Case.png",
            "id": "detect_credential_dumping_through_lsass_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "The activity may be legitimate. Other tools can access lsass for legitimate reasons, and it's possible this event could be generated in those cases. In these cases, false positives should be fairly obvious and you may need to tweak the search to eliminate noise.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_credential_dumping_through_lsass_access_filter"
                }
            ],
            "mitre_sub_technique": "T1003.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Sandworm Team|Whitefly|Blue Mockingbird|Silence|Threat Group-3390|Leviathan|APT41|Soft Cell|TEMP.Veles|APT33|APT39|Stolen Pencil|APT32|Lazarus Group|Leafminer|Magic Hound|MuddyWater|PLATINUM|FIN8|BRONZE BUTLER|OilRig|FIN6|APT3|APT28|APT1|Ke3chang|Cleaver",
            "name": "Detect Credential Dumping Through LSASS Access",
            "references": [],
            "released": "2019-12-03",
            "search": "`sysmon` EventCode=10 TargetImage=*lsass.exe (GrantedAccess=0x1010 OR GrantedAccess=0x1410) | stats count min(_time) as firstTime max(_time) as lastTime by Computer, SourceImage, SourceProcessId, TargetImage, TargetProcessId, EventCode, GrantedAccess | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_credential_dumping_through_lsass_access_filter` ",
            "search_name": "ESCU - Detect Credential Dumping through LSASS access - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a|5d14a962-569e-4578-939f-f386feb63ce4",
            "tags": {
                "analytics_story": [
                    "Credential Dumping",
                    "Detect Zerologon Attack"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Whitefly",
                    "Blue Mockingbird",
                    "Silence",
                    "Threat Group-3390",
                    "Leviathan",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Stolen Pencil",
                    "APT32",
                    "Lazarus Group",
                    "Leafminer",
                    "Magic Hound",
                    "MuddyWater",
                    "PLATINUM",
                    "FIN8",
                    "BRONZE BUTLER",
                    "OilRig",
                    "FIN6",
                    "APT3",
                    "APT28",
                    "APT1",
                    "Ke3chang",
                    "Cleaver"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "LSASS Memory"
                ],
                "nist": [
                    "PR.IP",
                    "PR.AC",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "detect_dns_requests_to_phishing_sites_leveraging_evilginx2": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Common Phishing Frameworks",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=detect_dns_requests_to_phishing_sites_leveraging_evilginx2",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Web.Web",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for DNS requests for phishing domains that are leveraging EvilGinx tools to mimic websites.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 7",
            "escu_nist": "ID.AM|PR.DS|PR.IP|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "You need to ingest data from your DNS logs in the Network_Resolution datamodel. Specifically you must ingest the domain that is being queried and the IP of the host originating the request. Ideally, you should also be ingesting the answer to the query and the query type. This approach allows you to also create your own localized passive DNS capability which can aid you in future investigations. You will have to add legitimate domain names to the `legit_domains.csv` file shipped with the app. \\\n **Splunk>Phantom Playbook Integration**\\\nIf Splunk>Phantom is also configured in your environment, a Playbook called `Lets Encrypt Domain Investigate` can be configured to run when any results are found by this detection search. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search, and set the corresponding Playbook to active. \\\n(Playbook link:`https://my.phantom.us/4.2/playbook/lets-encrypt-domain-investigate/`).\\\n",
            "highlight": "No",
            "how_to_implement": "You need to ingest data from your DNS logs in the Network_Resolution datamodel. Specifically you must ingest the domain that is being queried and the IP of the host originating the request. Ideally, you should also be ingesting the answer to the query and the query type. This approach allows you to also create your own localized passive DNS capability which can aid you in future investigations. You will have to add legitimate domain names to the `legit_domains.csv` file shipped with the app. \\\n **Splunk>Phantom Playbook Integration**\\\nIf Splunk>Phantom is also configured in your environment, a Playbook called `Lets Encrypt Domain Investigate` can be configured to run when any results are found by this detection search. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search, and set the corresponding Playbook to active. \\\n(Playbook link:`https://my.phantom.us/4.2/playbook/lets-encrypt-domain-investigate/`).\\\n",
            "icon": "ES_Use_Case.png",
            "id": "detect_dns_requests_to_phishing_sites_leveraging_evilginx2",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery|Command and Control",
            "known_false_positives": "If a known good domain is not listed in the legit_domains.csv file, then the search could give you false postives. Please update that lookup file to filter out DNS requests to legitimate domains.",
            "lookups": [
                {
                    "description": "A list of legit domains to be used to whitelist possible phishing sites",
                    "filename": "legit_domains.csv",
                    "name": "legit_domains"
                }
            ],
            "macros": [
                {
                    "definition": "(query=api* AND query = github*)",
                    "description": "This limits the query fields to domains that are associated with evilginx masquerading as GitHub",
                    "name": "evilginx_phishlets_github"
                },
                {
                    "definition": "(query=login* AND query=www*)",
                    "description": "This limits the query fields to domains that are associated with evilginx masquerading as Office 365",
                    "name": "evilginx_phishlets_0365"
                },
                {
                    "definition": "(query=outlook* AND query=login* AND query=account*)",
                    "description": "This limits the query fields to domains that are associated with evilginx masquerading as Outlook",
                    "name": "evilginx_phishlets_outlook"
                },
                {
                    "definition": "(query=www* AND query = m* AND query=static*)",
                    "description": "This limits the query fields to domains that are associated with evilginx masquerading as FaceBook",
                    "name": "evilginx_phishlets_facebook"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "(query=www* AND query=aws* AND query=console.aws* AND query=signin.aws* AND api-northeast-1.console.aws* AND query=fls-na* AND query=images-na*)",
                    "description": "This limits the query fields to domains that are associated with evilginx masquerading as an AWS console",
                    "name": "evilginx_phishlets_aws"
                },
                {
                    "definition": "(query=accounts* AND query=ssl* AND query=www*)",
                    "description": "This limits the query fields to domains that are associated with evilginx masquerading as Google",
                    "name": "evilginx_phishlets_google"
                },
                {
                    "definition": "(query=fls-na* AND query = www* AND query=images*)",
                    "description": "This limits the query fields to domains that are associated with evilginx masquerading as Amazon",
                    "name": "evilginx_phishlets_amazon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_dns_requests_to_phishing_sites_leveraging_evilginx2_filter"
                }
            ],
            "mitre_sub_technique": "T1566.003",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1566",
            "mitre_threat_groups": "Magic Hound|Windshift|FIN6|OilRig|Dark Caracal",
            "name": "Detect DNS Requests To Phishing Sites Leveraging Evilginx2",
            "references": "",
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(DNS.answer) as answer from datamodel=Network_Resolution.DNS by DNS.dest DNS.src DNS.query host | `drop_dm_object_name(DNS)`| rex field=query \".*?(?<domain>[^./:]+\\.(\\S{2,3}|\\S{2,3}.\\S{2,3}))$\" | stats count values(query) as query by domain dest src answer| search `evilginx_phishlets_amazon` OR `evilginx_phishlets_facebook` OR `evilginx_phishlets_github` OR `evilginx_phishlets_0365` OR `evilginx_phishlets_outlook` OR `evilginx_phishlets_aws` OR `evilginx_phishlets_google` | search NOT [ inputlookup legit_domains.csv | fields domain]| join domain type=outer [| tstats count `security_content_summariesonly` values(Web.url) as url from datamodel=Web.Web by Web.dest Web.site | rename \"Web.*\" as * | rex field=site \".*?(?<domain>[^./:]+\\.(\\S{2,3}|\\S{2,3}.\\S{2,3}))$\" | table dest domain url] | table count src dest query answer domain url | `detect_dns_requests_to_phishing_sites_leveraging_evilginx2_filter`",
            "search_name": "ESCU - Detect DNS requests to Phishing Sites leveraging EvilGinx2 - Rule",
            "story": "9a64ab44-9214-4639-8163-7eaa2621bd61",
            "tags": {
                "analytics_story": [
                    "Common Phishing Frameworks"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8",
                    "CIS 7"
                ],
                "kill_chain_phases": [
                    "Delivery",
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "Magic Hound",
                    "Windshift",
                    "FIN6",
                    "OilRig",
                    "Dark Caracal"
                ],
                "mitre_attack_id": [
                    "T1566"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Spearphishing via Service"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS",
                    "PR.IP",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_excessive_account_lockouts_from_endpoint": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Account Monitoring and Controls",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Account Compromise",
            "dashboard": "showcase_security_content?showcaseId=detect_excessive_account_lockouts_from_endpoint",
            "data_source_categories": "DS003Authentication-ET02Failure",
            "datamodel": "Change.All_Changes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-security.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-system.log"
            ],
            "date": "2020-11-09",
            "description": "This search identifies endpoints that have caused a relatively high number of account lockouts in a short period.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must ingest your Windows security event logs in the `Change` datamodel under the nodename is `Account_Management`, for this search to execute successfully. Please consider updating the cron schedule and the count of lockouts you want to monitor, according to your environment. \\\n **Splunk>Phantom Playbook Integration**\\\nIf Splunk>Phantom is also configured in your environment, a Playbook called \"Excessive Account Lockouts Enrichment and Response\" can be configured to run when any results are found by this detection search. The Playbook executes the Contextual and Investigative searches in this Story, conducts additional information gathering on Windows endpoints, and takes a response action to shut down the affected endpoint. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search, and set the corresponding Playbook to active. \\\n(Playbook Link:`https://my.phantom.us/4.1/playbook/excessive-account-lockouts-enrichment-and-response/`).\\\n",
            "highlight": "No",
            "how_to_implement": "You must ingest your Windows security event logs in the `Change` datamodel under the nodename is `Account_Management`, for this search to execute successfully. Please consider updating the cron schedule and the count of lockouts you want to monitor, according to your environment. \\\n **Splunk>Phantom Playbook Integration**\\\nIf Splunk>Phantom is also configured in your environment, a Playbook called \"Excessive Account Lockouts Enrichment and Response\" can be configured to run when any results are found by this detection search. The Playbook executes the Contextual and Investigative searches in this Story, conducts additional information gathering on Windows endpoints, and takes a response action to shut down the affected endpoint. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search, and set the corresponding Playbook to active. \\\n(Playbook Link:`https://my.phantom.us/4.1/playbook/excessive-account-lockouts-enrichment-and-response/`).\\\n",
            "icon": "ES_Use_Case.png",
            "id": "detect_excessive_account_lockouts_from_endpoint",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "None",
            "known_false_positives": "It's possible that a widely used system, such as a kiosk, could cause a large number of account lockouts.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_excessive_account_lockouts_from_endpoint_filter"
                }
            ],
            "mitre_sub_technique": "T1078.002",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "TA505|APT3|Threat Group-1314",
            "name": "Detect Excessive Account Lockouts From Endpoint",
            "references": "",
            "released": "2020-11-09",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(All_Changes.user) as user from datamodel=Change.All_Changes where nodename=All_Changes.Account_Management All_Changes.result=\"lockout\" by All_Changes.dest All_Changes.result |`drop_dm_object_name(\"All_Changes\")` |`drop_dm_object_name(\"Account_Management\")`| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search count > 5 | `detect_excessive_account_lockouts_from_endpoint_filter`",
            "search_name": "ESCU - Detect Excessive Account Lockouts From Endpoint - Rule",
            "story": "8892a655-6205-55f7-abba-06460e38c8ae",
            "tags": {
                "analytics_story": [
                    "Account Monitoring and Controls"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-security.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-system.log"
                ],
                "mitre_attack_groups": [
                    "TA505",
                    "APT3",
                    "Threat Group-1314"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Domain Accounts"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 5
        },
        "detect_excessive_user_account_lockouts": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Account Monitoring and Controls",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Account Compromise",
            "dashboard": "showcase_security_content?showcaseId=detect_excessive_user_account_lockouts",
            "data_source_categories": "DS003Authentication-ET02Failure",
            "datamodel": "Change.All_Changes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-security.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-system.log"
            ],
            "date": "2020-07-21",
            "description": "This search detects user accounts that have been locked out a relatively high number of times in a short period.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "ou must ingest your Windows security event logs in the `Change` datamodel under the nodename is `Account_Management`, for this search to execute successfully. Please consider updating the cron schedule and the count of lockouts you want to monitor, according to your environment.",
            "highlight": "No",
            "how_to_implement": "ou must ingest your Windows security event logs in the `Change` datamodel under the nodename is `Account_Management`, for this search to execute successfully. Please consider updating the cron schedule and the count of lockouts you want to monitor, according to your environment.",
            "icon": "ES_Use_Case.png",
            "id": "detect_excessive_user_account_lockouts",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "None",
            "known_false_positives": "It is possible that a legitimate user is experiencing an issue causing multiple account login failures leading to lockouts.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_excessive_user_account_lockouts_filter"
                }
            ],
            "mitre_sub_technique": "T1078.003",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Tropic Trooper|FIN10|Stolen Pencil|APT32",
            "name": "Detect Excessive User Account Lockouts",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Change.All_Changes where nodename=All_Changes.Account_Management All_Changes.result=\"lockout\" by All_Changes.user All_Changes.result |`drop_dm_object_name(\"All_Changes\")` |`drop_dm_object_name(\"Account_Management\")`| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search count > 5 | `detect_excessive_user_account_lockouts_filter`",
            "search_name": "ESCU - Detect Excessive User Account Lockouts - Rule",
            "story": "8892a655-6205-55f7-abba-06460e38c8ae",
            "tags": {
                "analytics_story": [
                    "Account Monitoring and Controls"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-security.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.002/account_lockout/windows-system.log"
                ],
                "mitre_attack_groups": [
                    "Tropic Trooper",
                    "FIN10",
                    "Stolen Pencil",
                    "APT32"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Local Accounts"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "detect_f5_tmui_rce_cve-2020-5902": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "F5 TMUI RCE CVE-2020-5902",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Network",
            "author": "Shannon Davis, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_f5_tmui_rce_cve-2020-5902",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2020-08-02",
            "description": "This search detects remote code exploit attempts on F5 BIG-IP, BIG-IQ, and Traffix SDC devices",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 11",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "To consistently detect exploit attempts on F5 devices using the vulnerabilities contained within CVE-2020-5902 it is recommended to ingest logs via syslog.  As many BIG-IP devices will have SSL enabled on their management interfaces, detections via wire data may not pick anything up unless you are decrypting SSL traffic in order to inspect it.  I am using a regex string from a Cloudflare mitigation technique to try and always catch the offending string (..;), along with the other exploit of using (hsqldb;).",
            "highlight": "No",
            "how_to_implement": "To consistently detect exploit attempts on F5 devices using the vulnerabilities contained within CVE-2020-5902 it is recommended to ingest logs via syslog.  As many BIG-IP devices will have SSL enabled on their management interfaces, detections via wire data may not pick anything up unless you are decrypting SSL traffic in order to inspect it.  I am using a regex string from a Cloudflare mitigation technique to try and always catch the offending string (..;), along with the other exploit of using (hsqldb;).",
            "icon": "ES_Use_Case.png",
            "id": "detect_f5_tmui_rce_cve-2020-5902",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "index=netops sourcetype=\"f5:bigip:rogue\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "f5_bigip_rogue"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_f5_tmui_rce_cve_2020_5902_filter"
                }
            ],
            "mitre_sub_technique": "T1190",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1190",
            "mitre_threat_groups": "Blue Mockingbird|Rocke|APT39|BlackTech|APT41|Soft Cell|Night Dragon|Axiom",
            "name": "Detect F5 Tmui RCE Cve-2020-5902",
            "references": [
                "https://www.ptsecurity.com/ww-en/about/news/f5-fixes-critical-vulnerability-discovered-by-positive-technologies-in-big-ip-application-delivery-controller/",
                "https://support.f5.com/csp/article/K52145254",
                "https://blog.cloudflare.com/cve-2020-5902-helping-to-protect-against-the-f5-tmui-rce-vulnerability/"
            ],
            "released": "2020-08-02",
            "search": "`f5_bigip_rogue` | regex _raw=\"(hsqldb;|.*\\\\.\\\\.;.*)\" | search `detect_f5_tmui_rce_cve_2020_5902_filter`",
            "search_name": "ESCU - Detect F5 TMUI RCE CVE-2020-5902 - Rule",
            "story": "7678c968-d46e-11ea-87d0-0242ac130003",
            "tags": {
                "analytics_story": [
                    "F5 TMUI RCE CVE-2020-5902"
                ],
                "asset_type": "Network",
                "cis20": [
                    "CIS 8",
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Rocke",
                    "APT39",
                    "BlackTech",
                    "APT41",
                    "Soft Cell",
                    "Night Dragon",
                    "Axiom"
                ],
                "mitre_attack_id": [
                    "T1190"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Exploit Public-Facing Application"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_gcp_storage_access_from_a_new_ip": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious GCP Storage Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Storage Bucket",
            "author": "Shannon Davis, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_gcp_storage_access_from_a_new_ip",
            "data_source_categories": "VendorSpecific-gcp-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-08-10",
            "description": "This search looks at GCP Storage bucket-access logs and detects new or previously unseen remote IP addresses that have successfully accessed a GCP Storage bucket.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13|CIS 14",
            "escu_nist": "PR.DS|PR.AC|DE.CM",
            "hasSearch": "Yes",
            "help": "This search relies on the Splunk Add-on for Google Cloud Platform, setting up a Cloud Pub/Sub input, along with the relevant GCP PubSub topics and logging sink to capture GCP Storage Bucket events (https://cloud.google.com/logging/docs/routing/overview). In order to capture public GCP Storage Bucket access logs, you must also enable storage bucket logging to your PubSub Topic as per https://cloud.google.com/storage/docs/access-logs.  These logs are deposited into the nominated Storage Bucket on an hourly basis and typically show up by 15 minutes past the hour.  It is recommended to configure any saved searches or correlation searches in Enterprise Security to run on an hourly basis at 30 minutes past the hour (cron definition of 30 * * * *).  A lookup table (previously_seen_gcp_storage_access_from_remote_ip.csv) stores the previously seen access requests, and is used by this search to determine any newly seen IP addresses accessing the Storage Buckets.",
            "highlight": "No",
            "how_to_implement": "This search relies on the Splunk Add-on for Google Cloud Platform, setting up a Cloud Pub/Sub input, along with the relevant GCP PubSub topics and logging sink to capture GCP Storage Bucket events (https://cloud.google.com/logging/docs/routing/overview). In order to capture public GCP Storage Bucket access logs, you must also enable storage bucket logging to your PubSub Topic as per https://cloud.google.com/storage/docs/access-logs.  These logs are deposited into the nominated Storage Bucket on an hourly basis and typically show up by 15 minutes past the hour.  It is recommended to configure any saved searches or correlation searches in Enterprise Security to run on an hourly basis at 30 minutes past the hour (cron definition of 30 * * * *).  A lookup table (previously_seen_gcp_storage_access_from_remote_ip.csv) stores the previously seen access requests, and is used by this search to determine any newly seen IP addresses accessing the Storage Buckets.",
            "icon": "ES_Use_Case.png",
            "id": "detect_gcp_storage_access_from_a_new_ip",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "GCP Storage buckets can be accessed from any IP (if the ACLs are open to allow it), as long as it can make a successful connection. This will be a false postive, since the search is looking for a new IP within the past two hours.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_gcp_storage_access_from_a_new_ip_filter"
                }
            ],
            "mitre_sub_technique": "T1530",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1530",
            "mitre_threat_groups": "no",
            "name": "Detect GCP Storage Access From A New IP",
            "references": [],
            "released": "2020-08-10",
            "search": "`google_gcp_pubsub_message` | multikv | rename sc_status_ as status | rename cs_object_ as bucket_name | rename c_ip_ as remote_ip | rename cs_uri_ as request_uri | rename cs_method_ as operation | search status=\"\\\"200\\\"\" | stats earliest(_time) as firstTime latest(_time) as lastTime by bucket_name remote_ip operation request_uri | table firstTime, lastTime, bucket_name, remote_ip, operation, request_uri | inputlookup append=t previously_seen_gcp_storage_access_from_remote_ip.csv | stats min(firstTime) as firstTime, max(lastTime) as lastTime by bucket_name remote_ip operation request_uri | outputlookup previously_seen_gcp_storage_access_from_remote_ip.csv | eval newIP=if(firstTime >= relative_time(now(),\"-70m@m\"), 1, 0) | where newIP=1 | eval first_time=strftime(firstTime,\"%m/%d/%y %H:%M:%S\") | eval last_time=strftime(lastTime,\"%m/%d/%y %H:%M:%S\") | table  first_time last_time bucket_name remote_ip operation request_uri | `detect_gcp_storage_access_from_a_new_ip_filter`",
            "search_name": "ESCU - Detect GCP Storage access from a new IP - Rule",
            "story": "4d656b2e-d6be-11ea-87d0-0242ac130003",
            "tags": {
                "analytics_story": [
                    "Suspicious GCP Storage Activities"
                ],
                "asset_type": "GCP Storage Bucket",
                "cis20": [
                    "CIS 13",
                    "CIS 14"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1530"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Data from Cloud Storage Object"
                ],
                "nist": [
                    "PR.DS",
                    "PR.AC",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_hosts_connecting_to_dynamic_domain_providers": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Data Protection|Prohibited Traffic Allowed or Protocol Mismatch|DNS Hijacking|Suspicious DNS Traffic|Dynamic DNS|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Command and Control",
            "dashboard": "showcase_security_content?showcaseId=detect_hosts_connecting_to_dynamic_domain_providers",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2020-01-16",
            "description": "Malicious actors often abuse legitimate Dynamic DNS services to host malicious payloads or interactive command and control nodes. Attackers will automate domain resolution changes by routing dynamic domains to countless IP addresses to circumvent firewall blocks, blacklists as well as frustrate a network defenders analytic and investigative processes. This search will look for DNS queries made from within your infrastructure to suspicious dynamic domains.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 12|CIS 13",
            "escu_nist": "PR.DS|PR.PT|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "First, you'll need to ingest data from your DNS operations. This can be done by ingesting logs from your server or data, collected passively by Splunk Stream or a similar solution. Specifically, data that contains the domain that is being queried and the IP of the host originating the request must be populating the `Network_Resolution` data model. This search also leverages a lookup file, `dynamic_dns_providers_default.csv`, which contains a non-exhaustive list of Dynamic DNS providers. Please consider updating the local lookup periodically by adding new domains to the list of `dynamic_dns_providers_local.csv`.\\\nThis search produces fields (query, answer, isDynDNS) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable event. To see the additional metadata, add the following fields, if not already present, to Incident Review. Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** DNS Query, **Field:** query\\\n1. \\\n1. **Label:** DNS Answer, **Field:** answer\\\n1. \\\n1. **Label:** IsDynamicDNS, **Field:** isDynDNS\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "First, you'll need to ingest data from your DNS operations. This can be done by ingesting logs from your server or data, collected passively by Splunk Stream or a similar solution. Specifically, data that contains the domain that is being queried and the IP of the host originating the request must be populating the `Network_Resolution` data model. This search also leverages a lookup file, `dynamic_dns_providers_default.csv`, which contains a non-exhaustive list of Dynamic DNS providers. Please consider updating the local lookup periodically by adding new domains to the list of `dynamic_dns_providers_local.csv`.\\\nThis search produces fields (query, answer, isDynDNS) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable event. To see the additional metadata, add the following fields, if not already present, to Incident Review. Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** DNS Query, **Field:** query\\\n1. \\\n1. **Label:** DNS Answer, **Field:** answer\\\n1. \\\n1. **Label:** IsDynamicDNS, **Field:** isDynDNS\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "detect_hosts_connecting_to_dynamic_domain_providers",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "Some users and applications may leverage Dynamic DNS to reach out to some domains on the Internet since dynamic DNS by itself is not malicious, however this activity must be verified.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "lookup update=true dynamic_dns_providers_default dynamic_dns_domains as query OUTPUTNEW isDynDNS_default | lookup update=true dynamic_dns_providers_local dynamic_dns_domains as query OUTPUTNEW isDynDNS_local| eval isDynDNS = coalesce(isDynDNS_default, isDynDNS_local)|fields - isDynDNS_default, isDynDNS_local| search isDynDNS=True",
                    "description": "This macro limits the output of the query field to dynamic dns domains. It looks up the domains in a file provided by Splunk and one intended to be updated by the end user.",
                    "lookups": [
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/dynamic_dns_providers_default.csv",
                            "description": "A list of dynammic dns providers that should not be modified",
                            "filename": "dynamic_dns_providers_default.csv",
                            "match_type": "WILDCARD(dynamic_dns_domains)",
                            "name": "dynamic_dns_providers_default"
                        },
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/dynamic_dns_providers_local.csv",
                            "description": "A list of dynammic dns providers that can be modified",
                            "filename": "dynamic_dns_providers_local.csv",
                            "match_type": "WILDCARD(dynamic_dns_domains)",
                            "name": "dynamic_dns_providers_local"
                        }
                    ],
                    "name": "dynamic_dns_providers"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_hosts_connecting_to_dynamic_domain_providers_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect Hosts Connecting To Dynamic Domain Providers",
            "references": "",
            "released": "2020-01-16",
            "search": "| tstats `security_content_summariesonly` count values(DNS.answer) as answer min(_time) as firstTime from datamodel=Network_Resolution by DNS.src, DNS.query | `drop_dm_object_name(\"DNS\")` | `security_content_ctime(firstTime)` | `dynamic_dns_providers` | `detect_hosts_connecting_to_dynamic_domain_providers_filter`",
            "search_name": "ESCU - Detect hosts connecting to dynamic domain providers - Rule",
            "security_domain": "network",
            "story": "91c676cf-0b23-438d-abee-f6335e1fce33|6d13121c-90f3-446d-8ac3-27efbbc65218|8169f17b-ef68-4b59-aa28-586907301221|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56|8169f17b-ef68-4b59-aae8-586907301221|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Data Protection",
                    "Prohibited Traffic Allowed or Protocol Mismatch",
                    "DNS Hijacking",
                    "Suspicious DNS Traffic",
                    "Dynamic DNS",
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8",
                    "CIS 12",
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.DS",
                    "PR.PT",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_ipv6_network_infrastructure_threats": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Router and Infrastructure Security",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Mikael Bjerkeland, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_ipv6_network_infrastructure_threats",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-28",
            "description": "By enabling IPv6 First Hop Security as a Layer 2 Security measure on the organization's network devices, we will be able to detect various attacks such as packet forging in the Infrastructure.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 11",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with one or more First Hop Security measures such as RA Guard, DHCP Guard and/or device tracking. See References for more information. The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "highlight": "No",
            "how_to_implement": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with one or more First Hop Security measures such as RA Guard, DHCP Guard and/or device tracking. See References for more information. The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "icon": "ES_Use_Case.png",
            "id": "detect_ipv6_network_infrastructure_threats",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "",
            "known_false_positives": "None currently known",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=cisco_ios",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cisco_networks"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_ipv6_network_infrastructure_threats_filter"
                }
            ],
            "mitre_sub_technique": "T1200|T1498|T1557.002",
            "mitre_tactic": "TA0001|TA0040",
            "mitre_tactic_display": "Initial Access|Impact",
            "mitre_technique": "T1200|T1498|T1557",
            "mitre_threat_groups": "DarkVishnya|no",
            "name": "Detect Ipv6 Network Infrastructure Threats",
            "references": [
                "https://www.ciscolive.com/c/dam/r/ciscolive/emea/docs/2019/pdf/BRKSEC-3200.pdf",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-16-12/ip6f-xe-16-12-book/ip6-ra-guard.html",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-16-12/ip6f-xe-16-12-book/ip6-snooping.html",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-16-12/ip6f-xe-16-12-book/ip6-dad-proxy.html",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-16-12/ip6f-xe-16-12-book/ip6-nd-mcast-supp.html",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-16-12/ip6f-xe-16-12-book/ip6-dhcpv6-guard.html",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-16-12/ip6f-xe-16-12-book/ip6-src-guard.html",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-16-12/ip6f-xe-16-12-book/ipv6-dest-guard.html"
            ],
            "released": "2020-10-28",
            "search": "`cisco_networks` facility=\"SISF\" mnemonic IN (\"IP_THEFT\",\"MAC_THEFT\",\"MAC_AND_IP_THEFT\",\"PAK_DROP\") | eval src_interface=src_int_prefix_long+src_int_suffix | eval dest_interface=dest_int_prefix_long+dest_int_suffix | stats min(_time) AS firstTime max(_time) AS lastTime values(src_mac) AS src_mac values(src_vlan) AS src_vlan values(mnemonic) AS mnemonic values(vendor_explanation) AS vendor_explanation values(src_ip) AS src_ip values(dest_ip) AS dest_ip values(dest_interface) AS dest_interface values(action) AS action count BY host src_interface | table host src_interface dest_interface src_mac src_ip dest_ip src_vlan mnemonic vendor_explanation action count | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `detect_ipv6_network_infrastructure_threats_filter`",
            "search_name": "ESCU - Detect IPv6 Network Infrastructure Threats - Rule",
            "story": "91c676cf-0b23-438d-abee-f6335e177e77",
            "tags": {
                "analytics_story": [
                    "Router and Infrastructure Security"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 1",
                    "CIS 11"
                ],
                "detection_name": "Detect IPv6 Network Infrastructure Threats",
                "kill_chain_phases": [
                    "Reconnaissance",
                    "Delivery",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "DarkVishnya",
                    "no"
                ],
                "mitre_attack_id": [
                    "T1200",
                    "T1498",
                    "T1557"
                ],
                "mitre_attack_tactics": [
                    "Initial Access",
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Hardware Additions",
                    "Network Denial of Service"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_large_outbound_icmp_packets": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_large_outbound_icmp_packets",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2018-06-01",
            "description": "This search looks for outbound ICMP packets with a packet size larger than 1,000 bytes. Various threat actors have been known to use ICMP as a command and control channel for their attack infrastructure. Large ICMP packets from an endpoint to a remote host may be indicative of this activity.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 9|CIS 12",
            "escu_nist": "DE.AE",
            "hasSearch": "Yes",
            "help": "In order to run this search effectively, we highly recommend that you leverage the Assets and Identity framework. It is important that you have a good understanding of how your network segments are designed and that you are able to distinguish internal from external address space. Add a category named `internal` to the CIDRs that host the company's assets in the `assets_by_cidr.csv` lookup file, which is located in `$SPLUNK_HOME/etc/apps/SA-IdentityManagement/lookups/`. More information on updating this lookup can be found here: https://docs.splunk.com/Documentation/ES/5.0.0/Admin/Addassetandidentitydata. This search also requires you to be ingesting your network traffic and populating the Network_Traffic data model",
            "highlight": "No",
            "how_to_implement": "In order to run this search effectively, we highly recommend that you leverage the Assets and Identity framework. It is important that you have a good understanding of how your network segments are designed and that you are able to distinguish internal from external address space. Add a category named `internal` to the CIDRs that host the company's assets in the `assets_by_cidr.csv` lookup file, which is located in `$SPLUNK_HOME/etc/apps/SA-IdentityManagement/lookups/`. More information on updating this lookup can be found here: https://docs.splunk.com/Documentation/ES/5.0.0/Admin/Addassetandidentitydata. This search also requires you to be ingesting your network traffic and populating the Network_Traffic data model",
            "icon": "ES_Use_Case.png",
            "id": "detect_large_outbound_icmp_packets",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Command and Control",
            "known_false_positives": "ICMP packets are used in a variety of ways to help troubleshoot networking issues and ensure the proper flow of traffic. As such, it is possible that a large ICMP packet could be perfectly legitimate. If large ICMP packets are associated with command and control traffic, there will typically be a large number of these packets observed over time. If the search is providing a large number of false positives, you can modify the search to adjust the byte threshold or whitelist specific IP addresses, as necessary.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_large_outbound_icmp_packets_filter"
                }
            ],
            "mitre_sub_technique": "T1095",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1095",
            "mitre_threat_groups": "APT29|PLATINUM|APT3",
            "name": "Detect Large Outbound ICMP Packets",
            "references": [],
            "released": "2018-06-01",
            "search": "| tstats `security_content_summariesonly` count earliest(_time) as firstTime latest(_time) as lastTime values(All_Traffic.action) values(All_Traffic.bytes) from datamodel=Network_Traffic where All_Traffic.action !=blocked All_Traffic.dest_category !=internal (All_Traffic.protocol=icmp OR All_Traffic.transport=icmp) All_Traffic.bytes > 1000 by All_Traffic.src_ip All_Traffic.dest_ip | `drop_dm_object_name(\"All_Traffic\")` | search ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16) | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | `detect_large_outbound_icmp_packets_filter`",
            "search_name": "ESCU - Detect Large Outbound ICMP Packets - Rule",
            "story": "943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 9",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT29",
                    "PLATINUM",
                    "APT3"
                ],
                "mitre_attack_id": [
                    "T1095"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "Non-Application Layer Protocol"
                ],
                "nist": [
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_long_dns_txt_record_response": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious DNS Traffic|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Command and Control",
            "dashboard": "showcase_security_content?showcaseId=detect_long_dns_txt_record_response",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search is used to detect attempts to use DNS tunneling, by calculating the length of responses to DNS TXT queries. Endpoints using DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls can often be detected by noting unusually large volumes of DNS traffic.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 12|CIS 13",
            "escu_nist": "PR.DS|PR.PT|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to ingest data from your DNS logs, or monitor DNS traffic using Stream, Bro or something similar. Specifically, this query requires that the DNS data model is populated with information regarding the DNS record type that is being returned as well as the data in the answer section of the protocol.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to ingest data from your DNS logs, or monitor DNS traffic using Stream, Bro or something similar. Specifically, this query requires that the DNS data model is populated with information regarding the DNS record type that is being returned as well as the data in the answer section of the protocol.",
            "icon": "ES_Use_Case.png",
            "id": "detect_long_dns_txt_record_response",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "It's possible that legitimate TXT record responses can be long enough to trigger this search. You can modify the packet threshold for this search to help mitigate false positives.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_long_dns_txt_record_response_filter"
                }
            ],
            "mitre_sub_technique": "T1071.004",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "APT39|Tropic Trooper|OilRig|Ke3chang|Cobalt Group|APT18|APT41|FIN7",
            "name": "Detect Long DNS Txt Record Response",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Resolution where DNS.message_type=response AND DNS.record_type=TXT by DNS.src DNS.dest DNS.answer DNS.record_type |  `drop_dm_object_name(\"DNS\")` | eval anslen=len(answer) | search anslen>100 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename src as \"Source IP\", dest as \"Destination IP\", answer as \"DNS Answer\" anslen as \"Answer Length\" record_type as \"DNS Record Type\" firstTime as \"First Time\" lastTime as \"Last Time\" count as Count | table \"Source IP\" \"Destination IP\" \"DNS Answer\" \"DNS Record Type\"  \"Answer Length\" Count \"First Time\" \"Last Time\" | `detect_long_dns_txt_record_response_filter`",
            "search_name": "ESCU - Detect Long DNS TXT Record Response - Rule",
            "story": "3c3835c0-255d-4f9e-ab84-e29ec9ec9b56|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Suspicious DNS Traffic",
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8",
                    "CIS 12",
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "Tropic Trooper",
                    "OilRig",
                    "Ke3chang",
                    "Cobalt Group",
                    "APT18",
                    "APT41",
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "DNS"
                ],
                "nist": [
                    "PR.DS",
                    "PR.PT",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_malicious_requests_to_exploit_jboss_servers": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "JBoss Vulnerability|SamSam Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Web Server",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Web Attack",
            "dashboard": "showcase_security_content?showcaseId=detect_malicious_requests_to_exploit_jboss_servers",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "Web",
            "dataset": "",
            "date": "2017-09-23",
            "description": "This search is used to detect malicious HTTP requests crafted to exploit jmx-console in JBoss servers. The malicious requests have a long URL length, as the payload is embedded in the URL.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 12|CIS 4|CIS 18",
            "escu_nist": "ID.RA|PR.PT|PR.IP|DE.AE|PR.MA|DE.CM",
            "hasSearch": "Yes",
            "help": "You must ingest data from the web server or capture network data that contains web specific information with solutions such as Bro or Splunk Stream, and populating the Web data model",
            "highlight": "No",
            "how_to_implement": "You must ingest data from the web server or capture network data that contains web specific information with solutions such as Bro or Splunk Stream, and populating the Web data model",
            "icon": "ES_Use_Case.png",
            "id": "detect_malicious_requests_to_exploit_jboss_servers",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "known_false_positives": "No known false positives for this detection.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_malicious_requests_to_exploit_jboss_servers_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect Malicious Requests To Exploit Jboss Servers",
            "references": [],
            "released": "2017-09-23",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where (Web.http_method=\"GET\" OR Web.http_method=\"HEAD\") by Web.http_method, Web.url,Web.url_length Web.src, Web.dest | search Web.url=\"*jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.admin*import*\" AND Web.url_length > 200 | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table src, dest_ip, http_method, url, firstTime, lastTime | `detect_malicious_requests_to_exploit_jboss_servers_filter`",
            "search_name": "ESCU - Detect malicious requests to exploit JBoss servers - Rule",
            "security_domain": "network",
            "story": "1f5294cb-b85f-4c2d-9c58-ffcf248f52bd|c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "tags": {
                "analytics_story": [
                    "JBoss Vulnerability",
                    "SamSam Ransomware"
                ],
                "asset_type": "Web Server",
                "cis20": [
                    "CIS 12",
                    "CIS 4",
                    "CIS 18"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.RA",
                    "PR.PT",
                    "PR.IP",
                    "DE.AE",
                    "PR.MA",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Application Security",
            "version": 1
        },
        "detect_mimikatz_using_loaded_images": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping|Detect Zerologon Attack",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=detect_mimikatz_using_loaded_images",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": "",
            "date": "2019-12-03",
            "description": "This search looks for reading loaded Images unique to credential dumping with Mimikatz. Deprecated because mimikatz libraries changed and very noisy sysmon Event Code.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 6|CIS 8",
            "escu_nist": "DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "This search needs Sysmon Logs and a sysmon configuration, which includes EventCode 7 with powershell.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "highlight": "No",
            "how_to_implement": "This search needs Sysmon Logs and a sysmon configuration, which includes EventCode 7 with powershell.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "icon": "ES_Use_Case.png",
            "id": "detect_mimikatz_using_loaded_images",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Other tools can import the same DLLs. These tools should be part of a whtelist.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_mimikatz_using_loaded_images_filter"
                }
            ],
            "mitre_sub_technique": "T1003.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Sandworm Team|Whitefly|Blue Mockingbird|Silence|Threat Group-3390|Leviathan|APT41|Soft Cell|TEMP.Veles|APT33|APT39|Stolen Pencil|APT32|Lazarus Group|Leafminer|Magic Hound|MuddyWater|PLATINUM|FIN8|BRONZE BUTLER|OilRig|FIN6|APT3|APT28|APT1|Ke3chang|Cleaver",
            "name": "Detect Mimikatz Using Loaded Images",
            "references": [
                "https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for.html"
            ],
            "released": "2019-12-03",
            "search": "`sysmon` EventCode=7 | stats values(ImageLoaded) as ImageLoaded values(ProcessId) as ProcessId by Computer, Image | search ImageLoaded=*WinSCard.dll ImageLoaded=*cryptdll.dll ImageLoaded=*hid.dll ImageLoaded=*samlib.dll ImageLoaded=*vaultcli.dll | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_mimikatz_using_loaded_images_filter`",
            "search_name": "ESCU - Detect Mimikatz Using Loaded Images - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a|5d14a962-569e-4578-939f-f386feb63ce4",
            "tags": {
                "analytics_story": [
                    "Credential Dumping",
                    "Detect Zerologon Attack"
                ],
                "asset_type": "Windows",
                "cis20": [
                    "CIS 6",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Whitefly",
                    "Blue Mockingbird",
                    "Silence",
                    "Threat Group-3390",
                    "Leviathan",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Stolen Pencil",
                    "APT32",
                    "Lazarus Group",
                    "Leafminer",
                    "Magic Hound",
                    "MuddyWater",
                    "PLATINUM",
                    "FIN8",
                    "BRONZE BUTLER",
                    "OilRig",
                    "FIN6",
                    "APT3",
                    "APT28",
                    "APT1",
                    "Ke3chang",
                    "Cleaver"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "LSASS Memory"
                ],
                "nist": [
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_mimikatz_via_powershell_and_eventcode_4703": {
            "SPLEase": "None",
            "alertvolume": "None",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_mimikatz_via_powershell_and_eventcode_4703",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": "",
            "date": "2019-02-27",
            "description": "This search looks for PowerShell requesting privileges consistent with credential dumping. Deprecated, looks like things changed from a logging perspective.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 16",
            "escu_nist": "PR.IP|PR.AC|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting Windows Security logs. You must also enable the account change auditing here: http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorWindowseventlogdata. Additionally, this search requires you to enable your Group Management Audit Logs in your Local Windows Security Policy and to be ingesting those logs.  More information on how to enable them can be found here: http://whatevernetworks.com/auditing-group-membership-changes-in-active-directory/. Finally, please make sure that the local administrator group name is \"Administrators\" to be able to look for the right group membership changes.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting Windows Security logs. You must also enable the account change auditing here: http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorWindowseventlogdata. Additionally, this search requires you to enable your Group Management Audit Logs in your Local Windows Security Policy and to be ingesting those logs.  More information on how to enable them can be found here: http://whatevernetworks.com/auditing-group-membership-changes-in-active-directory/. Finally, please make sure that the local administrator group name is \"Administrators\" to be able to look for the right group membership changes.",
            "icon": "ES_Use_Case.png",
            "id": "detect_mimikatz_via_powershell_and_eventcode_4703",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "The activity may be legitimate. PowerShell is often used by administrators to perform various tasks, and it's possible this event could be generated in those cases. In these cases, false positives should be fairly obvious and you may need to tweak the search to eliminate noise.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "eventtype=wineventlog_security",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_security"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_mimikatz_via_powershell_and_eventcode_4703_filter"
                }
            ],
            "mitre_sub_technique": "T1003.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Sandworm Team|Whitefly|Blue Mockingbird|Silence|Threat Group-3390|Leviathan|APT41|Soft Cell|TEMP.Veles|APT33|APT39|Stolen Pencil|APT32|Lazarus Group|Leafminer|Magic Hound|MuddyWater|PLATINUM|FIN8|BRONZE BUTLER|OilRig|FIN6|APT3|APT28|APT1|Ke3chang|Cleaver",
            "name": "Detect Mimikatz Via Powershell And Eventcode 4703",
            "references": [],
            "released": "2019-02-27",
            "search": "`wineventlog_security` signature_id=4703 Process_Name=*powershell.exe | rex field=Message \"Enabled Privileges:\\s+(?<privs>\\w+)\\s+Disabled Privileges:\" | where privs=\"SeDebugPrivilege\" | stats count min(_time) as firstTime max(_time) as lastTime by dest, Process_Name, privs, Process_ID, Message | rename privs as \"Enabled Privilege\" | rename Process_Name as process |  `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_mimikatz_via_powershell_and_eventcode_4703_filter`",
            "search_name": "ESCU - Detect Mimikatz Via PowerShell And EventCode 4703 - Rule",
            "tags": {
                "asset_type": "Windows",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Whitefly",
                    "Blue Mockingbird",
                    "Silence",
                    "Threat Group-3390",
                    "Leviathan",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Stolen Pencil",
                    "APT32",
                    "Lazarus Group",
                    "Leafminer",
                    "Magic Hound",
                    "MuddyWater",
                    "PLATINUM",
                    "FIN8",
                    "BRONZE BUTLER",
                    "OilRig",
                    "FIN6",
                    "APT3",
                    "APT28",
                    "APT1",
                    "Ke3chang",
                    "Cleaver"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "LSASS Memory"
                ],
                "nist": [
                    "PR.IP",
                    "PR.AC",
                    "DE.CM"
                ],
                "security_domain": "access"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_mshta_exe_running_scripts_in_command-line_arguments": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious MSHTA Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_mshta_exe_running_scripts_in_command-line_arguments",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.005/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-09",
            "description": "This search looks for the execution of \"mshta.exe\" with command-line arguments that launch a script. The search will return the first time and last time these command-line arguments were used for these executions, as well as the target system, the user, process \"mshta.exe\" and its parent process.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you need to be ingesting logs with the process name, parent process, and command-line executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you need to be ingesting logs with the process name, parent process, and command-line executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "icon": "ES_Use_Case.png",
            "id": "detect_mshta_exe_running_scripts_in_command-line_arguments",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Although unlikely, some legitimate applications may exhibit this behavior, triggering a false positive.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_mshta_exe_running_scripts_in_command_line_arguments_filter"
                }
            ],
            "mitre_sub_technique": "T1218.005",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1218",
            "mitre_threat_groups": "Inception|Kimsuky|APT32|MuddyWater|FIN7",
            "name": "Detect Mshta Exe Running Scripts In Command-Line Arguments",
            "references": [],
            "released": "2020-11-09",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=mshta.exe (Processes.process=*vbscript* OR Processes.process=*javascript*) by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| search (process=*vbscript* OR process=*javascript*) | `detect_mshta_exe_running_scripts_in_command_line_arguments_filter`",
            "search_name": "ESCU - Detect mshta exe running scripts in command-line arguments - Rule",
            "story": "2b1800dd-92f9-47dd-a981-fdf13w1q5d55",
            "tags": {
                "analytics_story": [
                    "Suspicious MSHTA Activity"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.005/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "Inception",
                    "Kimsuky",
                    "APT32",
                    "MuddyWater",
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1218"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Mshta"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "detect_new_api_calls_from_user_roles": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS User Monitoring",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-04-16",
                    "description": "This search looks for successful API calls made by different user roles, then creates a baseline of the earliest and latest times we have encountered this user role. It also returns the name of the API call in our dataset--grouped by user role and name of the API call--that occurred within the last 30 days. In this support search, we are only looking for events where the user identity is Assumed Role.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user role entries in `previously_seen_api_calls_from_user_roles.csv`, which is a lookup file created as a result of running this support search.",
                    "id": "fc0edc95-fq2c-48b0-9f6f-63da3289fd03",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/previously_seen_api_calls_from_user_roles.csv",
                            "description": "A placeholder for a list of AWS API calls for each user role",
                            "filename": "previously_seen_api_calls_from_user_roles.csv",
                            "name": "previously_seen_api_calls_from_user_roles"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_api_call_per_user_roles_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Previously seen API call per user roles in CloudTrail",
                    "search": "`cloudtrail` eventType=AwsApiCall errorCode=success userIdentity.type=AssumedRole | stats earliest(_time) as earliest latest(_time) as latest by userName eventName | outputlookup previously_seen_api_calls_from_user_roles | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS User Monitoring"
                        ],
                        "detections": [
                            "Detect new API calls from user roles"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_new_api_calls_from_user_roles",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-04-16",
            "description": "This search detects new API calls that have either never been seen before or that have not been seen in the previous hour, where the identity type is `AssumedRole`.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously seen API call per user roles in CloudTrail\" support search once to create a history of previously seen user roles.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously seen API call per user roles in CloudTrail\" support search once to create a history of previously seen user roles.",
            "icon": "ES_Use_Case.png",
            "id": "detect_new_api_calls_from_user_roles",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "It is possible that there are legitimate user roles making new or infrequently used API calls in your infrastructure, causing the search to trigger.",
            "lookups": [
                {
                    "description": "A placeholder for a list of AWS API calls for each user role",
                    "filename": "previously_seen_api_calls_from_user_roles.csv",
                    "name": "previously_seen_api_calls_from_user_roles"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_new_api_calls_from_user_roles_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Detect New API Calls From User Roles",
            "references": [],
            "released": "2018-04-16",
            "search": "`cloudtrail` eventType=AwsApiCall errorCode=success userIdentity.type=AssumedRole [search `cloudtrail` eventType=AwsApiCall errorCode=success  userIdentity.type=AssumedRole | stats earliest(_time) as earliest latest(_time) as latest by userName eventName |  inputlookup append=t previously_seen_api_calls_from_user_roles | stats min(earliest) as earliest, max(latest) as latest by userName eventName | outputlookup previously_seen_api_calls_from_user_roles| eval newApiCallfromUserRole=if(earliest>=relative_time(now(), \"-70m@m\"), 1, 0) | where newApiCallfromUserRole=1 | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | table eventName userName]  |rename userName as user| stats values(eventName) earliest(_time) as earliest latest(_time) as latest by user | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | `detect_new_api_calls_from_user_roles_filter`",
            "search_name": "ESCU - Detect new API calls from user roles - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50f1269af3",
            "tags": {
                "analytics_story": [
                    "AWS User Monitoring"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_new_local_admin_account": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=detect_new_local_admin_account",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-security.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-system.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-08",
            "description": "This search looks for newly created accounts that have been elevated to local administrators.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "PR.AC|DE.CM",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "detect_new_local_admin_account",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives|Command and Control",
            "known_false_positives": "The activity may be legitimate. For this reason, it's best to verify the account with an administrator and ask whether there was a valid service request for the account creation. If your local administrator group name is not \"Administrators\", this search may generate an excessive number of false positives",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "eventtype=wineventlog_security",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_security"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_new_local_admin_account_filter"
                }
            ],
            "mitre_sub_technique": "T1136.001",
            "mitre_tactic": "TA0003",
            "mitre_tactic_display": "Persistence",
            "mitre_technique": "T1136",
            "mitre_threat_groups": "APT39|APT41|Dragonfly 2.0|Leafminer|APT3",
            "name": "Detect New Local Admin Account",
            "references": [],
            "released": "2020-07-08",
            "search": "`wineventlog_security` EventCode=4720 OR (EventCode=4732 Group_Name=Administrators) | transaction member_id connected=false maxspan=180m | rename member_id as user | stats count min(_time) as firstTime max(_time) as lastTime by user dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_new_local_admin_account_filter`",
            "search_name": "ESCU - Detect New Local Admin account - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-security.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-system.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives",
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "APT41",
                    "Dragonfly 2.0",
                    "Leafminer",
                    "APT3"
                ],
                "mitre_attack_id": [
                    "T1136"
                ],
                "mitre_attack_tactics": [
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Local Account"
                ],
                "nist": [
                    "PR.AC",
                    "DE.CM"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "detect_new_login_attempts_to_routers": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Router and Infrastructure Security",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Operations",
            "dashboard": "showcase_security_content?showcaseId=detect_new_login_attempts_to_routers",
            "data_source_categories": "DS003Authentication-ET01Success|DS003Authentication-ET02Failure",
            "datamodel": "Authentication",
            "dataset": "",
            "date": "2017-09-12",
            "description": "The search queries the authentication logs for assets that are categorized as routers in the ES Assets and Identity Framework, to identify connections that have not been seen before in the last 30 days.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 11",
            "escu_nist": "PR.PT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must ensure the network router devices are categorized as \"router\" in the Assets and identity table. You must also populate the Authentication data model with logs related to users authenticating to routing infrastructure.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must ensure the network router devices are categorized as \"router\" in the Assets and identity table. You must also populate the Authentication data model with logs related to users authenticating to routing infrastructure.",
            "icon": "ES_Use_Case.png",
            "id": "detect_new_login_attempts_to_routers",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Legitimate router connections may appear as new connections",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_new_login_attempts_to_routers_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect New Login Attempts To Routers",
            "references": [],
            "released": "2017-09-12",
            "search": "| tstats `security_content_summariesonly` count earliest(_time) as earliest latest(_time) as latest from datamodel=Authentication where Authentication.dest_category=router by Authentication.dest Authentication.user| eval isOutlier=if(earliest >= relative_time(now(), \"-30d@d\"), 1, 0) | where isOutlier=1| `security_content_ctime(earliest)`| `security_content_ctime(latest)` | `drop_dm_object_name(\"Authentication\")` | `detect_new_login_attempts_to_routers_filter`",
            "search_name": "ESCU - Detect New Login Attempts to Routers - Rule",
            "security_domain": "network",
            "story": "91c676cf-0b23-438d-abee-f6335e177e77",
            "tags": {
                "analytics_story": [
                    "Router and Infrastructure Security"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_new_open_gcp_storage_buckets": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious GCP Storage Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Storage Bucket",
            "author": "Shannon Davis, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_new_open_gcp_storage_buckets",
            "data_source_categories": "VendorSpecific-gcp-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-08-05",
            "description": "This search looks for GCP PubSub events where a user has created an open/public GCP Storage bucket.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "PR.DS|PR.AC|DE.CM",
            "hasSearch": "Yes",
            "help": "This search relies on the Splunk Add-on for Google Cloud Platform, setting up a Cloud Pub/Sub input, along with the relevant GCP PubSub topics and logging sink to capture GCP Storage Bucket events (https://cloud.google.com/logging/docs/routing/overview).",
            "highlight": "No",
            "how_to_implement": "This search relies on the Splunk Add-on for Google Cloud Platform, setting up a Cloud Pub/Sub input, along with the relevant GCP PubSub topics and logging sink to capture GCP Storage Bucket events (https://cloud.google.com/logging/docs/routing/overview).",
            "icon": "ES_Use_Case.png",
            "id": "detect_new_open_gcp_storage_buckets",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "While this search has no known false positives, it is possible that a GCP admin has legitimately created a public bucket for a specific purpose. That said, GCP strongly advises against granting full control to the \"allUsers\" group.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_new_open_gcp_storage_buckets_filter"
                }
            ],
            "mitre_sub_technique": "T1530",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1530",
            "mitre_threat_groups": "no",
            "name": "Detect New Open GCP Storage Buckets",
            "references": [],
            "released": "2020-08-05",
            "search": "`google_gcp_pubsub_message` data.resource.type=gcs_bucket data.protoPayload.methodName=storage.setIamPermissions | spath output=action path=data.protoPayload.serviceData.policyDelta.bindingDeltas{}.action | spath output=user path=data.protoPayload.authenticationInfo.principalEmail | spath output=location path=data.protoPayload.resourceLocation.currentLocations{} | spath output=src path=data.protoPayload.requestMetadata.callerIp | spath output=bucketName path=data.protoPayload.resourceName | spath output=role path=data.protoPayload.serviceData.policyDelta.bindingDeltas{}.role | spath output=member path=data.protoPayload.serviceData.policyDelta.bindingDeltas{}.member | search (member=allUsers AND action=ADD) | table  _time, bucketName, src, user, location, action, role, member | search `detect_new_open_gcp_storage_buckets_filter`",
            "search_name": "ESCU - Detect New Open GCP Storage Buckets - Rule",
            "story": "4d656b2e-d6be-11ea-87d0-0242ac130003",
            "tags": {
                "analytics_story": [
                    "Suspicious GCP Storage Activities"
                ],
                "asset_type": "GCP Storage Bucket",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1530"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Data from Cloud Storage Object"
                ],
                "nist": [
                    "PR.DS",
                    "PR.AC",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_new_open_s3_buckets": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS S3 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "S3 Bucket",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_new_open_s3_buckets",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-07-25",
            "description": "This search looks for CloudTrail events where a user has created an open/public S3 bucket.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "PR.DS|PR.AC|DE.CM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), and then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), and then configure your CloudTrail inputs. The threshold value should be tuned to your environment.",
            "icon": "ES_Use_Case.png",
            "id": "detect_new_open_s3_buckets",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "While this search has no known false positives, it is possible that an AWS admin has legitimately created a public bucket for a specific purpose. That said, AWS strongly advises against granting full control to the \"All Users\" group.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_new_open_s3_buckets_filter"
                }
            ],
            "mitre_sub_technique": "T1530",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1530",
            "mitre_threat_groups": "no",
            "name": "Detect New Open S3 Buckets",
            "references": [],
            "released": "2018-07-25",
            "search": "`cloudtrail` AllUsers eventName=PutBucketAcl | spath output=userIdentityArn path=userIdentity.arn | spath output=bucketName path=requestParameters.bucketName | spath output=aclControlList path=requestParameters.AccessControlPolicy.AccessControlList | spath input=aclControlList output=grantee path=Grant{} | mvexpand grantee | spath input=grantee | search Grantee.URI=*AllUsers | rename userIdentityArn as user| table _time, src,awsRegion Permission, Grantee.URI, bucketName, user | `detect_new_open_s3_buckets_filter`",
            "search_name": "ESCU - Detect New Open S3 buckets - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50w3168af3",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS S3 Activities"
                ],
                "asset_type": "S3 Bucket",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1530"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Data from Cloud Storage Object"
                ],
                "nist": [
                    "PR.DS",
                    "PR.AC",
                    "DE.CM"
                ],
                "risk_object": "src",
                "risk_object_type": "system",
                "risk_score": 20,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_new_user_aws_console_login": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS Login Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last 30 days.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "fc0edc95-ff2b-48b0-9f6f-63da3789fd03",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) as firstTime latest(_time) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Jason Brewer, Splunk",
                    "date": "2018-04-30",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by ARN, within the last hour.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Please validate the user name entries in `previously_seen_users_console_logins`, which is a lookup file created as a result of running this support search.",
                    "id": "06c036e6-d6d7-4daa-bd76-411c3d356031",
                    "lookups": [
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        },
                        {
                            "collection": "previously_seen_users_console_logins",
                            "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                            "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                            "name": "previously_seen_users_console_logins"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail",
                    "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | iplocation src | eval City=if(City LIKE \"\",src,City),Region=if(Region LIKE \"\",src,Region) | stats earliest(_time) AS firstTime latest(_time) AS lastTime by user src City Region Country | inputlookup append=t previously_seen_users_console_logins | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS Login Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_new_user_aws_console_login",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Run the \"Previously seen users in CloudTrail\" support search only once to create a baseline of previously seen IAM users within the last 30 days. Run \"Update previously seen users in CloudTrail\" hourly (or more frequently depending on how often you run the detection searches) to refresh the baselines.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Run the \"Previously seen users in CloudTrail\" support search only once to create a baseline of previously seen IAM users within the last 30 days. Run \"Update previously seen users in CloudTrail\" hourly (or more frequently depending on how often you run the detection searches) to refresh the baselines.",
            "icon": "ES_Use_Case.png",
            "id": "detect_new_user_aws_console_login",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "When a legitimate new user logins for the first time, this activity will be detected. Check how old the account is and verify that the user activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_users_console_logins",
                    "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                    "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                    "name": "previously_seen_users_console_logins"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_new_user_aws_console_login_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Detect New User AWS Console Login",
            "references": "",
            "released": "2020-07-21",
            "search": "`cloudtrail` eventName=ConsoleLogin | rename userIdentity.arn as user | stats earliest(_time) as firstTime latest(_time) as lastTime by user | inputlookup append=t previously_seen_users_console_logins  | stats min(firstTime) as firstTime max(lastTime) as lastTime by user | eval userStatus=if(firstTime >= relative_time(now(), \"-70m@m\"), \"First Time Logging into AWS Console\",\"Previously Seen User\") | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`| where userStatus =\"First Time Logging into AWS Console\"  | `detect_new_user_aws_console_login_filter`",
            "search_name": "ESCU - Detect new user AWS Console Login - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c59f1268af3",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS Login Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_new_user_aws_console_login_-_dm": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Cloud Authentication Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then creates a baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by username, within the last 30 days.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "0a87ecf9-dc6a-43af-861a-205e75a09bf5",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authentication.src | iplocation Authentication.src | rename Authentication.user as user Authentication.src as src | table user src City Region Country firstTime lastTime | outputlookup previously_seen_users_console_logins.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2020-05-28",
                    "description": "This search looks for CloudTrail events where a user logs into the console, then updates the baseline of the latest and earliest times, City, Region, and Country we have encountered this user in our dataset, grouped by user, within the last hour.",
                    "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Validate the user name entries in `previously_seen_users_console_logins.csv`, which is a lookup file created by this support search.",
                    "id": "66ff71c2-7e01-47dd-a041-906688c9d322",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "update_previously_seen_users_in_cloudtrail___dm_filter"
                        }
                    ],
                    "name": "Update previously seen users in CloudTrail - DM",
                    "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user Authenticaiton.src | iplocation Authentication.src | rename Authentication.user as user Authentciation.src as src | table user src City Region Country firstTime lastTime | inputlookup append=t previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user src City Region Country | outputlookup previously_seen_users_console_logins.csv",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Cloud Authentication Activities"
                        ],
                        "detections": [
                            "Detect AWS Console Login by User from New Country",
                            "Detect AWS Console Login by User from New Region",
                            "Detect AWS Console Login by User from New City",
                            "Detect new user AWS Console Login - DM"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_new_user_aws_console_login_-_dm",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "Authentication",
            "dataset": "",
            "date": "2020-05-28",
            "description": "This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Run the \"Previously seen users in CloudTrail\" support search only once to create a baseline of previously seen IAM users within the last 30 days. Run \"Update previously seen users in CloudTrail\" hourly (or more frequently depending on how often you run the detection searches) to refresh the baselines.",
            "highlight": "No",
            "how_to_implement": "You must install and configure the Splunk Add-on for AWS (version 5.1.0 or later) and Enterprise Security 6.2, which contains the required updates to the Authentication data model for cloud use cases. Run the \"Previously seen users in CloudTrail\" support search only once to create a baseline of previously seen IAM users within the last 30 days. Run \"Update previously seen users in CloudTrail\" hourly (or more frequently depending on how often you run the detection searches) to refresh the baselines.",
            "icon": "ES_Use_Case.png",
            "id": "detect_new_user_aws_console_login_-_dm",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "When a legitimate new user logins for the first time, this activity will be detected. Check how old the account is and verify that the user activity is legitimate.",
            "lookups": [
                {
                    "collection": "previously_seen_users_console_logins",
                    "description": "A table of users seen doing console logins, and the first and last time that the activity was observed",
                    "fields_list": "_key, firstTime, lastTime, user, src, City, Region, Country",
                    "name": "previously_seen_users_console_logins"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_new_user_aws_console_login___dm_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect New User AWS Console Login - Dm",
            "references": "",
            "released": "2020-05-28",
            "search": "| tstats earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Authentication where Authentication.signature=ConsoleLogin by Authentication.user | `drop_dm_object_name(Authentication)` | inputlookup append=t previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user | eval userStatus=if(firstTime >=relative_time(now(), '-70m@m'), 'First Time Logging into AWS Console','Previously Seen User')| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `detect_new_user_aws_console_login___dm_filter`",
            "search_name": "ESCU - Detect new user AWS Console Login - DM - Rule",
            "security_domain": "network",
            "story": "6380ebbb-55c5-4fce-b754-01fd565fb73c",
            "tags": {
                "analytics_story": [
                    "Suspicious Cloud Authentication Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_oulook_exe_writing_a__zip_file": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Phishing Payloads",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_oulook_exe_writing_a__zip_file",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Filesystem",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for execution of process `outlook.exe` where the process is writing a `.zip` file to the disk.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7|CIS 8",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records filesystem and process activity from your hosts to populate the Endpoint data model. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records filesystem and process activity from your hosts to populate the Endpoint data model. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon.",
            "icon": "ES_Use_Case.png",
            "id": "detect_oulook_exe_writing_a__zip_file",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "It is not uncommon for outlook to write legitimate zip files to the disk.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_oulook_exe_writing_a__zip_file_filter"
                }
            ],
            "mitre_sub_technique": "T1566.001",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1566",
            "mitre_threat_groups": "Magic Hound|Windshift|APT33|Sandworm Team|Naikon|Gamaredon Group|Sharpshooter|Molerats|Mofang|Wizard Spider|RTM|Frankenstein|Inception|BlackTech|APT-C-36|APT41|Machete|admin@338|Kimsuky|APT12|TA505|Silence|The White Company|APT39|FIN4|Darkhotel|Gallmaker|Tropic Trooper|Turla|Gorgon Group|Rancor|DarkHydrus|Cobalt Group|FIN7|OilRig|Lazarus Group|APT19|Dragonfly 2.0|BRONZE BUTLER|APT32|FIN8|MuddyWater|APT28|TA459|Leviathan|Patchwork|PLATINUM|Elderwood|APT29|APT37|menuPass",
            "name": "Detect Oulook Exe Writing A Zip File",
            "references": "",
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly`  min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.process_name=outlook.exe OR Processes.process_name=explorer.exe by _time span=5m Processes.parent_process_id Processes.process_id Processes.dest Processes.process_name Processes.parent_process_name Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename process_id as malicious_id| rename parent_process_id as outlook_id| join malicious_id type=inner[| tstats `security_content_summariesonly` count values(Filesystem.file_path) as file_path values(Filesystem.file_name) as file_name  FROM datamodel=Endpoint.Filesystem where (Filesystem.file_path=*zip*   OR Filesystem.file_name=*.lnk ) AND (Filesystem.file_path=C:\\\\Users* OR Filesystem.file_path=*Local\\\\Temp*) by  _time span=5m Filesystem.process_id Filesystem.file_hash Filesystem.dest  | `drop_dm_object_name(Filesystem)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename process_id as malicious_id| fields malicious_id outlook_id dest file_path file_name file_hash count file_id] | table firstTime lastTime user malicious_id outlook_id process_name parent_process_name file_name  file_path | where file_name != \"\" | `detect_oulook_exe_writing_a__zip_file_filter` ",
            "search_name": "ESCU - Detect Oulook exe writing a  zip file - Rule",
            "story": "57226b40-94f3-4ce5-b101-a75f67759c27",
            "tags": {
                "analytics_story": [
                    "Phishing Payloads"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Magic Hound",
                    "Windshift",
                    "APT33",
                    "Sandworm Team",
                    "Naikon",
                    "Gamaredon Group",
                    "Sharpshooter",
                    "Molerats",
                    "Mofang",
                    "Wizard Spider",
                    "RTM",
                    "Frankenstein",
                    "Inception",
                    "BlackTech",
                    "APT-C-36",
                    "APT41",
                    "Machete",
                    "admin@338",
                    "Kimsuky",
                    "APT12",
                    "TA505",
                    "Silence",
                    "The White Company",
                    "APT39",
                    "FIN4",
                    "Darkhotel",
                    "Gallmaker",
                    "Tropic Trooper",
                    "Turla",
                    "Gorgon Group",
                    "Rancor",
                    "DarkHydrus",
                    "Cobalt Group",
                    "FIN7",
                    "OilRig",
                    "Lazarus Group",
                    "APT19",
                    "Dragonfly 2.0",
                    "BRONZE BUTLER",
                    "APT32",
                    "FIN8",
                    "MuddyWater",
                    "APT28",
                    "TA459",
                    "Leviathan",
                    "Patchwork",
                    "PLATINUM",
                    "Elderwood",
                    "APT29",
                    "APT37",
                    "menuPass"
                ],
                "mitre_attack_id": [
                    "T1566"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Spearphishing Attachment"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "detect_outbound_smb_traffic": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Hidden Cobra Malware|DHS Report TA18-074A|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=detect_outbound_smb_traffic",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for outbound SMB connections made by hosts within your network to the Internet. SMB traffic is used for Windows file-sharing activity. One of the techniques often used by attackers involves retrieving the credential hash using an SMB request made to a compromised server controlled by the threat actor.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 12",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "In order to run this search effectively, we highly recommend that you leverage the Assets and Identity framework. It is important that you have good understanding of how your network segments are designed, and be able to distinguish internal from external address space. Add a category named `internal` to the CIDRs that host the company's assets in `assets_by_cidr.csv` lookup file, which is located in `$SPLUNK_HOME/etc/apps/SA-IdentityManagement/lookups/`. More information on updating this lookup can be found here: https://docs.splunk.com/Documentation/ES/5.0.0/Admin/Addassetandidentitydata. This search also requires you to be ingesting your network traffic and populating the Network_Traffic data model",
            "highlight": "No",
            "how_to_implement": "In order to run this search effectively, we highly recommend that you leverage the Assets and Identity framework. It is important that you have good understanding of how your network segments are designed, and be able to distinguish internal from external address space. Add a category named `internal` to the CIDRs that host the company's assets in `assets_by_cidr.csv` lookup file, which is located in `$SPLUNK_HOME/etc/apps/SA-IdentityManagement/lookups/`. More information on updating this lookup can be found here: https://docs.splunk.com/Documentation/ES/5.0.0/Admin/Addassetandidentitydata. This search also requires you to be ingesting your network traffic and populating the Network_Traffic data model",
            "icon": "ES_Use_Case.png",
            "id": "detect_outbound_smb_traffic",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives|Command and Control",
            "known_false_positives": "It is likely that the outbound Server Message Block (SMB) traffic is legitimate, if the company's internal networks are not well-defined in the Assets and Identity Framework. Categorize the internal CIDR blocks as `internal` in the lookup file to avoid creating notable events for traffic destined to those CIDR blocks. Any other network connection that is going out to the Internet should be investigated and blocked. Best practices suggest preventing external communications of all SMB versions and related protocols at the network boundary.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_outbound_smb_traffic_filter"
                }
            ],
            "mitre_sub_technique": "T1071.002",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "APT41|SilverTerrier|Machete|Honeybee",
            "name": "Detect Outbound SMB Traffic",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count earliest(_time) as earliest latest(_time) as latest values(All_Traffic.action) from datamodel=Network_Traffic where All_Traffic.action !=blocked All_Traffic.dest_category !=internal (All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb) by All_Traffic.src_ip All_Traffic.dest_ip | `drop_dm_object_name(\"All_Traffic\")` | search ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16) | `security_content_ctime(earliest)`| `security_content_ctime(latest)` | `detect_outbound_smb_traffic_filter` ",
            "search_name": "ESCU - Detect Outbound SMB Traffic - Rule",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Hidden Cobra Malware",
                    "DHS Report TA18-074A",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives",
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT41",
                    "SilverTerrier",
                    "Machete",
                    "Honeybee"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "File Transfer Protocols"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "detect_path_interception_by_creation_of_program_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_path_interception_by_creation_of_program_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1574.009/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-03",
            "description": "The detection Detect Path Interception By Creation Of program exe is detecting the abuse of unquoted service paths, which is a popular technique for privilege escalation. ",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "detect_path_interception_by_creation_of_program_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_path_interception_by_creation_of_program_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1574.009",
            "mitre_tactic": "TA0003|TA0004|TA0005",
            "mitre_tactic_display": "Persistence|Privilege Escalation|Defense Evasion",
            "mitre_technique": "T1574",
            "mitre_threat_groups": "no",
            "name": "Detect Path Interception By Creation Of Program Exe",
            "references": [
                "https://medium.com/@SumitVerma101/windows-privilege-escalation-part-1-unquoted-service-path-c7a011a8d8ae"
            ],
            "released": "2020-07-03",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process_name=services.exe by Processes.user Processes.process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | rex field=process \"^.*\\\\\\\\(?<service_process>.*\\.(?:exe|bat|com|ps1))\" | eval process_name = lower(process_name) | eval service_process = lower(service_process)| where process_name != service_process | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_path_interception_by_creation_of_program_exe_filter`",
            "search_name": "ESCU - Detect Path Interception By Creation Of program exe - Rule",
            "story": "30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Windows Persistence Techniques"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1574.009/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1574"
                ],
                "mitre_attack_tactics": [
                    "Persistence",
                    "Privilege Escalation",
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Path Interception by Unquoted Path"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "detect_port_security_violation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Router and Infrastructure Security",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Mikael Bjerkeland, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_port_security_violation",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-28",
            "description": "By enabling Port Security on a Cisco switch you can restrict input to an interface by limiting and identifying MAC addresses of the workstations that are allowed to access the port. When you assign secure MAC addresses to a secure port, the port does not forward packets with source addresses outside the group of defined addresses. If you limit the number of secure MAC addresses to one and assign a single secure MAC address, the workstation attached to that port is assured the full bandwidth of the port. If a port is configured as a secure port and the maximum number of secure MAC addresses is reached, when the MAC address of a workstation attempting to access the port is different from any of the identified secure MAC addresses, a security violation occurs.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 11",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with Port Security and Error Disable for this to work (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12-2/25ew/configuration/guide/conf/port_sec.html) and log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "highlight": "No",
            "how_to_implement": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with Port Security and Error Disable for this to work (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12-2/25ew/configuration/guide/conf/port_sec.html) and log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "icon": "ES_Use_Case.png",
            "id": "detect_port_security_violation",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "",
            "known_false_positives": "This search might be prone to high false positives if you have malfunctioning devices connected to your ethernet ports or if end users periodically connect physical devices to the network.",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=cisco_ios",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cisco_networks"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_port_security_violation_filter"
                }
            ],
            "mitre_sub_technique": "T1200|T1498|T1557.002",
            "mitre_tactic": "TA0001|TA0040",
            "mitre_tactic_display": "Initial Access|Impact",
            "mitre_technique": "T1200|T1498|T1557",
            "mitre_threat_groups": "DarkVishnya|no",
            "name": "Detect Port Security Violation",
            "references": [],
            "released": "2020-10-28",
            "search": "`cisco_networks` (facility=\"PM\" mnemonic=\"ERR_DISABLE\" disable_cause=\"psecure-violation\") OR (facility=\"PORT_SECURITY\" mnemonic=\"PSECURE_VIOLATION\" OR mnemonic=\"PSECURE_VIOLATION_VLAN\") | eval src_interface=src_int_prefix_long+src_int_suffix | stats min(_time) AS firstTime max(_time) AS lastTime values(disable_cause) AS disable_cause values(src_mac) AS src_mac values(src_vlan) AS src_vlan values(action) AS action count by host src_interface | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `detect_port_security_violation_filter`",
            "search_name": "ESCU - Detect Port Security Violation - Rule",
            "story": "91c676cf-0b23-438d-abee-f6335e177e77",
            "tags": {
                "analytics_story": [
                    "Router and Infrastructure Security"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 1",
                    "CIS 11"
                ],
                "detection_name": "Detect Port Security Violation",
                "kill_chain_phases": [
                    "Reconnaissance",
                    "Delivery",
                    "Exploitation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "DarkVishnya",
                    "no"
                ],
                "mitre_attack_id": [
                    "T1200",
                    "T1498",
                    "T1557"
                ],
                "mitre_attack_tactics": [
                    "Initial Access",
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Hardware Additions",
                    "Network Denial of Service"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_processes_used_for_system_network_configuration_discovery": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Unusual Processes",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=detect_processes_used_for_system_network_configuration_discovery",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1016/discovery_commands/windows-sysmon.log"
            ],
            "date": "2020-11-10",
            "description": "This search looks for fast execution of processes used for system network configuration discovery on the endpoint.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 2",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records registry activity from your hosts to populate the Endpoint data model in the processes node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon. The data used for this search is usually generated via logs that report reads and writes to the registry or that are populated via Windows event logs, after enabling process tracking in your Windows audit settings.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records registry activity from your hosts to populate the Endpoint data model in the processes node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon. The data used for this search is usually generated via logs that report reads and writes to the registry or that are populated via Windows event logs, after enabling process tracking in your Windows audit settings.",
            "icon": "ES_Use_Case.png",
            "id": "detect_processes_used_for_system_network_configuration_discovery",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Command and Control|Actions On Objectives",
            "known_false_positives": "It is uncommon for normal users to execute a series of commands used for network discovery. System administrators often use scripts to execute these commands. These can generate false positives.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "(process_name= \"arp.exe\" OR process_name= \"at.exe\" OR process_name= \"attrib.exe\" OR process_name= \"cscript.exe\" OR process_name= \"dsquery.exe\" OR process_name= \"hostname.exe\" OR process_name= \"ipconfig.exe\" OR process_name= \"mimikatz.exe\" OR process_name= \"nbstat.exe\" OR process_name= \"net.exe\" OR process_name= \"netsh.exe\" OR process_name= \"nslookup.exe\" OR process_name= \"ping.exe\" OR process_name= \"quser.exe\" OR process_name= \"qwinsta.exe\" OR process_name= \"reg.exe\" OR process_name= \"runas.exe\" OR process_name= \"sc.exe\" OR process_name= \"schtasks.exe\" OR process_name= \"ssh.exe\" OR process_name= \"systeminfo.exe\" OR process_name= \"taskkill.exe\" OR process_name= \"telnet.exe\" OR process_name= \"tracert.exe\" OR process_name=\"wscript.exe\" OR process_name= \"xcopy.exe\")",
                    "description": "This macro is a list of process that can be used to discover the network configuration",
                    "name": "system_network_configuration_discovery_tools"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_processes_used_for_system_network_configuration_discovery_filter"
                }
            ],
            "mitre_sub_technique": "T1016",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1016",
            "mitre_threat_groups": "Sandworm Team|Tropic Trooper|Frankenstein|APT41|Soft Cell|APT32|Darkhotel|MuddyWater|APT1|APT19|Dragonfly 2.0|Magic Hound|OilRig|menuPass|Threat Group-3390|Stealth Falcon|Lazarus Group|APT3|Naikon|admin@338|Turla|Ke3chang",
            "name": "Detect Processes Used For System Network Configuration Discovery",
            "references": [],
            "released": "2020-11-10",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest Processes.process_name Processes.user _time | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | search `system_network_configuration_discovery_tools` | transaction dest connected=false maxpause=5m |where eventcount>=5 | table firstTime lastTime dest user process_name process parent_process eventcount | `detect_processes_used_for_system_network_configuration_discovery_filter`",
            "search_name": "ESCU - Detect processes used for System Network Configuration Discovery - Rule",
            "story": "f4368e3f-d59f-4192-84f6-748ac5a3ddb6",
            "tags": {
                "analytics_story": [
                    "Unusual Processes"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 2"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1016/discovery_commands/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Tropic Trooper",
                    "Frankenstein",
                    "APT41",
                    "Soft Cell",
                    "APT32",
                    "Darkhotel",
                    "MuddyWater",
                    "APT1",
                    "APT19",
                    "Dragonfly 2.0",
                    "Magic Hound",
                    "OilRig",
                    "menuPass",
                    "Threat Group-3390",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "APT3",
                    "Naikon",
                    "admin@338",
                    "Turla",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1016"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "System Network Configuration Discovery"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "detect_prohibited_applications_spawning_cmd_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Command-Line Executions|Suspicious MSHTA Activity|Suspicious Zoom Child Processes|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_prohibited_applications_spawning_cmd_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.003/powershell_spawn_cmd/windows-sysmon.log"
            ],
            "date": "2020-11-10",
            "description": "This search looks for executions of cmd.exe spawned by a process that is often abused by attackers and that does not typically launch cmd.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts and populates the Endpoint data model with the resultant dataset. This search includes a lookup file, `prohibited_apps_launching_cmd.csv`, that contains a list of processes that should not be spawning cmd.exe. You can modify this lookup to better suit your environment.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts and populates the Endpoint data model with the resultant dataset. This search includes a lookup file, `prohibited_apps_launching_cmd.csv`, that contains a list of processes that should not be spawning cmd.exe. You can modify this lookup to better suit your environment.",
            "icon": "ES_Use_Case.png",
            "id": "detect_prohibited_applications_spawning_cmd_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "There are circumstances where an application may legitimately execute and interact with the Windows command-line interface. Investigate and modify the lookup file, as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "| inputlookup prohibited_apps_launching_cmd | rename prohibited_applications as parent_process_name | eval parent_process_name=\"*\" . parent_process_name | table parent_process_name",
                    "description": "This macro outputs a list of process that should not be the parent process of cmd.exe",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/prohibited_apps_launching_cmd.csv",
                            "description": "A list of processes that should not be launching cmd.exe",
                            "fields": "prohibited_applications",
                            "filename": "prohibited_apps_launching_cmd.csv",
                            "match_type": "WILDCARD(prohibited_applications)",
                            "name": "prohibited_apps_launching_cmd"
                        }
                    ],
                    "name": "prohibited_apps_launching_cmd"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_prohibited_applications_spawning_cmd_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1059.003",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1059",
            "mitre_threat_groups": "TA505|Blue Mockingbird|Tropic Trooper|Frankenstein|OilRig|Lazarus Group|Honeybee|Cobalt Group|FIN7|APT41|Soft Cell|Turla|Silence|APT32|APT39|Darkhotel|MuddyWater|APT18|APT38|Dark Caracal|Gorgon Group|Dragonfly 2.0|Rancor|Ke3chang|APT37|Leviathan|FIN8|APT28|Magic Hound|Sowbug|BRONZE BUTLER|FIN10|Threat Group-3390|menuPass|Gamaredon Group|Suckfly|Patchwork|Threat Group-1314|APT3|admin@338|APT1",
            "name": "Detect Prohibited Applications Spawning Cmd Exe",
            "references": [],
            "released": "2020-11-10",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe by Processes.parent_process_name Processes.process_name Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` |search [`prohibited_apps_launching_cmd`] | `detect_prohibited_applications_spawning_cmd_exe_filter`",
            "search_name": "ESCU - Detect Prohibited Applications Spawning cmd exe - Rule",
            "story": "f4368ddf-d59f-4192-84f6-778ac5a3ffc7|2b1800dd-92f9-47dd-a981-fdf13w1q5d55|aa3749a6-49c7-491e-a03f-4eaee5fe0258|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Suspicious Command-Line Executions",
                    "Suspicious MSHTA Activity",
                    "Suspicious Zoom Child Processes",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.003/powershell_spawn_cmd/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "TA505",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "OilRig",
                    "Lazarus Group",
                    "Honeybee",
                    "Cobalt Group",
                    "FIN7",
                    "APT41",
                    "Soft Cell",
                    "Turla",
                    "Silence",
                    "APT32",
                    "APT39",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "APT38",
                    "Dark Caracal",
                    "Gorgon Group",
                    "Dragonfly 2.0",
                    "Rancor",
                    "Ke3chang",
                    "APT37",
                    "Leviathan",
                    "FIN8",
                    "APT28",
                    "Magic Hound",
                    "Sowbug",
                    "BRONZE BUTLER",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Gamaredon Group",
                    "Suckfly",
                    "Patchwork",
                    "Threat Group-1314",
                    "APT3",
                    "admin@338",
                    "APT1"
                ],
                "mitre_attack_id": [
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Command Shell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 5
        },
        "detect_psexec_with_accepteula_flag": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware|DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=detect_psexec_with_accepteula_flag",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1021.002/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-10",
            "description": "This search looks for events where `PsExec.exe` is run with the `accepteula` flag in the command line. PsExec is a built-in Windows utility that enables you to execute processes on other systems. It is fully interactive for console applications. This tool is widely used for launching interactive command prompts on remote systems. Threat actors leverage this extensively for executing code on compromised systems. If an attacker is running PsExec for the first time, they will be prompted to accept the end-user license agreement (EULA), which can be passed as the argument `accepteula` within the command line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "detect_psexec_with_accepteula_flag",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Administrators can leverage PsExec for accessing remote systems and might pass `accepteula` as an argument if they are running this tool for the first time. However, it is not likely that you'd see multiple occurrences of this event on a machine",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_psexec_with_accepteula_flag_filter"
                }
            ],
            "mitre_sub_technique": "T1021.002",
            "mitre_tactic": "TA0008",
            "mitre_tactic_display": "Lateral Movement",
            "mitre_technique": "T1021",
            "mitre_threat_groups": "Blue Mockingbird|APT39|APT32|Orangeworm|FIN8|APT3|Lazarus Group|Threat Group-1314|Turla|Deep Panda|Ke3chang",
            "name": "Detect Psexec With Accepteula Flag",
            "references": [],
            "released": "2020-11-10",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process=*psexec* Processes.process=*accepteula* by Processes.process_name Processes.dest  Processes.parent_process_name | `drop_dm_object_name(Processes)`| `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_psexec_with_accepteula_flag_filter`",
            "search_name": "ESCU - Detect PsExec With accepteula Flag - Rule",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware",
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1021.002/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "APT32",
                    "Orangeworm",
                    "FIN8",
                    "APT3",
                    "Lazarus Group",
                    "Threat Group-1314",
                    "Turla",
                    "Deep Panda",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1021"
                ],
                "mitre_attack_tactics": [
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "SMB/Windows Admin Shares"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "detect_rare_executables": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Emotet Malware  DHS Report TA18-201A |Unusual Processes",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Unauthorized Software",
            "dashboard": "showcase_security_content?showcaseId=detect_rare_executables",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-03-16",
            "description": "This search will return a table of rare processes, the names of the systems running them, and the users who initiated each process.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 2|CIS 8",
            "escu_nist": "ID.AM|PR.PT|PR.DS|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records process activity from your hosts and populating the endpoint data model with the resultant dataset. The macro `filter_rare_process_whitelist` searches two lookup files to whitelist your processes.  These consist of `rare_process_whitelist_default.csv` and `rare_process_whitelist_local.csv`. To add your own processes to the whitelist, add them to `rare_process_whitelist_local.csv`. If you wish to remove an entry from the default lookup file, you will have to modify the macro itself to set the whitelist value for that process to false. You can modify the limit parameter and search scheduling to better suit your environment.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records process activity from your hosts and populating the endpoint data model with the resultant dataset. The macro `filter_rare_process_whitelist` searches two lookup files to whitelist your processes.  These consist of `rare_process_whitelist_default.csv` and `rare_process_whitelist_local.csv`. To add your own processes to the whitelist, add them to `rare_process_whitelist_local.csv`. If you wish to remove an entry from the default lookup file, you will have to modify the macro itself to set the whitelist value for that process to false. You can modify the limit parameter and search scheduling to better suit your environment.",
            "icon": "ES_Use_Case.png",
            "id": "detect_rare_executables",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Command and Control|Actions On Objectives",
            "known_false_positives": "Some legitimate processes may be only rarely executed in your environment. As these are identified, update `rare_process_whitelist_local.csv` to filter them out of your search results.",
            "lookups": "",
            "macros": [
                {
                    "definition": "lookup update=true lookup_rare_process_whitelist_default process as process OUTPUTNEW whitelist | where whitelist=\"false\" | lookup update=true lookup_rare_process_whitelist_local process as process OUTPUT whitelist | where whitelist=\"false\"",
                    "description": "This macro is intended to whitelist processes that have been definied as rare",
                    "lookups": [
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/rare_process_whitelist_default.csv",
                            "default_match": "false",
                            "description": "A list of rare processes that are legitimate provided by Splunk",
                            "filename": "rare_process_whitelist_default.csv",
                            "match_type": "WILDCARD(process)",
                            "min_matches": 1,
                            "name": "lookup_rare_process_whitelist_default"
                        },
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/rare_process_whitelist_local.csv",
                            "default_match": "false",
                            "description": "A list of rare processes that are legitimate provided by the end user",
                            "filename": "rare_process_whitelist_local.csv",
                            "match_type": "WILDCARD(process)",
                            "min_matches": 1,
                            "name": "lookup_rare_process_whitelist_local"
                        }
                    ],
                    "name": "filter_rare_process_whitelist"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_rare_executables_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect Rare Executables",
            "references": [],
            "released": "2020-03-16",
            "search": "| tstats `security_content_summariesonly` count values(Processes.dest) as dest values(Processes.user) as user min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.process_name  | rename Processes.process_name as process | rex field=user \"(?<user_domain>.*)\\\\\\\\(?<user_name>.*)\" | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| search [| tstats count from datamodel=Endpoint.Processes by Processes.process_name | rare Processes.process_name limit=30 | rename Processes.process_name as process| `filter_rare_process_whitelist`| table process ] | `detect_rare_executables_filter` ",
            "search_name": "ESCU - Detect Rare Executables - Rule",
            "security_domain": "endpoint",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52|f4368e3f-d59f-4192-84f6-748ac5a3ddb6",
            "tags": {
                "analytics_story": [
                    "Emotet Malware  DHS Report TA18-201A ",
                    "Unusual Processes"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 2",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM",
                    "PR.PT",
                    "PR.DS",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 5
        },
        "detect_rogue_dhcp_server": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Router and Infrastructure Security",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Mikael Bjerkeland, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_rogue_dhcp_server",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2020-08-11",
            "description": "By enabling DHCP Snooping as a Layer 2 Security measure on the organization's network devices, we will be able to detect unauthorized DHCP servers handing out DHCP leases to devices on the network (Man in the Middle attack).",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 11",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with DHCP Snooping enabled (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960x/software/15-0_2_EX/security/configuration_guide/b_sec_152ex_2960-x_cg/b_sec_152ex_2960-x_cg_chapter_01101.html) and log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "highlight": "No",
            "how_to_implement": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must be configured with DHCP Snooping enabled (see https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960x/software/15-0_2_EX/security/configuration_guide/b_sec_152ex_2960-x_cg/b_sec_152ex_2960-x_cg_chapter_01101.html) and log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices.",
            "icon": "ES_Use_Case.png",
            "id": "detect_rogue_dhcp_server",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "",
            "known_false_positives": "This search might be prone to high false positives if DHCP Snooping has been incorrectly configured or in the unlikely event that the DHCP server has been moved to another network interface.",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=cisco_ios",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cisco_networks"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_rogue_dhcp_server_filter"
                }
            ],
            "mitre_sub_technique": "T1200|T1498|T1557",
            "mitre_tactic": "TA0001|TA0040|TA0006|TA0009",
            "mitre_tactic_display": "Initial Access|Impact|Credential Access|Collection",
            "mitre_technique": "T1200|T1498|T1557",
            "mitre_threat_groups": "DarkVishnya|no|no",
            "name": "Detect Rogue DHCP Server",
            "references": [],
            "released": "2020-08-11",
            "search": "`cisco_networks` facility=\"DHCP_SNOOPING\" mnemonic=\"DHCP_SNOOPING_UNTRUSTED_PORT\" | stats min(_time) AS firstTime max(_time) AS lastTime count values(message_type) AS message_type values(src_mac) AS src_mac BY host | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`| `detect_rogue_dhcp_server_filter`",
            "search_name": "ESCU - Detect Rogue DHCP Server - Rule",
            "story": "91c676cf-0b23-438d-abee-f6335e177e77",
            "tags": {
                "analytics_story": [
                    "Router and Infrastructure Security"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 1",
                    "CIS 11"
                ],
                "detection_name": "Detect Rogue DHCP Server",
                "kill_chain_phases": [
                    "Reconnaissance",
                    "Delivery",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "DarkVishnya",
                    "no",
                    "no"
                ],
                "mitre_attack_id": [
                    "T1200",
                    "T1498",
                    "T1557"
                ],
                "mitre_attack_tactics": [
                    "Initial Access",
                    "Impact",
                    "Credential Access",
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Hardware Additions",
                    "Network Denial of Service",
                    "Man-in-the-Middle"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_s3_access_from_a_new_ip": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS S3 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "S3 Bucket",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-06-28",
                    "description": "This search looks for successful access to S3 buckets from remote IP addresses, then creates a baseline of the earliest and latest times we have encountered this remote IP within the last 30 days. In this support search, we are only looking for S3 access events where the HTTP response code from AWS is \"200\"",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your S3 access-logs inputs. You must validate the remote IP and bucket name entries in `previously_seen_S3_access_from_remote_ip.csv`, which is a lookup file created as a result of running this support search.",
                    "id": "fc0edc15-fq2c-48b0-9f6f-63qa1281fd03",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/previously_seen_S3_access_from_remote_ip.csv",
                            "description": "A placeholder for a list of IPs that have access S3",
                            "filename": "previously_seen_S3_access_from_remote_ip.csv",
                            "name": "previously_seen_S3_access_from_remote_ip"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:s3:accesslogs",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "aws_s3_accesslogs"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_s3_bucket_access_by_remote_ip_filter"
                        }
                    ],
                    "name": "Previously seen S3 bucket access by remote IP",
                    "search": "`aws_s3_accesslogs` http_status=200  | stats  earliest(_time) as earliest latest(_time) as latest by bucket_name remote_ip | outputlookup previously_seen_S3_access_from_remote_ip | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS S3 Activities"
                        ],
                        "detections": [
                            "Detect S3 access from a new IP"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_s3_access_from_a_new_ip",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|DS014WebServer-ET01Access",
            "datamodel": "",
            "dataset": "",
            "date": "2018-06-28",
            "description": "This search looks at S3 bucket-access logs and detects new or previously unseen remote IP addresses that have successfully accessed an S3 bucket.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13|CIS 14",
            "escu_nist": "PR.DS|PR.AC|DE.CM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your S3 access logs' inputs. This search works best when you run the \"Previously Seen S3 Bucket Access by Remote IP\" support search once to create a history of previously seen remote IPs and bucket names.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your S3 access logs' inputs. This search works best when you run the \"Previously Seen S3 Bucket Access by Remote IP\" support search once to create a history of previously seen remote IPs and bucket names.",
            "icon": "ES_Use_Case.png",
            "id": "detect_s3_access_from_a_new_ip",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "S3 buckets can be accessed from any IP, as long as it can make a successful connection. This will be a false postive, since the search is looking for a new IP within the past hour",
            "lookups": [
                {
                    "description": "A placeholder for a list of IPs that have access S3",
                    "filename": "previously_seen_S3_access_from_remote_ip.csv",
                    "name": "previously_seen_S3_access_from_remote_ip"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=aws:s3:accesslogs",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_s3_accesslogs"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_s3_access_from_a_new_ip_filter"
                }
            ],
            "mitre_sub_technique": "T1530",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1530",
            "mitre_threat_groups": "no",
            "name": "Detect S3 Access From A New IP",
            "references": [],
            "released": "2018-06-28",
            "search": "`aws_s3_accesslogs` http_status=200  [search `aws_s3_accesslogs` http_status=200 | stats earliest(_time) as firstTime latest(_time) as lastTime by bucket_name remote_ip | inputlookup append=t previously_seen_S3_access_from_remote_ip.csv | stats min(firstTime) as firstTime, max(lastTime) as lastTime by bucket_name remote_ip | outputlookup previously_seen_S3_access_from_remote_ip.csv | eval newIP=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newIP=1 | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | table bucket_name remote_ip]| iplocation remote_ip |rename remote_ip as src_ip | table _time bucket_name src_ip City Country operation request_uri | `detect_s3_access_from_a_new_ip_filter`",
            "search_name": "ESCU - Detect S3 access from a new IP - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50w3168af3",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS S3 Activities"
                ],
                "asset_type": "S3 Bucket",
                "cis20": [
                    "CIS 13",
                    "CIS 14"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1530"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Data from Cloud Storage Object"
                ],
                "nist": [
                    "PR.DS",
                    "PR.AC",
                    "DE.CM"
                ],
                "risk_object": "src_ip",
                "risk_object_type": "system",
                "risk_score": 10,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_snicat_sni_exfiltration": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Data Exfiltration",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Network",
            "author": "Shannon Davis, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_snicat_sni_exfiltration",
            "data_source_categories": "Other",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-21",
            "description": "This search looks for commands that the SNICat tool uses in the TLS SNI field.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "PR.DS|DE.CM|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting Zeek SSL data into Splunk. Zeek data should also be getting ingested in JSON format.  We are detecting when any of the predefined SNICat commands are found within the server_name (SNI) field. These commands are LIST, LS, SIZE, LD, CB, EX, ALIVE, EXIT, WHERE, and finito.  You can go further once this has been detected, and run other searches to decode the SNI data to prove or disprove if any data exfiltration has taken place.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting Zeek SSL data into Splunk. Zeek data should also be getting ingested in JSON format.  We are detecting when any of the predefined SNICat commands are found within the server_name (SNI) field. These commands are LIST, LS, SIZE, LD, CB, EX, ALIVE, EXIT, WHERE, and finito.  You can go further once this has been detected, and run other searches to decode the SNI data to prove or disprove if any data exfiltration has taken place.",
            "icon": "ES_Use_Case.png",
            "id": "detect_snicat_sni_exfiltration",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "index=zeek sourcetype=\"zeek:ssl:json\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "zeek_ssl"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_snicat_sni_exfiltration_filter"
                }
            ],
            "mitre_sub_technique": "T1041",
            "mitre_tactic": "TA0010",
            "mitre_tactic_display": "Exfiltration",
            "mitre_technique": "T1041",
            "mitre_threat_groups": "Sandworm Team|MuddyWater|Wizard Spider|Frankenstein|Kimsuky|Soft Cell|APT32|APT3|Gamaredon Group|Stealth Falcon|Lazarus Group|Ke3chang",
            "name": "Detect Snicat Sni Exfiltration",
            "references": [
                "https://www.mnemonic.no/blog/introducing-snicat/",
                "https://github.com/mnemonic-no/SNIcat",
                "https://attack.mitre.org/techniques/T1041/"
            ],
            "released": "2020-10-21",
            "search": "`zeek_ssl` | rex field=server_name \"(?<snicat>(LIST|LS|SIZE|LD|CB|CD|EX|ALIVE|EXIT|WHERE|finito)-[A-Za-z0-9]{16}\\.)\" | stats count by src_ip dest_ip server_name snicat | where count>0 | table src_ip dest_ip server_name snicat | `detect_snicat_sni_exfiltration_filter`",
            "search_name": "ESCU - Detect SNICat SNI Exfiltration - Rule",
            "story": "66b0fe0c-1351-11eb-adc1-0242ac120002",
            "tags": {
                "analytics_story": [
                    "Data Exfiltration"
                ],
                "asset_type": "Network",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "MuddyWater",
                    "Wizard Spider",
                    "Frankenstein",
                    "Kimsuky",
                    "Soft Cell",
                    "APT32",
                    "APT3",
                    "Gamaredon Group",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1041"
                ],
                "mitre_attack_tactics": [
                    "Exfiltration"
                ],
                "mitre_attack_technique": [
                    "Exfiltration Over C2 Channel"
                ],
                "nist": [
                    "PR.DS",
                    "DE.CM",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_software_download_to_network_device": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Router and Infrastructure Security",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Mikael Bjerkeland, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_software_download_to_network_device",
            "data_source_categories": "Other",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-10-28",
            "description": "Adversaries may abuse netbooting to load an unauthorized network device operating system from a Trivial File Transfer Protocol (TFTP) server. TFTP boot (netbooting) is commonly used by network administrators to load configuration-controlled network device images from a centralized management server. Netbooting is one option in the boot sequence and can be used to centralize, manage, and control device images.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 11",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "This search looks for Network Traffic events to TFTP, FTP or SSH/SCP ports from network devices. Make sure to tag any network devices as network, router or switch in order for this detection to work. If the TFTP traffic doesn't traverse a firewall nor packet inspection, these events will not be logged. This is typically an issue if the TFTP server is on the same subnet as the network device. There is also a chance of the network device loading software using a DHCP assigned IP address (netboot) which is not in the Asset inventory.",
            "highlight": "No",
            "how_to_implement": "This search looks for Network Traffic events to TFTP, FTP or SSH/SCP ports from network devices. Make sure to tag any network devices as network, router or switch in order for this detection to work. If the TFTP traffic doesn't traverse a firewall nor packet inspection, these events will not be logged. This is typically an issue if the TFTP server is on the same subnet as the network device. There is also a chance of the network device loading software using a DHCP assigned IP address (netboot) which is not in the Asset inventory.",
            "icon": "ES_Use_Case.png",
            "id": "detect_software_download_to_network_device",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This search will also report any legitimate attempts of software downloads to network devices as well as outbound SSH sessions from network devices.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_software_download_to_network_device_filter"
                }
            ],
            "mitre_sub_technique": "T1542.005",
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_technique": "T1542",
            "mitre_threat_groups": "",
            "name": "Detect Software Download To Network Device",
            "references": [],
            "released": "2020-10-28",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where (All_Traffic.transport=udp AND All_Traffic.dest_port=69) OR (All_Traffic.transport=tcp AND All_Traffic.dest_port=21) OR (All_Traffic.transport=tcp AND All_Traffic.dest_port=22) AND All_Traffic.dest_category!=common_software_repo_destination AND All_Traffic.src_category=network OR All_Traffic.src_category=router OR All_Traffic.src_category=switch by All_Traffic.src All_Traffic.dest All_Traffic.dest_port | `drop_dm_object_name(\"All_Traffic\")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_software_download_to_network_device_filter`",
            "search_name": "ESCU - Detect Software Download To Network Device - Rule",
            "security_domain": "network",
            "story": "91c676cf-0b23-438d-abee-f6335e177e77",
            "tags": {
                "analytics_story": [
                    "Router and Infrastructure Security"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 1",
                    "CIS 11"
                ],
                "detection_name": "Detect Software Download To Network Device",
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_id": [
                    "T1542"
                ],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_spike_in_aws_api_activity": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS User Monitoring",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-04-09",
                    "description": "This search establishes, on a per-hour basis, the average and the standard deviation of the number of API calls made by each user. Also recorded is the number of data points for each user. This table is then outputted to a lookup file to allow the detection search to operate quickly.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "fc0edc96-ff2b-48b0-9f6f-63da3783fd63",
                    "lookups": [
                        {
                            "collection": "api_call_by_user_baseline",
                            "description": "A collection that will contain the baseline information for number of AWS API calls per user",
                            "fields_list": "arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls",
                            "name": "api_call_by_user_baseline"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_api_calls_per_user_arn_filter"
                        }
                    ],
                    "name": "Baseline of API Calls per User ARN",
                    "search": "`cloudtrail` eventType=AwsApiCall | spath output=arn path=userIdentity.arn | bucket _time span=1h | stats count as apiCalls by _time, arn | stats count(apiCalls) as numDataPoints, latest(apiCalls) as latestCount, avg(apiCalls) as avgApiCalls, stdev(apiCalls) as stdevApiCalls by arn | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup api_call_by_user_baseline | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS User Monitoring"
                        ],
                        "detections": [
                            "Detect Spike in AWS API Activity"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_spike_in_aws_api_activity",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search will detect users creating spikes of API activity in your AWS environment.  It will also update the cache file that factors in the latest data.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike.\\\nThis search produces fields (`eventName`,`numberOfApiCalls`,`uniqueApisCalled`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** AWS Event Name, **Field:** eventName\\\n1. \\\n1. **Label:** Number of API Calls, **Field:** numberOfApiCalls\\\n1. \\\n1. **Label:** Unique API Calls, **Field:** uniqueApisCalled\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike.\\\nThis search produces fields (`eventName`,`numberOfApiCalls`,`uniqueApisCalled`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** AWS Event Name, **Field:** eventName\\\n1. \\\n1. **Label:** Number of API Calls, **Field:** numberOfApiCalls\\\n1. \\\n1. **Label:** Unique API Calls, **Field:** uniqueApisCalled\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "detect_spike_in_aws_api_activity",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "",
            "lookups": [
                {
                    "collection": "api_call_by_user_baseline",
                    "description": "A collection that will contain the baseline information for number of AWS API calls per user",
                    "fields_list": "arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls",
                    "name": "api_call_by_user_baseline"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_spike_in_aws_api_activity_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Detect Spike In AWS API Activity",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` eventType=AwsApiCall [search `cloudtrail` eventType=AwsApiCall | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup api_call_by_user_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup api_call_by_user_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | stats values(eventName) as eventName, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user | `detect_spike_in_aws_api_activity_filter`",
            "search_name": "ESCU - Detect Spike in AWS API Activity - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50f1269af3",
            "tags": {
                "analytics_story": [
                    "AWS User Monitoring"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.AC"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detect_spike_in_aws_security_hub_alerts_for_ec2_instance": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Security Hub Alerts",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_spike_in_aws_security_hub_alerts_for_ec2_instance",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for a spike in number of of AWS security Hub alerts for an EC2 instance in 4 hours intervals",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your Security Hub inputs. The threshold_value should be tuned to your environment and schedule these searches according to the bucket span interval.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your Security Hub inputs. The threshold_value should be tuned to your environment and schedule these searches according to the bucket span interval.",
            "icon": "ES_Use_Case.png",
            "id": "detect_spike_in_aws_security_hub_alerts_for_ec2_instance",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "None",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:securityhub:firehose\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_securityhub_firehose"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_spike_in_aws_security_hub_alerts_for_ec2_instance_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect Spike In AWS Security Hub Alerts For EC2 Instance",
            "references": [],
            "released": "2020-07-21",
            "search": "`aws_securityhub_firehose` \"findings{}.Resources{}.Type\"=AWSEC2Instance | rex field=findings{}.Resources{}.Id .*instance/(?<instance>.*) | rename instance as dest | bucket span=4h _time | stats count AS alerts by _time dest | eventstats avg(alerts) as total_launched_avg, stdev(alerts) as total_launched_stdev | eval threshold_value = 4 | eval isOutlier=if(alerts > total_launched_avg+(total_launched_stdev * threshold_value), 1, 0) | search isOutlier=1 | table _time dest alerts|`detect_spike_in_aws_security_hub_alerts_for_ec2_instance_filter`",
            "search_name": "ESCU - Detect Spike in AWS Security Hub Alerts for EC2 Instance - Rule",
            "security_domain": "network",
            "story": "2f2f610a-d64d-48c2-b57c-96722b49ab5a",
            "tags": {
                "analytics_story": [
                    "AWS Security Hub Alerts"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 13"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "detect_spike_in_aws_security_hub_alerts_for_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Security Hub Alerts",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_spike_in_aws_security_hub_alerts_for_user",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for a spike in number of of AWS security Hub alerts for an AWS IAM User in 4 hours intervals.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your Security Hub inputs. The threshold_value should be tuned to your environment and schedule these searches according to the bucket span interval.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your Security Hub inputs. The threshold_value should be tuned to your environment and schedule these searches according to the bucket span interval.",
            "icon": "ES_Use_Case.png",
            "id": "detect_spike_in_aws_security_hub_alerts_for_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "None",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:securityhub:firehose\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_securityhub_firehose"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_spike_in_aws_security_hub_alerts_for_user_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect Spike In AWS Security Hub Alerts For User",
            "references": [],
            "released": "2020-07-21",
            "search": "`aws_securityhub_firehose` \"findings{}.Resources{}.Type\"= AwsIamUser | rename findings{}.Resources{}.Id as user | bucket span=4h _time | stats count AS alerts by _time user | eventstats avg(alerts) as total_launched_avg, stdev(alerts) as total_launched_stdev | eval threshold_value = 2 | eval isOutlier=if(alerts > total_launched_avg+(total_launched_stdev * threshold_value), 1, 0) | search isOutlier=1 | table _time user alerts |`detect_spike_in_aws_security_hub_alerts_for_user_filter`",
            "search_name": "ESCU - Detect Spike in AWS Security Hub Alerts for User - Rule",
            "security_domain": "network",
            "story": "2f2f610a-d64d-48c2-b57c-96722b49ab5a",
            "tags": {
                "analytics_story": [
                    "AWS Security Hub Alerts"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 13"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "detect_spike_in_blocked_outbound_traffic_from_your_aws": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Network ACL Activity|Suspicious AWS Traffic|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-05-07",
                    "description": "This search establishes, on a per-hour basis, the average and the standard deviation of the number of outbound connections blocked in your VPC flow logs by each source IP address (IP address of your EC2 instances). Also recorded is the number of data points for each source IP. This table outputs to a lookup file to allow the detection search to operate quickly.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your `VPC flow logs.`.",
                    "id": "fc0edd96-ff2b-48b0-9f1f-63da3782fd63",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/baseline_blocked_outbound_connections.csv",
                            "description": "A lookup file that will contain the baseline information for number of blocked outbound connections",
                            "filename": "baseline_blocked_outbound_connections.csv",
                            "name": "baseline_blocked_outbound_connections"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudwatchlogs:vpcflow",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudwatchlogs_vpcflow"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_blocked_outbound_traffic_from_aws_filter"
                        }
                    ],
                    "name": "Baseline of blocked outbound traffic from AWS",
                    "search": "`cloudwatchlogs_vpcflow` action=blocked (src_ip=10.0.0.0/8 OR src_ip=172.16.0.0/12 OR src_ip=192.168.0.0/16) ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16) | bucket _time span=1h | stats count as numberOfBlockedConnections by _time, src_ip | stats count(numberOfBlockedConnections) as numDataPoints, latest(numberOfBlockedConnections) as latestCount, avg(numberOfBlockedConnections) as avgBlockedConnections, stdev(numberOfBlockedConnections) as stdevBlockedConnections by src_ip | table src_ip, latestCount, numDataPoints, avgBlockedConnections, stdevBlockedConnections | outputlookup baseline_blocked_outbound_connections | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Network ACL Activity",
                            "Command and Control",
                            "Suspicious AWS Traffic"
                        ],
                        "detections": [
                            "Detect Spike in blocked Outbound Traffic from your AWS"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_spike_in_blocked_outbound_traffic_from_your_aws",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2018-05-07",
            "description": "This search will detect spike in blocked outbound network connections originating from within your AWS environment.  It will also update the cache file that factors in the latest data.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 11",
            "escu_nist": "DE.AE|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your VPC Flow logs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the number of data points required to meet the definition of \"spike.\" The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike. This search works best when you run the \"Baseline of Blocked Outbound Connection\" support search once to create a history of previously seen blocked outbound connections.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your VPC Flow logs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the number of data points required to meet the definition of \"spike.\" The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike. This search works best when you run the \"Baseline of Blocked Outbound Connection\" support search once to create a history of previously seen blocked outbound connections.",
            "icon": "ES_Use_Case.png",
            "id": "detect_spike_in_blocked_outbound_traffic_from_your_aws",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives|Command and Control",
            "known_false_positives": "The false-positive rate may vary based on the values of`dataPointThreshold` and `deviationThreshold`. Additionally, false positives may result when AWS administrators roll out policies enforcing network blocks, causing sudden increases in the number of blocked outbound connections.",
            "lookups": [
                {
                    "description": "A lookup file that will contain the baseline information for number of blocked outbound connections",
                    "filename": "baseline_blocked_outbound_connections.csv",
                    "name": "baseline_blocked_outbound_connections"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudwatchlogs:vpcflow",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudwatchlogs_vpcflow"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_spike_in_blocked_outbound_traffic_from_your_aws_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect Spike In Blocked Outbound Traffic From Your AWS",
            "references": [],
            "released": "2018-05-07",
            "search": "`cloudwatchlogs_vpcflow` action=blocked (src_ip=10.0.0.0/8 OR src_ip=172.16.0.0/12 OR src_ip=192.168.0.0/16) ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16)  [search  `cloudwatchlogs_vpcflow` action=blocked (src_ip=10.0.0.0/8 OR src_ip=172.16.0.0/12 OR src_ip=192.168.0.0/16) ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16)  | stats count as numberOfBlockedConnections by src_ip | inputlookup baseline_blocked_outbound_connections append=t | fields - latestCount | stats values(*) as * by src_ip | rename numberOfBlockedConnections as latestCount | eval newAvgBlockedConnections=avgBlockedConnections + (latestCount-avgBlockedConnections)/720 | eval newStdevBlockedConnections=sqrt(((pow(stdevBlockedConnections, 2)*719 + (latestCount-newAvgBlockedConnections)*(latestCount-avgBlockedConnections))/720)) | eval avgBlockedConnections=coalesce(newAvgBlockedConnections, avgBlockedConnections), stdevBlockedConnections=coalesce(newStdevBlockedConnections, stdevBlockedConnections), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table src_ip, latestCount, numDataPoints, avgBlockedConnections, stdevBlockedConnections | outputlookup baseline_blocked_outbound_connections | eval dataPointThreshold = 5, deviationThreshold = 3 | eval isSpike=if((latestCount > avgBlockedConnections+deviationThreshold*stdevBlockedConnections) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | table src_ip] | stats values(dest_ip) as \"Blocked Destination IPs\", values(interface_id) as \"resourceId\" count as numberOfBlockedConnections, dc(dest_ip) as uniqueDestConnections by src_ip | `detect_spike_in_blocked_outbound_traffic_from_your_aws_filter`",
            "search_name": "ESCU - Detect Spike in blocked Outbound Traffic from your AWS - Rule",
            "security_domain": "network",
            "story": "2e8948a5-5239-406b-b56b-6c50ff268af4|2e8948a5-5239-406b-b56b-6c50f2168af3|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "AWS Network ACL Activity",
                    "Suspicious AWS Traffic",
                    "Command and Control"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives",
                    "Command and Control"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.AE",
                    "DE.CM",
                    "PR.AC"
                ],
                "risk_object": "src_ip",
                "risk_object_type": "system",
                "risk_score": 20,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_spike_in_network_acl_activity": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Network ACL Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-05-21",
                    "description": "This search establishes, on a per-hour basis, the average and the standard deviation of the number of API calls that were related to network ACLs made by each user. Also recorded is the number of data points for each user. This table is then outputted to a lookup file to allow the detection search to operate quickly.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs. To add or remove API event names for network ACLs, edit the macro `network_acl_events`.",
                    "id": "fc0edd96-ff2b-4810-9f1f-63da3783fd63",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/network_acl_activity_baseline.csv",
                            "description": "A lookup file that will contain the baseline information for number of AWS Network ACL Activity",
                            "filename": "network_acl_activity_baseline.csv",
                            "name": "network_acl_activity_baseline"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "(eventName = CreateNetworkAcl OR eventName = CreateNetworkAclEntry OR eventName = DeleteNetworkAcl OR eventName = DeleteNetworkAclEntry OR eventName = ReplaceNetworkAclEntry OR eventName = ReplaceNetworkAclAssociation)",
                            "description": "This is a list of AWS event names that are associated with Network ACLs",
                            "name": "network_acl_events"
                        },
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_network_acl_activity_by_arn_filter"
                        }
                    ],
                    "name": "Baseline of Network ACL Activity by ARN",
                    "search": "`cloudtrail` `network_acl_events` | spath output=arn path=userIdentity.arn | bucket _time span=1h | stats count as apiCalls by _time, arn | stats count(apiCalls) as numDataPoints, latest(apiCalls) as latestCount, avg(apiCalls) as avgApiCalls, stdev(apiCalls) as stdevApiCalls by arn | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup network_acl_activity_baseline | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Network ACL Activity"
                        ],
                        "detections": [
                            "Detect Spike in Network ACL Activity"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_spike_in_network_acl_activity",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-05-21",
            "description": "This search will detect users creating spikes in API activity related to network access-control lists (ACLs)in your AWS environment.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 12|CIS 11",
            "escu_nist": "DE.DP|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike. This search works best when you run the \"Baseline of Network ACL Activity by ARN\" support search once to create a lookup file of previously seen Network ACL Activity. To add or remove API event names related to network ACLs, edit the macro `network_acl_events`.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike. This search works best when you run the \"Baseline of Network ACL Activity by ARN\" support search once to create a lookup file of previously seen Network ACL Activity. To add or remove API event names related to network ACLs, edit the macro `network_acl_events`.",
            "icon": "ES_Use_Case.png",
            "id": "detect_spike_in_network_acl_activity",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "The false-positive rate may vary based on the values of`dataPointThreshold` and `deviationThreshold`. Please modify this according the your environment.",
            "lookups": [
                {
                    "description": "A lookup file that will contain the baseline information for number of AWS Network ACL Activity",
                    "filename": "network_acl_activity_baseline.csv",
                    "name": "network_acl_activity_baseline"
                }
            ],
            "macros": [
                {
                    "definition": "(eventName = CreateNetworkAcl OR eventName = CreateNetworkAclEntry OR eventName = DeleteNetworkAcl OR eventName = DeleteNetworkAclEntry OR eventName = ReplaceNetworkAclEntry OR eventName = ReplaceNetworkAclAssociation)",
                    "description": "This is a list of AWS event names that are associated with Network ACLs",
                    "name": "network_acl_events"
                },
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_spike_in_network_acl_activity_filter"
                }
            ],
            "mitre_sub_technique": "T1562.007",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1562",
            "mitre_threat_groups": "no",
            "name": "Detect Spike In Network ACL Activity",
            "references": [],
            "released": "2018-05-21",
            "search": "`cloudtrail` `network_acl_events` [search `cloudtrail` `network_acl_events` | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup network_acl_activity_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup network_acl_activity_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | stats values(eventName) as eventNames, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user | `detect_spike_in_network_acl_activity_filter`",
            "search_name": "ESCU - Detect Spike in Network ACL Activity - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50ff268af4",
            "tags": {
                "analytics_story": [
                    "AWS Network ACL Activity"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 12",
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1562"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Disable or Modify Cloud Firewall"
                ],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.AC"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 20,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_spike_in_s3_bucket_deletion": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious AWS S3 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "S3 Bucket",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-07-17",
                    "description": "This search establishes, on a per-hour basis, the average and standard deviation for the number of API calls related to deleting an S3 bucket by each user. Also recorded is the number of data points for each user. This table is then outputted to a lookup file to allow the detection search to operate quickly.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "fc0edd96-ff2b-48b0-9f1f-63eq3783fd63",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/s3_deletion_baseline.csv",
                            "description": "A placeholder for the baseline information for AWS S3 deletions",
                            "filename": "s3_deletion_baseline.csv",
                            "name": "s3_deletion_baseline"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_s3_bucket_deletion_activity_by_arn_filter"
                        }
                    ],
                    "name": "Baseline of S3 Bucket deletion activity by ARN",
                    "search": "`cloudtrail` eventName=DeleteBucket | spath output=arn path=userIdentity.arn | bucket _time span=1h | stats count as apiCalls by _time, arn | stats count(apiCalls) as numDataPoints, latest(apiCalls) as latestCount, avg(apiCalls) as avgApiCalls, stdev(apiCalls) as stdevApiCalls by arn | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup s3_deletion_baseline | stats count",
                    "tags": {
                        "analytics_story": [
                            "Suspicious AWS S3 Activities"
                        ],
                        "detections": [
                            "Detect Spike in S3 Bucket deletion"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_spike_in_s3_bucket_deletion",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-11-27",
            "description": "This search detects users creating spikes in API activity related to deletion of S3 buckets in your AWS environment. It will also update the cache file that factors in the latest data.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "DE.DP|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike. This search works best when you run the \"Baseline of S3 Bucket deletion activity by ARN\" support search once to create a baseline of previously seen S3 bucket-deletion activity.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike. This search works best when you run the \"Baseline of S3 Bucket deletion activity by ARN\" support search once to create a baseline of previously seen S3 bucket-deletion activity.",
            "icon": "ES_Use_Case.png",
            "id": "detect_spike_in_s3_bucket_deletion",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Based on the values of`dataPointThreshold` and `deviationThreshold`, the false positive rate may vary. Please modify this according the your environment.",
            "lookups": [
                {
                    "description": "A placeholder for the baseline information for AWS S3 deletions",
                    "filename": "s3_deletion_baseline.csv",
                    "name": "s3_deletion_baseline"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_spike_in_s3_bucket_deletion_filter"
                }
            ],
            "mitre_sub_technique": "T1530",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1530",
            "mitre_threat_groups": "no",
            "name": "Detect Spike In S3 Bucket Deletion",
            "references": [],
            "released": "2018-11-27",
            "search": "`cloudtrail` eventName=DeleteBucket [search `cloudtrail` eventName=DeleteBucket | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup s3_deletion_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup s3_deletion_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | spath output=bucketName path=requestParameters.bucketName | stats values(bucketName) as bucketName, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user | `detect_spike_in_s3_bucket_deletion_filter`",
            "search_name": "ESCU - Detect Spike in S3 Bucket deletion - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50w3168af3",
            "tags": {
                "analytics_story": [
                    "Suspicious AWS S3 Activities"
                ],
                "asset_type": "S3 Bucket",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1530"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Data from Cloud Storage Object"
                ],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.AC"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 10,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_spike_in_security_group_activity": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS User Monitoring",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-04-17",
                    "description": "This search establishes, on a per-hour basis, the average and the standard deviation for the number of API calls related to security groups made by each user. Also recorded is the number of data points for each user. This table is then outputted to a lookup file to allow the detection search to operate quickly.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs. To add or remove API event names for security groups, edit the macro `security_group_api_calls`.",
                    "id": "fc0edd96-ff2b-48b0-9f1f-63da3783fd63",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/security_group_activity_baseline.csv",
                            "description": "A placeholder for the baseline information for AWS security groups",
                            "filename": "security_group_activity_baseline.csv",
                            "name": "security_group_activity_baseline"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "(eventName=AuthorizeSecurityGroupIngress OR eventName=CreateSecurityGroup OR eventName=DeleteSecurityGroup OR eventName=DescribeClusterSecurityGroups OR eventName=DescribeDBSecurityGroups OR eventName=DescribeSecurityGroupReferences OR eventName=DescribeSecurityGroups OR eventName=DescribeStaleSecurityGroups OR eventName=RevokeSecurityGroupIngress OR eventName=UpdateSecurityGroupRuleDescriptionsIngress)",
                            "description": "This macro is a list of AWS event names associated with security groups",
                            "name": "security_group_api_calls"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_security_group_activity_by_arn_filter"
                        }
                    ],
                    "name": "Baseline of Security Group Activity by ARN",
                    "search": "`cloudtrail` `security_group_api_calls` | spath output=arn path=userIdentity.arn | bucket _time span=1h | stats count as apiCalls by _time, arn | stats count(apiCalls) as numDataPoints, latest(apiCalls) as latestCount, avg(apiCalls) as avgApiCalls, stdev(apiCalls) as stdevApiCalls by arn | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup security_group_activity_baseline | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS User Monitoring"
                        ],
                        "detections": [
                            "Detect Spike in Security Group Activity"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=detect_spike_in_security_group_activity",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-04-18",
            "description": "This search will detect users creating spikes in API activity related to security groups in your AWS environment.  It will also update the cache file that factors in the latest data.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike.This search works best when you run the \"Baseline of Security Group Activity by ARN\" support search once to create a history of previously seen Security Group Activity. To add or remove API event names for security groups, edit the macro `security_group_api_calls`.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You can modify `dataPointThreshold` and `deviationThreshold` to better fit your environment. The `dataPointThreshold` variable is the minimum number of data points required to have a statistically significant amount of data to determine. The `deviationThreshold` variable is the number of standard deviations away from the mean that the value must be to be considered a spike.This search works best when you run the \"Baseline of Security Group Activity by ARN\" support search once to create a history of previously seen Security Group Activity. To add or remove API event names for security groups, edit the macro `security_group_api_calls`.",
            "icon": "ES_Use_Case.png",
            "id": "detect_spike_in_security_group_activity",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Based on the values of`dataPointThreshold` and `deviationThreshold`, the false positive rate may vary. Please modify this according the your environment.",
            "lookups": [
                {
                    "description": "A placeholder for the baseline information for AWS security groups",
                    "filename": "security_group_activity_baseline.csv",
                    "name": "security_group_activity_baseline"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "definition": "(eventName=AuthorizeSecurityGroupIngress OR eventName=CreateSecurityGroup OR eventName=DeleteSecurityGroup OR eventName=DescribeClusterSecurityGroups OR eventName=DescribeDBSecurityGroups OR eventName=DescribeSecurityGroupReferences OR eventName=DescribeSecurityGroups OR eventName=DescribeStaleSecurityGroups OR eventName=RevokeSecurityGroupIngress OR eventName=UpdateSecurityGroupRuleDescriptionsIngress)",
                    "description": "This macro is a list of AWS event names associated with security groups",
                    "name": "security_group_api_calls"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_spike_in_security_group_activity_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "Detect Spike In Security Group Activity",
            "references": [],
            "released": "2018-04-18",
            "search": "`cloudtrail` `security_group_api_calls` [search `cloudtrail` `security_group_api_calls` | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup security_group_activity_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup security_group_activity_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | stats values(eventName) as eventNames, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user | `detect_spike_in_security_group_activity_filter`",
            "search_name": "ESCU - Detect Spike in Security Group Activity - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50f1269af3",
            "tags": {
                "analytics_story": [
                    "AWS User Monitoring"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.AC"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "detect_traffic_mirroring": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Router and Infrastructure Security",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Mikael Bjerkeland, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_traffic_mirroring",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-28",
            "description": "Adversaries may leverage traffic mirroring in order to automate data exfiltration over compromised network infrastructure. Traffic mirroring is a native feature for some network devices and used for network analysis and may be configured to duplicate traffic and forward to one or more destinations for analysis by a network analyzer or other monitoring device.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 11",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices and that the devices have been configured according to the documentation of the Cisco Networks Add-on. Also note that an attacker may disable logging from the device prior to enabling traffic mirroring.",
            "highlight": "No",
            "how_to_implement": "This search uses a standard SPL query on logs from Cisco Network devices. The network devices must log with a severity level of minimum \"5 - notification\". The search also requires that the Cisco Networks Add-on for Splunk (https://splunkbase.splunk.com/app/1467) is used to parse the logs from the Cisco network devices and that the devices have been configured according to the documentation of the Cisco Networks Add-on. Also note that an attacker may disable logging from the device prior to enabling traffic mirroring.",
            "icon": "ES_Use_Case.png",
            "id": "detect_traffic_mirroring",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "",
            "known_false_positives": "This search will return false positives for any legitimate traffic captures by network administrators.",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=cisco_ios",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cisco_networks"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_traffic_mirroring_filter"
                }
            ],
            "mitre_sub_technique": "T1200|T1498|T1020.001",
            "mitre_tactic": "TA0001|TA0040",
            "mitre_tactic_display": "Initial Access|Impact",
            "mitre_technique": "T1200|T1498|T1020",
            "mitre_threat_groups": "DarkVishnya|no",
            "name": "Detect Traffic Mirroring",
            "references": [],
            "released": "2020-10-28",
            "search": "`cisco_networks` (facility=\"MIRROR\" mnemonic=\"ETH_SPAN_SESSION_UP\") OR (facility=\"SPAN\" mnemonic=\"SESSION_UP\") OR (facility=\"SPAN\" mnemonic=\"PKTCAP_START\") OR (mnemonic=\"CFGLOG_LOGGEDCMD\" command=\"monitor session*\") | stats min(_time) AS firstTime max(_time) AS lastTime count BY host facility mnemonic | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | `detect_traffic_mirroring_filter`",
            "search_name": "ESCU - Detect Traffic Mirroring - Rule",
            "story": "91c676cf-0b23-438d-abee-f6335e177e77",
            "tags": {
                "analytics_story": [
                    "Router and Infrastructure Security"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 1",
                    "CIS 11"
                ],
                "detection_name": "Detect Traffic Mirroring",
                "kill_chain_phases": [
                    "Delivery",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "DarkVishnya",
                    "no"
                ],
                "mitre_attack_id": [
                    "T1200",
                    "T1498",
                    "T1020"
                ],
                "mitre_attack_tactics": [
                    "Initial Access",
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Hardware Additions",
                    "Network Denial of Service"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_unauthorized_assets_by_mac_address": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Asset Tracking",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2017-09-13",
                    "description": "This search shows you every asset category you have and the assets that belong to those categories.",
                    "how_to_implement": "To successfully implement this search you must first leverage the Assets and Identity framework in Enterprise Security to populate your assets_by_str.csv file which should then be mapped to the Identity_Management data model. The Identity_Management data model will contain a list of known authorized company assets. Ensure that all inventoried systems are constantly vetted and updated.",
                    "id": "dcfd6b40-42f9-469d-a433-2e53f7489ff9",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "count_of_assets_by_category_filter"
                        }
                    ],
                    "name": "Count of assets by category",
                    "search": "| from datamodel Identity_Management.All_Assets | stats count values(nt_host) by category | sort -count",
                    "tags": {
                        "analytics_story": [
                            "Asset Tracking"
                        ],
                        "detections": [
                            "Detect Unauthorized Assets by MAC address"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Compliance",
            "dashboard": "showcase_security_content?showcaseId=detect_unauthorized_assets_by_mac_address",
            "data_source_categories": "DS025IPAddressAssignment-ET01General",
            "datamodel": "Network_Sessions",
            "dataset": "",
            "date": "2017-09-13",
            "description": "By populating the organization's assets within the assets_by_str.csv, we will be able to detect unauthorized devices that are trying to connect with the organization's network by inspecting DHCP request packets, which are issued by devices when they attempt to obtain an IP address from the DHCP server. The MAC address associated with the source of the DHCP request is checked against the list of known devices, and reports on those that are not found.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "This search uses the Network_Sessions data model shipped with Enterprise Security. It leverages the Assets and Identity framework to populate the assets_by_str.csv file located in SA-IdentityManagement, which will contain a list of known authorized organizational assets including their MAC addresses. Ensure that all inventoried systems have their MAC address populated.",
            "highlight": "No",
            "how_to_implement": "This search uses the Network_Sessions data model shipped with Enterprise Security. It leverages the Assets and Identity framework to populate the assets_by_str.csv file located in SA-IdentityManagement, which will contain a list of known authorized organizational assets including their MAC addresses. Ensure that all inventoried systems have their MAC address populated.",
            "icon": "ES_Use_Case.png",
            "id": "detect_unauthorized_assets_by_mac_address",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Reconnaissance|Delivery|Actions On Objectives",
            "known_false_positives": "This search might be prone to high false positives. Please consider this when conducting analysis or investigations. Authorized devices may be detected as unauthorized. If this is the case, verify the MAC address of the system responsible for the false positive and add it to the Assets and Identity framework with the proper information.",
            "lookups": [],
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_unauthorized_assets_by_mac_address_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect Unauthorized Assets By MAC Address",
            "references": [],
            "released": "2017-09-13",
            "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Sessions where nodename=All_Sessions.DHCP All_Sessions.signature=DHCPREQUEST by All_Sessions.src_ip All_Sessions.src_mac | dedup All_Sessions.src_mac| `drop_dm_object_name(\"Network_Sessions\")`|`drop_dm_object_name(\"All_Sessions\")` | search NOT [| inputlookup asset_lookup_by_str |rename mac as src_mac | fields + src_mac] | `detect_unauthorized_assets_by_mac_address_filter`",
            "search_name": "ESCU - Detect Unauthorized Assets by MAC address - Rule",
            "security_domain": "network",
            "story": "91c676cf-0b23-438d-abee-f6335e1fce77",
            "tags": {
                "analytics_story": [
                    "Asset Tracking"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 1"
                ],
                "kill_chain_phases": [
                    "Reconnaissance",
                    "Delivery",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Compliance",
            "version": 1
        },
        "detect_usb_device_insertion": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Data Protection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Data Exfiltration",
            "dashboard": "showcase_security_content?showcaseId=detect_usb_device_insertion",
            "data_source_categories": "DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS016DataLossPrevention-ET01Violation",
            "datamodel": "Change_Analysis",
            "dataset": "",
            "date": "2017-11-27",
            "description": "The search is used to detect hosts that generate Windows Event ID 4663 for successful attempts to write to or read from a removable storage and Event ID 4656 for failures, which occurs when a USB drive is plugged in. In this scenario we are querying the Change_Analysis data model to look for Windows Event ID 4656 or 4663 where the priority of the affected host is marked as high in the ES Assets and Identity Framework.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "PR.PT|PR.DS",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must ingest Windows Security Event logs and track event code 4663 and 4656. Ensure that the field from the event logs is being mapped to the result_id field in the Change_Analysis data model. To minimize the alert volume, this search leverages the Assets and Identity framework to filter out events from those assets not marked high priority in the Enterprise Security Assets and Identity Framework.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must ingest Windows Security Event logs and track event code 4663 and 4656. Ensure that the field from the event logs is being mapped to the result_id field in the Change_Analysis data model. To minimize the alert volume, this search leverages the Assets and Identity framework to filter out events from those assets not marked high priority in the Enterprise Security Assets and Identity Framework.",
            "icon": "ES_Use_Case.png",
            "id": "detect_usb_device_insertion",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Installation|Actions On Objectives",
            "known_false_positives": "Legitimate USB activity will also be detected. Please verify and investigate as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_usb_device_insertion_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Detect USB Device Insertion",
            "references": [],
            "released": "2017-11-27",
            "search": "| tstats `security_content_summariesonly` count earliest(_time) AS earliest latest(_time) AS latest from datamodel=Change_Analysis where (nodename = All_Changes) All_Changes.result=\"Removable Storage device\" (All_Changes.result_id=4663 OR All_Changes.result_id=4656) (All_Changes.src_priority=high) by All_Changes.dest | `drop_dm_object_name(\"All_Changes\")`| `security_content_ctime(earliest)`| `security_content_ctime(latest)`  | `detect_usb_device_insertion_filter`",
            "search_name": "ESCU - Detect USB device insertion - Rule",
            "security_domain": "endpoint",
            "story": "91c676cf-0b23-438d-abee-f6335e1fce33",
            "tags": {
                "analytics_story": [
                    "Data Protection"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "PR.DS"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Insider Threat",
            "version": 1
        },
        "detect_use_of_cmd_exe_to_launch_script_interpreters": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Emotet Malware  DHS Report TA18-201A |Suspicious Command-Line Executions",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_use_of_cmd_exe_to_launch_script_interpreters",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.003/cmd_spawns_cscript/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for the execution of the cscript.exe or wscript.exe processes, with a parent of cmd.exe. The search will return the count, the first and last time this execution was seen on a machine, the user, and the destination of the machine",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "icon": "ES_Use_Case.png",
            "id": "detect_use_of_cmd_exe_to_launch_script_interpreters",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Some legitimate applications may exhibit this behavior.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_use_of_cmd_exe_to_launch_script_interpreters_filter"
                }
            ],
            "mitre_sub_technique": "T1059.003",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1059",
            "mitre_threat_groups": "TA505|Blue Mockingbird|Tropic Trooper|Frankenstein|OilRig|Lazarus Group|Honeybee|Cobalt Group|FIN7|APT41|Soft Cell|Turla|Silence|APT32|APT39|Darkhotel|MuddyWater|APT18|APT38|Dark Caracal|Gorgon Group|Dragonfly 2.0|Rancor|Ke3chang|APT37|Leviathan|FIN8|APT28|Magic Hound|Sowbug|BRONZE BUTLER|FIN10|Threat Group-3390|menuPass|Gamaredon Group|Suckfly|Patchwork|Threat Group-1314|APT3|admin@338|APT1",
            "name": "Detect Use Of Cmd Exe To Launch Script Interpreters",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process_name=\"cmd.exe\" (Processes.process_name=cscript.exe OR Processes.process_name =wscript.exe) by Processes.parent_process Processes.process_name Processes.user Processes.dest | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | `detect_use_of_cmd_exe_to_launch_script_interpreters_filter`",
            "search_name": "ESCU - Detect Use of cmd exe to Launch Script Interpreters - Rule",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52|f4368ddf-d59f-4192-84f6-778ac5a3ffc7",
            "tags": {
                "analytics_story": [
                    "Emotet Malware  DHS Report TA18-201A ",
                    "Suspicious Command-Line Executions"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.003/cmd_spawns_cscript/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "TA505",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "OilRig",
                    "Lazarus Group",
                    "Honeybee",
                    "Cobalt Group",
                    "FIN7",
                    "APT41",
                    "Soft Cell",
                    "Turla",
                    "Silence",
                    "APT32",
                    "APT39",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "APT38",
                    "Dark Caracal",
                    "Gorgon Group",
                    "Dragonfly 2.0",
                    "Rancor",
                    "Ke3chang",
                    "APT37",
                    "Leviathan",
                    "FIN8",
                    "APT28",
                    "Magic Hound",
                    "Sowbug",
                    "BRONZE BUTLER",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Gamaredon Group",
                    "Suckfly",
                    "Patchwork",
                    "Threat Group-1314",
                    "APT3",
                    "admin@338",
                    "APT1"
                ],
                "mitre_attack_id": [
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Command Shell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "detect_web_traffic_to_dynamic_domain_providers": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Dynamic DNS",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=detect_web_traffic_to_dynamic_domain_providers",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "datamodel": "Web",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for web connections to dynamic DNS providers.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7|CIS 8",
            "escu_nist": "PR.IP|DE.DP",
            "hasSearch": "Yes",
            "help": "This search requires you to be ingesting web-traffic logs. You can obtain these logs from indexing data from a web proxy or by using a network-traffic-analysis tool, such as Bro or Splunk Stream. The web data model must contain the URL being requested, the IP address of the host initiating the request, and the destination IP. This search also leverages a lookup file, `dynamic_dns_providers_default.csv`, which contains a non-exhaustive list of dynamic DNS providers. Consider periodically updating this local lookup file with new domains.\\\nThis search produces fields (`isDynDNS`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** IsDynamicDNS, **Field:** isDynDNS\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "This search requires you to be ingesting web-traffic logs. You can obtain these logs from indexing data from a web proxy or by using a network-traffic-analysis tool, such as Bro or Splunk Stream. The web data model must contain the URL being requested, the IP address of the host initiating the request, and the destination IP. This search also leverages a lookup file, `dynamic_dns_providers_default.csv`, which contains a non-exhaustive list of dynamic DNS providers. Consider periodically updating this local lookup file with new domains.\\\nThis search produces fields (`isDynDNS`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** IsDynamicDNS, **Field:** isDynDNS\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "detect_web_traffic_to_dynamic_domain_providers",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "It is possible that list of dynamic DNS providers is outdated and/or that the URL being requested is legitimate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "lookup update=true dynamic_dns_providers_default dynamic_dns_domains as url OUTPUTNEW isDynDNS_default | lookup update=true dynamic_dns_providers_local dynamic_dns_domains as url OUTPUTNEW isDynDNS_local| eval isDynDNS = coalesce(isDynDNS_default, isDynDNS_local)|fields - isDynDNS_default, isDynDNS_local| search isDynDNS=True",
                    "description": "This is a description",
                    "lookups": [
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/dynamic_dns_providers_default.csv",
                            "description": "A list of dynammic dns providers that should not be modified",
                            "filename": "dynamic_dns_providers_default.csv",
                            "match_type": "WILDCARD(dynamic_dns_domains)",
                            "name": "dynamic_dns_providers_default"
                        },
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/dynamic_dns_providers_local.csv",
                            "description": "A list of dynammic dns providers that can be modified",
                            "filename": "dynamic_dns_providers_local.csv",
                            "match_type": "WILDCARD(dynamic_dns_domains)",
                            "name": "dynamic_dns_providers_local"
                        }
                    ],
                    "name": "dynamic_dns_web_traffic"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_web_traffic_to_dynamic_domain_providers_filter"
                }
            ],
            "mitre_sub_technique": "T1071.001",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "Sandworm Team|TA505|Rocke|APT39|Tropic Trooper|MuddyWater|Wizard Spider|Inception|APT41|SilverTerrier|Machete|APT28|WIRTE|APT33|FIN4|Night Dragon|APT18|APT38|Cobalt Group|APT19|Threat Group-3390|Rancor|Orangeworm|APT37|Ke3chang|Dark Caracal|Turla|Lazarus Group|BRONZE BUTLER|APT32|OilRig|Magic Hound|Gamaredon Group|Stealth Falcon",
            "name": "Detect Web Traffic To Dynamic Domain Providers",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Web.url) as url min(_time) as firstTime from datamodel=Web where Web.status=200 by Web.src Web.dest Web.status | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `dynamic_dns_web_traffic` | `detect_web_traffic_to_dynamic_domain_providers_filter`",
            "search_name": "ESCU - Detect web traffic to dynamic domain providers - Rule",
            "story": "8169f17b-ef68-4b59-aae8-586907301221",
            "tags": {
                "analytics_story": [
                    "Dynamic DNS"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "TA505",
                    "Rocke",
                    "APT39",
                    "Tropic Trooper",
                    "MuddyWater",
                    "Wizard Spider",
                    "Inception",
                    "APT41",
                    "SilverTerrier",
                    "Machete",
                    "APT28",
                    "WIRTE",
                    "APT33",
                    "FIN4",
                    "Night Dragon",
                    "APT18",
                    "APT38",
                    "Cobalt Group",
                    "APT19",
                    "Threat Group-3390",
                    "Rancor",
                    "Orangeworm",
                    "APT37",
                    "Ke3chang",
                    "Dark Caracal",
                    "Turla",
                    "Lazarus Group",
                    "BRONZE BUTLER",
                    "APT32",
                    "OilRig",
                    "Magic Hound",
                    "Gamaredon Group",
                    "Stealth Falcon"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "Web Protocols"
                ],
                "nist": [
                    "PR.IP",
                    "DE.DP"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "detect_windows_dns_sigred_via_splunk_stream": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows DNS SIGRed CVE-2020-1350",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Shannon Davis, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_windows_dns_sigred_via_splunk_stream",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-28",
            "description": "This search detects SIGRed via Splunk Stream.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 12",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting Splunk Stream DNS and Splunk Stream TCP. We are detecting SIG and KEY records via stream:dns and TCP payload over 65KB in size via stream:tcp.  Replace the macro definitions ('stream:dns' and 'stream:tcp') with configurations for your Splunk environment.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting Splunk Stream DNS and Splunk Stream TCP. We are detecting SIG and KEY records via stream:dns and TCP payload over 65KB in size via stream:tcp.  Replace the macro definitions ('stream:dns' and 'stream:tcp') with configurations for your Splunk environment.",
            "icon": "ES_Use_Case.png",
            "id": "detect_windows_dns_sigred_via_splunk_stream",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=stream:tcp",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "stream_tcp"
                },
                {
                    "definition": "sourcetype=stream:dns",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "stream_dns"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_windows_dns_sigred_via_splunk_stream_filter"
                }
            ],
            "mitre_sub_technique": "T1203",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1203",
            "mitre_threat_groups": "Sandworm Team|MuddyWater|Frankenstein|Inception|BlackTech|APT41|admin@338|Threat Group-3390|APT12|The White Company|APT33|APT32|APT28|Tropic Trooper|Lazarus Group|BRONZE BUTLER|Cobalt Group|APT37|Patchwork|Leviathan|Elderwood|TA459|APT29",
            "name": "Detect Windows DNS Sigred Via Splunk Stream",
            "references": [
                "https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/"
            ],
            "released": "2020-07-28",
            "search": "`stream_dns` | spath \"query_type{}\" | search \"query_type{}\" IN (SIG,KEY) | spath protocol_stack | search protocol_stack=\"ip:tcp:dns\" | append [search `stream_tcp` bytes_out>65000] | `detect_windows_dns_sigred_via_splunk_stream_filter` | stats count by flow_id | where count>1 | fields - count",
            "search_name": "ESCU - Detect Windows DNS SIGRed via Splunk Stream - Rule",
            "story": "36dbb206-d073-11ea-87d0-0242ac130003",
            "tags": {
                "analytics_story": [
                    "Windows DNS SIGRed CVE-2020-1350"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "MuddyWater",
                    "Frankenstein",
                    "Inception",
                    "BlackTech",
                    "APT41",
                    "admin@338",
                    "Threat Group-3390",
                    "APT12",
                    "The White Company",
                    "APT33",
                    "APT32",
                    "APT28",
                    "Tropic Trooper",
                    "Lazarus Group",
                    "BRONZE BUTLER",
                    "Cobalt Group",
                    "APT37",
                    "Patchwork",
                    "Leviathan",
                    "Elderwood",
                    "TA459",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1203"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Exploitation for Client Execution"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_windows_dns_sigred_via_zeek": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows DNS SIGRed CVE-2020-1350",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Shannon Davis, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_windows_dns_sigred_via_zeek",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-28",
            "description": "This search detects SIGRed via Zeek DNS and Zeek Conn data.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting Zeek DNS and Zeek Conn data into Splunk. Zeek data should also be getting ingested in JSON format.  We are detecting SIG and KEY records via bro:dns:json and TCP payload over 65KB in size via bro:conn:json.  The Network Resolution and Network Traffic datamodels are in use for this search.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting Zeek DNS and Zeek Conn data into Splunk. Zeek data should also be getting ingested in JSON format.  We are detecting SIG and KEY records via bro:dns:json and TCP payload over 65KB in size via bro:conn:json.  The Network Resolution and Network Traffic datamodels are in use for this search.",
            "icon": "ES_Use_Case.png",
            "id": "detect_windows_dns_sigred_via_zeek",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_windows_dns_sigred_via_zeek_filter"
                }
            ],
            "mitre_sub_technique": "T1203",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1203",
            "mitre_threat_groups": "Sandworm Team|MuddyWater|Frankenstein|Inception|BlackTech|APT41|admin@338|Threat Group-3390|APT12|The White Company|APT33|APT32|APT28|Tropic Trooper|Lazarus Group|BRONZE BUTLER|Cobalt Group|APT37|Patchwork|Leviathan|Elderwood|TA459|APT29",
            "name": "Detect Windows DNS Sigred Via Zeek",
            "references": [
                "https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/"
            ],
            "released": "2020-07-28",
            "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Resolution where DNS.query_type IN (SIG,KEY) by DNS.flow_id | rename DNS.flow_id as flow_id | append [| tstats  `security_content_summariesonly` count from datamodel=Network_Traffic where All_Traffic.bytes_in>65000 by All_Traffic.flow_id | rename All_Traffic.flow_id as flow_id] | `detect_windows_dns_sigred_via_zeek_filter` | stats count by flow_id | where count>1 | fields - count ",
            "search_name": "ESCU - Detect Windows DNS SIGRed via Zeek - Rule",
            "story": "36dbb206-d073-11ea-87d0-0242ac130003",
            "tags": {
                "analytics_story": [
                    "Windows DNS SIGRed CVE-2020-1350"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "MuddyWater",
                    "Frankenstein",
                    "Inception",
                    "BlackTech",
                    "APT41",
                    "admin@338",
                    "Threat Group-3390",
                    "APT12",
                    "The White Company",
                    "APT33",
                    "APT32",
                    "APT28",
                    "Tropic Trooper",
                    "Lazarus Group",
                    "BRONZE BUTLER",
                    "Cobalt Group",
                    "APT37",
                    "Patchwork",
                    "Leviathan",
                    "Elderwood",
                    "TA459",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1203"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Exploitation for Client Execution"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detect_zerologon_via_zeek": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Detect Zerologon Attack",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Network",
            "author": "Shannon Davis, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=detect_zerologon_via_zeek",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "",
            "dataset": "",
            "date": "2020-09-15",
            "description": "This search detects attempts to run exploits for the Zerologon CVE-2020-1472 vulnerability via Zeek RPC",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 11",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting Zeek DCE-RPC data into Splunk. Zeek data should also be getting ingested in JSON format.  We are detecting when all three RPC operations (NetrServerReqChallenge, NetrServerAuthenticate3, NetrServerPasswordSet2) are splunk_security_essentials_app via bro:rpc:json.  These three operations are then correlated on the Zeek UID field.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting Zeek DCE-RPC data into Splunk. Zeek data should also be getting ingested in JSON format.  We are detecting when all three RPC operations (NetrServerReqChallenge, NetrServerAuthenticate3, NetrServerPasswordSet2) are splunk_security_essentials_app via bro:rpc:json.  These three operations are then correlated on the Zeek UID field.",
            "icon": "ES_Use_Case.png",
            "id": "detect_zerologon_via_zeek",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "index=zeek sourcetype=\"zeek:rpc:json\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "zeek_rpc"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detect_zerologon_via_zeek_filter"
                }
            ],
            "mitre_sub_technique": "T1190",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1190",
            "mitre_threat_groups": "Blue Mockingbird|Rocke|APT39|BlackTech|APT41|Soft Cell|Night Dragon|Axiom",
            "name": "Detect Zerologon Via Zeek",
            "references": [
                "https://www.secura.com/blog/zero-logon",
                "https://github.com/SecuraBV/CVE-2020-1472",
                "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472"
            ],
            "released": "2020-09-15",
            "search": "`zeek_rpc` operation IN (NetrServerPasswordSet2,NetrServerReqChallenge,NetrServerAuthenticate3) | bin span=5m _time | stats values(operation) dc(operation) as opscount count(eval(operation==\"NetrServerReqChallenge\")) as challenge count(eval(operation==\"NetrServerAuthenticate3\")) as authcount count(eval(operation==\"NetrServerPasswordSet2\")) as passcount count as totalcount by _time,src_ip,dest_ip | search opscount=3 authcount>4 passcount>0 | search `detect_zerologon_via_zeek_filter`",
            "search_name": "ESCU - Detect Zerologon via Zeek - Rule",
            "story": "5d14a962-569e-4578-939f-f386feb63ce4",
            "tags": {
                "analytics_story": [
                    "Detect Zerologon Attack"
                ],
                "asset_type": "Network",
                "cis20": [
                    "CIS 8",
                    "CIS 11"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Rocke",
                    "APT39",
                    "BlackTech",
                    "APT41",
                    "Soft Cell",
                    "Night Dragon",
                    "Axiom"
                ],
                "mitre_attack_id": [
                    "T1190"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Exploit Public-Facing Application"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "detection_abnormally_high_ec2_instances_launched": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Cloud Security|SaaS",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "This search looks for CloudTrail events where a user successfully launches an abnormally high number of instances.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Network",
            "escu_cis": "CIS 13",
            "escu_data_source": "AWS CloudTrail logs",
            "escu_nist": "DE.DP|DE.AE",
            "escu_providing_technologies": "AWS",
            "hasSearch": "No",
            "help": "In this search, we query CloudTrail logs to look for events where an instance is successfully launched by a particular user. Since we want to detect a high number of instances launched within a short period, we create event buckets for 10-minute windows. We then calculate the total number of instances launched by a particular user, as well as the average and standard deviation values. Assign a <code>threshold_value</code> in the search. Start with 3 (but it will likely need to be tweaked for your environment). The <code>eval</code> function will set the outlier 1 if the number of instances is greater than the average number of instances terminated, added to the multiplied value of threshold and standard deviation. For your reference, we then keep only the outliers and calculate the number of standard deviations away the value is from the average.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Execution",
            "mitre_notes": "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
            "mitre_tactic": "TA0002",
            "mitre_technique": "",
            "name": "Abnormally High AWS Instances Launched by User",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ec2_instance_isolation"
            ],
            "released": "2.2.0",
            "searchKeywords": "",
            "search_name": "ESCU - Abnormally High AWS Instances Launched by User - Rule",
            "story": "2e8948a5-5239-406b-b56b-6c50f1268af3|ced74200-8465-4bc3-bd2c-9a782eec6750",
            "usecase": "Advanced Threat Detection"
        },
        "detection_attackers_scanning_for_vulnerable_jboss_servers": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Scanning",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "This search looks for specific GET or HEAD requests to web servers that are indicative of reconnaissance attempts to identify vulnerable JBoss servers. JexBoss is described as the exploit tool of choice for this malicious activity.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Network",
            "escu_data_models": "Web",
            "escu_data_source": "Network Communications|Web Server",
            "escu_providing_technologies": "Splunk Stream|Palo Alto Firewall|Apache|Bro",
            "hasSearch": "No",
            "help": "This search returns the number of times a URL associated with this type of JexBoss probe is observed.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Reconnaissance",
            "mitre": "Discovery",
            "mitre_notes": "",
            "mitre_tactic": "TA0007",
            "mitre_technique": "T1082",
            "name": "Detect attackers scanning for vulnerable JBoss servers",
            "narrative": "...",
            "relatedUseCases": [
                "external_website_attack"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Detect attackers scanning for vulnerable JBoss servers - Rule",
            "story": "1f5294cb-b85f-4c2d-9c58-ffcf248f52bd|c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "usecase": "Security Monitoring"
        },
        "detection_attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass": {
            "alertvolume": "Low",
            "app": "Enterprise_Security_Content_Update",
            "category": "Adversary Tactics|",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "description": "Monitor for changes of the ExecutionPolicy in the registry to the values \"unrestricted\" or \"bypass,\" which allows the execution of malicious scripts.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 3|CIS 8",
            "escu_confidence": "high",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for changes of the ExecutionPolicy in the registry. The ExecutionPolicy is a safety feature that controls the conditions under which PowerShell loads configuration files and runs scripts. Usually, the ExecutionPolicy is \"Restricted\" for Windows clients and \"RemoteSigned\" for Windows Servers, allowing only certain scripts to run. This search detects when an attacker sets the ExecutionPolicy to \"Unrestricted\" or \"Bypass.\"",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "id": "detection_attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "mitre_tactic": "TA0002",
            "mitre_technique": "T1086|T1064",
            "name": "Attempt To Set Default PowerShell Execution Policy To Unrestricted or Bypass",
            "released": "3.1.1",
            "search_name": "ESCU - Attempt To Set Default PowerShell Execution Policy To Unrestricted or Bypass - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a|2c8ff66e-0b57-42af-8ad7-912438a403fc",
            "usecase": "Advanced Threat Detection"
        },
        "detection_attrib_to_hide_files": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Attackers leverage an existing Windows binary, attrib.exe, to mark specific as hidden by using specific flags so that the victim does not see the file.  The search looks for specific command-line arguments to detect the use of attrib.exe to hide files.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search is looking to detect command-line execution with of attrib.exe binary with the +h flag set.  The +h flag is used to hide a file.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Defense Evasion|Persistence",
            "mitre_tactic": "TA0005|TA0003",
            "mitre_technique": "|T1158",
            "name": "Hiding Files And Directories With Attrib.exe",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "relatedUseCases": [],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Hiding Files And Directories With Attrib.exe - Rule",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "usecase": "Advanced Threat Detection"
        },
        "detection_children_of_spoolsv": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Adversary Tactics|",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for child processes of spoolsv.exe. This activity is associated with a POC privilege-escalation exploit associated with CVE-2018-8440. Spoolsv.exe is the process associated with the Print Spooler service in Windows and typically runs as SYSTEM.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 5|CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.AC|PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for child processes of spoolsv.exe, which is associated with the Print Spooler service on Windows. Children of this process typically run under the SYSTEM context. This search should address the POC developed for the Windows local-privilege-escalation exploit announced in September of 2018. The associated vulnerability was assigned CVE-2018-8440. More information is available at https://doublepulsar.com/task-scheduler-alpc-exploit-high-level-analysis-ff08cda6ad4f.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "mitre": "Privilege Escalation",
            "mitre_tactic": "TA0004",
            "mitre_technique": "T1068",
            "name": "Child Processes of Spoolsv.exe",
            "released": "2.2.0",
            "story": "644e22d3-598a-429c-a007-16fdb802cae5",
            "usecase": "Advanced Threat Detection"
        },
        "detection_create_hidden_shares": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Malware",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for the creation or deletion of hidden shares using net.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "Net.exe is a built-in command-line tool on Windows that can be used to create, delete, and manage shared resources on the computer, both locally and remotely. Though this tool is used by Microsoft administrators to manage the network shares, attackers also leverage it to create and delete hidden file shares by appending \"$\" after the name of the share. To look for hidden shares, use a regular expression to look for a `(name_file_share)$`. In this search, we are looking for the command-line execution of net.exe with command-line parameters such as `net`, `share`, or `delete` that may correspond to the creation of hidden shares",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Execution|Persistence",
            "mitre_tactic": "TA0002|TA0003",
            "mitre_technique": "T1059",
            "name": "Create or delete hidden shares using net.exe",
            "released": "2.2.0",
            "searchKeywords": "",
            "search_name": "ESCU - Create or delete hidden shares using net.exe - Rule",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335",
            "usecase": "Security Monitoring"
        },
        "detection_create_local_admin_via_net": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Malware",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for the creation of local administrator accounts using net.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "Net.exe is a built-in Windows command-line tool that can be used to add, display, or modify user accounts. While Microsoft administrators use this tool to manage user groups, threat actors often leverage it to create local admin accounts to maintain persistence. In this search, we are looking for the execution of process net.exe with command-line parameters such as `localgroup`, `add`, or `user` that may correspond to the creation of local admin accounts or setting user/group properties.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Execution|Persistence",
            "mitre_tactic": "TA0002|TA0003",
            "mitre_technique": "T1059",
            "name": "Create local admin accounts using net.exe",
            "released": "2.2.0",
            "searchKeywords": "",
            "search_name": "ESCU - Create local admin accounts using net.exe - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "usecase": "Security Monitoring"
        },
        "detection_create_or_delete_network_shares": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Malware|",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "description": "This search looks for the creation or deletion of hidden shares using net.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_confidence": "medium",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "In this search, we are looking for the command-line execution of net.exe with command-line parameters such as `net`, `share`, or `delete` that may correspond to the creation/deletion of windows drive shares. Net.exe is a built-in command-line tool on Windows that can be used to create, delete, and manage shared resources on the computer, both locally and remotely. Though this tool is used by Microsoft administrators to manage the network shares, attackers also leverage it to create and delete (hidden) file shares by appending \"$\" after the name of the share. Since the creation/deletion of hidden shares is a special case of detecting share creation/deletion we have commented out the regex that adds that additional matching criteria. If only hidden share detection is desired add `| regex process=\"\\S+[$]\"` before the last pipe in the search.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "id": "detection_create_or_delete_network_shares",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre_tactic": "TA0008",
            "mitre_technique": "",
            "name": "Create or delete windows shares using net.exe",
            "released": "3.1.1",
            "search_name": "ESCU - Create or delete windows shares using net.exe - Rule",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335",
            "usecase": "Advanced Threat Detection"
        },
        "detection_cred_dump_via_reg": {
            "alertvolume": "Low",
            "app": "Enterprise_Security_Content_Update",
            "category": "Adversary Tactics",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for execution of reg.exe with parameters specifying an export of keys that contain hashed credentials that attackers may try to crack offline,",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 3|CIS 5|CIS 16",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.IP|PR.AC|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for the process reg.exe with the \"save\" parameter, which specifies a binary export from the registry. In addition, it looks for the keys that contain the hashed credentials, which attackers may retrieve and use for brute-force attacks in order to harvest legitimate credentials.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Credential Access",
            "mitre_tactic": "TA0006",
            "mitre_technique": "T1003",
            "name": "Attempted Credential Dump From Registry Via Reg.exe",
            "released": "2.2.0",
            "searchKeywords": "",
            "search_name": "ESCU - Attempted Credential Dump From Registry Via Reg.exe - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "usecase": "Advanced Threat Detection"
        },
        "detection_cscript_via_cmd": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for the execution of the cscript.exe or wscript.exe processes, with a parent of cmd.exe. The search will return the count, the first and last time this execution was seen on a machine, the user, and the destination of the machine",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "Attackers often leverage various scripting languages to execute their attacks. In a Windows environment, the Windows Script Host is the tool that interprets the scripts and is included in all modern versions of Windows. The Windows Script Host is available as a command-line tool called \"cscript.exe\" or \"wscript.exe.\" To detect this behavior, the search looks for process-creation events for cscript.exe or wscript.exe with a parent process of cmd.exe. The search will return the count, the first and last times this behavior was seen on a destination machine, and user and process information.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "mitre": "Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "T1059",
            "name": "Detect Use of cmd.exe to Launch Script Interpreters",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Detect Use of cmd.exe to Launch Script Interpreters - Rule",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52|f4368ddf-d59f-4192-84f6-778ac5a3ffc7",
            "usecase": "Advanced Threat Detection"
        },
        "detection_detect_mshta_exe_running_scripts_in_command-line_arguments": {
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected|DS004EndPointAntiMalware-ET02UpdatedSig|DS034ApplicationLogs-ET01General|VendorSpecific-winsec|DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch",
            "description": "This search looks for the execution of \"mshta.exe\" with command-line arguments that launch a script. The search will return the first time and last time these command-line arguments were used for these executions, as well as the target system, the user, process \"mshta.exe\" and its parent process.",
            "displayapp": "Enterprise Security Content Update",
            "escu_cis": "CIS 8",
            "escu_data_models": "",
            "escu_data_source": "",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "",
            "hasSearch": "No",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "id": "detection_Detect_mshta_exe_running_scripts_in_command-line_arguments",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detect mshta exe running scripts in command-line arguments",
            "released": "3.1.2",
            "search_name": "ESCU - Detect mshta exe running scripts in command-line arguments - Rule",
            "story": "",
            "usecase": "Security Monitoring"
        },
        "detection_detect_oulook_exe_writing_a_zip_file": {
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected|DS004EndPointAntiMalware-ET02UpdatedSig|DS034ApplicationLogs-ET01General|VendorSpecific-winsec|DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch",
            "description": "This search looks for execution of process `outlook.exe` where the process is writing a `.zip` file to the disk.",
            "displayapp": "Enterprise Security Content Update",
            "escu_cis": "CIS 7|CIS 8",
            "escu_data_models": "",
            "escu_data_source": "",
            "escu_nist": "ID.AM|PR.DS",
            "escu_providing_technologies": "",
            "hasSearch": "No",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "id": "detection_Detect_Oulook_exe_writing_a_zip_file",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detect Oulook exe writing a  zip file",
            "released": "3.1.2",
            "search_name": "ESCU - Detect Oulook exe writing a  zip file - Rule",
            "story": "",
            "usecase": "Security Monitoring"
        },
        "detection_excessive_dns_failures": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Command and Control",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS002DNS-ET01QueryResponse",
            "deprecated_not_used_anymore_datasource": "DNS",
            "description": "This search identifies DNS query failures by counting the number of DNS responses that do not indicate success, and trigger on more than 50 occurrences.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Network",
            "escu_cis": "CIS 8|CIS 9|CIS 12",
            "escu_data_models": "Network_Resolution",
            "escu_data_source": "DNS",
            "escu_nist": "PR.PT|DE.AE|DE.CM",
            "escu_providing_technologies": "Splunk Stream|Bro",
            "hasSearch": "No",
            "help": "This search looks at DNS traffic with a reply code that is NOT indicative of a successful response. Numerous unsuccessful replies may be indicative of DNS protocol tampering or other malicious activity. If more than 50 of these unsuccessful responses are observed over the time frame of the search, a notable event will be generated.",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Command and Control",
            "mitre": "Exfiltration|Command and Control",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "T1048|T1043",
            "name": "Excessive DNS Failures",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Excessive DNS Failures - Rule",
            "story": "943773c6-c4de-4f38-89a8-0b92f98804d8|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56",
            "usecase": "Advanced Threat Detection"
        },
        "detection_first_time_seen_child_process_of_zoom": {
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected|DS004EndPointAntiMalware-ET02UpdatedSig|DS034ApplicationLogs-ET01General|VendorSpecific-winsec|DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch",
            "description": "This search looks for child processes spawned by zoom.exe or zoom.us that has not previously been seen.",
            "displayapp": "Enterprise Security Content Update",
            "escu_cis": "CIS 3|CIS 8",
            "escu_data_models": "",
            "escu_data_source": "",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "escu_providing_technologies": "",
            "hasSearch": "No",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "id": "detection_First_Time_Seen_Child_Process_of_Zoom",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "First Time Seen Child Process of Zoom",
            "released": "3.1.2",
            "search_name": "ESCU - First Time Seen Child Process of Zoom - Rule",
            "story": "",
            "usecase": "Security Monitoring"
        },
        "detection_kerberoasting_spn_request_with_rc4_encryption": {
            "app": "Enterprise_Security_Content_Update",
            "category": "Network Attack",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected|DS004EndPointAntiMalware-ET02UpdatedSig|DS034ApplicationLogs-ET01General",
            "description": "This search detects a potential kerberoasting attack via service principal name requests",
            "displayapp": "Enterprise Security Content Update",
            "escu_cis": "CIS 8|CIS 16",
            "escu_data_models": "",
            "escu_data_source": "",
            "escu_nist": "DE.CM",
            "escu_providing_technologies": "",
            "hasSearch": "No",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "id": "detection_Kerberoasting_spn_request_with_RC4_encryption",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Kerberoasting spn request with RC4 encryption",
            "released": "3.1.2",
            "search_name": "ESCU - Kerberoasting spn request with RC4 encryption - Rule",
            "story": "",
            "usecase": "Security Monitoring"
        },
        "detection_long_dns_text_response": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Command and Control",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS002DNS-ET01Query",
            "deprecated_not_used_anymore_datasource": "DNS",
            "description": "This search is used to detect attempts to use DNS tunneling, by calculating the length of responses to DNS TXT queries. Endpoints using DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls can often be detected by noting unusually large volumes of DNS traffic.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Network",
            "escu_cis": "CIS 8|CIS 12|CIS 13",
            "escu_data_models": "Network_Resolution",
            "escu_data_source": "DNS",
            "escu_nist": "PR.DS|PR.PT|DE.AE|DE.CM",
            "escu_providing_technologies": "Splunk Stream|Bro",
            "hasSearch": "No",
            "help": "This search uses the Network_Resolution data model and gathers all the answers to DNS queries for TXT records. The query then looks at the answer section and calculates the length of the answer. The search will then return information for those responses that exceed 100 characters in length.",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "mitre": "Command and Control|Exfiltration",
            "mitre_tactic": "TA0011|TA0010",
            "mitre_technique": "T1043",
            "name": "Detect Long DNS TXT Record Response",
            "relatedUseCases": [
                "sser_tor_traffic",
                "Large_Web_Upload",
                "showcase_huge_volume_dns_volume"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Detect Long DNS TXT Record Response - Rule",
            "similarUseCases": [
                "showcase_huge_volume_dns_volume",
                "showcase_huge_volume_dns_requests"
            ],
            "story": "943773c6-c4de-4f38-89a8-0b92f98804d8|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56",
            "usecase": "Advanced Threat Detection"
        },
        "detection_malicious_powershell_process_obfuscation_techniques": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for PowerShell processes launched with arguments that have characters indicative of obfuscation on the command-line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 3|CIS 7|CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for PowerShell processes that are passing command-line arguments with unusual characters (backticks and carets) that are PowerShell specific escape characters. Attackers use this obfuscation technique since it does not affect the functionality of PowerShell and it will bypass standard security controls that look for straight up malicious strings and commands. The search counts the occurrence of these obfuscation characters and lists out destination IPs running these PowerShell commands.",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "mitre": "Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "T1086|T1064",
            "name": "Malicious PowerShell Process With Obfuscation Techniques",
            "relatedUseCases": [
                "detection_registry_persistence",
                "sser_fake_windows_processes",
                "suspicious_network_exploration"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Malicious PowerShell Process With Obfuscation Techniques - Rule",
            "story": "2c8ff66e-0b57-42af-8ad7-912438a403fc",
            "usecase": "Advanced Threat Detection"
        },
        "detection_of_dns_tunnels": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Data Protection|Suspicious DNS Traffic|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Command and Control",
            "dashboard": "showcase_security_content?showcaseId=detection_of_dns_tunnels",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2017-09-18",
            "description": "This search is used to detect DNS tunneling, by calculating the sum of the length of DNS queries and DNS answers. The search also filters out potential false positives by filtering out queries made to internal systems and the queries originating from internal DNS, Web, and Email servers. Endpoints using DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls can often be detected by noting an unusually large volume of DNS traffic.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 13",
            "escu_nist": "PR.PT|PR.DS",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, we must ensure that DNS data is being ingested and mapped to the appropriate fields in the Network_Resolution data model. Fields like src_category are automatically provided by the Assets and Identity Framework shipped with Splunk Enterprise Security. You will need to ensure you are using the Assets and Identity Framework and populating the src_category field. You will also need to enable the `cim_corporate_web_domain_search()` macro which will essentially filter out the DNS queries made to the corporate web domains to reduce alert fatigue.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, we must ensure that DNS data is being ingested and mapped to the appropriate fields in the Network_Resolution data model. Fields like src_category are automatically provided by the Assets and Identity Framework shipped with Splunk Enterprise Security. You will need to ensure you are using the Assets and Identity Framework and populating the src_category field. You will also need to enable the `cim_corporate_web_domain_search()` macro which will essentially filter out the DNS queries made to the corporate web domains to reduce alert fatigue.",
            "icon": "ES_Use_Case.png",
            "id": "detection_of_dns_tunnels",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "It's possible that normal DNS traffic will exhibit this behavior. If an alert is generated, please investigate and validate as appropriate. The threshold can also be modified to better suit your environment.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detection_of_dns_tunnels_filter"
                }
            ],
            "mitre_sub_technique": "T1071.004",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "APT39|Tropic Trooper|OilRig|Ke3chang|Cobalt Group|APT18|APT41|FIN7",
            "name": "Detection Of DNS Tunnels",
            "references": [],
            "released": "2017-09-18",
            "search": "| tstats `security_content_summariesonly` dc(\"DNS.query\") as count  from datamodel=Network_Resolution  where nodename=DNS \"DNS.message_type\"=\"QUERY\" NOT (`cim_corporate_web_domain_search(\"DNS.query\")`) NOT \"DNS.query\"=\"*.in-addr.arpa\" NOT (\"DNS.src_category\"=\"svc_infra_dns\" OR \"DNS.src_category\"=\"svc_infra_webproxy\" OR \"DNS.src_category\"=\"svc_infra_email*\"   ) by \"DNS.src\",\"DNS.query\" | rename \"DNS.src\" as src  \"DNS.query\" as message | eval length=len(message) | stats sum(length) as length by src | append [ tstats `security_content_summariesonly` dc(\"DNS.answer\") as count  from datamodel=Network_Resolution  where nodename=DNS \"DNS.message_type\"=\"QUERY\" NOT (`cim_corporate_web_domain_search(\"DNS.query\")`) NOT \"DNS.query\"=\"*.in-addr.arpa\" NOT (\"DNS.src_category\"=\"svc_infra_dns\" OR \"DNS.src_category\"=\"svc_infra_webproxy\" OR \"DNS.src_category\"=\"svc_infra_email*\"   ) by \"DNS.src\",\"DNS.answer\" | rename \"DNS.src\" as src  \"DNS.answer\" as message | eval message=if(message==\"unknown\",\"\", message) | eval length=len(message) | stats sum(length) as length by src ] | stats sum(length) as length by src | where length > 10000 | `detection_of_dns_tunnels_filter`",
            "search_name": "ESCU - Detection of DNS Tunnels - Rule",
            "story": "91c676cf-0b23-438d-abee-f6335e1fce33|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Data Protection",
                    "Suspicious DNS Traffic",
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 13"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "Tropic Trooper",
                    "OilRig",
                    "Ke3chang",
                    "Cobalt Group",
                    "APT18",
                    "APT41",
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "DNS"
                ],
                "nist": [
                    "PR.PT",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "detection_of_tools_built_by_nirsoft": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Emotet Malware  DHS Report TA18-201A ",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=detection_of_tools_built_by_nirsoft",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for specific command-line arguments that may indicate the execution of tools made by Nirsoft, which are legitimate, but may be abused by attackers.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "detection_of_tools_built_by_nirsoft",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "known_false_positives": "While legitimate, these NirSoft tools are prone to abuse. You should verfiy that the tool was used for a legitimate purpose.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "detection_of_tools_built_by_nirsoft_filter"
                }
            ],
            "mitre_sub_technique": "T1072",
            "mitre_tactic": "TA0002|TA0008",
            "mitre_tactic_display": "Execution|Lateral Movement",
            "mitre_technique": "T1072",
            "mitre_threat_groups": "Silence|APT32|Threat Group-1314",
            "name": "Detection Of Tools Built By Nirsoft",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process=\"* /stext *\" OR Processes.process=\"* /scomma *\" ) by Processes.parent_process Processes.process_name Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `detection_of_tools_built_by_nirsoft_filter`",
            "search_name": "ESCU - Detection of tools built by NirSoft - Rule",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52",
            "tags": {
                "analytics_story": [
                    "Emotet Malware  DHS Report TA18-201A "
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Silence",
                    "APT32",
                    "Threat Group-1314"
                ],
                "mitre_attack_id": [
                    "T1072"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "Software Deployment Tools"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "detection_path_interception_program.exe": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Adversary Tactics",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "The search is looking for the creation of program.exe in the C: drive.  The creation of this file in that location may be driven by a motive to perform path interception.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search queries the Endpoint file-system data model node to list out all the values of destination machines, as well as the values of file hashes and file paths that have the file \"program.exe\" in the C: drive. Path interception occurs when an executable is placed in a specific path so that it is executed by an application instead of by the intended target. In this case, applications vulnerable to path interception (because of unquoted service paths with spaces in Windows registry) allow attackers to execute maliciously crafted program.exes.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Privilege Escalation|Persistence",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_technique": "",
            "name": "Detect Path Interception By Creation Of program.exe",
            "released": "2.2.0",
            "searchKeywords": "",
            "search_name": "ESCU - Detect Path Interception By Creation Of program.exe - Rule",
            "story": "30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "usecase": "Advanced Threat Detection"
        },
        "detection_powershell_read_from_lsass": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Adversary Tactics",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "This search looks for PowerShell reading lsass memory consistent with credential dumping.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Access",
            "escu_cis": "CIS 3|CIS 5|CIS 16",
            "escu_data_source": "Windows Event Logs",
            "escu_nist": "PR.IP|PR.AC|DE.CM",
            "escu_providing_technologies": "Microsoft Windows",
            "hasSearch": "No",
            "help": "This search looks for Windows Event Code(signature_id) 4663 (object access), where the process performing the access is PowerShell.exe, the target process of the access is lsass.exe, and the access mask is given as 0x10. This is consistent with the use of PowerShell to execute Mimikatz using sekurlsa::logonpasswords. It will return the host where the activity occurred, the process and associated id, the enabled privilege, and the message in the event.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "mitre": "Credential Access",
            "mitre_tactic": "TA0006",
            "mitre_technique": "T1003",
            "name": "Detect Mimikatz Via PowerShell And EventCode 4663",
            "released": "2.2.0",
            "searchKeywords": "login log in logon log on sign",
            "search_name": "ESCU - Detect Mimikatz Via PowerShell And EventCode 4663 - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "usecase": "Advanced Threat Detection"
        },
        "detection_process_launching_netsh": {
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Abuse",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for processes launching netsh.exe. Netsh is a command-line scripting utility that allows you to, either locally or remotely, display or modify the network configuration of a computer that is currently running. Netsh can be used as a persistence proxy technique to execute a helper DLL when netsh.exe is executed. In this search, we are looking for processes spawned by netsh.exe and executing commands via the command line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for all the parent processes of netsh.exe and returns that process, the command-line used to execute it, the host name, and the user context under which it ran.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Execution|Persistence|Defense Evasion",
            "mitre_tactic": "TA0002|TA0003|TA0005",
            "mitre_technique": "T1059|T1089",
            "name": "Processes launching netsh",
            "released": "2.2.0",
            "searchKeywords": "",
            "search_name": "ESCU - Processes launching netsh - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|fcc27099-46a0-46b0-a271-5c7dab56b6f1|2b1800dd-92f9-47ec-a981-fdf1351e5f65",
            "usecase": "Other"
        },
        "detection_prohibited_apps_spawning_cmdprompt": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for executions of cmd.exe spawned by a process that is often abused by attackers and that does not typically launch cmd.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.PT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "Obtaining access to the Command-Line Interface (CLI) is typically a primary attacker goal. Once an attacker has obtained the ability to execute code on a target system, they will often further manipulate the system via commands passed to the CLI. It is also unusual for many applications to spawn a command shell during normal operation, while it is often observed if an application has been compromised in some way. As such, it is often beneficial to look for cmd.exe being executed by processes that are often targeted for exploitation, or that would not spawn cmd.exe in any other circumstances. A lookup file is provided to easily modify the processes that are being watched for execution of cmd.exe.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "mitre": "Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "T1059",
            "name": "Detect Prohibited Applications Spawning cmd.exe",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Detect Prohibited Applications Spawning cmd.exe - Rule",
            "story": "f4368ddf-d59f-4192-84f6-778ac5a3ffc7|2b1800dd-92f9-47dd-a981-fdf13w1q5d55",
            "usecase": "Advanced Threat Detection"
        },
        "detection_reg_manipulating_services": {
            "alertvolume": "Low",
            "app": "Enterprise_Security_Content_Update",
            "category": "Malware",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "The search looks for reg.exe modifying registry keys that define Windows services and their configurations.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 3|CIS 5|CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.IP|PR.PT|PR.AC|PR.AT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for modifications to registry paths that specify the definition and configuration of Windows services by reg.exe. Reg.exe is a Windows utility that allows for manipulation of the registry via the command line. Malware often uses the Windows services architecture to persist, hide in plain sight, and gain the ability to interact with the Windows kernel. While it is common to modify the configuration of Windows services (and new services may be created with software installs), the use of reg.exe to create or modify a service configuration is unusual and a technique commonly used by attackers. The search returns the count, the first time the activity was seen, the last time activity was seen, the registry path that was modified, the host where the modification took place, and the user that performed the modification.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "mitre": "Persistence|Privilege Escalation|Defense Evasion",
            "mitre_tactic": "TA0003|TA0004|TA0005",
            "mitre_technique": "T1050|T1031|T1089",
            "name": "Reg.exe Manipulating Windows Services Registry Keys",
            "released": "2.2.0",
            "searchKeywords": "",
            "search_name": "ESCU - Reg.exe Manipulating Windows Services Registry Keys - Rule",
            "story": "6dbd810e-f66d-414b-8dfc-e46de55cbfe2|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "usecase": "Security Monitoring"
        },
        "detection_reg_used_to_hide_files": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "The search looks for command-line arguments used to hide a file or directory using the reg add command.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "Reg.exe is a binary native to Windows platform used to edit the registry hives of the system. Attackers can leverage this binary to hide files by passing in arguments that are used to hide the files. In the search, we first gather results with keywords, add, Hidden, and REG_DWORD, that will be in the raw event and filter by process and the command-line. We then leverage regular expressions on the command-line field to look for /d value as 2 which is responsible for hiding a file or directory.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Defense Evasion|Persistence",
            "mitre_tactic": "TA0005|TA0003",
            "mitre_technique": "|T1060|T1112",
            "name": "Reg.exe used to hide files/directories via registry keys",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Reg.exe used to hide files/directories via registry keys - Rule",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|2b1800dd-92f9-47dd-a981-fdf1351e5d55|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "usecase": "Advanced Threat Detection"
        },
        "detection_sc_manipulating_services": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for arguments to sc.exe indicating the creation or modification of a Windows service.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 3|CIS 5|CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "PR.IP|PR.PT|PR.AC|PR.AT|DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for the execution of sc.exe with parameters that indicate the utility is being used to create a new Windows service, or modify an existing one. Attackers often create a new service to host their malicious code, or they may take a non-critical service or one that is disabled, and modify it to point to their malware and enable the service if necessary. It is unusual for a service to be created or modified using the sc.exe utility.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "mitre": "Persistence|Privilege Escalation|Defense Evasion",
            "mitre_tactic": "TA0003|TA0004|TA0005",
            "mitre_technique": "T1050|T1031|T1089",
            "name": "Sc.exe Manipulating Windows Services",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Sc.exe Manipulating Windows Services - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|fcc27099-46a0-46b0-a271-5c7dab56b6f1|bb9f5ed2-916e-4364-bb6d-97c370efcf52|6dbd810e-f66d-414b-8dfc-e46de55cbfe2|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "usecase": "Advanced Threat Detection"
        },
        "detection_sql_injection_with_long_urls": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Web Attack",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "This search looks for long URLs that have several SQL commands visible within them.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Network",
            "escu_cis": "CIS 4|CIS 13|CIS 18",
            "escu_data_models": "Web",
            "escu_data_source": "Network Communication",
            "escu_nist": "PR.DS|ID.RA|PR.PT|PR.IP|DE.CM",
            "escu_providing_technologies": "Splunk Stream|Bro",
            "hasSearch": "No",
            "help": "This search looks only at your web servers and returns the source, the web server, the URL and its length, and the user agent associated with HTTP GET requests for extremely long URLs or user agent lengths with more than three common SQL commands found within the URL.",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Delivery",
            "mitre": "Defense Evasion|Execution",
            "mitre_tactic": "TA0005|TA0002",
            "mitre_technique": "T1068|T1043",
            "name": "SQL Injection with Long URLs",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - SQL Injection with Long URLs - Rule",
            "story": "4f6632f5-449c-4686-80df-57625f59bab3",
            "usecase": "Application Security"
        },
        "detection_suspicious_reg_process": {
            "SPLEase": "None",
            "alertvolume": "Medium",
            "app": "Enterprise_Security_Content_Update",
            "category": "Endpoint Compromise",
            "dashboard": "ESCU_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "This search looks for reg.exe being launched from a command prompt not started by the user. When a user launches cmd.exe, the parent process is usually explorer.exe. This search filters out those instances.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Endpoint",
            "escu_cis": "CIS 8",
            "escu_data_models": "Endpoint",
            "escu_data_source": "Endpoint Intel",
            "escu_nist": "DE.CM",
            "escu_providing_technologies": "Carbon Black Response|CrowdStrike Falcon|Sysmon|Tanium|Ziften",
            "hasSearch": "No",
            "help": "This search looks for the execution of reg.exe with a parent process of cmd.exe. It then executes a subsearch looking for those cmd.exe processes with a parent that is not explorer.exe. It then joins those two searches to make sure that the reg.exe process is a grandchild of the non explorer.exe process. The search will return the number of such instances and the first and last time this activity has been seen on each endpoint and user.",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "mitre": "Defense Evasion",
            "mitre_tactic": "TA0005",
            "mitre_technique": "T1112|T1089",
            "name": "Suspicious Reg.exe Process",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_threat_hunting"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "ESCU - Suspicious Reg.exe Process - Rule",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|fcc27099-46a0-46b0-a271-5c7dab56b6f1",
            "usecase": "Advanced Threat Detection"
        },
        "detection_uba_email_anomaly": {
            "alertvolume": "Medium",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "description": "This detection looks for emails that are suspicious because of their sender, domain rareness, or behavior differences. This is an anomaly generated by Splunk User Behavior Analytics (UBA).",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "This detection monitors for emails that are suspicious because of their sender, domain rareness, or behavior differences, as determined by Splunk UBA. In this search, we query the \"UEBA\" data model to look for anomalies that are raised by the \"SuspiciousEmailDetectionModel\" and will output the count, description of the anomaly, signature, the type of event in UBA, the severity, and the user who received a potentially suspicious email from a newly seen domain. It will also output all the categories associated with that anomaly.",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "detection_uba_email_anomaly",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious Email - UBA Anomaly",
            "released": "3.0.0",
            "usecase": "Advanced Threat Detection"
        },
        "disabling_remote_user_account_control": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Defense Evasion Tactics|Suspicious Windows Registry Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=disabling_remote_user_account_control",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Registry",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548.002/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-18",
            "description": "The search looks for modifications to registry keys that control the enforcement of Windows User Account Control (UAC).",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report registry modifications.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report registry modifications.",
            "icon": "ES_Use_Case.png",
            "id": "disabling_remote_user_account_control",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "This registry key may be modified via administrators to implement a change in system policy. This type of change should be a very rare occurrence.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "disabling_remote_user_account_control_filter"
                }
            ],
            "mitre_sub_technique": "T1548.002",
            "mitre_tactic": "TA0004|TA0005",
            "mitre_tactic_display": "Privilege Escalation|Defense Evasion",
            "mitre_technique": "T1548",
            "mitre_threat_groups": "APT37|MuddyWater|Honeybee|Cobalt Group|Threat Group-3390|BRONZE BUTLER|Patchwork|APT29",
            "name": "Disabling Remote User Account Control",
            "references": [],
            "released": "2020-11-18",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where Registry.registry_path=*HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\EnableLUA* Registry.registry_value_name=\"DWORD (0x00000000)\" by Registry.dest, Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_name Registry.action | `drop_dm_object_name(Registry)` | `disabling_remote_user_account_control_filter`",
            "search_name": "ESCU - Disabling Remote User Account Control - Rule",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|2b1800dd-92f9-47dd-a981-fdf1351e5d55",
            "tags": {
                "analytics_story": [
                    "Windows Defense Evasion Tactics",
                    "Suspicious Windows Registry Activities"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548.002/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT37",
                    "MuddyWater",
                    "Honeybee",
                    "Cobalt Group",
                    "Threat Group-3390",
                    "BRONZE BUTLER",
                    "Patchwork",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1548"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Bypass User Access Control"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "dns_query_length_outliers_-_mltk": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Hidden Cobra Malware|Suspicious DNS Traffic|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2019-05-08",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model to characterize the length of the DNS queries for each DNS record type observed in the environment. By default, the search uses the last 30 days of data to build the model. The model created by this search is then used in the corresponding detection search, which uses it to identify outliers in the length of the DNS query.",
                    "how_to_implement": "To successfully implement this search, you will need to ensure that DNS data is populating the Network_Resolution data model. In addition, you must have the Machine Learning Toolkit (MLTK) version >= 4.2 installed, along with any required dependencies. By default, the search builds the model using the past 30 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data. More information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "c914844c-0ff5-4efc-8d44-c063443129ba",
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_dns_query_length___mltk_filter"
                        }
                    ],
                    "name": "Baseline of DNS Query Length - MLTK",
                    "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Resolution by DNS.query DNS.record_type | search DNS.record_type=* | `drop_dm_object_name(\"DNS\")` | eval query_length = len(query) | fit DensityFunction query_length by record_type into dns_query_pdfmodel",
                    "tags": {
                        "analytics_story": [
                            "Command and Control",
                            "Hidden Cobra Malware",
                            "Suspicious DNS Traffic"
                        ],
                        "detections": [
                            "DNS Query Length Outliers - MLTK"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=dns_query_length_outliers_-_mltk",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2020-01-22",
            "description": "This search allows you to identify DNS requests that are unusually large for the record type being requested in your environment.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 12",
            "escu_nist": "PR.PT|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you will need to ensure that DNS data is populating the Network_Resolution data model. In addition, the Machine Learning Toolkit (MLTK) version 4.2 or greater must be installed on your search heads, along with any required dependencies. Finally, the support search \"Baseline of DNS Query Length - MLTK\" must be executed before this detection search, because it builds a machine-learning (ML) model over the historical data used by this search. It is important that this search is run in the same app context as the associated support search, so that the model created by the support search is available for use. You should periodically re-run the support search to rebuild the model with the latest data available in your environment.\\\nThis search produces fields (`query`,`query_length`,`count`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** DNS Query, **Field:** query\\\n1. \\\n1. **Label:** DNS Query Length, **Field:** query_length\\\n1. \\\n1. **Label:** Number of events, **Field:** count\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you will need to ensure that DNS data is populating the Network_Resolution data model. In addition, the Machine Learning Toolkit (MLTK) version 4.2 or greater must be installed on your search heads, along with any required dependencies. Finally, the support search \"Baseline of DNS Query Length - MLTK\" must be executed before this detection search, because it builds a machine-learning (ML) model over the historical data used by this search. It is important that this search is run in the same app context as the associated support search, so that the model created by the support search is available for use. You should periodically re-run the support search to rebuild the model with the latest data available in your environment.\\\nThis search produces fields (`query`,`query_length`,`count`) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. These fields contribute additional context to the notable. To see the additional metadata, add the following fields, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry):\\\\n1. **Label:** DNS Query, **Field:** query\\\n1. \\\n1. **Label:** DNS Query Length, **Field:** query_length\\\n1. \\\n1. **Label:** Number of events, **Field:** count\\\nDetailed documentation on how to create a new field within Incident Review may be found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "dns_query_length_outliers_-_mltk",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "If you are seeing more results than desired, you may consider reducing the value for threshold in the search. You should also periodically re-run the support search to re-build the ML model on the latest data.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "dns_query_length_outliers___mltk_filter"
                }
            ],
            "mitre_sub_technique": "T1071.004",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "APT39|Tropic Trooper|OilRig|Ke3chang|Cobalt Group|APT18|APT41|FIN7",
            "name": "DNS Query Length Outliers - MLTK",
            "references": [],
            "released": "2020-01-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as start_time max(_time) as end_time values(DNS.src) as src values(DNS.dest) as dest from datamodel=Network_Resolution by DNS.query DNS.record_type | search DNS.record_type=* |  `drop_dm_object_name(DNS)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | eval query_length = len(query) | apply dns_query_pdfmodel threshold=0.01 | rename \"IsOutlier(query_length)\" as isOutlier | search isOutlier > 0 | sort -query_length | table start_time end_time query record_type count src dest query_length | `dns_query_length_outliers___mltk_filter` ",
            "search_name": "ESCU - DNS Query Length Outliers - MLTK - Rule",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Hidden Cobra Malware",
                    "Suspicious DNS Traffic",
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "Tropic Trooper",
                    "OilRig",
                    "Ke3chang",
                    "Cobalt Group",
                    "APT18",
                    "APT41",
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "DNS"
                ],
                "nist": [
                    "PR.PT",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "dns_query_length_with_high_standard_deviation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Hidden Cobra Malware|Suspicious DNS Traffic|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Command and Control",
            "dashboard": "showcase_security_content?showcaseId=dns_query_length_with_high_standard_deviation",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search allows you to identify DNS requests and compute the standard deviation on the length of the names being resolved, then filter on two times the standard deviation to show you those queries that are unusually large for your environment.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 12",
            "escu_nist": "PR.PT|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you will need to ensure that DNS data is populating the Network_Resolution data model.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you will need to ensure that DNS data is populating the Network_Resolution data model.",
            "icon": "ES_Use_Case.png",
            "id": "dns_query_length_with_high_standard_deviation",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "It's possible there can be long domain names that are legitimate.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "dns_query_length_with_high_standard_deviation_filter"
                }
            ],
            "mitre_sub_technique": "T1071.004",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "APT39|Tropic Trooper|OilRig|Ke3chang|Cobalt Group|APT18|APT41|FIN7",
            "name": "DNS Query Length With High Standard Deviation",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Resolution by DNS.query DNS.record_type |  `drop_dm_object_name(\"DNS\")` | eval query_length = len(query) | table query query_length record_type count | eventstats stdev(query_length) AS stdev avg(query_length) AS avg p50(query_length) AS p50| where query_length>(avg+stdev*2) | eval z_score=(query_length-avg)/stdev | `dns_query_length_with_high_standard_deviation_filter` ",
            "search_name": "ESCU - DNS Query Length With High Standard Deviation - Rule",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Hidden Cobra Malware",
                    "Suspicious DNS Traffic",
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "Tropic Trooper",
                    "OilRig",
                    "Ke3chang",
                    "Cobalt Group",
                    "APT18",
                    "APT41",
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "DNS"
                ],
                "nist": [
                    "PR.PT",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "dns_query_requests_resolved_by_unauthorized_dns_servers": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DNS Hijacking|Command and Control|Suspicious DNS Traffic|Host Redirection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Compliance",
            "dashboard": "showcase_security_content?showcaseId=dns_query_requests_resolved_by_unauthorized_dns_servers",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search will detect DNS requests resolved by unauthorized DNS servers. Legitimate DNS servers should be identified in the Enterprise Security Assets and Identity Framework.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 3|CIS 8|CIS 12",
            "escu_nist": "ID.AM|PR.DS|PR.IP|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you will need to ensure that DNS data is populating the Network_Resolution data model. It also requires that your DNS servers are identified correctly in the Assets and Identity table of Enterprise Security.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you will need to ensure that DNS data is populating the Network_Resolution data model. It also requires that your DNS servers are identified correctly in the Assets and Identity table of Enterprise Security.",
            "icon": "ES_Use_Case.png",
            "id": "dns_query_requests_resolved_by_unauthorized_dns_servers",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "Legitimate DNS activity can be detected in this search. Investigate, verify and update the list of authorized DNS servers as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "dns_query_requests_resolved_by_unauthorized_dns_servers_filter"
                }
            ],
            "mitre_sub_technique": "T1071.004",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "APT39|Tropic Trooper|OilRig|Ke3chang|Cobalt Group|APT18|APT41|FIN7",
            "name": "DNS Query Requests Resolved By Unauthorized DNS Servers",
            "references": "",
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Resolution where DNS.dest_category != dns_server AND DNS.src_category != dns_server by DNS.src DNS.dest | `drop_dm_object_name(\"DNS\")` | `dns_query_requests_resolved_by_unauthorized_dns_servers_filter` ",
            "search_name": "ESCU - DNS Query Requests Resolved by Unauthorized DNS Servers - Rule",
            "story": "8169f17b-ef68-4b59-aa28-586907301221|943773c6-c4de-4f38-89a8-0b92f98804d8|3c3835c0-255d-4f9e-ab84-e29ec9ec9b56|2e8948a5-5239-406b-b56b-6c50fe268af4",
            "tags": {
                "analytics_story": [
                    "DNS Hijacking",
                    "Command and Control",
                    "Suspicious DNS Traffic",
                    "Host Redirection"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 1",
                    "CIS 3",
                    "CIS 8",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "Tropic Trooper",
                    "OilRig",
                    "Ke3chang",
                    "Cobalt Group",
                    "APT18",
                    "APT41",
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "DNS"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS",
                    "PR.IP",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Compliance",
            "version": 3
        },
        "dns_record_changed": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DNS Hijacking",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jose Hernandez, Splunk",
            "baselines": [
                {
                    "author": "Jose Hernandez, Splunk",
                    "date": "2019-02-14",
                    "description": "The search takes corporate and common cloud provider domains configured under `cim_corporate_email_domains.csv`, `cim_corporate_web_domains.csv`, and `cloud_domains.csv` finds their responses across the last 30 days from data in the `Network_Resolution ` datamodel, then stores the output under the `discovered_dns_records.csv` lookup",
                    "how_to_implement": "To successfully implement this search, you must be ingesting DNS logs, and populating the Network_Resolution data model. Also make sure that the cim_corporate_web_domains and cim_corporate_email_domains lookups are populated with the domains owned by your corporation",
                    "id": "c096f721-8842-42ce-bfc7-74bd8c72b7c3",
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "discover_dns_records_filter"
                        }
                    ],
                    "name": "Discover DNS records",
                    "search": "| inputlookup cim_corporate_email_domains.csv | inputlookup append=T cim_corporate_web_domains.csv | inputlookup append=T cim_cloud_domains.csv | eval domain = trim(replace(domain, \"\\*\", \"\")) | join domain [|tstats `security_content_summariesonly` count values(DNS.record_type) as type, values(DNS.answer) as answer from datamodel=Network_Resolution where DNS.message_type=RESPONSE DNS.answer!=\"unknown\" DNS.answer!=\"\" by DNS.query | rename DNS.query as query | where query!=\"unknown\" | rex field=query \"(?<domain>\\w+\\.\\w+?)(?:$|/)\"] | makemv delim=\" \" answer |  makemv delim=\" \" type | sort -count | table count,domain,type,query,answer | outputlookup createinapp=true discovered_dns_records",
                    "tags": {
                        "analytics_story": [
                            "DNS Hijacking"
                        ],
                        "detections": [
                            "DNS record changed"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=dns_record_changed",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2020-07-21",
            "description": "The search takes the DNS records and their answers results of the discovered_dns_records lookup and finds if any records have changed by searching DNS response from the Network_Resolution datamodel across the last day.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1|CIS 3|CIS 8|CIS 12",
            "escu_nist": "ID.AM|PR.DS|PR.IP|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you will need to ensure that DNS data is populating the `Network_Resolution` data model. It also requires that the `discover_dns_record` lookup table be populated by the included support search \"Discover DNS record\". \\\n **Splunk>Phantom Playbook Integration**\\\nIf Splunk>Phantom is also configured in your environment, a Playbook called \"DNS Hijack Enrichment\" can be configured to run when any results are found by this detection search. The playbook takes in the DNS record changed and uses Geoip, whois, Censys and PassiveTotal to detect if DNS issuers changed. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search, and set the corresponding Playbook to active. \\\n(Playbook Link:`https://my.phantom.us/4.2/playbook/dns-hijack-enrichment/`).\\\n",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you will need to ensure that DNS data is populating the `Network_Resolution` data model. It also requires that the `discover_dns_record` lookup table be populated by the included support search \"Discover DNS record\". \\\n **Splunk>Phantom Playbook Integration**\\\nIf Splunk>Phantom is also configured in your environment, a Playbook called \"DNS Hijack Enrichment\" can be configured to run when any results are found by this detection search. The playbook takes in the DNS record changed and uses Geoip, whois, Censys and PassiveTotal to detect if DNS issuers changed. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search, and set the corresponding Playbook to active. \\\n(Playbook Link:`https://my.phantom.us/4.2/playbook/dns-hijack-enrichment/`).\\\n",
            "icon": "ES_Use_Case.png",
            "id": "dns_record_changed",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "Legitimate DNS changes can be detected in this search. Investigate, verify and update the list of provided current answers for the domains in question as appropriate.",
            "lookups": [
                {
                    "default_match": "false",
                    "description": "A placeholder for a list of discovered DNS records generated by the baseline discover_dns_records",
                    "filename": "discovered_dns_records.csv",
                    "min_matches": 1,
                    "name": "discovered_dns_records"
                }
            ],
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "dns_record_changed_filter"
                }
            ],
            "mitre_sub_technique": "T1071.004",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "APT39|Tropic Trooper|OilRig|Ke3chang|Cobalt Group|APT18|APT41|FIN7",
            "name": "DNS Record Changed",
            "references": "",
            "released": "2020-07-21",
            "search": "| inputlookup discovered_dns_records | rename answer as discovered_answer | join domain[|tstats `security_content_summariesonly` count values(DNS.record_type) as type, values(DNS.answer) as current_answer values(DNS.src) as src from datamodel=Network_Resolution where DNS.message_type=RESPONSE DNS.answer!=\"unknown\" DNS.answer!=\"\" by DNS.query | rename DNS.query as query | where query!=\"unknown\" | rex field=query \"(?<domain>\\w+\\.\\w+?)(?:$|/)\"] | makemv delim=\" \" answer |  makemv delim=\" \" type | sort -count | table count,src,domain,type,query,current_answer,discovered_answer | makemv current_answer  | mvexpand current_answer | makemv discovered_answer | eval n=mvfind(discovered_answer, current_answer) | where isnull(n) | `dns_record_changed_filter`",
            "search_name": "ESCU - DNS record changed - Rule",
            "story": "8169f17b-ef68-4b59-aa28-586907301221",
            "tags": {
                "analytics_story": [
                    "DNS Hijacking"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 1",
                    "CIS 3",
                    "CIS 8",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "Tropic Trooper",
                    "OilRig",
                    "Ke3chang",
                    "Cobalt Group",
                    "APT18",
                    "APT41",
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "DNS"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS",
                    "PR.IP",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "download_from_internal_server": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detects outliers in the timeseries of downloaded bytes from possible internal servers per user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0009",
            "mitre_technique": "|T1039|T1213",
            "name": "Download from Internal Server",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "dump_lsass_via_comsvcs_dll": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=dump_lsass_via_comsvcs_dll",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-02-21",
            "description": "Detect the usage of comsvcs.dll for dumping the lsass process.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "dump_lsass_via_comsvcs_dll",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "None identified.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "dump_lsass_via_comsvcs_dll_filter"
                }
            ],
            "mitre_sub_technique": "T1003.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Sandworm Team|Whitefly|Blue Mockingbird|Silence|Threat Group-3390|Leviathan|APT41|Soft Cell|TEMP.Veles|APT33|APT39|Stolen Pencil|APT32|Lazarus Group|Leafminer|Magic Hound|MuddyWater|PLATINUM|FIN8|BRONZE BUTLER|OilRig|FIN6|APT3|APT28|APT1|Ke3chang|Cleaver",
            "name": "Dump LSASS Via Comsvcs DLL",
            "references": [
                "https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/",
                "https://twitter.com/SBousseaden/status/1167417096374050817"
            ],
            "released": "2020-02-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=rundll32.exe Processes.process=*comsvcs.dll* Processes.process=*MiniDump* by Processes.user Processes.process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `dump_lsass_via_comsvcs_dll_filter`",
            "search_name": "ESCU - Dump LSASS via comsvcs DLL - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Whitefly",
                    "Blue Mockingbird",
                    "Silence",
                    "Threat Group-3390",
                    "Leviathan",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Stolen Pencil",
                    "APT32",
                    "Lazarus Group",
                    "Leafminer",
                    "Magic Hound",
                    "MuddyWater",
                    "PLATINUM",
                    "FIN8",
                    "BRONZE BUTLER",
                    "OilRig",
                    "FIN6",
                    "APT3",
                    "APT28",
                    "APT1",
                    "Ke3chang",
                    "Cleaver"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "LSASS Memory"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "ec2_instance_modified_with_previously_unseen_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Unusual AWS EC2 Modifications",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-04-05",
                    "description": "This search builds a table of previously seen ARNs that have launched a EC2 instance.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs. To add or remove APIs that modify an EC2 instance, edit the macro `ec2_modification_api_calls`.",
                    "id": "4d69091b-d975-4267-85df-888bd41034eb",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/previously_seen_ec2_modifications_by_user.csv",
                            "description": "A place holder for a list of AWS EC2 modifications done by each user",
                            "filename": "previously_seen_ec2_modifications_by_user.csv",
                            "name": "previously_seen_ec2_modifications_by_user"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "(eventName=AssociateAddress OR eventName=AssociateIamInstanceProfile OR eventName=AttachClassicLinkVpc OR eventName=AttachNetworkInterface OR eventName=AttachVolume OR eventName=BundleInstance OR eventName=DetachClassicLinkVpc OR eventName=DetachVolume OR eventName=ModifyInstanceAttribute OR eventName=ModifyInstancePlacement OR eventName=MonitorInstances OR eventName=RebootInstances OR eventName=ResetInstanceAttribute OR eventName=StartInstances OR eventName=StopInstances OR eventName=TerminateInstances OR eventName=UnmonitorInstances)",
                            "description": "This is a list of AWS event names that have to do with modifying Amazon EC2 instances",
                            "name": "ec2_modification_api_calls"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_ec2_modifications_by_user_filter"
                        }
                    ],
                    "name": "Previously Seen EC2 Modifications By User",
                    "search": "`cloudtrail` `ec2_modification_api_calls` errorCode=success | spath output=arn userIdentity.arn | stats earliest(_time) as firstTime latest(_time) as lastTime by arn | outputlookup previously_seen_ec2_modifications_by_user | stats count",
                    "tags": {
                        "analytics_story": [
                            "Unusual AWS EC2 Modifications"
                        ],
                        "detections": [
                            "EC2 Instance Modified With Previously Unseen User"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=ec2_instance_modified_with_previously_unseen_user",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for EC2 instances being modified by users who have not previously modified them.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 Launches By User\" support search once to create a history of previously seen ARNs. To add or remove APIs that modify an EC2 instance, edit the macro `ec2_modification_api_calls`.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 Launches By User\" support search once to create a history of previously seen ARNs. To add or remove APIs that modify an EC2 instance, edit the macro `ec2_modification_api_calls`.",
            "icon": "ES_Use_Case.png",
            "id": "ec2_instance_modified_with_previously_unseen_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "It's possible that a new user will start to modify EC2 instances when they haven't before for any number of reasons. Verify with the user that is modifying instances that this is the intended behavior.",
            "lookups": [
                {
                    "description": "A place holder for a list of AWS EC2 modifications done by each user",
                    "filename": "previously_seen_ec2_modifications_by_user.csv",
                    "name": "previously_seen_ec2_modifications_by_user"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "(eventName=AssociateAddress OR eventName=AssociateIamInstanceProfile OR eventName=AttachClassicLinkVpc OR eventName=AttachNetworkInterface OR eventName=AttachVolume OR eventName=BundleInstance OR eventName=DetachClassicLinkVpc OR eventName=DetachVolume OR eventName=ModifyInstanceAttribute OR eventName=ModifyInstancePlacement OR eventName=MonitorInstances OR eventName=RebootInstances OR eventName=ResetInstanceAttribute OR eventName=StartInstances OR eventName=StopInstances OR eventName=TerminateInstances OR eventName=UnmonitorInstances)",
                    "description": "This is a list of AWS event names that have to do with modifying Amazon EC2 instances",
                    "name": "ec2_modification_api_calls"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "ec2_instance_modified_with_previously_unseen_user_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "EC2 Instance Modified With Previously Unseen User",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` `ec2_modification_api_calls` [search `cloudtrail` `ec2_modification_api_calls` errorCode=success | stats earliest(_time) as firstTime latest(_time) as lastTime by userIdentity.arn | rename userIdentity.arn as arn | inputlookup append=t previously_seen_ec2_modifications_by_user | stats min(firstTime) as firstTime, max(lastTime) as lastTime by arn | outputlookup previously_seen_ec2_modifications_by_user | eval newUser=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newUser=1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=dest responseElements.instancesSet.items{}.instanceId | spath output=user userIdentity.arn | table _time, user, dest | `ec2_instance_modified_with_previously_unseen_user_filter`",
            "search_name": "ESCU - EC2 Instance Modified With Previously Unseen User - Rule",
            "story": "73de57ef-0dfc-411f-b1e7-fa24428aeae0",
            "tags": {
                "analytics_story": [
                    "Unusual AWS EC2 Modifications"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "risk_object": "user",
                "risk_object_type": "user",
                "risk_score": 5,
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "ec2_instance_started_in_previously_unseen_region": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cryptomining|Suspicious AWS EC2 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2018-01-08",
                    "description": "This search looks for CloudTrail events where an AWS instance is started and creates a baseline of most recent time (latest) and the first time (earliest) we've seen this region in our dataset grouped by the value awsRegion for the last 30 days",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "fc0edc95-ff2b-48b0-9f6f-63da3789fd63",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_aws_regions_filter"
                        }
                    ],
                    "name": "Previously Seen AWS Regions",
                    "search": "`cloudtrail` StartInstances | stats earliest(_time) as earliest latest(_time) as latest by awsRegion | outputlookup previously_seen_aws_regions.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Cryptomining",
                            "Suspicious AWS EC2 Activities"
                        ],
                        "detections": [
                            "EC2 Instance Started In Previously Unseen Region"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=ec2_instance_started_in_previously_unseen_region",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-02-23",
            "description": "This search looks for CloudTrail events where an instance is started in a particular region in the last one hour and then compares it to a lookup file of previously seen regions where an instance was started",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 12",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Run the \"Previously seen AWS Regions\" support search only once to create of baseline of previously seen regions.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. Run the \"Previously seen AWS Regions\" support search only once to create of baseline of previously seen regions.",
            "icon": "ES_Use_Case.png",
            "id": "ec2_instance_started_in_previously_unseen_region",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It's possible that a user has unknowingly started an instance in a new region. Please verify that this activity is legitimate.",
            "lookups": [
                {
                    "default_match": "false",
                    "description": "A place holder for a list of used AWS regions",
                    "filename": "previously_seen_aws_regions.csv",
                    "min_matches": 1,
                    "name": "previously_seen_aws_regions"
                }
            ],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "ec2_instance_started_in_previously_unseen_region_filter"
                }
            ],
            "mitre_sub_technique": "T1535",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1535",
            "mitre_threat_groups": "no",
            "name": "EC2 Instance Started In Previously Unseen Region",
            "references": [],
            "released": "2018-02-23",
            "search": "`cloudtrail` earliest=-1h StartInstances | stats earliest(_time) as earliest latest(_time) as latest by awsRegion | inputlookup append=t previously_seen_aws_regions.csv | stats min(earliest) as earliest max(latest) as latest by awsRegion | outputlookup previously_seen_aws_regions.csv | eval regionStatus=if(earliest >= relative_time(now(),\"-1d@d\"), \"Instance Started in a New Region\",\"Previously Seen Region\") | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | where regionStatus=\"Instance Started in a New Region\" | `ec2_instance_started_in_previously_unseen_region_filter`",
            "search_name": "ESCU - EC2 Instance Started In Previously Unseen Region - Rule",
            "story": "ced74200-8465-4bc3-bd2c-9a782eec6750|2e8948a5-5239-406b-b56b-6c50f1268af3",
            "tags": {
                "analytics_story": [
                    "AWS Cryptomining",
                    "Suspicious AWS EC2 Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1535"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Unused/Unsupported Cloud Regions"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "risk_object": "src",
                "risk_object_type": "system",
                "risk_score": 10,
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "ec2_instance_started_with_previously_unseen_ami": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-12",
                    "description": "This search builds a table of previously seen AMIs used to launch EC2 instances",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "bb1bd99d-1e93-45f1-9571-cfed42d372b9",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_ec2_amis_filter"
                        }
                    ],
                    "name": "Previously Seen EC2 AMIs",
                    "search": "`cloudtrail` eventName=RunInstances errorCode=success | rename requestParameters.instancesSet.items{}.imageId as amiID | stats earliest(_time) as firstTime latest(_time) as lastTime by amiID | outputlookup previously_seen_ec2_amis.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Cryptomining"
                        ],
                        "detections": [
                            "EC2 Instance Started With Previously Unseen AMI"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=ec2_instance_started_with_previously_unseen_ami",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2018-03-12",
            "description": "This search looks for EC2 instances being created with previously unseen AMIs.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 AMIs\" support search once to create a history of previously seen AMIs.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 AMIs\" support search once to create a history of previously seen AMIs.",
            "icon": "ES_Use_Case.png",
            "id": "ec2_instance_started_with_previously_unseen_ami",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "After a new AMI is created, the first systems created with that AMI will cause this alert to fire.  Verify that the AMI being used was created by a legitimate user.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "ec2_instance_started_with_previously_unseen_ami_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "EC2 Instance Started With Previously Unseen Ami",
            "references": [],
            "released": "2018-03-12",
            "search": "`cloudtrail` eventName=RunInstances [search `cloudtrail` eventName=RunInstances errorCode=success | stats earliest(_time) as firstTime latest(_time) as lastTime by requestParameters.instancesSet.items{}.imageId | rename requestParameters.instancesSet.items{}.imageId as amiID | inputlookup append=t previously_seen_ec2_amis.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by amiID | outputlookup previously_seen_ec2_amis.csv | eval newAMI=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | where newAMI=1 | rename amiID as requestParameters.instancesSet.items{}.imageId | table requestParameters.instancesSet.items{}.imageId] | rename requestParameters.instanceType as instanceType, responseElements.instancesSet.items{}.instanceId as dest, userIdentity.arn as arn, requestParameters.instancesSet.items{}.imageId as amiID | table firstTime, lastTime, arn, amiID, dest, instanceType | `ec2_instance_started_with_previously_unseen_ami_filter`",
            "search_name": "ESCU - EC2 Instance Started With Previously Unseen AMI - Rule",
            "security_domain": "endpoint",
            "story": "ced74200-8465-4bc3-bd2c-9a782eec6750",
            "tags": {
                "analytics_story": [
                    "AWS Cryptomining"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "ec2_instance_started_with_previously_unseen_instance_type": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cryptomining",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-08",
                    "description": "This search builds a table of previously seen EC2 instance types",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "b8f029f2-65a6-4d76-be98-dad1c9d59c45",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_ec2_instance_types_filter"
                        }
                    ],
                    "name": "Previously Seen EC2 Instance Types",
                    "search": "`cloudtrail` eventName=RunInstances errorCode=success | rename requestParameters.instanceType as instanceType | fillnull value=\"m1.small\" instanceType | stats earliest(_time) as earliest latest(_time) as latest by instanceType | outputlookup previously_seen_ec2_instance_types.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Cryptomining"
                        ],
                        "detections": [
                            "EC2 Instance Started With Previously Unseen Instance Type"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=ec2_instance_started_with_previously_unseen_instance_type",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-02-07",
            "description": "This search looks for EC2 instances being created with previously unseen instance types.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 Instance Types\" support search once to create a history of previously seen instance types.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 Instance Types\" support search once to create a history of previously seen instance types.",
            "icon": "ES_Use_Case.png",
            "id": "ec2_instance_started_with_previously_unseen_instance_type",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "It is possible that an admin will create a new system using a new instance type never used before. Verify with the creator that they intended to create the system with the new instance type.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "ec2_instance_started_with_previously_unseen_instance_type_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "EC2 Instance Started With Previously Unseen Instance Type",
            "references": [],
            "released": "2020-02-07",
            "search": "`cloudtrail` eventName=RunInstances [search `cloudtrail` eventName=RunInstances errorCode=success | fillnull value=\"m1.small\" requestParameters.instanceType | stats earliest(_time) as earliest latest(_time) as latest by requestParameters.instanceType | rename requestParameters.instanceType as instanceType | inputlookup append=t previously_seen_ec2_instance_types.csv | stats min(earliest) as earliest max(latest) as latest by instanceType | outputlookup previously_seen_ec2_instance_types.csv | eval newType=if(earliest >= relative_time(now(), \"-70m@m\"), 1, 0) | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | where newType=1 | rename instanceType as requestParameters.instanceType | table requestParameters.instanceType] | spath output=user userIdentity.arn | rename requestParameters.instanceType as instanceType, responseElements.instancesSet.items{}.instanceId as dest | table _time, user, dest, instanceType | `ec2_instance_started_with_previously_unseen_instance_type_filter`",
            "search_name": "ESCU - EC2 Instance Started With Previously Unseen Instance Type - Rule",
            "security_domain": "endpoint",
            "story": "ced74200-8465-4bc3-bd2c-9a782eec6750",
            "tags": {
                "analytics_story": [
                    "AWS Cryptomining"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "ec2_instance_started_with_previously_unseen_user": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "AWS Cryptomining|Suspicious AWS EC2 Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS Instance",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-03-15",
                    "description": "This search builds a table of previously seen ARNs that have launched a EC2 instance.",
                    "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS version (4.4.0 or later), then configure your CloudTrail inputs.",
                    "id": "6c767ac0-0906-4355-9a83-927f5ee7bdad",
                    "macros": [
                        {
                            "definition": "sourcetype=aws:cloudtrail",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "cloudtrail"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_ec2_launches_by_user_filter"
                        }
                    ],
                    "name": "Previously Seen EC2 Launches By User",
                    "search": "`cloudtrail` eventName=RunInstances errorCode=success | rename userIdentity.arn as arn | stats earliest(_time) as firstTime latest(_time) as lastTime by arn | outputlookup previously_seen_ec2_launches_by_user.csv | stats count",
                    "tags": {
                        "analytics_story": [
                            "AWS Cryptomining",
                            "Suspicious AWS EC2 Activities"
                        ],
                        "detections": [
                            "EC2 Instance Started With Previously Unseen User"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Cloud Security|SaaS",
            "dashboard": "showcase_security_content?showcaseId=ec2_instance_started_with_previously_unseen_user",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for EC2 instances being created by users who have not created them before.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 1",
            "escu_nist": "ID.AM",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 Launches By User\" support search once to create a history of previously seen ARNs.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. This search works best when you run the \"Previously Seen EC2 Launches By User\" support search once to create a history of previously seen ARNs.",
            "icon": "ES_Use_Case.png",
            "id": "ec2_instance_started_with_previously_unseen_user",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "It's possible that a user will start to create EC2 instances when they haven't before for any number of reasons. Verify with the user that is launching instances that this is the intended behavior.",
            "lookups": [],
            "macros": [
                {
                    "definition": "sourcetype=aws:cloudtrail",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "cloudtrail"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "ec2_instance_started_with_previously_unseen_user_filter"
                }
            ],
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "APT33",
            "name": "EC2 Instance Started With Previously Unseen User",
            "references": [],
            "released": "2020-07-21",
            "search": "`cloudtrail` eventName=RunInstances [search `cloudtrail` eventName=RunInstances errorCode=success | stats earliest(_time) as firstTime latest(_time) as lastTime by userIdentity.arn | rename userIdentity.arn as arn | inputlookup append=t previously_seen_ec2_launches_by_user.csv | stats min(firstTime) as firstTime, max(lastTime) as lastTime by arn | outputlookup previously_seen_ec2_launches_by_user.csv | eval newUser=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newUser=1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename arn as userIdentity.arn | table userIdentity.arn] | rename requestParameters.instanceType as instanceType, responseElements.instancesSet.items{}.instanceId as dest, userIdentity.arn as user | table _time, user, dest, instanceType | `ec2_instance_started_with_previously_unseen_user_filter`",
            "search_name": "ESCU - EC2 Instance Started With Previously Unseen User - Rule",
            "story": "ced74200-8465-4bc3-bd2c-9a782eec6750|2e8948a5-5239-406b-b56b-6c50f1268af3",
            "tags": {
                "analytics_story": [
                    "AWS Cryptomining",
                    "Suspicious AWS EC2 Activities"
                ],
                "asset_type": "AWS Instance",
                "cis20": [
                    "CIS 1"
                ],
                "mitre_attack_groups": [
                    "APT33"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Cloud Accounts"
                ],
                "nist": [
                    "ID.AM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "email_attachments_with_lots_of_spaces": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Emotet Malware  DHS Report TA18-201A |Suspicious Emails",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=email_attachments_with_lots_of_spaces",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "Email",
            "dataset": "",
            "date": "2017-09-19",
            "description": "Attackers often use spaces as a means to obfuscate an attachment's file extension. This search looks for messages with email attachments that have many spaces within the file names.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You need to ingest data from emails. Specifically, the sender's address and the file names of any attachments must be mapped to the Email data model. The threshold ratio is set to 10%, but this value can be configured to suit each environment. \\\n **Splunk Phantom Playbook Integration**\\\nIf Splunk Phantom is also configured in your environment, a playbook called \"Suspicious Email Attachment Investigate and Delete\" can be configured to run when any results are found by this detection search. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/` and add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search. The notable event will be sent to Phantom and the playbook will gather further information about the file attachment and its network behaviors. If Phantom finds malicious behavior and an analyst approves of the results, the email will be deleted from the user's inbox.",
            "highlight": "No",
            "how_to_implement": "You need to ingest data from emails. Specifically, the sender's address and the file names of any attachments must be mapped to the Email data model. The threshold ratio is set to 10%, but this value can be configured to suit each environment. \\\n **Splunk Phantom Playbook Integration**\\\nIf Splunk Phantom is also configured in your environment, a playbook called \"Suspicious Email Attachment Investigate and Delete\" can be configured to run when any results are found by this detection search. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/` and add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search. The notable event will be sent to Phantom and the playbook will gather further information about the file attachment and its network behaviors. If Phantom finds malicious behavior and an analyst approves of the results, the email will be deleted from the user's inbox.",
            "icon": "ES_Use_Case.png",
            "id": "email_attachments_with_lots_of_spaces",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "known_false_positives": "None at this time",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "email_attachments_with_lots_of_spaces_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Email Attachments With Lots Of Spaces",
            "references": "",
            "released": "2017-09-19",
            "search": "| tstats `security_content_summariesonly` count values(All_Email.recipient) as recipient_address min(_time) as firstTime max(_time) as lastTime from datamodel=Email where All_Email.file_name=\"*\" by All_Email.src_user, All_Email.file_name All_Email.message_id | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(\"All_Email\")` | eval space_ratio = (mvcount(split(file_name,\" \"))-1)/len(file_name) | search space_ratio >= 0.1 |  rex field=recipient_address \"(?<recipient_user>.*)@\" | `email_attachments_with_lots_of_spaces_filter`",
            "search_name": "ESCU - Email Attachments With Lots Of Spaces - Rule",
            "security_domain": "network",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52|2b1800dd-92f9-47ec-a981-fdf1351e5d55",
            "tags": {
                "analytics_story": [
                    "Emotet Malware  DHS Report TA18-201A ",
                    "Suspicious Emails"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "email_files_written_outside_of_the_outlook_directory": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Collection and Staging",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=email_files_written_outside_of_the_outlook_directory",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "Endpoint.Filesystem",
            "dataset": "",
            "date": "2020-07-21",
            "description": "The search looks at the change-analysis data model and detects email files created outside the normal Outlook directory.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records the file-system activity from your hosts to populate the Endpoint.Filesystem data model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or by other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file-system reads and writes.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records the file-system activity from your hosts to populate the Endpoint.Filesystem data model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or by other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file-system reads and writes.",
            "icon": "ES_Use_Case.png",
            "id": "email_files_written_outside_of_the_outlook_directory",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Administrators and users sometimes prefer backing up their email data by moving the email files into a different folder. These attempts will be detected by the search.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "email_files_written_outside_of_the_outlook_directory_filter"
                }
            ],
            "mitre_sub_technique": "T1114.001",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1114",
            "mitre_threat_groups": "Magic Hound|APT1",
            "name": "Email Files Written Outside Of The Outlook Directory",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Filesystem.file_path) as file_path min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Filesystem where (Filesystem.file_name=*.pst OR Filesystem.file_name=*.ost) Filesystem.file_path != \"C:\\\\Users\\\\*\\\\My Documents\\\\Outlook Files\\\\*\"  Filesystem.file_path!=\"C:\\\\Users\\\\*\\\\AppData\\\\Local\\\\Microsoft\\\\Outlook*\" by Filesystem.action Filesystem.process_id Filesystem.file_name Filesystem.dest | `drop_dm_object_name(\"Filesystem\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `email_files_written_outside_of_the_outlook_directory_filter` ",
            "search_name": "ESCU - Email files written outside of the Outlook directory - Rule",
            "story": "8e03c61e-13c4-4dcd-bfbe-5ce5a8dc031a",
            "tags": {
                "analytics_story": [
                    "Collection and Staging"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Magic Hound",
                    "APT1"
                ],
                "mitre_attack_id": [
                    "T1114"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Local Email Collection"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "email_servers_sending_high_volume_traffic_to_hosts": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Collection and Staging",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=email_servers_sending_high_volume_traffic_to_hosts",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for an increase of data transfers from your email server to your clients. This could be indicative of a malicious actor collecting data using your email server.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7",
            "escu_nist": "PR.PT|DE.CM|DE.AE",
            "hasSearch": "Yes",
            "help": "This search requires you to be ingesting your network traffic and populating the Network_Traffic data model.  Your email servers must be categorized as \"email_server\" for the search to work, as well. You may need to adjust the deviation_threshold and minimum_data_samples values based on the network traffic in your environment. The \"deviation_threshold\" field is a multiplying factor to control how much variation you're willing to tolerate. The \"minimum_data_samples\" field is the minimum number of connections of data samples required for the statistic to be valid.",
            "highlight": "No",
            "how_to_implement": "This search requires you to be ingesting your network traffic and populating the Network_Traffic data model.  Your email servers must be categorized as \"email_server\" for the search to work, as well. You may need to adjust the deviation_threshold and minimum_data_samples values based on the network traffic in your environment. The \"deviation_threshold\" field is a multiplying factor to control how much variation you're willing to tolerate. The \"minimum_data_samples\" field is the minimum number of connections of data samples required for the statistic to be valid.",
            "icon": "ES_Use_Case.png",
            "id": "email_servers_sending_high_volume_traffic_to_hosts",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "The false-positive rate will vary based on how you set the deviation_threshold and data_samples values. Our recommendation is to adjust these values based on your network traffic to and from your email servers.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "email_servers_sending_high_volume_traffic_to_hosts_filter"
                }
            ],
            "mitre_sub_technique": "T1114.002",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1114",
            "mitre_threat_groups": "APT1|FIN4|APT28|Dragonfly 2.0|Ke3chang|Leafminer",
            "name": "Email Servers Sending High Volume Traffic To Hosts",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` sum(All_Traffic.bytes_out) as bytes_out from datamodel=Network_Traffic where All_Traffic.src_category=email_server by All_Traffic.dest_ip _time span=1d | `drop_dm_object_name(\"All_Traffic\")` | eventstats avg(bytes_out) as avg_bytes_out stdev(bytes_out) as stdev_bytes_out | eventstats count as num_data_samples avg(eval(if(_time < relative_time(now(), \"@d\"), bytes_out, null))) as per_source_avg_bytes_out stdev(eval(if(_time < relative_time(now(), \"@d\"), bytes_out, null))) as per_source_stdev_bytes_out by dest_ip | eval minimum_data_samples = 4, deviation_threshold = 3 | where num_data_samples >= minimum_data_samples AND bytes_out > (avg_bytes_out + (deviation_threshold * stdev_bytes_out)) AND bytes_out > (per_source_avg_bytes_out + (deviation_threshold * per_source_stdev_bytes_out)) AND _time >= relative_time(now(), \"@d\") | eval num_standard_deviations_away_from_server_average = round(abs(bytes_out - avg_bytes_out) / stdev_bytes_out, 2), num_standard_deviations_away_from_client_average = round(abs(bytes_out - per_source_avg_bytes_out) / per_source_stdev_bytes_out, 2) | table dest_ip, _time, bytes_out, avg_bytes_out, per_source_avg_bytes_out, num_standard_deviations_away_from_server_average, num_standard_deviations_away_from_client_average | `email_servers_sending_high_volume_traffic_to_hosts_filter`",
            "search_name": "ESCU - Email servers sending high volume traffic to hosts - Rule",
            "story": "8e03c61e-13c4-4dcd-bfbe-5ce5a8dc031a",
            "tags": {
                "analytics_story": [
                    "Collection and Staging"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT1",
                    "FIN4",
                    "APT28",
                    "Dragonfly 2.0",
                    "Ke3chang",
                    "Leafminer"
                ],
                "mitre_attack_id": [
                    "T1114"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Remote Email Collection"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "excessive_data_transmission": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Insider Threat",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detects outliers in the timeseries of outgoing bytes transmission by each user, and each device. This detection will occur both normal traffic, VPN traffic, and separately after profiling connections. The profiling connections model only considers connections that behave as file transfers and ignores other type of connections, such as regular web browsing and interactive chat/video connections. Connection profiling aims to reduce False Positives (FP). Note that connection profiling is only available when network events include information about number of packets.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1048|T1041",
            "name": "Excessive Data Transmission",
            "relatedUseCases": [
                "multiple_logins",
                "multiple_outgoing_connections"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "excessive_dns_failures": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Command and Control|Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS002DNS-ET01Query",
            "deprecated_not_used_anymore_datasource": "DNS",
            "description": "Alerts when a host receives many DNS failures in a short span",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_tactic": "|TA0011|TA0007",
            "mitre_technique": "|T1071|T1049",
            "name": "Excessive DNS Failures",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Excessive DNS Failures - Rule",
            "usecase": "Advanced Threat Detection"
        },
        "excessive_dns_queries": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Command and Control|Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS002DNS-ET01QueryRequest",
            "deprecated_not_used_anymore_datasource": "DNS",
            "description": "Alerts when a host starts sending excessive DNS queries",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1071",
            "name": "Excessive DNS Queries",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Excessive DNS Queries - Rule",
            "usecase": "Advanced Threat Detection"
        },
        "excessive_failed_logins": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Lateral Movement|IAM Analytics",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET02Failure",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects excessive number of failed login attempts (this is likely a brute force attack)",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Excessive Failed Logins",
            "relatedUseCases": [
                "Basic_Scanning",
                "showcase_first_logon",
                "detection_no_win_updates_in_timeframe"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "search_name": "Access - Excessive Failed Logins - Rule",
            "similarUseCases": [
                "basic_brute_force",
                "brute_force_access_behavior_detected",
                "brute_force_access_behavior_detected_over_one_day",
                "UC0099",
                "UC0108",
                "UC0109"
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "excessive_http_failure_responses": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Web Attack",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "Alerts when a host generates a lot of HTTP failures in a short span of time",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0001|TA0006",
            "mitre_technique": "|T1190|T1110",
            "name": "Excessive HTTP Failure Responses",
            "relatedUseCases": [
                ""
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Excessive HTTP Failure Responses - Rule",
            "usecase": "Application Security"
        },
        "execution_of_file_with_multiple_extensions": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows File Extension and Association Abuse",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=execution_of_file_with_multiple_extensions",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-18",
            "description": "This search looks for processes launched from files that have double extensions in the file name. This is typically done to obscure the \"real\" file extension and make it appear as though the file being accessed is a data file, as opposed to executable content.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 8",
            "escu_nist": "DE.CM|PR.PT|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node.",
            "icon": "ES_Use_Case.png",
            "id": "execution_of_file_with_multiple_extensions",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "None identified.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "execution_of_file_with_multiple_extensions_filter"
                }
            ],
            "mitre_sub_technique": "T1036.003",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1036",
            "mitre_threat_groups": "menuPass|APT32|Soft Cell|PLATINUM",
            "name": "Execution Of File With Multiple Extensions",
            "references": [],
            "released": "2020-11-18",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process = *.doc.exe OR Processes.process = *.htm.exe OR Processes.process = *.html.exe OR Processes.process = *.txt.exe OR Processes.process = *.pdf.exe OR Processes.process = *.doc.exe by Processes.dest Processes.user Processes.process Processes.parent_process | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `execution_of_file_with_multiple_extensions_filter`",
            "search_name": "ESCU - Execution of File with Multiple Extensions - Rule",
            "story": "30552a76-ac78-48e4-b3c0-de4e34e9563d",
            "tags": {
                "analytics_story": [
                    "Windows File Extension and Association Abuse"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "menuPass",
                    "APT32",
                    "Soft Cell",
                    "PLATINUM"
                ],
                "mitre_attack_id": [
                    "T1036"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Rename System Utilities"
                ],
                "nist": [
                    "DE.CM",
                    "PR.PT",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "execution_of_file_with_spaces_before_extension": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows File Extension and Association Abuse",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=execution_of_file_with_spaces_before_extension",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for processes launched from files with at least five spaces in the name before the extension. This is typically done to obfuscate the file extension by pushing it outside of the default view.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 8",
            "escu_nist": "DE.CM|PR.PT|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "icon": "ES_Use_Case.png",
            "id": "execution_of_file_with_spaces_before_extension",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "None identified.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "execution_of_file_with_spaces_before_extension_filter"
                }
            ],
            "mitre_sub_technique": "T1036",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1036",
            "mitre_threat_groups": "Windshift|APT32|BRONZE BUTLER|menuPass|Dragonfly 2.0",
            "name": "Execution Of File With Spaces Before Extension",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process_path) as process_path min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process = \"*     .*\" by Processes.dest Processes.user Processes.process Processes.process_name | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `execution_of_file_with_spaces_before_extension_filter`",
            "search_name": "ESCU - Execution of File With Spaces Before Extension - Rule",
            "story": "30552a76-ac78-48e4-b3c0-de4e34e9563d",
            "tags": {
                "analytics_story": [
                    "Windows File Extension and Association Abuse"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Windshift",
                    "APT32",
                    "BRONZE BUTLER",
                    "menuPass",
                    "Dragonfly 2.0"
                ],
                "mitre_attack_id": [
                    "T1036"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Masquerading"
                ],
                "nist": [
                    "DE.CM",
                    "PR.PT",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "expected_host_not_reporting": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Operations|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Discovers hosts that are longer reporting events but should be submitting log events. This rule is used to monitor hosts that you know should be providing a constant stream of logs in order to determine why the host has failed to provide log data.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Audit",
            "gdprtext": "<h4>Problem:</h4><p>Many compliance and regulatory frameworks contain clauses specifying requirements for central logging of event data, as well as retention periods and use of that data to assist in detecting data breaches and investigation and handling of threats. These regulations also specify that a mechanism exist to notify when critical systems stop forwarding event data. For example, tracking of \u201cinitialization, stopping, or pausing of audit logs\u201d. This is directly related to the fact that commonly, the intent behind disruption to event data forwarding is malicious, e.g. an attempt to evade a preventive measure or to avoid detection. </p><h4>Impact:</h4><p>The GDPR requires that organizations collect the full audit trail of data processing activities of involved systems and applications. This can impact the organization via a wide array of GDPR articles. If breached, Article 33 requires organizations to inform the authorities, including details about the nature of the breach, such as how many individuals have been affected. The same requirement is in Article 34 for when organizations must identify which individuals are affected, in order to notify them if there is a high risk related to their individual data. If organizations do not store the requisite logs and are therefore not able to proper scope the impact, data privacy officers will need to assume the worst case scenario: all personal data that was stored or processed in the breached environment or accessible by the breached user was affected. In addition, Article 32 requires implementation of proper security controls, and for organizations to monitor, test, and demonstrate their effectiveness. If an organization experiences that logging stops for a particular host or set of hosts, then the organization will not be able to prove the status and effectiveness of the applied security controls on those systems, in the event of damage claims (Article 82) or privacy audits (Article 58). If the organization lacks host logs and corresponding application logs, they will not be able to prove which records have been processed, such as proving that a record was deleted according to an individual's delete request (Article 17) or proving compliance with a processing restriction requested by an individual (Article 18 and Article 21). If a host does not report event data, a processor cannot prove that only authorized individuals have accessed the data (Article 28).</p><h4>Resolution Path:</h4><p>Identify all GDPR-relevant IT assets from the data mapping exercise conducted by the Data Privacy Officer\u2019s team -- that is, all IT assets that are relevant to the full audit trail of data processing activities. This includes not only data stores and repositories that house sensitive PD / PII, but also any technologies that are involved in the processing, storage, transmission, receipt, rendering, encrypt/decrypt, relaying, and any other function that involves handling that data in any capacity. Ensure that those assets are configured properly to report logging activity to an appropriate central repository. Monitor for changes in logging status, adjust for known outages, and prioritize incident response for any failures to report by hosts that are not scheduled for downtime.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "|TA0005",
            "mitre_technique": "|T1089",
            "name": "Expected Host Not Reporting",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Audit - Expected Host Not Reporting - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "extended_period_without_successful_netbackup_backups": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Monitor Backup Solution",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Compliance",
            "dashboard": "showcase_security_content?showcaseId=extended_period_without_successful_netbackup_backups",
            "data_source_categories": "DS027EndpointBackup-ET01General",
            "datamodel": "",
            "dataset": "",
            "date": "2017-09-12",
            "description": "This search returns a list of hosts that have not successfully completed a backup in over a week.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 10",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to first obtain data from your backup solution, either from the backup logs on your hosts, or from a central server responsible for performing the backups. If you do not use Netbackup, you can modify this search for your backup solution. Depending on how often you backup your systems, you may want to modify how far in the past to look for a successful backup, other than the default of seven days.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to first obtain data from your backup solution, either from the backup logs on your hosts, or from a central server responsible for performing the backups. If you do not use Netbackup, you can modify this search for your backup solution. Depending on how often you backup your systems, you may want to modify how far in the past to look for a successful backup, other than the default of seven days.",
            "icon": "ES_Use_Case.png",
            "id": "extended_period_without_successful_netbackup_backups",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "None",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"netbackup_logs\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "netbackup"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "extended_period_without_successful_netbackup_backups_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Extended Period Without Successful Netbackup Backups",
            "references": [],
            "released": "2017-09-12",
            "search": "`netbackup` MESSAGE=\"Disk/Partition backup completed successfully.\" | stats latest(_time) as latestTime by COMPUTERNAME | `security_content_ctime(latestTime)` | rename COMPUTERNAME as dest | eval isOutlier=if(latestTime <= relative_time(now(), \"-7d@d\"), 1, 0) | search isOutlier=1 | table latestTime, dest | `extended_period_without_successful_netbackup_backups_filter`",
            "search_name": "ESCU - Extended Period Without Successful Netbackup Backups - Rule",
            "security_domain": "endpoint",
            "story": "abe807c7-1eb6-4304-ac32-6e7aacdb891d",
            "tags": {
                "analytics_story": [
                    "Monitor Backup Solution"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 10"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Compliance",
            "version": 1
        },
        "external_alarm_activity": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Network Attack",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS012NetworkIntrusionDetection-ET01SigDetection|DS020HostIntrustionDetection-ET01SigDetected|DS004EndPointAntiMalware-ET01SigDetected|DS025IPAddressAssignment-ET01General",
            "deprecated_not_used_anymore_datasource": "DLP|IDS or IPS|Host-based IDS|Anti-Virus|Web Application Firewall",
            "description": "Computes risk analytics for the external alarm of entities and raises anomalies for the most noteworthy external alarm activity.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_5",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "This is too generic to map to a specific technique.  The alarms could be from various systems",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "External Alarm Activity",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "external_website_attack": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Web Attack",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "Raises anomalies when there are suspicious patterns in incoming web traffic.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0001|TA0018",
            "mitre_technique": "|T1190|T1293",
            "name": "External Website Attack",
            "relatedUseCases": [
                ""
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Application Security"
        },
        "file_with_samsam_extension": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=file_with_samsam_extension",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/samsam_extension/windows-sysmon.log"
            ],
            "date": "2018-12-14",
            "description": "The search looks for file writes with extensions consistent with a SamSam ransomware attack.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "file_with_samsam_extension",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "known_false_positives": "Because these extensions are not typically used in normal operations, you should investigate all results.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "file_with_samsam_extension_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "File With Samsam Extension",
            "references": [],
            "released": "2018-12-14",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`| rex field=file_name \"(?<file_extension>\\.[^\\.]+)$\" | search file_extension=.stubbin OR file_extension=.berkshire OR file_extension=.satoshi OR file_extension=.sophos OR file_extension=.keyxml | `file_with_samsam_extension_filter`",
            "search_name": "ESCU - File with Samsam Extension - Rule",
            "security_domain": "endpoint",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/samsam_extension/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "first_call_to_foreign_country": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|Compliance",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
            "deprecated_not_used_anymore_datasource": "Other",
            "description": "<p>Detect when a user who has never called a foreign country before starts making international calls, to meet HR, Finance, or Regulatory requirements.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Audit",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": " - Demo"
                },
                {
                    "label": "Live Data",
                    "name": " - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": " - Accelerated"
                }
            ],
            "hasSearch": "No",
            "help": "<p>This example leverages the  search assistant. Our dataset is an anonymized collection of . For this analysis, we are .</p>",
            "highlight": "No",
            "howToImplement": "<p>There are a few components to implementing this detection -- handling your CDR logs correctly, and then resolving those calls to external countries.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p>",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "First Call to Foreign Country",
            "operationalize": "<p>The rules for this will be highly dependent on your organizational policy dictated by legal, HR, or Finance. Consult the appropriate teams to build next steps before implementing.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/first_call_to_foreign_country.png",
            "released": "2.2.0",
            "relevance": "<p>Whether guided by HR concerns, phone cost concerns, or regulatory requirements, many organizations want to track when users start making international phone calls. Fortunately, that's easy to do in Splunk.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat|Compliance"
        },
        "first_time_seen_child_process_of_zoom": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Zoom Child Processes",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-05-20",
                    "description": "This search returns the first and last time a process was seen per endpoint with a parent process of zoom.exe (Windows) or zoom.us (macOS). This table is then cached.",
                    "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node.",
                    "id": "60b9c00f-a9d6-4e51-803c-5d63ea21b95b",
                    "lookups": [
                        {
                            "collection": "zoom_first_time_child_process",
                            "description": "A list of suspicious file names",
                            "fields_list": "_key, dest, process_name, firstTimeSeen, lastTimeSeen",
                            "name": "zoom_first_time_child_process"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_zoom_child_processes___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Zoom Child Processes - Initial",
                    "search": "| tstats `security_content_summariesonly` min(_time) as firstTimeSeen max(_time) as lastTimeSeen from datamodel=Endpoint.Processes where (Processes.parent_process_name=zoom.exe OR Processes.parent_process_name=zoom.us) by Processes.process_name Processes.dest| `drop_dm_object_name(Processes)` | table dest, process_name, firstTimeSeen, lastTimeSeen | outputlookup zoom_first_time_child_process",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Zoom Child Processes"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "First Time Seen Child Process of Zoom"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-05-20",
                    "description": "This search returns the first and last time a process was seen per endpoint with a parent process of zoom.exe (Windows) or zoom.us (macOS) within the last hour. It then updates this information with historical data and filters out proces_name and endpoint pairs that have not been seen within the specified time window. This updated table is outputed to disk.",
                    "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints, to populate the Endpoint data model in the Processes node.",
                    "id": "80aea7fd-5da2-4533-b3c2-560533bfbaee",
                    "lookups": [
                        {
                            "collection": "zoom_first_time_child_process",
                            "description": "A list of suspicious file names",
                            "fields_list": "_key, dest, process_name, firstTimeSeen, lastTimeSeen",
                            "name": "zoom_first_time_child_process"
                        },
                        {
                            "collection": "zoom_first_time_child_process",
                            "description": "A list of suspicious file names",
                            "fields_list": "_key, dest, process_name, firstTimeSeen, lastTimeSeen",
                            "name": "zoom_first_time_child_process"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_zoom_child_processes___update_filter"
                        }
                    ],
                    "name": "Previously Seen Zoom Child Processes - Update",
                    "search": "| tstats `security_content_summariesonly` min(_time) as firstTimeSeen max(_time) as lastTimeSeen from datamodel=Endpoint.Processes where (Processes.parent_process_name=zoom.exe OR Processes.parent_process_name=zoom.us) by Processes.process_name Processes.dest| `drop_dm_object_name(Processes)` | table firstTimeSeen, lastTimeSeen, process_name, dest | inputlookup zoom_first_time_child_process append=t | stats min(firstTimeSeen) as firstTimeSeen max(lastTimeSeen) as lastTimeSeen by process_name, dest | where lastTimeSeen > relative_time(now(), \"`previously_seen_zoom_child_processes_forget_window`\") | outputlookup zoom_first_time_child_process",
                    "tags": {
                        "analytics_story": [
                            "Suspicious Zoom Child Processes"
                        ],
                        "deployments": [
                            "Hourly Cache Updates"
                        ],
                        "detections": [
                            "First Time Seen Child Process of Zoom"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=first_time_seen_child_process_of_zoom",
            "data_source_categories": "VendorSpecific-zoom|DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1068/zoom_child_process/windows-sysmon.log"
            ],
            "date": "2020-05-20",
            "description": "This search looks for child processes spawned by zoom.exe or zoom.us that has not previously been seen.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You should run the baseline search `Previously Seen Zoom Child Processes - Initial` to build the initial table of child processes and hostnames for this search to work. You should also schedule at the same interval as this search the second baseline search `Previously Seen Zoom Child Processes - Update` to keep this table up to date and to age out old child processes. Please update the `previously_seen_zoom_child_processes_window` macro to adjust the time window.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You should run the baseline search `Previously Seen Zoom Child Processes - Initial` to build the initial table of child processes and hostnames for this search to work. You should also schedule at the same interval as this search the second baseline search `Previously Seen Zoom Child Processes - Update` to keep this table up to date and to age out old child processes. Please update the `previously_seen_zoom_child_processes_window` macro to adjust the time window.",
            "icon": "ES_Use_Case.png",
            "id": "first_time_seen_child_process_of_zoom",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "A new child process of zoom isn't malicious by that fact alone. Further investigation of the actions of the child process is needed to verify any malicious behavior is taken.",
            "lookups": [
                {
                    "collection": "zoom_first_time_child_process",
                    "description": "A list of suspicious file names",
                    "fields_list": "_key, dest, process_name, firstTimeSeen, lastTimeSeen",
                    "name": "zoom_first_time_child_process"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "\"-70m@m\"",
                    "description": "Use this macro to determine how far back you should be checking for new zoom child processes",
                    "name": "previously_seen_zoom_child_processes_window"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "first_time_seen_child_process_of_zoom_filter"
                }
            ],
            "mitre_sub_technique": "T1068",
            "mitre_tactic": "TA0004",
            "mitre_tactic_display": "Privilege Escalation",
            "mitre_technique": "T1068",
            "mitre_threat_groups": "Whitefly|APT33|Cobalt Group|PLATINUM|FIN8|APT32|Threat Group-3390|FIN6|APT28",
            "name": "First Time Seen Child Process Of Zoom",
            "references": [],
            "released": "2020-05-20",
            "search": "| tstats `security_content_summariesonly` min(_time) as firstTime values(Processes.parent_process_name) as parent_process_name values(Processes.parent_process_id) as parent_process_id values(Processes.process_name) as process_name values(Processes.process) as process from datamodel=Endpoint.Processes where (Processes.parent_process_name=zoom.exe OR Processes.parent_process_name=zoom.us) by Processes.process_id Processes.dest | `drop_dm_object_name(Processes)` | lookup zoom_first_time_child_process dest as dest process_name as process_name OUTPUT firstTimeSeen | where isnull(firstTimeSeen) OR firstTimeSeen > relative_time(now(), \"`previously_seen_zoom_child_processes_window`\") | `security_content_ctime(firstTime)` | table firstTime dest, process_id, process_name, parent_process_id, parent_process_name |`first_time_seen_child_process_of_zoom_filter`",
            "search_name": "ESCU - First Time Seen Child Process of Zoom - Rule",
            "story": "aa3749a6-49c7-491e-a03f-4eaee5fe0258",
            "tags": {
                "analytics_story": [
                    "Suspicious Zoom Child Processes"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1068/zoom_child_process/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Whitefly",
                    "APT33",
                    "Cobalt Group",
                    "PLATINUM",
                    "FIN8",
                    "APT32",
                    "Threat Group-3390",
                    "FIN6",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1068"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Exploitation for Privilege Escalation"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "first_time_seen_command_line_argument": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DHS Report TA18-074A|Suspicious Command-Line Executions|Orangeworm Attack Group|Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns|Hidden Cobra Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": [
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2019-03-01",
                    "description": "This search looks for command-line arguments where `cmd.exe /c` is used to execute a program, then creates a baseline of the earliest and latest times we have encountered this command-line argument in our dataset within the last 30 days.",
                    "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must be ingesting logs with both the process name and command line from your endpoints. The complete process name with command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
                    "id": "56059acf-50fe-4f60-98d1-b75b51b5c2f3",
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_command_line_arguments_filter"
                        }
                    ],
                    "name": "Previously seen command line arguments",
                    "search": "| tstats `security_content_summariesonly` min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe AND Processes.process=\"* /c *\" by Processes.process | `drop_dm_object_name(Processes)`",
                    "tags": {
                        "analytics_story": [
                            "DHS Report TA18-074A",
                            "Disabling Security Tools",
                            "Hidden Cobra Malware",
                            "Netsh Abuse",
                            "Orangeworm Attack Group",
                            "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
                            "Suspicious Command-Line Executions",
                            "Suspicious MSHTA Activity"
                        ],
                        "detections": [
                            "Detect Prohibited Applications Spawning cmd.exe",
                            "Processes launching netsh",
                            "First time seen command line argument"
                        ]
                    },
                    "version": 2
                }
            ],
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=first_time_seen_command_line_argument",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for command-line arguments that use a `/c` parameter to execute a command that has not previously been seen.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must be ingesting logs with both the process name and command line from your endpoints. The complete process name with command-line arguments are mapped to the \"process\" field in the Endpoint data model. Please make sure you run the support search \"Previously seen command line arguments,\"&#151;which creates a lookup file called `previously_seen_cmd_line_arguments.csv`&#151;a historical baseline of all command-line arguments. You must also validate this list. For the search to do accurate calculation, ensure the search scheduling is the same value as the `relative_time` evaluation function.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must be ingesting logs with both the process name and command line from your endpoints. The complete process name with command-line arguments are mapped to the \"process\" field in the Endpoint data model. Please make sure you run the support search \"Previously seen command line arguments,\"&#151;which creates a lookup file called `previously_seen_cmd_line_arguments.csv`&#151;a historical baseline of all command-line arguments. You must also validate this list. For the search to do accurate calculation, ensure the search scheduling is the same value as the `relative_time` evaluation function.",
            "icon": "ES_Use_Case.png",
            "id": "first_time_seen_command_line_argument",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "Legitimate programs can also use command-line arguments to execute. Please verify the command-line arguments to check what command/program is being executed. We recommend customizing the `first_time_seen_cmd_line_filter` macro to exclude legitimate parent_process_name",
            "lookups": [
                {
                    "description": "A placeholder for a list of cmd line arugments that been seen before",
                    "filename": "previously_seen_cmd_line_arguments.csv",
                    "name": "previously_seen_cmd_line_arguments"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "first_time_seen_command_line_argument_filter"
                }
            ],
            "mitre_sub_technique": "T1059.001|T1059.003",
            "mitre_tactic": "TA0002|TA0002",
            "mitre_tactic_display": "Execution|Execution",
            "mitre_technique": "T1059|T1059",
            "mitre_threat_groups": "Blue Mockingbird|APT39|DarkVishnya|Molerats|Wizard Spider|Frankenstein|Inception|Silence|APT41|Kimsuky|Soft Cell|TA505|WIRTE|TEMP.Veles|APT33|Gallmaker|Turla|APT19|DarkHydrus|APT28|Thrip|Gorgon Group|Cobalt Group|Dragonfly 2.0|Leviathan|TA459|FIN8|MuddyWater|Magic Hound|OilRig|BRONZE BUTLER|CopyKittens|APT32|FIN7|FIN10|Threat Group-3390|menuPass|Patchwork|Stealth Falcon|FIN6|Poseidon Group|APT3|APT29|Deep Panda|TA505|Blue Mockingbird|Tropic Trooper|Frankenstein|OilRig|Lazarus Group|Honeybee|Cobalt Group|FIN7|APT41|Soft Cell|Turla|Silence|APT32|APT39|Darkhotel|MuddyWater|APT18|APT38|Dark Caracal|Gorgon Group|Dragonfly 2.0|Rancor|Ke3chang|APT37|Leviathan|FIN8|APT28|Magic Hound|Sowbug|BRONZE BUTLER|FIN10|Threat Group-3390|menuPass|Gamaredon Group|Suckfly|Patchwork|Threat Group-1314|APT3|admin@338|APT1",
            "name": "First Time Seen Command Line Argument",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = cmd.exe Processes.process = \"* /c *\" by Processes.process Processes.process_name Processes.parent_process_name Processes.dest| `drop_dm_object_name(Processes)`| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search [| tstats `security_content_summariesonly` earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = cmd.exe Processes.process = \"* /c *\" by Processes.process | `drop_dm_object_name(Processes)` | inputlookup append=t previously_seen_cmd_line_arguments | stats min(firstTime) as firstTime, max(lastTime) as lastTime by process | outputlookup previously_seen_cmd_line_arguments | eval newCmdLineArgument=if(firstTime >= relative_time(now(), \"-70m@m\"), 1, 0) | where newCmdLineArgument=1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table process] | `first_time_seen_command_line_argument_filter` ",
            "search_name": "ESCU - First time seen command line argument - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|f4368ddf-d59f-4192-84f6-778ac5a3ffc7|bb9f5ed2-916e-4364-bb6d-97c370efcf52|988C59C5-0A1C-45B6-A555-0C62276E327E|baf7580b-d4b4-4774-8173-7d198e9da335",
            "tags": {
                "analytics_story": [
                    "DHS Report TA18-074A",
                    "Suspicious Command-Line Executions",
                    "Orangeworm Attack Group",
                    "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
                    "Hidden Cobra Malware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "DarkVishnya",
                    "Molerats",
                    "Wizard Spider",
                    "Frankenstein",
                    "Inception",
                    "Silence",
                    "APT41",
                    "Kimsuky",
                    "Soft Cell",
                    "TA505",
                    "WIRTE",
                    "TEMP.Veles",
                    "APT33",
                    "Gallmaker",
                    "Turla",
                    "APT19",
                    "DarkHydrus",
                    "APT28",
                    "Thrip",
                    "Gorgon Group",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "Leviathan",
                    "TA459",
                    "FIN8",
                    "MuddyWater",
                    "Magic Hound",
                    "OilRig",
                    "BRONZE BUTLER",
                    "CopyKittens",
                    "APT32",
                    "FIN7",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Patchwork",
                    "Stealth Falcon",
                    "FIN6",
                    "Poseidon Group",
                    "APT3",
                    "APT29",
                    "Deep Panda",
                    "TA505",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "OilRig",
                    "Lazarus Group",
                    "Honeybee",
                    "Cobalt Group",
                    "FIN7",
                    "APT41",
                    "Soft Cell",
                    "Turla",
                    "Silence",
                    "APT32",
                    "APT39",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "APT38",
                    "Dark Caracal",
                    "Gorgon Group",
                    "Dragonfly 2.0",
                    "Rancor",
                    "Ke3chang",
                    "APT37",
                    "Leviathan",
                    "FIN8",
                    "APT28",
                    "Magic Hound",
                    "Sowbug",
                    "BRONZE BUTLER",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Gamaredon Group",
                    "Suckfly",
                    "Patchwork",
                    "Threat Group-1314",
                    "APT3",
                    "admin@338",
                    "APT1"
                ],
                "mitre_attack_id": [
                    "T1059",
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "PowerShell",
                    "Windows Command Shell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "first_time_seen_running_windows_service": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Service Abuse|Orangeworm Attack Group|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-06-23",
                    "description": "This collects the services that have been started across your entire enterprise.",
                    "how_to_implement": "While this search does not require you to adhere to Splunk CIM, you must be ingesting your Windows security-event logs for it to execute successfully. Please ensure that the Splunk Add-on for Microsoft Windows is version 8.0.0 or above.",
                    "id": "64ce0ade-cb01-4678-bddd-d31c0b175394",
                    "lookups": [
                        {
                            "collection": "previously_seen_running_windows_services",
                            "description": "A placeholder for the list of Windows Services running",
                            "fields_list": "_key, service, firstTimeSeen, lastTimeSeen",
                            "name": "previously_seen_running_windows_services"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "eventtype=wineventlog_system",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "wineventlog_system"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_running_windows_services___initial_filter"
                        }
                    ],
                    "name": "Previously Seen Running Windows Services - Initial",
                    "search": "`wineventlog_system` EventCode=7036 | rex field=Message \"The (?<service>[-\\(\\)\\s\\w]+) service entered the (?<state>\\w+) state\" | where state=\"running\" | stats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen by service | outputlookup previously_seen_running_windows_services",
                    "tags": {
                        "analytics_story": [
                            "Orangeworm Attack Group",
                            "Windows Service Abuse",
                            "Sunburst Malware"
                        ],
                        "deployments": [
                            "90 Day Baseline"
                        ],
                        "detections": [
                            "First Time Seen Running Windows Service"
                        ]
                    },
                    "version": 3
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2020-06-23",
                    "description": "This search returns the first and last time a Windows service was seen across your enterprise within the last hour. It then updates this information with historical data and filters out Windows services pairs that have not been seen within the specified time window. This updated table is then cached.",
                    "how_to_implement": "While this search does not require you to adhere to Splunk CIM, you must be ingesting your Windows security-event logs for it to execute successfully. Please ensure that the Splunk Add-on for Microsoft Windows is version 8.0.0 or above.",
                    "id": "2e3bdd68-1863-46ee-81f8-87273eee7f1c",
                    "lookups": [
                        {
                            "collection": "previously_seen_running_windows_services",
                            "description": "A placeholder for the list of Windows Services running",
                            "fields_list": "_key, service, firstTimeSeen, lastTimeSeen",
                            "name": "previously_seen_running_windows_services"
                        },
                        {
                            "collection": "previously_seen_running_windows_services",
                            "description": "A placeholder for the list of Windows Services running",
                            "fields_list": "_key, service, firstTimeSeen, lastTimeSeen",
                            "name": "previously_seen_running_windows_services"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "eventtype=wineventlog_system",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "wineventlog_system"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_running_windows_services___update_filter"
                        }
                    ],
                    "name": "Previously Seen Running Windows Services - Update",
                    "search": "`wineventlog_system` EventCode=7036 | rex field=Message \"The (?<service>[-\\(\\)\\s\\w]+) service entered the (?<state>\\w+) state\" | where state=\"running\" | stats earliest(_time) as firstTimeSeen, latest(_time) as lastTimeSeen by service | inputlookup previously_seen_running_windows_services append=t | stats min(firstTimeSeen) as firstTimeSeen, max(lastTimeSeen) as lastTimeSeen by service | where lastTimeSeen > relative_time(now(), \"`previously_seen_windows_service_forget_window`\") | outputlookup previously_seen_running_windows_services",
                    "tags": {
                        "analytics_story": [
                            "Orangeworm Attack Group",
                            "Windows Service Abuse",
                            "Sunburst Malware"
                        ],
                        "deployments": [
                            "Hourly Cache Updates"
                        ],
                        "detections": [
                            "First Time Seen Running Windows Service"
                        ]
                    },
                    "version": 3
                }
            ],
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=first_time_seen_running_windows_service",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for the first and last time a Windows service is seen running in your environment. This table is then cached.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 2|CIS 9",
            "escu_nist": "ID.AM|PR.DS|PR.AC|DE.AE",
            "hasSearch": "Yes",
            "help": "While this search does not require you to adhere to Splunk CIM, you must be ingesting your Windows system event logs in order for this search to execute successfully. You should run the baseline search `Previously Seen Running Windows Services - Initial` to build the initial table of child processes and hostnames for this search to work. You should also schedule at the same interval as this search the second baseline search `Previously Seen Running Windows Services - Update` to keep this table up to date and to age out old Windows Services. Please update the `previously_seen_windows_service_window` macro to adjust the time window. Please ensure that the Splunk Add-on for Microsoft Windows is version 8.0.0 or above.",
            "highlight": "No",
            "how_to_implement": "While this search does not require you to adhere to Splunk CIM, you must be ingesting your Windows system event logs in order for this search to execute successfully. You should run the baseline search `Previously Seen Running Windows Services - Initial` to build the initial table of child processes and hostnames for this search to work. You should also schedule at the same interval as this search the second baseline search `Previously Seen Running Windows Services - Update` to keep this table up to date and to age out old Windows Services. Please update the `previously_seen_windows_service_window` macro to adjust the time window. Please ensure that the Splunk Add-on for Microsoft Windows is version 8.0.0 or above.",
            "icon": "ES_Use_Case.png",
            "id": "first_time_seen_running_windows_service",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Installation|Actions On Objectives",
            "known_false_positives": "A previously unseen service is not necessarily malicious. Verify that the service is legitimate and that was installed by a legitimate process.",
            "lookups": [
                {
                    "collection": "previously_seen_running_windows_services",
                    "description": "A placeholder for the list of Windows Services running",
                    "fields_list": "_key, service, firstTimeSeen, lastTimeSeen",
                    "name": "previously_seen_running_windows_services"
                }
            ],
            "macros": [
                {
                    "definition": "eventtype=wineventlog_system",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_system"
                },
                {
                    "definition": "\"-70m@m\"",
                    "description": "Use this macro to determine how far back you should be checking for new Windows services",
                    "name": "previously_seen_windows_service_window"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "first_time_seen_running_windows_service_filter"
                }
            ],
            "mitre_sub_technique": "T1569.002",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1569",
            "mitre_threat_groups": "Blue Mockingbird|APT39|APT41|Silence|FIN6|APT32|Honeybee|Ke3chang",
            "name": "First Time Seen Running Windows Service",
            "references": [],
            "released": "2020-07-21",
            "search": "`wineventlog_system` EventCode=7036 | rex field=Message \"The (?<service>[-\\(\\)\\s\\w]+) service entered the (?<state>\\w+) state\" | where state=\"running\" | lookup previously_seen_running_windows_services service as service OUTPUT firstTimeSeen | where isnull(firstTimeSeen) OR firstTimeSeen > relative_time(now(), \"`previously_seen_windows_service_window`\") | table _time dest service | `first_time_seen_running_windows_service_filter`",
            "search_name": "ESCU - First Time Seen Running Windows Service - Rule",
            "story": "6dbd810e-f66d-414b-8dfc-e46de55cbfe2|bb9f5ed2-916e-4364-bb6d-97c370efcf52|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Windows Service Abuse",
                    "Orangeworm Attack Group",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 2",
                    "CIS 9"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "APT41",
                    "Silence",
                    "FIN6",
                    "APT32",
                    "Honeybee",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1569"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Service Execution"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS",
                    "PR.AC",
                    "DE.AE"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "flight_risk_email": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Flight Risk Emails - Demo",
            "data_source_categories": "DS001MAIL-ET03Send",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "<p>This search implements several heuristics to look for indications that a user is a flight risk. While most savvy employees will use a personal email address when emailing competitors, everyone in Security has some story of employees who don't, as it will happen. Detect when it does.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Flight Risk Emails - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Flight Risk Emails - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of email logs.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>This search leverages email logs, with attachment data. You can pull this data in from your email system, or from Splunk Stream. See <i>How to Respond</i> for more details.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "<p>There is a variety of different rules being implemented here with varying levels of confidence. See <i>How to Respond</i> for more details.</p>",
            "mitre": "Exfiltration",
            "mitre_notes": "Possible insider threat, data theft candidate, not an external attacker.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Flight Risk Emailing",
            "operationalize": "<p>There are several checks being run in this search. Most of these will require some tuning, and are often best to combine with another correlation searches that look for anomalous activities (e.g., data exfiltration). <ul><li><b>Emailing Competitors</b>: while there can be legitimate reasons to email competitors, there are several concerns as well. We don't have concrete guidelines for tuning this search, and consider it beta and high false positive.</li><li><b>Email to careers@ / jobs@ / recruiting@</b>: There are a few common email aliases used for job sites. If a user is emailing multiple recruiting aliases, alert on that. Low false positives.</li><li><b>Outbound Attachments Mentioning Resume</b>: Look for someone emailing out a resume. Medium false positives.</li><li><b>Outbound Attachments Mentioning Resume and Name</b>: Look for someone emailing out a resume that has their name in it. Low false positives.</li></ul></p><p>You should likely not look at the results of this search directly, but correlate it with other risky events via the Risk Framework in ES or the Threat Models in UBA.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/flight_risk_email.png",
            "released": "2.2.0",
            "relevance": "<p>Detecting users who are about to leave, before they actually give notice, can provide you the opportunity to potentially fix the situation for an unhappy employee, but also can help you prevent the exfiltration of sensitive data (which usually happens before an employee actually gives notice). Look for the indications that an employee may be leaving, by checking email logs.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "flight_risk_printing": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Flight Risk Printing - Demo",
            "data_source_categories": "DS006UserActivity-ET03Create",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "<p>This search implements two heuristics to look for indications that a user is a flight risk. Many people will print offer letters, drafts of their resume, or related docs on the work environment (for convenience, or because they don't have a printer at home). Detect when that happens.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Flight Risk Printing - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Flight Risk Printing - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of printer logs.</p>",
            "highlight": "No",
            "howToImplement": "<p>This search implements several heuristics to look for indications that a user is a flight risk, detailed below. While most savvy employees will use a personal email address when emailing competitors, everyone in Security has some story of employees who don't.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "<p>This search will innately generate false positives when a user prints an old copy of their resume for a new boss, or a user prints a family member's resume, or of course for managers or users in HR who will print offer letters for their explicit job duties. While you can attempt to build the correlation searches to tune out those false positives (e.g., alert when a user prints an offer letter and is not in HR and is not the hiring manager for any open positions), that can be practically very difficult. It's more common to use a flight risk alert to correlate with other risky events, such as data exfil alerts coming from your DLP or your UEBA systems.</p>",
            "mitre": "Exfiltration",
            "mitre_tactic": "TA0010",
            "mitre_technique": "|T1052",
            "name": "Flight Risk Printing",
            "operationalize": "<p>You should likely not look at this search directly, but correlate it with other risky events via the Risk Framework in ES or the Threat Models in UBA.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/flight_risk_printing.png",
            "released": "2.2.0",
            "relevance": "<p>Detecting users who are about to leave, before they actually give notice, can provide you the opportunity to potentially fix the situation for an unhappy employee, but also can help you prevent the exfiltration of sensitive data (which usually happens before an employee actually gives notice). Look for the indications that an employee may be leaving, by checking printer logs.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "flight_risk_user": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send|DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Email|Web Proxy",
            "description": "Detecting indications of a persistent interest in flight risk based on signals in email, web, and other user activity.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "Insider Threat, not external attacker",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Flight Risk User",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_prompt_and_block_domain"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "flight_risk_user_browsing": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Flight Risk Web Browsing - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01RequestedWebAppAware",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "<p>This search implements several heuristics to look for indications that a user is a flight risk from Web Logs. Detect a user who may be leaving before they do.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Flight Risk Web Browsing - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Flight Risk Web Browsing - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the  search assistant. Our dataset is an anonymized collection of . For this analysis, we are .</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Initial implementation of this search is very straightforward -- just implement Common Information Model compliant proxy logs, and it will work. You should then evaluate how many false positives you get from the different components, and tune as appropriate. Focus your efforts on reducing event volume to a reasonable level, and then use the results to add into the ES Risk Framework or the UBA Threat Models.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "knownFP": "<p>This search will innately generate false positives when a user is helping a friend who is job hunting, or interviewing a candidate. While you can attempt to build the correlation searches to tune out some of those false positives (e.g., alert on sustained job hunting browsing for a user who is not in HR and is not the hiring manager for any open positions), that can be practically impossible. It's more common to use a flight risk alert to correlate with other risky events, such as data exfil alerts coming from your DLP or your UEBA systems.</p>",
            "mitre": "Exfiltration",
            "mitre_notes": "Not an attacker technique",
            "mitre_tactic": "TA0010",
            "mitre_technique": "",
            "name": "Flight Risk Web Browsing",
            "operationalize": "<p>There are several checks being run in this search. Most of these will require some tuning, and are often best to combine with another correlation searches that look for anomalous activities (e.g., data exfiltration). <ul><li><b>Browsing to Job Hunting Sites over Multiple Days</b>: while recruiters may spend their entire days on job hunting sites, most users will not heavily use job hunting sites.</li><li><b>Searching for \"Interview Questions\"</b>: when starting a job hunt, most people will refresh themselves on common interview questions, or look for similar resources. While this could indicate that someone is interviewing a candidate at your company, it can also be a crafty way to detect a flight risk.</li><li><b>Browsing to the Top Results for Interview Questions</b>: while most organizations won't be able to introspect Google searches because of their complete implementation of HTTPS with certificate pinning, you can see if users click on the top results for those queries.</li></ul></p><p>You should likely not look at the results of this search directly, but correlate it with other risky events via the Risk Framework in ES or the Threat Models in UBA.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_prompt_and_block_domain"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/flight_risk_user_browsing.png",
            "released": "2.2.0",
            "relevance": "<p>Detecting users who are about to leave, before they actually give notice, can provide you the opportunity to potentially fix the situation for an unhappy employee, but also can help you prevent the exfiltration of sensitive data (which usually happens before an employee actually gives notice). Look for the indications that an employee may be leaving, by checking proxy logs.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "gcp_detect_accounts_with_high_risk_roles_by_project": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "GCP Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=gcp_detect_accounts_with_high_risk_roles_by_project",
            "data_source_categories": "VendorSpecific-gcp-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-09",
            "description": "This search provides detection of accounts with high risk roles by projects. Compromised accounts with high risk roles can move laterally or even scalate privileges at different projects depending on organization schema.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "icon": "ES_Use_Case.png",
            "id": "gcp_detect_accounts_with_high_risk_roles_by_project",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Accounts with high risk roles should be reduced to the minimum number needed, however specific tasks and setups may be simply expected behavior within organization",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "gcp_detect_accounts_with_high_risk_roles_by_project_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "GCP Detect Accounts With High Risk Roles By Project",
            "references": [
                "https://github.com/dxa4481/gcploit",
                "https://www.youtube.com/watch?v=Ml09R38jpok",
                "https://cloud.google.com/iam/docs/understanding-roles"
            ],
            "released": "2020-10-09",
            "search": "`google_gcp_pubsub_message` data.protoPayload.request.policy.bindings{}.role=roles/owner OR roles/editor OR roles/iam.serviceAccountUser OR roles/iam.serviceAccountAdmin OR roles/iam.serviceAccountTokenCreator OR roles/dataflow.developer OR roles/dataflow.admin OR roles/composer.admin OR roles/dataproc.admin OR roles/dataproc.editor | table data.resource.type data.protoPayload.authenticationInfo.principalEmail data.protoPayload.authorizationInfo{}.permission data.protoPayload.authorizationInfo{}.resource data.protoPayload.response.bindings{}.role data.protoPayload.response.bindings{}.members{} | `gcp_detect_accounts_with_high_risk_roles_by_project_filter`",
            "search_name": "ESCU - GCP Detect accounts with high risk roles by project - Rule",
            "story": "0432039c-ef41-4b03-b157-450c25dad1e6",
            "tags": {
                "analytics_story": [
                    "GCP Cross Account Activity"
                ],
                "asset_type": "GCP Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "gcp_detect_gcploit_framework": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "GCP Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=gcp_detect_gcploit_framework",
            "data_source_categories": "VendorSpecific-gcp-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-08",
            "description": "This search provides detection of GCPloit exploitation framework. This framework can be used to escalate privileges and move laterally from compromised high privilege accounts.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "icon": "ES_Use_Case.png",
            "id": "gcp_detect_gcploit_framework",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Payload.request.function.timeout value can possibly be match with other functions or requests however the source user and target request account may indicate an attempt to move laterally accross acounts or projects",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "gcp_detect_gcploit_framework_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "GCP Detect Gcploit Framework",
            "references": [
                "https://github.com/dxa4481/gcploit",
                "https://www.youtube.com/watch?v=Ml09R38jpok"
            ],
            "released": "2020-10-08",
            "search": "`google_gcp_pubsub_message` data.protoPayload.request.function.timeout=539s | table src src_user data.resource.labels.project_id data.protoPayload.request.function.serviceAccountEmail data.protoPayload.authorizationInfo{}.permission data.protoPayload.request.location http_user_agent | `gcp_detect_gcploit_framework_filter`",
            "search_name": "ESCU - GCP Detect gcploit framework - Rule",
            "story": "0432039c-ef41-4b03-b157-450c25dad1e6",
            "tags": {
                "analytics_story": [
                    "GCP Cross Account Activity"
                ],
                "asset_type": "GCP Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "gcp_detect_high_risk_permissions_by_resource_and_account": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "GCP Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=gcp_detect_high_risk_permissions_by_resource_and_account",
            "data_source_categories": "VendorSpecific-gcp-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-10-09",
            "description": "This search provides detection of high risk permissions by resource and accounts. These are permissions that can allow attackers with compromised accounts to move laterally and escalate privileges.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "icon": "ES_Use_Case.png",
            "id": "gcp_detect_high_risk_permissions_by_resource_and_account",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "High risk permissions are part of any GCP environment, however it is important to track resource and accounts usage, this search may produce false positives.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "gcp_detect_high_risk_permissions_by_resource_and_account_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "GCP Detect High Risk Permissions By Resource And Account",
            "references": [
                "https://github.com/dxa4481/gcploit",
                "https://www.youtube.com/watch?v=Ml09R38jpok",
                "https://cloud.google.com/iam/docs/permissions-reference"
            ],
            "released": "2020-10-09",
            "search": "`google_gcp_pubsub_message` data.protoPayload.authorizationInfo{}.permission=iam.serviceAccounts.getaccesstoken OR iam.serviceAccounts.setIamPolicy OR iam.serviceAccounts.actas OR dataflow.jobs.create OR composer.environments.create OR dataproc.clusters.create |table data.protoPayload.requestMetadata.callerIp data.protoPayload.authenticationInfo.principalEmail data.protoPayload.authorizationInfo{}.permission data.protoPayload.response.bindings{}.members{} data.resource.labels.project_id | `gcp_detect_high_risk_permissions_by_resource_and_account_filter`",
            "search_name": "ESCU - GCP Detect high risk permissions by resource and account - Rule",
            "story": "0432039c-ef41-4b03-b157-450c25dad1e6",
            "tags": {
                "analytics_story": [
                    "GCP Cross Account Activity"
                ],
                "asset_type": "GCP Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "gcp_detect_oauth_token_abuse": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "GCP Cross Account Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Account",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=gcp_detect_oauth_token_abuse",
            "data_source_categories": "VendorSpecific-gcp-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-09-01",
            "description": "This search provides detection of possible GCP Oauth token abuse. GCP Oauth token without time limit can be exfiltrated and reused for keeping access sessions alive without further control of authentication, allowing attackers to access and move laterally.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
            "icon": "ES_Use_Case.png",
            "id": "gcp_detect_oauth_token_abuse",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "GCP Oauth token abuse detection will only work if there are access policies in place along with audit logs.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "gcp_detect_oauth_token_abuse_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "GCP Detect Oauth Token Abuse",
            "references": [
                "https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-1",
                "https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2"
            ],
            "released": "2020-09-01",
            "search": "`google_gcp_pubsub_message` type.googleapis.com/google.cloud.audit.AuditLog |table protoPayload.@type protoPayload.status.details{}.@type protoPayload.status.details{}.violations{}.callerIp protoPayload.status.details{}.violations{}.type protoPayload.status.message  | `gcp_detect_oauth_token_abuse_filter`",
            "search_name": "ESCU - gcp detect oauth token abuse - Rule",
            "story": "0432039c-ef41-4b03-b157-450c25dad1e6",
            "tags": {
                "analytics_story": [
                    "GCP Cross Account Activity"
                ],
                "asset_type": "GCP Account",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "gcp_gcr_container_uploaded": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Container Implantation Monitoring and Investigation",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP GCR Container",
            "author": "Rod Soto, Rico Valdez, Splunk",
            "baselines": "",
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=gcp_gcr_container_uploaded",
            "data_source_categories": "DS036CloudInfrastructure-ET02Storage|VendorSpecific-gcp-audit",
            "datamodel": "Cloud_Infrastructure.Storage",
            "dataset": "",
            "date": "2020-02-20",
            "description": "This search show information on uploaded containers including source user, account, action, bucket name event name, http user agent, message and destination path.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the GCP App for Splunk (version 2.0.0 or later), then configure stackdriver and set a subpub subscription to be imported to Splunk. You must also install Cloud Infrastructure data model. Please also customize the `container_implant_gcp_detection_filter` macro to filter out the false positives.",
            "highlight": "No",
            "how_to_implement": "You must install the GCP App for Splunk (version 2.0.0 or later), then configure stackdriver and set a subpub subscription to be imported to Splunk. You must also install Cloud Infrastructure data model. Please also customize the `container_implant_gcp_detection_filter` macro to filter out the false positives.",
            "icon": "ES_Use_Case.png",
            "id": "gcp_gcr_container_uploaded",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "Uploading container is a normal behavior from developers or users with access to container registry. GCP GCR registers container upload as a Storage event, this search must be considered under the context of CONTAINER upload creation which automatically generates a bucket entry for destination path.",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "gcp_gcr_container_uploaded_filter"
                }
            ],
            "mitre_sub_technique": "T1525",
            "mitre_tactic": "TA0003",
            "mitre_tactic_display": "Persistence",
            "mitre_technique": "T1525",
            "mitre_threat_groups": "no",
            "name": "GCP GCR Container Uploaded",
            "references": [],
            "released": "2020-02-20",
            "search": "|tstats count min(_time) as firstTime max(_time) as lastTime  FROM datamodel=Cloud_Infrastructure.Storage where Storage.event_name=storage.objects.create by Storage.src_user Storage.account Storage.action Storage.bucket_name Storage.event_name Storage.http_user_agent Storage.msg Storage.object_path | `drop_dm_object_name(\"Storage\")`  | `gcp_gcr_container_uploaded_filter` ",
            "search_name": "ESCU - GCP GCR container uploaded - Rule",
            "story": "aa0e28b1-0521-4b6f-9d2a-7b87e34af246",
            "tags": {
                "analytics_story": [
                    "Container Implantation Monitoring and Investigation"
                ],
                "asset_type": "GCP GCR Container",
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1525"
                ],
                "mitre_attack_tactics": [
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Implant Container Image"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "gcp_kubernetes_cluster_pod_scan_detection": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Scanning Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=gcp_kubernetes_cluster_pod_scan_detection",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-17",
            "description": "This search provides information of unauthenticated requests via user agent, and authentication data against Kubernetes cluster's pods",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the GCP App for Splunk (version 2.0.0 or later), then configure stackdriver and set a Pub/Sub subscription to be imported to Splunk.",
            "highlight": "No",
            "how_to_implement": "You must install the GCP App for Splunk (version 2.0.0 or later), then configure stackdriver and set a Pub/Sub subscription to be imported to Splunk.",
            "icon": "ES_Use_Case.png",
            "id": "gcp_kubernetes_cluster_pod_scan_detection",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all unauthenticated requests are malicious, but frequency, User Agent, source IPs and pods  will provide context.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "gcp_kubernetes_cluster_pod_scan_detection_filter"
                }
            ],
            "mitre_sub_technique": "T1526",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1526",
            "mitre_threat_groups": "no",
            "name": "GCP Kubernetes Cluster Pod Scan Detection",
            "references": [],
            "released": "2020-07-17",
            "search": "`google_gcp_pubsub_message` category=kube-audit |spath input=properties.log |search responseStatus.code=401 |table sourceIPs{} userAgent verb requestURI responseStatus.reason properties.pod | `gcp_kubernetes_cluster_pod_scan_detection_filter`",
            "search_name": "ESCU - GCP Kubernetes cluster pod scan detection - Rule",
            "story": "a9ef59cf-e981-4e66-9eef-bb049f695c09",
            "tags": {
                "analytics_story": [
                    "Kubernetes Scanning Activity"
                ],
                "asset_type": "GCP Kubernetes cluster",
                "kill_chain_phases": [
                    "Reconnaissance"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1526"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "Cloud Service Discovery"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "gcp_kubernetes_cluster_scan_detection": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Scanning Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=gcp_kubernetes_cluster_scan_detection",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-04-15",
            "description": "This search provides information of unauthenticated requests via user agent, and authentication data against Kubernetes cluster",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the GCP App for Splunk (version 2.0.0 or later), then configure stackdriver and set a Pub/Sub subscription to be imported to Splunk. You must also install Cloud Infrastructure data model.Customize the macro kubernetes_gcp_scan_fingerprint_attack_detection to filter out FPs.",
            "highlight": "No",
            "how_to_implement": "You must install the GCP App for Splunk (version 2.0.0 or later), then configure stackdriver and set a Pub/Sub subscription to be imported to Splunk. You must also install Cloud Infrastructure data model.Customize the macro kubernetes_gcp_scan_fingerprint_attack_detection to filter out FPs.",
            "icon": "ES_Use_Case.png",
            "id": "gcp_kubernetes_cluster_scan_detection",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Reconnaissance",
            "known_false_positives": "Not all unauthenticated requests are malicious, but frequency, User Agent and source IPs will provide context.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "gcp_kubernetes_cluster_scan_detection_filter"
                }
            ],
            "mitre_sub_technique": "T1526",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1526",
            "mitre_threat_groups": "no",
            "name": "GCP Kubernetes Cluster Scan Detection",
            "references": [],
            "released": "2020-04-15",
            "search": "`google_gcp_pubsub_message` data.protoPayload.requestMetadata.callerIp!=127.0.0.1 data.protoPayload.requestMetadata.callerIp!=::1 \"data.labels.authorization.k8s.io/decision\"=forbid \"data.protoPayload.status.message\"=PERMISSION_DENIED data.protoPayload.authenticationInfo.principalEmail=\"system:anonymous\" | rename data.protoPayload.requestMetadata.callerIp as src_ip | stats count min(_time) as firstTime max(_time) as lastTime values(data.protoPayload.methodName) as method_name values(data.protoPayload.resourceName) as resource_name values(data.protoPayload.requestMetadata.callerSuppliedUserAgent) as http_user_agent by src_ip data.resource.labels.cluster_name | rename data.resource.labels.cluster_name as cluster_name| `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`  | `gcp_kubernetes_cluster_scan_detection_filter` ",
            "search_name": "ESCU - GCP Kubernetes cluster scan detection - Rule",
            "story": "a9ef59cf-e981-4e66-9eef-bb049f695c09",
            "tags": {
                "analytics_story": [
                    "Kubernetes Scanning Activity"
                ],
                "asset_type": "GCP Kubernetes cluster",
                "kill_chain_phases": [
                    "Reconnaissance"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1526"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "Cloud Service Discovery"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "gdpr_glass_table": {
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "GDPR",
            "dashboard": "gdpr_glass_table?load=1",
            "data_source_categories": "DS034ApplicationLogs-ET01General|DS006UserActivity-ET01List|DS006UserActivity-ET02Read|DS006UserActivity-ET03Create|DS006UserActivity-ET04Update|DS006UserActivity-ET05Delete|VendorSpecific-sfdc-elf",
            "deprecated_not_used_anymore_datasource": "Application Logs|Audit Trail|Vendor-Specific Data",
            "description": "Understand and monitor the compliance of API and user connections to systems with sensitive data for GDPR Compliance.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Data",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "mitre": "",
            "mitre_notes": "Not an attacker technique",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Auditing Overview of Data Processing Systems (Glass Table)",
            "released": "2.1.0",
            "searchKeywords": "",
            "usecase": "Compliance"
        },
        "gdpr_investigation": {
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "GDPR",
            "dashboard": "gdpr_investigation?load=1",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected|DS004EndPointAntiMalware-ET02UpdatedSig|DS034ApplicationLogs-ET01General|DS003Authentication-ET01Success|DS003Authentication-ET02Failure|DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS010NetworkCommunication-ET01Traffic|DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Anti-Virus|Application Logs|Authentication|Endpoint Detection and Response|Network Communication|Web Proxy",
            "description": "Meeting your compliance requirements necessitates being able to investigate breaches. Splunk ES provides you a single place to fully understand attacker activities.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Data",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "Not an attacker technique",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Investigate GDPR Breaches Using ES",
            "released": "2.1.0",
            "searchKeywords": "",
            "usecase": "Compliance"
        },
        "geographically_improbable_access_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics|Account Sharing|Account Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Alerts on access attempts that are improbable based on time and geography.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0001|TA0004",
            "mitre_technique": "|T1078",
            "name": "Geographically Improbable Access Detected",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Geographically Improbable Access Detected - Rule",
            "usecase": "Advanced Threat Detection|Compliance"
        },
        "hiding_files_and_directories_with_attrib_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Defense Evasion Tactics|Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=hiding_files_and_directories_with_attrib_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1222.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "Attackers leverage an existing Windows binary, attrib.exe, to mark specific as hidden by using specific flags so that the victim does not see the file.  The search looks for specific command-line arguments to detect the use of attrib.exe to hide files.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "hiding_files_and_directories_with_attrib_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Some applications and users may legitimately use attrib.exe to interact with the files. ",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "hiding_files_and_directories_with_attrib_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1222.001",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1222",
            "mitre_threat_groups": "no",
            "name": "Hiding Files And Directories With Attrib Exe",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=attrib.exe (Processes.process=*+h*) by Processes.parent_process Processes.process_name Processes.user Processes.dest | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`| `hiding_files_and_directories_with_attrib_exe_filter` ",
            "search_name": "ESCU - Hiding Files And Directories With Attrib exe - Rule",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Windows Defense Evasion Tactics",
                    "Windows Persistence Techniques"
                ],
                "asset_type": "",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1222.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1222"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Windows File and Directory Permissions Modification"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "high_number_of_hosts_not_updating_malware_signatures": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Operations|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET02UpdatedSig",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when a high number of hosts not updating malware signatures have been discovered.  These hosts should be evaluated to determine why they are not updating their malware signatures.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "gdprtext": "<h4>Problem</h4><p>Similar to Detection of Uncleaned Malware on Endpoint, malware may persist if somehow, an endpoint protection solution is not updating its malware signatures. If there are a high number of hosts not updating, then this could indicate a sign of more widespread infection or other compromised state that is resulting in malware signatures not updating.</p><h4>Impact</h4><p>Uncleaned malware puts digital systems at risk. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><h4>Resolution Path:</h4><p> Removing malware infections that antivirus and other legacy endpoint protection software cannot remove (whether due to file permissions or other configurations that prevents easy quarantine or cleaning) can be considered in many cases appropriate, and helps to demonstrate compliance.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "images": [
                {
                    "label": "In ES, it is easy to see all of the AV versions running in your environment.",
                    "name": "Clients by Signature Version",
                    "path": "/static/app/Splunk_Security_Essentials/images/example_images/es_hosts_not_updating_signatures_1.png"
                },
                {
                    "label": "Here is another perspective on the same capability.",
                    "name": "Example Search",
                    "path": "/static/app/Splunk_Security_Essentials/images/example_images/es_hosts_not_updating_signatures_2.png"
                }
            ],
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "|TA0005",
            "mitre_technique": "|T1089",
            "name": "High Number of Hosts Not Updating Malware Signatures",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - High Number of Hosts Not Updating Malware Signatures - Rule",
            "similarUseCases": [
                "UC0030",
                "Outdated_Malware_Definitions",
                ""
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "high_number_of_infected_hosts": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when a high total number of infected hosts is discovered.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "Not an attacker technique",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "High Number Of Infected Hosts",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - High Number Of Infected Hosts - Rule",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "Recurring_Infection_on_Host",
                "host_with_a_recurring_malware_infection",
                "host_with_multiple_infections",
                "UC0029",
                "UC0028",
                "UC0075",
                "UC0065"
            ],
            "usecase": "Security Monitoring"
        },
        "high_number_of_login_failures_from_a_single_source": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Office 365 Detections",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Office 365",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=high_number_of_login_failures_from_a_single_source",
            "data_source_categories": "Other",
            "datamodel": "",
            "dataset": "",
            "date": "2020-12-16",
            "description": "This search detects more than 5 login failures in Office365 Azure Active Directory from a single source IP address. Please adjust the threshold value of 5 as suited for your environment.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "high_number_of_login_failures_from_a_single_source",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=o365:management:activity",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "o365_management_activity"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "high_number_of_login_failures_from_a_single_source_filter"
                }
            ],
            "mitre_sub_technique": "T1110.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1110",
            "mitre_threat_groups": "no",
            "name": "High Number Of Login Failures From A Single Source",
            "references": "",
            "released": "2020-12-16",
            "search": "`o365_management_activity` Operation=UserLoginFailed  record_type=AzureActiveDirectoryStsLogon app=AzureActiveDirectory | stats count dc(user) as accounts_locked values(user) as user values(LogonError) as LogonError values(authentication_method) as authentication_method values(signature) as signature values(UserAgent) as UserAgent by src_ip record_type Operation app | search accounts_locked >= 5| `high_number_of_login_failures_from_a_single_source_filter`",
            "search_name": "ESCU - High Number of Login Failures from a single source - Rule",
            "story": "1a51dd71-effc-48b2-abc4-3e9cdb61e5b9",
            "tags": {
                "analytics_story": [
                    "Office 365 Detections"
                ],
                "asset_type": "Office 365",
                "cis20": [
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1110"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "Password Guessing"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "high_or_critical_priority_host_with_malware_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when an infection is noted on a host with high or critical priority.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "",
            "mitre_sub_technique": "T1566.001|T1566.002",
            "mitre_tactic": "|TA0001|TA0002",
            "mitre_technique": "|T1189|T1193|T1192|T1204",
            "name": "High Or Critical Priority Host With Malware Detected",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - High Or Critical Priority Host With Malware - Rule",
            "usecase": "Security Monitoring"
        },
        "high_or_critical_priority_individual_logging_into_infected_machine": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Account Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Authentication|Anti-Virus",
            "description": "Detects users with a high or critical priority logging into a malware infected machine",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0004|TA0001",
            "mitre_technique": "|T1078",
            "name": "High or Critical Priority Individual Logging into Infected Machine",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - High or Critical Priority Individual Logging into Infected Machine - Rule",
            "usecase": "Security Monitoring"
        },
        "high_process_count": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts when host has a high number of processes. This may be due to an infection or a runaway process.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_sub_technique": "T1569.002",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|T1035",
            "name": "High Process Count",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Host With Excessive Number Of Processes - Rule",
            "usecase": "Advanced Threat Detection"
        },
        "high_volume_email_activity_to_noncorporate_domains_by_user": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Data Exfiltration|Insider Threat",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "Alerts on high volume email activity by a user to non-corporate domains.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Identity",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|TA0010",
            "name": "High Volume Email Activity to Non-corporate Domains by User",
            "relatedUseCases": [
                "detection_email_attachments_with_spaces",
                "showcase_external_emails_with_internal_domain",
                "showcase_spike_in_outgoing_email",
                "detection_suspicious_email_attachments",
                "UC0004"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Identity - High Volume Email Activity with Non-corporate Domains - Rule",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "high_volume_of_traffic_from_high_or_critical_host_observed": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Data Exfiltration|Insider Threat",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Alerts when a host of high or critical severity generates a high volume of outbound traffic. This may indicate that the host has been compromised.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|T1048|T1041",
            "name": "High Volume of Traffic from High or Critical Host Observed",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Insider Threat"
        },
        "host_sending_excessive_email": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Data Exfiltration|Insider Threat",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "Alerts when an host not designated as an e-mail server sends excessive e-mail to one or more target hosts.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_sub_technique": "T1566.001|T1566.002",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1193|T1192",
            "name": "Host Sending Excessive Email",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Host Sending Excessive Email - Rule",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "host_with_a_recurring_malware_infection": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when a host has an infection that has been re-infected remove multiple times over multiple days.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "|T1204",
            "name": "Host With A Recurring Malware Infection",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Recurring Malware Infection - Rule",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "Recurring_Infection_on_Host",
                "high_number_of_infected_hosts",
                "host_with_multiple_infections",
                "UC0029",
                "UC0028",
                "UC0075",
                "UC0065"
            ],
            "usecase": "Security Monitoring"
        },
        "host_with_high_number_of_listening_ports": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Unauthorized Software|Lateral Movement",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET06ListeningPorts",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts when host has a high number of listening services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server) or is not running a firewall.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_notes": "Cyber Hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Host With High Number Of Listening ports",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Host With Excessive Number Of Listening Ports - Rule",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "host_with_high_number_of_services": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Unauthorized Software|Lateral Movement",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts when host has a high number of services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server).",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "mitre": "",
            "mitre_notes": "cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Host With High Number Of Services",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Host With Excessive Number Of Services - Rule",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "host_with_multiple_infections": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when a host with multiple infections is discovered.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "",
            "mitre_sub_technique": "T1566.001|T1566.002",
            "mitre_tactic": "|TA0001|TA0002",
            "mitre_technique": "|T1189|T1193|T1192|T1204",
            "name": "Host With Multiple Infections",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Host With Multiple Infections - Rule",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "Recurring_Infection_on_Host",
                "high_number_of_infected_hosts",
                "host_with_a_recurring_malware_infection",
                "UC0029",
                "UC0028",
                "UC0075",
                "UC0065"
            ],
            "usecase": "Security Monitoring"
        },
        "host_with_old_infection_or_potential_reinfection": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when a host with an old infection is discovered (likely a re-infection).",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "gdprtext": "<h4>Impact:</h4><p>Similar to Detection of Uncleaned Malware on Endpoint \u2013 uncleaned malware puts digital systems at risk. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><h4>Resolution Path:</h4><p>Removing malware infections that antivirus and other legacy endpoint protection software cannot remove (whether due to file permissions or other configurations that prevents easy quarantine or cleaning) can be considered in many cases appropriate, and helps to demonstrate compliance.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "images": [
                {
                    "label": "In ES, the Malware Operations Center provides lots of powerful visibility into the malware status of your organization.",
                    "name": "Malware Operations Center",
                    "path": "/static/app/Splunk_Security_Essentials/images/example_images/es_host_with_reinfection_1.png"
                }
            ],
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|T1204",
            "name": "Host With Old Infection Or Potential Re-Infection",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Old Malware Infection - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "hosts_receiving_high_volume_of_network_traffic_from_email_server": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Collection and Staging",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=hosts_receiving_high_volume_of_network_traffic_from_email_server",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for an increase of data transfers from your email server to your clients. This could be indicative of a malicious actor collecting data using your email server.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7",
            "escu_nist": "PR.PT|DE.CM|DE.AE",
            "hasSearch": "Yes",
            "help": "This search requires you to be ingesting your network traffic and populating the Network_Traffic data model.  Your email servers must be categorized as \"email_server\" for the search to work, as well. You may need to adjust the deviation_threshold and minimum_data_samples values based on the network traffic in your environment. The \"deviation_threshold\" field is a multiplying factor to control how much variation you're willing to tolerate. The \"minimum_data_samples\" field is the minimum number of connections of data samples required for the statistic to be valid.",
            "highlight": "No",
            "how_to_implement": "This search requires you to be ingesting your network traffic and populating the Network_Traffic data model.  Your email servers must be categorized as \"email_server\" for the search to work, as well. You may need to adjust the deviation_threshold and minimum_data_samples values based on the network traffic in your environment. The \"deviation_threshold\" field is a multiplying factor to control how much variation you're willing to tolerate. The \"minimum_data_samples\" field is the minimum number of connections of data samples required for the statistic to be valid.",
            "icon": "ES_Use_Case.png",
            "id": "hosts_receiving_high_volume_of_network_traffic_from_email_server",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "The false-positive rate will vary based on how you set the deviation_threshold and data_samples values. Our recommendation is to adjust these values based on your network traffic to and from your email servers.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "hosts_receiving_high_volume_of_network_traffic_from_email_server_filter"
                }
            ],
            "mitre_sub_technique": "T1114.002",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1114",
            "mitre_threat_groups": "APT1|FIN4|APT28|Dragonfly 2.0|Ke3chang|Leafminer",
            "name": "Hosts Receiving High Volume Of Network Traffic From Email Server",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` sum(All_Traffic.bytes_in) as bytes_in from datamodel=Network_Traffic where All_Traffic.dest_category=email_server by All_Traffic.src_ip _time span=1d | `drop_dm_object_name(\"All_Traffic\")` | eventstats avg(bytes_in) as avg_bytes_in stdev(bytes_in) as stdev_bytes_in | eventstats count as num_data_samples avg(eval(if(_time < relative_time(now(), \"@d\"), bytes_in, null))) as per_source_avg_bytes_in stdev(eval(if(_time < relative_time(now(), \"@d\"), bytes_in, null))) as per_source_stdev_bytes_in by src_ip | eval minimum_data_samples = 4, deviation_threshold = 3 | where num_data_samples >= minimum_data_samples AND bytes_in > (avg_bytes_in + (deviation_threshold * stdev_bytes_in)) AND bytes_in > (per_source_avg_bytes_in + (deviation_threshold * per_source_stdev_bytes_in)) AND _time >= relative_time(now(), \"@d\") | eval num_standard_deviations_away_from_server_average = round(abs(bytes_in - avg_bytes_in) / stdev_bytes_in, 2), num_standard_deviations_away_from_client_average = round(abs(bytes_in - per_source_avg_bytes_in) / per_source_stdev_bytes_in, 2) | table src_ip, _time, bytes_in, avg_bytes_in, per_source_avg_bytes_in, num_standard_deviations_away_from_server_average, num_standard_deviations_away_from_client_average | `hosts_receiving_high_volume_of_network_traffic_from_email_server_filter`",
            "search_name": "ESCU - Hosts receiving high volume of network traffic from email server - Rule",
            "story": "8e03c61e-13c4-4dcd-bfbe-5ce5a8dc031a",
            "tags": {
                "analytics_story": [
                    "Collection and Staging"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT1",
                    "FIN4",
                    "APT28",
                    "Dragonfly 2.0",
                    "Ke3chang",
                    "Leafminer"
                ],
                "mitre_attack_id": [
                    "T1114"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Remote Email Collection"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "hr_concerns_for_user": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
            "deprecated_not_used_anymore_datasource": "Other",
            "description": "<p>Correlate HR Complaints with other event data to detect malicious insiders sooner.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Audit",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": " - Demo"
                },
                {
                    "label": "Live Data",
                    "name": " - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": " - Accelerated"
                }
            ],
            "hasSearch": "No",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of HR Events.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this control is typically difficult not for technical reasons but for business reasons. For many organizations, HR events can be the most sensitive data inside of an organization, subject to universal regulation and requiring very limited and controlled access. For this reason, we don't typically see these log sources inside of Splunk, except in the most mature insider programs who have solved the simpler issues and made the case that to adequately protect the organization a limited number of users must have access to this data.</p><p>Because HR systems don't typically provide API access, when this is enabled is typically by configuring the HR system to send data out when an event occurs. The configuration can depend on the system you use, but most systems can BCC a mailbox on HR complaint confirmations, or send out an XML document.</p><p>When ingested into Splunk, at a bare minimum this data will be stored in a separate index to allow for strict access controls. Some teams have mandated a separate instance to ensure that Splunk administrators can't grant themselves access, though this is less common.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "<p>Not Applicable</p>",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "HR Complaints for User",
            "operationalize": "<p>These complaints should not be directly acted on by InfoSec staff. They're only valuable when combined with other events (for example, someone threatening employees combined with unusual system access can indicate malicious intent).</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/hr_concerns_for_user.png",
            "released": "2.2.0",
            "relevance": "<p>For high maturity Insider Threat organizations, accurately predicting the intent of users requires full visibility into the profile of those users. When there are low grade anomalous events for a user that you might not normally take seriously, recent workplace harassment citations should cause you to look closer. Similarly, if a user has filed a complaint about their boss, they're more likely to be disgruntled and those data exfil DLP alerts should be more closely investigated.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "hunting_covid_themed_attacks_with_iocs": {
            "SPLEase": "Low",
            "additional_context": [
                {
                    "detail": "Full details on how to implement this use case can be found in the Splunk Blog \"Hunting COVID Themed Attacks With IOCs\". Use the link below to get the full details. ",
                    "link": "https://www.splunk.com/en_us/blog/security/hunting-covid-themed-attacks-with-iocs.html",
                    "open_panel": true,
                    "title": "Hunting COVID Themed Attacks With IOCs"
                }
            ],
            "advancedtags": "",
            "alertvolume": "Other",
            "app": "Splunk_Security_Essentials",
            "category": "Threat Intelligence",
            "dashboard": "showcase_custom?showcaseId=hunting_covid_themed_attacks_with_iocs",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic",
            "description": "Leverage open source Theat Intelligence and add COVID related IOCs to Enterprise Security Threat Intelligence Framework.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint|Network|Threat",
            "featured": "Yes",
            "hasSearch": "No",
            "help": "Help not needed",
            "highlight": "No",
            "howToImplement": "",
            "icon": "ES_Use_Case.png",
            "id": "hunting_covid_themed_attacks_with_iocs",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "name": "Hunting COVID Themed Attacks With IOCs",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_covid_19_indicator_check"
            ],
            "released": "3.1.1",
            "relevance": "",
            "searchKeywords": "covid covid-19 corona ioc threat intel blog",
            "severity": "",
            "usecase": "Security Monitoring"
        },
        "identify_new_user_accounts": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Account Monitoring and Controls",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Domain Server",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Operations|GDPR",
            "dashboard": "showcase_security_content?showcaseId=identify_new_user_accounts",
            "data_source_categories": "DS006UserActivity-ET03Create|VendorSpecific-winsec|VendorSpecific-winsec-domaincontroller",
            "datamodel": "Identity_Management.All_Identities",
            "dataset": "",
            "date": "2017-09-12",
            "description": "This detection search will help profile user accounts in your environment by identifying newly created accounts that have been added to your network in the past week.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you need to be populating the Enterprise Security Identity_Management data model in the assets and identity framework.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you need to be populating the Enterprise Security Identity_Management data model in the assets and identity framework.",
            "icon": "ES_Use_Case.png",
            "id": "identify_new_user_accounts",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "None",
            "known_false_positives": "If the Identity_Management data model is not updated regularly, this search could give you false positive alerts. Please consider this and investigate appropriately.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "identify_new_user_accounts_filter"
                }
            ],
            "mitre_sub_technique": "T1078.002",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "TA505|APT3|Threat Group-1314",
            "name": "Identify New User Accounts",
            "references": [],
            "released": "2017-09-12",
            "search": "| from datamodel Identity_Management.All_Identities  | eval empStatus=case((now()-startDate)<604800, \"Accounts created in last week\") | search empStatus=\"Accounts created in last week\"| `security_content_ctime(endDate)` | `security_content_ctime(startDate)`| table identity empStatus endDate startDate | `identify_new_user_accounts_filter`",
            "search_name": "ESCU - Identify New User Accounts - Rule",
            "story": "8892a655-6205-55f7-abba-06460e38c8ae",
            "tags": {
                "analytics_story": [
                    "Account Monitoring and Controls"
                ],
                "asset_type": "Domain Server",
                "cis20": [
                    "CIS 16"
                ],
                "mitre_attack_groups": [
                    "TA505",
                    "APT3",
                    "Threat Group-1314"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Domain Accounts"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring|Compliance",
            "version": 1
        },
        "image_from_new_repository_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Cloud Security|Abuse|Unauthorized Software|Account Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Image From New Repository Detected - Live",
            "data_source_categories": "VendorSpecific-kubernetes",
            "description": "<p>Detect the presence of an Image created from a Repository not seen in your Kubernetes environment before.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Live Data",
                    "name": "Image From New Repository Detected - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple search assistant. Here we start with a dataset of Splunk Connect for Kubernetes Pod logs. These logs are generated from the Pods themselves and reveals the image, container and repository information. This search might look a bit complicated but it is rather simple, we search the data for the last 1 hour, append the current baseline stored in the csv file image_from_new_respository_detected_baseline.csv. Then we calculate the first and last time we saw the repository based on the latest values and the baseline that we appended. At the end of the search we write back to the baseline file and mark any outliers so we can alert whenever the search returns something. There's also some logic that excludes the alerts if we don't have a baseline created and if the baseline is newer than two hours. This is to prevent outliers being created when you first run the search. .</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For this search, it is recommended it is run every hour but this can be changed to a less frequent schedule. .</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This search is designed to find older versions of Mimikatz (or other tools with similar techniques), and is not known to have any other false positives.</p>",
            "mitre": "Impact",
            "mitre_tactic": "TA0040",
            "mitre_technique": "|T1496",
            "name": "Image From New Repository Detected",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the owner of the Container and check if the usage of a completely new Repository of warranted. New Repositories should only rarely appear in a production environment.</p>",
            "relatedUseCases": [
                "suspicious_container_image_name"
            ],
            "released": "3.2.0",
            "relevance": "<p>If an attacker manages to get access to your cluster he is likely to spin up new containers that contain either hacker tools or utilities or that contain cryptocurrency mining software. New repositories should only rarely appear in your production environment so the alert volume and false positive rate should be low. This detection leverages a baseline stored in a lookup to maintain the performance over longer time periods. By default the baseline is stored for 30 days. </p>",
            "searchKeywords": "kubernetes|k8s|docker|container|repository",
            "usecase": "Advanced Threat Detection|Compliance"
        },
        "inactive_account_activity_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Insider Threat",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Discovers previously inactive accounts that are now being used. This may be due to an attacker that successfully gained access to an account that was no longer being used.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1078",
            "name": "Inactive Account Activity Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Inactive Account Usage - Rule",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "insecure_or_cleartext_authentication_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "IAM Analytics|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET03UserAware",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detects authentication requests that transmit the password over the network as cleartext (unencrypted)",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "gdprtext": "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "Not an attack - cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Insecure Or Cleartext Authentication Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Insecure Or Cleartext Authentication - Rule",
            "usecase": "Compliance"
        },
        "integrating_misp_and_splunk_enterprise_security": {
            "SPLEase": "Low",
            "additional_context": [
                {
                    "detail": "Full details on how to implement this use case can be found in the Splunk Blog \"Integrating COVID (or Any) Threat Indicators with MISP and Splunk Enterprise Security\". Use the link below to get the full details. ",
                    "link": "https://www.splunk.com/en_us/blog/security/integrating-covid-or-any-threat-indicators-with-misp-and-enterprise-security.html",
                    "open_panel": true,
                    "title": "Integrating COVID (or Any) Threat Indicators with MISP and Splunk Enterprise Security"
                }
            ],
            "advancedtags": "",
            "alertvolume": "Other",
            "app": "Splunk_Security_Essentials",
            "category": "Threat Intelligence",
            "dashboard": "showcase_custom?showcaseId=integrating_misp_and_splunk_enterprise_security",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic",
            "description": "Integrating COVID (or Any) Threat Indicators from Malware Information Sharing Platform (MISP) in Enterprise Security.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint|Network|Threat",
            "featured": "Yes",
            "hasSearch": "No",
            "help": "Help not needed",
            "highlight": "No",
            "howToImplement": "",
            "icon": "ES_Use_Case.png",
            "id": "integrating_misp_and_splunk_enterprise_security",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "name": "Integrating Threat Indicators with MISP and Splunk Enterprise Security",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_covid_19_indicator_check"
            ],
            "released": "3.1.1",
            "relevance": "",
            "searchKeywords": "covid covid-19 corona ioc threat intel blog misp",
            "severity": "",
            "usecase": "Security Monitoring"
        },
        "kerberoasting_spn_request_with_rc4_encryption": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Lateral Movement",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jose Hernandez, Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kerberoasting_spn_request_with_rc4_encryption",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1558.003/atomic_red_team/windows-security.log"
            ],
            "date": "2020-10-16",
            "description": "This search detects a potential kerberoasting attack via service principal name requests",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, and include the windows security event logs that contain kerberos",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, and include the windows security event logs that contain kerberos",
            "icon": "ES_Use_Case.png",
            "id": "kerberoasting_spn_request_with_rc4_encryption",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "known_false_positives": "Older systems that support kerberos RC4 by default NetApp may generate false positives",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "eventtype=wineventlog_security",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_security"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kerberoasting_spn_request_with_rc4_encryption_filter"
                }
            ],
            "mitre_sub_technique": "T1558.003",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1558",
            "mitre_threat_groups": "no",
            "name": "Kerberoasting Spn Request With RC4 Encryption",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1208/T1208.md",
                "https://www.trimarcsecurity.com/post/trimarcresearch-detecting-kerberoasting-activity"
            ],
            "released": "2020-10-16",
            "search": "`wineventlog_security` EventCode=4769 Ticket_Options=0x40810000 Ticket_Encryption_Type=0x17 | stats count min(_time) as firstTime max(_time) as lastTime by dest, service, service_id, Ticket_Encryption_Type, Ticket_Options | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `kerberoasting_spn_request_with_rc4_encryption_filter`",
            "search_name": "ESCU - Kerberoasting spn request with RC4 encryption - Rule",
            "story": "399d65dc-1f08-499b-a259-aad9051f38ad",
            "tags": {
                "analytics_story": [
                    "Lateral Movement"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1558.003/atomic_red_team/windows-security.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1558"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "Kerberoasting"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "kubernetes_aws_detect_most_active_service_accounts_by_pod": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_aws_detect_most_active_service_accounts_by_pod",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-06-23",
            "description": "This search provides information on Kubernetes service accounts,accessing pods by IP address, verb and decision",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_aws_detect_most_active_service_accounts_by_pod",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all service accounts interactions are malicious. Analyst must consider IP, verb and decision context when trying to detect maliciousness.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_aws_detect_most_active_service_accounts_by_pod_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes AWS Detect Most Active Service Accounts By Pod",
            "references": [],
            "released": "2020-06-23",
            "search": "`aws_cloudwatchlogs_eks` user.groups{}=system:serviceaccounts  objectRef.resource=pods | table  sourceIPs{} user.username userAgent verb annotations.authorization.k8s.io/decision  | top  sourceIPs{} user.username verb annotations.authorization.k8s.io/decision |`kubernetes_aws_detect_most_active_service_accounts_by_pod_filter`",
            "search_name": "ESCU - Kubernetes AWS detect most active service accounts by pod - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "AWS EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_aws_detect_rbac_authorization_by_account": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_aws_detect_rbac_authorization_by_account",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-06-23",
            "description": "This search provides information on Kubernetes RBAC authorizations by accounts, this search can be modified by adding top to see both extremes of RBAC by accounts occurrences",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_aws_detect_rbac_authorization_by_account",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all RBAC Authorications are malicious. RBAC authorizations can uncover malicious activity specially if sensitive Roles have been granted.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_aws_detect_rbac_authorization_by_account_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes AWS Detect Rbac Authorization By Account",
            "references": [],
            "released": "2020-06-23",
            "search": "`aws_cloudwatchlogs_eks` annotations.authorization.k8s.io/reason=* | table sourceIPs{} user.username userAgent annotations.authorization.k8s.io/reason | stats count by user.username annotations.authorization.k8s.io/reason | rare user.username annotations.authorization.k8s.io/reason |`kubernetes_aws_detect_rbac_authorization_by_account_filter`",
            "search_name": "ESCU - Kubernetes AWS detect RBAC authorization by account - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "AWS EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_aws_detect_sensitive_role_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_aws_detect_sensitive_role_access",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-06-23",
            "description": "This search provides information on Kubernetes accounts accessing sensitve objects such as configmpas or secrets",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs.",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs.",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_aws_detect_sensitive_role_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sensitive role resource access is necessary for cluster operation, however source IP, namespace and user group may indicate possible malicious use. ",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_aws_detect_sensitive_role_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes AWS Detect Sensitive Role Access",
            "references": [],
            "released": "2020-06-23",
            "search": "`aws_cloudwatchlogs_eks` objectRef.resource=clusterroles OR clusterrolebindings sourceIPs{}!=::1 sourceIPs{}!=127.0.0.1  | table sourceIPs{} user.username user.groups{} objectRef.namespace requestURI annotations.authorization.k8s.io/reason | dedup user.username user.groups{} |`kubernetes_aws_detect_sensitive_role_access_filter`",
            "search_name": "ESCU - Kubernetes AWS detect sensitive role access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "AWS EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_aws_detect_service_accounts_forbidden_failure_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_aws_detect_service_accounts_forbidden_failure_access",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-06-23",
            "description": "This search provides information on Kubernetes service accounts with failure or forbidden access status, this search can be extended by using top or rare operators to find trends or rarities in failure status, user agents, source IPs and request URI",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs.",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs.",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_aws_detect_service_accounts_forbidden_failure_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This search can give false positives as there might be inherent issues with authentications and permissions at cluster.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_aws_detect_service_accounts_forbidden_failure_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes AWS Detect Service Accounts Forbidden Failure Access",
            "references": [],
            "released": "2020-06-23",
            "search": "`aws_cloudwatchlogs_eks` user.groups{}=system:serviceaccounts responseStatus.status = Failure | table sourceIPs{} user.username userAgent verb responseStatus.status requestURI | `kubernetes_aws_detect_service_accounts_forbidden_failure_access_filter`",
            "search_name": "ESCU - Kubernetes AWS detect service accounts forbidden failure access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "AWS EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_aws_detect_suspicious_kubectl_calls": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_aws_detect_suspicious_kubectl_calls",
            "data_source_categories": "VendorSpecific-aws-cloudwatch-eks",
            "datamodel": "",
            "dataset": "",
            "date": "2020-06-23",
            "description": "This search provides information on anonymous Kubectl calls with IP, verb namespace and object access context",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs.",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on and Splunk App for AWS. This search works with cloudwatch logs.",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_aws_detect_suspicious_kubectl_calls",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Kubectl calls are not malicious by nature. However source IP, verb and Object can reveal potential malicious activity, specially anonymous suspicious IPs and sensitive objects such as configmaps or secrets",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"aws:cloudwatchlogs:eks\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "aws_cloudwatchlogs_eks"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_aws_detect_suspicious_kubectl_calls_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes AWS Detect Suspicious Kubectl Calls",
            "references": [],
            "released": "2020-06-23",
            "search": "`aws_cloudwatchlogs_eks` userAgent=kubectl* sourceIPs{}!=127.0.0.1 sourceIPs{}!=::1 src_user=system:anonymous  | table  src_ip src_user verb userAgent requestURI  | stats  count by src_ip src_user verb userAgent requestURI |`kubernetes_aws_detect_suspicious_kubectl_calls_filter`",
            "search_name": "ESCU - Kubernetes AWS detect suspicious kubectl calls - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "AWS EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_detect_most_active_service_accounts_by_pod_namespace": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_detect_most_active_service_accounts_by_pod_namespace",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-26",
            "description": "This search provides information on Kubernetes service accounts,accessing pods and namespaces by IP address and verb",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_detect_most_active_service_accounts_by_pod_namespace",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all service accounts interactions are malicious. Analyst must consider IP and verb context when trying to detect maliciousness.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_detect_most_active_service_accounts_by_pod_namespace_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes Azure Detect Most Active Service Accounts By Pod Namespace",
            "references": [],
            "released": "2020-05-26",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log | search user.groups{}=system:serviceaccounts* OR user.username=system.anonymous OR annotations.authorization.k8s.io/decision=allow  | table  sourceIPs{} user.username userAgent verb responseStatus.reason responseStatus.status properties.pod objectRef.namespace | top sourceIPs{} user.username verb responseStatus.status properties.pod objectRef.namespace |`kubernetes_azure_detect_most_active_service_accounts_by_pod_namespace_filter`",
            "search_name": "ESCU - Kubernetes Azure detect most active service accounts by pod namespace - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_detect_rbac_authorization_by_account": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_detect_rbac_authorization_by_account",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-26",
            "description": "This search provides information on Kubernetes RBAC authorizations by accounts, this search can be modified by adding rare or top to see both extremes of RBAC by accounts occurrences",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_detect_rbac_authorization_by_account",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all RBAC Authorications are malicious. RBAC authorizations can uncover malicious activity specially if sensitive Roles have been granted.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_detect_rbac_authorization_by_account_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes Azure Detect Rbac Authorization By Account",
            "references": [],
            "released": "2020-05-26",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log | search annotations.authorization.k8s.io/reason=* | table sourceIPs{} user.username userAgent annotations.authorization.k8s.io/reason |stats count by user.username annotations.authorization.k8s.io/reason | rare user.username annotations.authorization.k8s.io/reason |`kubernetes_azure_detect_rbac_authorization_by_account_filter`",
            "search_name": "ESCU - Kubernetes Azure detect RBAC authorization by account - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_detect_sensitive_object_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_detect_sensitive_object_access",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-20",
            "description": "This search provides information on Kubernetes accounts accessing sensitve objects such as configmpas or secrets",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_detect_sensitive_object_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sensitive object access is not necessarily malicious but user and object context can provide guidance for detection.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_detect_sensitive_object_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes Azure Detect Sensitive Object Access",
            "references": [],
            "released": "2020-05-20",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log| search objectRef.resource=secrets OR configmaps user.username=system.anonymous OR annotations.authorization.k8s.io/decision=allow  |table user.username user.groups{} objectRef.resource objectRef.namespace objectRef.name annotations.authorization.k8s.io/reason |dedup user.username user.groups{} |`kubernetes_azure_detect_sensitive_object_access_filter`",
            "search_name": "ESCU - Kubernetes Azure detect sensitive object access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_detect_sensitive_role_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_detect_sensitive_role_access",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-20",
            "description": "This search provides information on Kubernetes accounts accessing sensitve objects such as configmpas or secrets",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_detect_sensitive_role_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sensitive role resource access is necessary for cluster operation, however source IP, namespace and user group may indicate possible malicious use. ",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_detect_sensitive_role_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes Azure Detect Sensitive Role Access",
            "references": [],
            "released": "2020-05-20",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log| search objectRef.resource=clusterroles OR clusterrolebindings | table sourceIPs{} user.username user.groups{} objectRef.namespace requestURI annotations.authorization.k8s.io/reason | dedup user.username user.groups{} |`kubernetes_azure_detect_sensitive_role_access_filter`",
            "search_name": "ESCU - Kubernetes Azure detect sensitive role access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_detect_service_accounts_forbidden_failure_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_detect_service_accounts_forbidden_failure_access",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-20",
            "description": "This search provides information on Kubernetes service accounts with failure or forbidden access status",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_detect_service_accounts_forbidden_failure_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This search can give false positives as there might be inherent issues with authentications and permissions at cluster.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_detect_service_accounts_forbidden_failure_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes Azure Detect Service Accounts Forbidden Failure Access",
            "references": [],
            "released": "2020-05-20",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log | search user.groups{}=system:serviceaccounts*  responseStatus.reason=Forbidden | table  sourceIPs{} user.username userAgent verb responseStatus.reason responseStatus.status properties.pod objectRef.namespace  |`kubernetes_azure_detect_service_accounts_forbidden_failure_access_filter`",
            "search_name": "ESCU - Kubernetes Azure detect service accounts forbidden failure access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_detect_suspicious_kubectl_calls": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_detect_suspicious_kubectl_calls",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-26",
            "description": "This search provides information on rare Kubectl calls with IP, verb namespace and object access context",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_detect_suspicious_kubectl_calls",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Kubectl calls are not malicious by nature. However source IP, verb and Object can reveal potential malicious activity, specially suspicious IPs and sensitive objects such as configmaps or secrets",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_detect_suspicious_kubectl_calls_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes Azure Detect Suspicious Kubectl Calls",
            "references": [],
            "released": "2020-05-26",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log | spath input=responseObject.metadata.annotations.kubectl.kubernetes.io/last-applied-configuration | search userAgent=kubectl* sourceIPs{}!=127.0.0.1 sourceIPs{}!=::1 | table sourceIPs{} verb userAgent user.groups{} objectRef.resource objectRef.namespace requestURI | rare sourceIPs{} verb userAgent user.groups{} objectRef.resource objectRef.namespace requestURI |`kubernetes_azure_detect_suspicious_kubectl_calls_filter`",
            "search_name": "ESCU - Kubernetes Azure detect suspicious kubectl calls - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_pod_scan_fingerprint": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Scanning Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_pod_scan_fingerprint",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-20",
            "description": "This search provides information of unauthenticated requests via source IP user agent, request URI and response status data against Kubernetes cluster pod in Azure",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_pod_scan_fingerprint",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all unauthenticated requests are malicious, but source IPs, userAgent, verb, request URI and response status will provide context.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_pod_scan_fingerprint_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes Azure Pod Scan Fingerprint",
            "references": [],
            "released": "2020-05-20",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log | search responseStatus.code=401 | table  sourceIPs{} userAgent verb requestURI responseStatus.reason properties.pod |`kubernetes_azure_pod_scan_fingerprint_filter`",
            "search_name": "ESCU - Kubernetes Azure pod scan fingerprint - Rule",
            "security_domain": "threat",
            "story": "a9ef59cf-e981-4e66-9eef-bb049f695c09",
            "tags": {
                "analytics_story": [
                    "Kubernetes Scanning Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Reconnaissance"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_azure_scan_fingerprint": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Scanning Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Azure AKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_azure_scan_fingerprint",
            "data_source_categories": "VendorSpecific-azure-aks-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-05-19",
            "description": "This search provides information of unauthenticated requests via source IP user agent, request URI and response status data against Kubernetes cluster in Azure",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "highlight": "No",
            "how_to_implement": "You must install the Add-on for Microsoft Cloud Services and Configure Kube-Audit data diagnostics",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_azure_scan_fingerprint",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all unauthenticated requests are malicious, but source IPs, userAgent, verb, request URI and response status will provide context.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=mscs:storage:blob:json",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype) for Kubernetes data from Azure. Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "kubernetes_azure"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_azure_scan_fingerprint_filter"
                }
            ],
            "mitre_sub_technique": "T1526",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1526",
            "mitre_threat_groups": "no",
            "name": "Kubernetes Azure Scan Fingerprint",
            "references": [],
            "released": "2020-05-19",
            "search": "`kubernetes_azure` category=kube-audit | spath input=properties.log | search responseStatus.code=401 | table  sourceIPs{} userAgent verb requestURI responseStatus.reason |`kubernetes_azure_scan_fingerprint_filter`",
            "search_name": "ESCU - Kubernetes Azure scan fingerprint - Rule",
            "story": "a9ef59cf-e981-4e66-9eef-bb049f695c09",
            "tags": {
                "analytics_story": [
                    "Kubernetes Scanning Activity"
                ],
                "asset_type": "Azure AKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Reconnaissance"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1526"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "Cloud Service Discovery"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_gcp_detect_most_active_service_accounts_by_pod": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP GKE Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_gcp_detect_most_active_service_accounts_by_pod",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-10",
            "description": "This search provides information on Kubernetes service accounts,accessing pods by IP address, verb and decision",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk GCP add on. This search works with pubsub messaging service logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk GCP add on. This search works with pubsub messaging service logs",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_gcp_detect_most_active_service_accounts_by_pod",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all service accounts interactions are malicious. Analyst must consider IP, verb and decision context when trying to detect maliciousness.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_gcp_detect_most_active_service_accounts_by_pod_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes GCP Detect Most Active Service Accounts By Pod",
            "references": [],
            "released": "2020-07-10",
            "search": "`google_gcp_pubsub_message`  data.protoPayload.request.spec.group{}=system:serviceaccounts | table src_ip src_user http_user_agent data.protoPayload.request.spec.nonResourceAttributes.verb data.labels.authorization.k8s.io/decision data.protoPayload.response.spec.resourceAttributes.resource | top src_ip src_user http_user_agent data.labels.authorization.k8s.io/decision data.protoPayload.response.spec.resourceAttributes.resource |`kubernetes_gcp_detect_most_active_service_accounts_by_pod_filter`",
            "search_name": "ESCU - Kubernetes GCP detect most active service accounts by pod - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "GCP GKE Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_gcp_detect_rbac_authorizations_by_account": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP GKE Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_gcp_detect_rbac_authorizations_by_account",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-11",
            "description": "This search provides information on Kubernetes RBAC authorizations by accounts, this search can be modified by adding top to see both extremes of RBAC by accounts occurrences",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk AWS add on for GCP. This search works with pubsub messaging service logs",
            "highlight": "No",
            "how_to_implement": "You must install splunk AWS add on for GCP. This search works with pubsub messaging service logs",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_gcp_detect_rbac_authorizations_by_account",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Not all RBAC Authorications are malicious. RBAC authorizations can uncover malicious activity specially if sensitive Roles have been granted.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_gcp_detect_rbac_authorizations_by_account_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes GCP Detect Rbac Authorizations By Account",
            "references": [],
            "released": "2020-07-11",
            "search": "`google_gcp_pubsub_message` data.labels.authorization.k8s.io/reason=ClusterRoleBinding OR Clusterrole  | table src_ip src_user data.labels.authorization.k8s.io/decision data.labels.authorization.k8s.io/reason | rare src_user data.labels.authorization.k8s.io/reason |`kubernetes_gcp_detect_rbac_authorizations_by_account_filter`",
            "search_name": "ESCU - Kubernetes GCP detect RBAC authorizations by account - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "GCP GKE Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_gcp_detect_sensitive_object_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP GKE Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_gcp_detect_sensitive_object_access",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-11",
            "description": "This search provides information on Kubernetes accounts accessing sensitve objects such as configmaps or secrets",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk add on for GCP . This search works with pubsub messaging service logs.",
            "highlight": "No",
            "how_to_implement": "You must install splunk add on for GCP . This search works with pubsub messaging service logs.",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_gcp_detect_sensitive_object_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sensitive object access is not necessarily malicious but user and object context can provide guidance for detection.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_gcp_detect_sensitive_object_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes GCP Detect Sensitive Object Access",
            "references": [],
            "released": "2020-07-11",
            "search": "`google_gcp_pubsub_message` data.protoPayload.authorizationInfo{}.resource=configmaps OR secrets  | table data.protoPayload.requestMetadata.callerIp src_user data.resource.labels.cluster_name data.protoPayload.request.metadata.namespace data.labels.authorization.k8s.io/decision | dedup data.protoPayload.requestMetadata.callerIp src_user data.resource.labels.cluster_name |`kubernetes_gcp_detect_sensitive_object_access_filter`",
            "search_name": "ESCU - Kubernetes GCP detect sensitive object access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "GCP GKE Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_gcp_detect_sensitive_role_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Role Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP GKE EKS Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_gcp_detect_sensitive_role_access",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-11",
            "description": "This search provides information on Kubernetes accounts accessing sensitve objects such as configmpas or secrets",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk add on for GCP. This search works with pubsub messaging servicelogs.",
            "highlight": "No",
            "how_to_implement": "You must install splunk add on for GCP. This search works with pubsub messaging servicelogs.",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_gcp_detect_sensitive_role_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Sensitive role resource access is necessary for cluster operation, however source IP, user agent, decision and reason may indicate possible malicious use. ",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_gcp_detect_sensitive_role_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes GCP Detect Sensitive Role Access",
            "references": [],
            "released": "2020-07-11",
            "search": "`google_gcp_pubsub_message` data.labels.authorization.k8s.io/reason=ClusterRoleBinding OR Clusterrole dest=apis/rbac.authorization.k8s.io/v1 src_ip!=::1  | table src_ip src_user http_user_agent data.labels.authorization.k8s.io/decision data.labels.authorization.k8s.io/reason | dedup src_ip src_user |`kubernetes_gcp_detect_sensitive_role_access_filter`",
            "search_name": "ESCU - Kubernetes GCP detect sensitive role access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ew",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Role Activity"
                ],
                "asset_type": "GCP GKE EKS Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_gcp_detect_service_accounts_forbidden_failure_access": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP GKE Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_gcp_detect_service_accounts_forbidden_failure_access",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-06-23",
            "description": "This search provides information on Kubernetes service accounts with failure or forbidden access status, this search can be extended by using top or rare operators to find trends or rarities in failure status, user agents, source IPs and request URI",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk add on for GCP. This search works with pubsub messaging service logs.",
            "highlight": "No",
            "how_to_implement": "You must install splunk add on for GCP. This search works with pubsub messaging service logs.",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_gcp_detect_service_accounts_forbidden_failure_access",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This search can give false positives as there might be inherent issues with authentications and permissions at cluster.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_gcp_detect_service_accounts_forbidden_failure_access_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes GCP Detect Service Accounts Forbidden Failure Access",
            "references": [],
            "released": "2020-06-23",
            "search": "`google_gcp_pubsub_message` system:serviceaccounts data.protoPayload.response.status.allowed!=* | table src_ip src_user http_user_agent data.protoPayload.response.spec.resourceAttributes.namespace data.resource.labels.cluster_name data.protoPayload.response.spec.resourceAttributes.verb  data.protoPayload.request.status.allowed data.protoPayload.response.status.reason data.labels.authorization.k8s.io/decision | dedup src_ip src_user | `kubernetes_gcp_detect_service_accounts_forbidden_failure_access_filter`",
            "search_name": "ESCU - Kubernetes GCP detect service accounts forbidden failure access - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "GCP GKE Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "kubernetes_gcp_detect_suspicious_kubectl_calls": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Kubernetes Sensitive Object Access Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "GCP GKE Kubernetes cluster",
            "author": "Rod Soto, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=kubernetes_gcp_detect_suspicious_kubectl_calls",
            "data_source_categories": "VendorSpecific-gcp-gke-audit",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-11",
            "description": "This search provides information on anonymous Kubectl calls with IP, verb namespace and object access context",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install splunk add on for GCP. This search works with pubsub messaging logs.",
            "highlight": "No",
            "how_to_implement": "You must install splunk add on for GCP. This search works with pubsub messaging logs.",
            "icon": "ES_Use_Case.png",
            "id": "kubernetes_gcp_detect_suspicious_kubectl_calls",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Kubectl calls are not malicious by nature. However source IP, source user, user agent, object path, and authorization context can reveal potential malicious activity, specially anonymous suspicious IPs and sensitive objects such as configmaps or secrets",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"google:gcp:pubsub:message\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "google_gcp_pubsub_message"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "kubernetes_gcp_detect_suspicious_kubectl_calls_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Kubernetes GCP Detect Suspicious Kubectl Calls",
            "references": [],
            "released": "2020-07-11",
            "search": "`google_gcp_pubsub_message` data.protoPayload.requestMetadata.callerSuppliedUserAgent=kubectl* src_user=system:unsecured OR src_user=system:anonymous | table src_ip src_user data.protoPayload.requestMetadata.callerSuppliedUserAgent data.protoPayload.authorizationInfo{}.granted object_path |dedup src_ip src_user |`kubernetes_gcp_detect_suspicious_kubectl_calls_filter`",
            "search_name": "ESCU - Kubernetes GCP detect suspicious kubectl calls - Rule",
            "security_domain": "threat",
            "story": "2574e6d9-7254-4751-8925-0447deeec8ea",
            "tags": {
                "analytics_story": [
                    "Kubernetes Sensitive Object Access Activity"
                ],
                "asset_type": "GCP GKE Kubernetes cluster",
                "kill_chain_phases": [
                    "Lateral Movement"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "land_speed_privileged": {
            "SPLEase": "Advanced",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|Account Sharing|Cloud Security",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Land Speed Privileged - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-sfdc-elf|VendorSpecific-aws-cloudtrail",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "Detecting when the same account is logged into twice in a short period of time but from locations very far away, is key to finding account compromise or account credential sharing for your privileged accounts.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Land Speed Privileged - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Land Speed Privileged - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Salesforce.com logs, during which someone logs in from opposite ends of the earth. Our live search looks for the same activity across the standard index and sourcetype of SFDC data. For this use case, you can use any kind of data source, including VPN logs and others.",
            "highlight": "Yes",
            "howToImplement": "First, use the \"Pull List of Privileged Users\" content to generate a list of privileged users (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>). Then you just need a log source that provide external IP addresses. If you are using SFDC data, as we are in the live example, it will work easily. Otherwise, any data source that is compliant with the Splunk Common Information Model (so that it contains a src_ip field) should work automatically.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "There are two big buckets for false positives. One is where the geoip is unreliable -- particularly outside of major economic areas (e.g., US, larger countries in Western Europe), the free MaxMind GeoIP that ships with Splunk Enterprise tends to be less accurate, causing some customers to add the paid version in their Splunk installations. The other big category is where IPs are centralized, such as someone in the US using a Korean VPN service, or using a networking service that originates nation-wide traffic from the same set of IPs (for example, years ago all traffic from a major US cellular carrier originated from the same IP space that was geolocated to Ohio).",
            "mitre": "Credential Access",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_technique": "|T1078",
            "name": "Geographically Improbable Access Detected for Privileged Accounts",
            "operationalize": "When this fires, you should reach out to the user involved to see if they're aware of why their account was used in two places. You should also see what actions were taken, particularly if one of the locations was unusual. If the user is not aware of the reason, it's important to also ask if the user is aware of sharing their credentials with anyone else. You can also see what other activities occurred from the same remote IP addresses.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/land_speed_privileged.png",
            "released": "2.2.0",
            "relevance": "When the same account is logged into in a short time period from distant locations, that can indicate one of two different problems. The first is account compromise -- threat actors who successfully acquire a user's credentials will usually log in from the same general region that the user lives in to reduce suspicion, but they will sometimes make mistakes (or simply be less diligent), and sometimes users will travel to different regions without the threat actor noticing. The other big scenario that this detection can find is intentional account sharing. Suppose an executive who can't be bothered to follow the standard procedure for granting her EA account access, and just shares her password. When that executive travels to distant areas but the EA stays at home, this search will alert.",
            "searchKeywords": "land speed superman",
            "usecase": "Insider Threat"
        },
        "land_speed_violation": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Account Sharing",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Raises anomalies when accounts login over VPN from multiple locations within a short time.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0001|TA0003",
            "mitre_technique": "|T1078",
            "name": "Land Speed Violation",
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "large_volume_of_dns_any_queries": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DNS Amplification Attacks",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "DNS Servers",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Denial of Service",
            "dashboard": "showcase_security_content?showcaseId=large_volume_of_dns_any_queries",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2017-09-20",
            "description": "The search is used to identify attempts to use your DNS Infrastructure for DDoS purposes via a DNS amplification attack leveraging ANY queries.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 11|CIS 12",
            "escu_nist": "PR.PT|DE.AE|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you must ensure that DNS data is populating the Network_Resolution data model.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you must ensure that DNS data is populating the Network_Resolution data model.",
            "icon": "ES_Use_Case.png",
            "id": "large_volume_of_dns_any_queries",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Legitimate ANY requests may trigger this search, however it is unusual to see a large volume of them under typical circumstances. You may modify the threshold in the search to better suit your environment.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "large_volume_of_dns_any_queries_filter"
                }
            ],
            "mitre_sub_technique": "T1498.002",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1498",
            "mitre_threat_groups": "no",
            "name": "Large Volume Of DNS Any Queries",
            "references": [],
            "released": "2017-09-20",
            "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Resolution where nodename=DNS \"DNS.message_type\"=\"QUERY\" \"DNS.record_type\"=\"ANY\" by \"DNS.dest\" | `drop_dm_object_name(\"DNS\")` | where count>200 | `large_volume_of_dns_any_queries_filter`",
            "search_name": "ESCU - Large Volume of DNS ANY Queries - Rule",
            "story": "e8afd39e-3294-11e6-b39d-a45e60c6700",
            "tags": {
                "analytics_story": [
                    "DNS Amplification Attacks"
                ],
                "asset_type": "DNS Servers",
                "cis20": [
                    "CIS 11",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1498"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Reflection Amplification"
                ],
                "nist": [
                    "PR.PT",
                    "DE.AE",
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Application Security",
            "version": 1
        },
        "large_web_upload": {
            "SPLEase": "Basic",
            "advancedtags": "Autobahn",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Large Web Upload - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Uses a basic threshold to detect a large web upload, which could be exfiltration from malware or a malicious insider.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Large Web Upload - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Large Web Upload - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Large Web Upload - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Palo Alto Networks proxy logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Palo Alto Networks or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "This search should work immediately for any Palo Alto Networks environment, and can be easily adapted to apply to any other source of proxy visibility (dedicated proxies, along with network visibility tools such as Splunk Stream or bro). Just adjust the sourcetype and fields to match, and you will be good to go.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Energy",
            "journey": "Stage_1",
            "knownFP": "By definition, this search is very simple and will fire for many innocent occurrences (uploading vacation photos, etc.). Many organizations will try to filter this down by focusing on users who are on a watchlist either because they have access to sensitive data (execs, scientists, etc.) or because of employment reasons (performance plan, notice given, contract ending, etc.). These watchlists can be implemented by using lookups.",
            "mitre": "Exfiltration",
            "mitre_tactic": "TA0010",
            "mitre_technique": "|T1041|T1048",
            "name": "Large Web Upload",
            "operationalize": "When this fires, it will usually do so for perfectly legitimate reasons (uploading vacation photos, etc.). When this fires, many analysts will look where the data was sent to, whether the user has uploaded data to that site before. Often analysts will call the user to confirm the activity, preferably with the knowledge of that employee's status in the organization (e.g., are they on a performance plan or reaching the end of a contract, where they would be at greater risk of data exfiltration). If you have SSL Inspection turned on via your NGFW or DLP for that site, you can sometimes see the actual files that were transferred, which can help provide context.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/large_web_upload.png",
            "relatedUseCases": [
                "sser_tor_traffic",
                "showcase_huge_volume_dns_volume",
                "detection_long_dns_text_response"
            ],
            "released": "2.0.0",
            "relevance": "Data Exfiltration usually occurs over standard channels these days, with insiders uploading data to Google, Dropbox, Box, smaller file sharing sites, or even unlisted drop sites. Because HTTPS is always allowed out, exfiltration becomes relatively easy in most organizations. Detect those big transfers!",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Insider Threat"
        },
        "machine_generated_beacon": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Network Communication|Web Proxy",
            "description": "Correlates beaconing activity with global information in the enterprise to identify suspicious beaconing activity.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1071|T1095",
            "name": "Machine Generated Beacon",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "macos_-_re-opened_applications": {
            "SPLEase": "None",
            "alertvolume": "None",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jamie Windley, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=macos_-_re-opened_applications",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-02-07",
            "description": "This search looks for processes referencing the plist files that determine which applications are re-opened when a user reboots their machine.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.DP|DE.CM",
            "hasSearch": "Yes",
            "help": "In order to properly run this search, Splunk needs to ingest process data from your osquery deployed agents with the [splunk.conf](https://github.com/splunk/TA-osquery/blob/master/config/splunk.conf) pack enabled. Also the [TA-OSquery](https://github.com/splunk/TA-osquery) must be deployed across your indexers and universal forwarders in order to have the data populate the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "In order to properly run this search, Splunk needs to ingest process data from your osquery deployed agents with the [splunk.conf](https://github.com/splunk/TA-osquery/blob/master/config/splunk.conf) pack enabled. Also the [TA-OSquery](https://github.com/splunk/TA-osquery) must be deployed across your indexers and universal forwarders in order to have the data populate the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "macos_-_re-opened_applications",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Command and Control",
            "known_false_positives": "At this stage, there are no known false positives. During testing, no process events refering the com.apple.loginwindow.plist files were observed during normal operation of re-opening applications on reboot. Therefore, it can be asumed that any occurences of this in the process events would be worth investigating. In the event that the legitimate modification by the system of these files is in fact logged to the process log, then the process_name of that process can be whitelisted.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "macos___re_opened_applications_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Macos - Re-Opened Applications",
            "references": [],
            "released": "2020-02-07",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process=\"*com.apple.loginwindow*\" by Processes.user Processes.process_name Processes.parent_process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `macos___re_opened_applications_filter`",
            "search_name": "ESCU - MacOS - Re-opened Applications - Rule",
            "security_domain": "threat",
            "tags": {
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Command and Control"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.CM"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "malicious_ad_activity": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Raises anomalies when the input data matches a set of predefined patterns in Microsoft Windows logs.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0003|TA0004|TA0001",
            "mitre_technique": "|T1078",
            "name": "Malicious AD Activity",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "malicious_powershell_process_-_connect_to_internet_with_hidden_window": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Malicious PowerShell|Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=malicious_powershell_process_-_connect_to_internet_with_hidden_window",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/hidden_powershell/windows-sysmon.log"
            ],
            "date": "2020-11-20",
            "description": "This search looks for PowerShell processes started with parameters to modify the execution policy of the run, run in a hidden window, and connect to the Internet. This combination of command-line options is suspicious because it's overriding the default PowerShell execution policy, attempts to hide its activity from the user, and connects to the Internet. Deprecated becaue hidden is not needed when download file with System.Net.WebClient.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 7|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "malicious_powershell_process_-_connect_to_internet_with_hidden_window",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "Legitimate process can have this combination of command-line options, but it's not common.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "malicious_powershell_process___connect_to_internet_with_hidden_window_filter"
                }
            ],
            "mitre_sub_technique": "T1059.001",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1059",
            "mitre_threat_groups": "Blue Mockingbird|APT39|DarkVishnya|Molerats|Wizard Spider|Frankenstein|Inception|Silence|APT41|Kimsuky|Soft Cell|TA505|WIRTE|TEMP.Veles|APT33|Gallmaker|Turla|APT19|DarkHydrus|APT28|Thrip|Gorgon Group|Cobalt Group|Dragonfly 2.0|Leviathan|TA459|FIN8|MuddyWater|Magic Hound|OilRig|BRONZE BUTLER|CopyKittens|APT32|FIN7|FIN10|Threat Group-3390|menuPass|Patchwork|Stealth Falcon|FIN6|Poseidon Group|APT3|APT29|Deep Panda",
            "name": "Malicious Powershell Process - Connect To Internet With Hidden Window",
            "references": [],
            "released": "2020-11-20",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe Processes.process=*-WindowStyle* Processes.process=*hidden* Processes.process=\"*New-Object*\" by Processes.user Processes.process_name Processes.parent_process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `malicious_powershell_process___connect_to_internet_with_hidden_window_filter`",
            "search_name": "ESCU - Malicious PowerShell Process - Connect To Internet With Hidden Window - Rule",
            "story": "2c8ff66e-0b57-42af-8ad7-912438a403fc|988C59C5-0A1C-45B6-A555-0C62276E327E",
            "tags": {
                "analytics_story": [
                    "Malicious PowerShell",
                    "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 7",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/hidden_powershell/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "DarkVishnya",
                    "Molerats",
                    "Wizard Spider",
                    "Frankenstein",
                    "Inception",
                    "Silence",
                    "APT41",
                    "Kimsuky",
                    "Soft Cell",
                    "TA505",
                    "WIRTE",
                    "TEMP.Veles",
                    "APT33",
                    "Gallmaker",
                    "Turla",
                    "APT19",
                    "DarkHydrus",
                    "APT28",
                    "Thrip",
                    "Gorgon Group",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "Leviathan",
                    "TA459",
                    "FIN8",
                    "MuddyWater",
                    "Magic Hound",
                    "OilRig",
                    "BRONZE BUTLER",
                    "CopyKittens",
                    "APT32",
                    "FIN7",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Patchwork",
                    "Stealth Falcon",
                    "FIN6",
                    "Poseidon Group",
                    "APT3",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "PowerShell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "malicious_powershell_process_-_encoded_command": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Malicious PowerShell|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=malicious_powershell_process_-_encoded_command",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1027/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for PowerShell processes that have encoded the script within the command-line. Malware has been seen using this parameter, as it obfuscates the code and makes it relatively easy to pass a script on the command-line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 7|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "malicious_powershell_process_-_encoded_command",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "System administrators may use this option, but it's not common.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "malicious_powershell_process___encoded_command_filter"
                }
            ],
            "mitre_sub_technique": "T1027",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1027",
            "mitre_threat_groups": "Gamaredon Group|Rocke|Sandworm Team|Blue Mockingbird|Whitefly|Molerats|Wizard Spider|Mofang|Frankenstein|Inception|APT-C-36|APT41|Machete|Soft Cell|Turla|TA505|Silence|APT33|Night Dragon|Darkhotel|Gallmaker|APT29|APT18|Tropic Trooper|Cobalt Group|Patchwork|Leafminer|APT37|Threat Group-3390|Honeybee|Dark Caracal|menuPass|APT19|BlackOasis|FIN8|Leviathan|Elderwood|MuddyWater|FIN7|Magic Hound|OilRig|APT3|APT32|Group5|Dust Storm|Lazarus Group|Putter Panda|APT28",
            "name": "Malicious Powershell Process - Encoded Command",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = powershell.exe (Processes.process=*-EncodedCommand* OR Processes.process=*-enc*) by Processes.user Processes.process_name Processes.process Processes.parent_process_name Processes.dest Processes.process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `malicious_powershell_process___encoded_command_filter`",
            "search_name": "ESCU - Malicious PowerShell Process - Encoded Command - Rule",
            "story": "2c8ff66e-0b57-42af-8ad7-912438a403fc|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Malicious PowerShell",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 7",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1027/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Rocke",
                    "Sandworm Team",
                    "Blue Mockingbird",
                    "Whitefly",
                    "Molerats",
                    "Wizard Spider",
                    "Mofang",
                    "Frankenstein",
                    "Inception",
                    "APT-C-36",
                    "APT41",
                    "Machete",
                    "Soft Cell",
                    "Turla",
                    "TA505",
                    "Silence",
                    "APT33",
                    "Night Dragon",
                    "Darkhotel",
                    "Gallmaker",
                    "APT29",
                    "APT18",
                    "Tropic Trooper",
                    "Cobalt Group",
                    "Patchwork",
                    "Leafminer",
                    "APT37",
                    "Threat Group-3390",
                    "Honeybee",
                    "Dark Caracal",
                    "menuPass",
                    "APT19",
                    "BlackOasis",
                    "FIN8",
                    "Leviathan",
                    "Elderwood",
                    "MuddyWater",
                    "FIN7",
                    "Magic Hound",
                    "OilRig",
                    "APT3",
                    "APT32",
                    "Group5",
                    "Dust Storm",
                    "Lazarus Group",
                    "Putter Panda",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1027"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Obfuscated Files or Information"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "malicious_powershell_process_-_execution_policy_bypass": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=malicious_powershell_process_-_execution_policy_bypass",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for PowerShell processes started with parameters used to bypass the local execution policy for scripts. These parameters are often observed in attacks leveraging PowerShell scripts as they override the default PowerShell execution policy.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 7|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "malicious_powershell_process_-_execution_policy_bypass",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "There may be legitimate reasons to bypass the PowerShell execution policy. The PowerShell script being run with this parameter should be validated to ensure that it is legitimate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "malicious_powershell_process___execution_policy_bypass_filter"
                }
            ],
            "mitre_sub_technique": "T1059.001",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1059",
            "mitre_threat_groups": "Blue Mockingbird|APT39|DarkVishnya|Molerats|Wizard Spider|Frankenstein|Inception|Silence|APT41|Kimsuky|Soft Cell|TA505|WIRTE|TEMP.Veles|APT33|Gallmaker|Turla|APT19|DarkHydrus|APT28|Thrip|Gorgon Group|Cobalt Group|Dragonfly 2.0|Leviathan|TA459|FIN8|MuddyWater|Magic Hound|OilRig|BRONZE BUTLER|CopyKittens|APT32|FIN7|FIN10|Threat Group-3390|menuPass|Patchwork|Stealth Falcon|FIN6|Poseidon Group|APT3|APT29|Deep Panda",
            "name": "Malicious Powershell Process - Execution Policy Bypass",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` values(Processes.process_id) as process_id, values(Processes.parent_process_id) as parent_process_id values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe AND (Processes.process=\"* -ex*\" OR Processes.process=\"* bypass *\") by Processes.process_id, Processes.user, Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `malicious_powershell_process___execution_policy_bypass_filter`",
            "search_name": "ESCU - Malicious PowerShell Process - Execution Policy Bypass - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 7",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "DarkVishnya",
                    "Molerats",
                    "Wizard Spider",
                    "Frankenstein",
                    "Inception",
                    "Silence",
                    "APT41",
                    "Kimsuky",
                    "Soft Cell",
                    "TA505",
                    "WIRTE",
                    "TEMP.Veles",
                    "APT33",
                    "Gallmaker",
                    "Turla",
                    "APT19",
                    "DarkHydrus",
                    "APT28",
                    "Thrip",
                    "Gorgon Group",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "Leviathan",
                    "TA459",
                    "FIN8",
                    "MuddyWater",
                    "Magic Hound",
                    "OilRig",
                    "BRONZE BUTLER",
                    "CopyKittens",
                    "APT32",
                    "FIN7",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Patchwork",
                    "Stealth Falcon",
                    "FIN6",
                    "Poseidon Group",
                    "APT3",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "PowerShell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "malicious_powershell_process_-_multiple_suspicious_command-line_arguments": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Malicious PowerShell",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=malicious_powershell_process_-_multiple_suspicious_command-line_arguments",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-11-20",
            "description": "This search looks for PowerShell processes started with a base64 encoded command-line passed to it, with parameters to modify the execution policy for the process, and those that prevent the display of an interactive prompt to the user. This combination of command-line options is suspicious because it overrides the default PowerShell execution policy, attempts to hide itself from the user, and passes an encoded script to be run on the command-line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 7|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "malicious_powershell_process_-_multiple_suspicious_command-line_arguments",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "Legitimate process can have this combination of command-line options, but it's not common.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "malicious_powershell_process___multiple_suspicious_command_line_arguments_filter"
                }
            ],
            "mitre_sub_technique": "T1027",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1027",
            "mitre_threat_groups": "Gamaredon Group|Rocke|Sandworm Team|Blue Mockingbird|Whitefly|Molerats|Wizard Spider|Mofang|Frankenstein|Inception|APT-C-36|APT41|Machete|Soft Cell|Turla|TA505|Silence|APT33|Night Dragon|Darkhotel|Gallmaker|APT29|APT18|Tropic Trooper|Cobalt Group|Patchwork|Leafminer|APT37|Threat Group-3390|Honeybee|Dark Caracal|menuPass|APT19|BlackOasis|FIN8|Leviathan|Elderwood|MuddyWater|FIN7|Magic Hound|OilRig|APT3|APT32|Group5|Dust Storm|Lazarus Group|Putter Panda|APT28",
            "name": "Malicious Powershell Process - Multiple Suspicious Command-Line Arguments",
            "references": [],
            "released": "2020-11-20",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| search (process=*-EncodedCommand* OR process=*-enc*) process=*-Exec* AND process=*-NonI* | `malicious_powershell_process___multiple_suspicious_command_line_arguments_filter`",
            "search_name": "ESCU - Malicious PowerShell Process - Multiple Suspicious Command-Line Arguments - Rule",
            "story": "2c8ff66e-0b57-42af-8ad7-912438a403fc",
            "tags": {
                "analytics_story": [
                    "Malicious PowerShell"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 7",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Rocke",
                    "Sandworm Team",
                    "Blue Mockingbird",
                    "Whitefly",
                    "Molerats",
                    "Wizard Spider",
                    "Mofang",
                    "Frankenstein",
                    "Inception",
                    "APT-C-36",
                    "APT41",
                    "Machete",
                    "Soft Cell",
                    "Turla",
                    "TA505",
                    "Silence",
                    "APT33",
                    "Night Dragon",
                    "Darkhotel",
                    "Gallmaker",
                    "APT29",
                    "APT18",
                    "Tropic Trooper",
                    "Cobalt Group",
                    "Patchwork",
                    "Leafminer",
                    "APT37",
                    "Threat Group-3390",
                    "Honeybee",
                    "Dark Caracal",
                    "menuPass",
                    "APT19",
                    "BlackOasis",
                    "FIN8",
                    "Leviathan",
                    "Elderwood",
                    "MuddyWater",
                    "FIN7",
                    "Magic Hound",
                    "OilRig",
                    "APT3",
                    "APT32",
                    "Group5",
                    "Dust Storm",
                    "Lazarus Group",
                    "Putter Panda",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1027"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Obfuscated Files or Information"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "malicious_powershell_process_with_obfuscation_techniques": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Malicious PowerShell",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=malicious_powershell_process_with_obfuscation_techniques",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for PowerShell processes launched with arguments that have characters indicative of obfuscation on the command-line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 7|CIS 8",
            "escu_nist": "PR.PT|DE.CM|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. Deprecated because the detection need rework and would need to work base on powershell logs.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. Deprecated because the detection need rework and would need to work base on powershell logs.",
            "icon": "ES_Use_Case.png",
            "id": "malicious_powershell_process_with_obfuscation_techniques",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control|Actions On Objectives",
            "known_false_positives": "These characters might be legitimately on the command-line, but it is not common.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "malicious_powershell_process_with_obfuscation_techniques_filter"
                }
            ],
            "mitre_sub_technique": "T1059.001",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1059",
            "mitre_threat_groups": "Blue Mockingbird|APT39|DarkVishnya|Molerats|Wizard Spider|Frankenstein|Inception|Silence|APT41|Kimsuky|Soft Cell|TA505|WIRTE|TEMP.Veles|APT33|Gallmaker|Turla|APT19|DarkHydrus|APT28|Thrip|Gorgon Group|Cobalt Group|Dragonfly 2.0|Leviathan|TA459|FIN8|MuddyWater|Magic Hound|OilRig|BRONZE BUTLER|CopyKittens|APT32|FIN7|FIN10|Threat Group-3390|menuPass|Patchwork|Stealth Falcon|FIN6|Poseidon Group|APT3|APT29|Deep Panda",
            "name": "Malicious Powershell Process With Obfuscation Techniques",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest Processes.process | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| eval num_obfuscation = (mvcount(split(process, \"`\"))-1) + (mvcount(split(process, \"^\"))-1) | `malicious_powershell_process_with_obfuscation_techniques_filter` | search num_obfuscation > 0",
            "search_name": "ESCU - Malicious PowerShell Process With Obfuscation Techniques - Rule",
            "story": "2c8ff66e-0b57-42af-8ad7-912438a403fc",
            "tags": {
                "analytics_story": [
                    "Malicious PowerShell"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 7",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "DarkVishnya",
                    "Molerats",
                    "Wizard Spider",
                    "Frankenstein",
                    "Inception",
                    "Silence",
                    "APT41",
                    "Kimsuky",
                    "Soft Cell",
                    "TA505",
                    "WIRTE",
                    "TEMP.Veles",
                    "APT33",
                    "Gallmaker",
                    "Turla",
                    "APT19",
                    "DarkHydrus",
                    "APT28",
                    "Thrip",
                    "Gorgon Group",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "Leviathan",
                    "TA459",
                    "FIN8",
                    "MuddyWater",
                    "Magic Hound",
                    "OilRig",
                    "BRONZE BUTLER",
                    "CopyKittens",
                    "APT32",
                    "FIN7",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Patchwork",
                    "Stealth Falcon",
                    "FIN6",
                    "Poseidon Group",
                    "APT3",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "PowerShell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "many_usb_file_copies": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Many USB File Copies for User - Demo",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "deprecated_not_used_anymore_datasource": "DLP|Endpoint Detection and Response",
            "description": "<p>Build a baseline of how many file copies each user does to USB media, and detect when a user copies an uncharacteristically large number of files.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Many USB File Copies for User - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Many USB File Copies for User - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized data collection from an actual customer environment.</p>",
            "highlight": "No",
            "howToImplement": "<p>This detection relies on visibility for files copied to USB. There are two frequent paths to building out that visibility. The first (and most common) is commercial DLP or EDR software that tracks these activities. The second, and cheaper, is that there is a little-known group policy option that instructs Windows itself to log these activities in the Windows Security Event Log. DV Provide This Link</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely the opportunity for lots of noise.</p>",
            "mitre": "Exfiltration",
            "mitre_sub_technique": "T1052.001",
            "mitre_tactic": "TA0010",
            "mitre_technique": "|T1052",
            "name": "Many USB File Copies for User",
            "operationalize": "<p>When this alert fires, the immediate questions should be: what data was copied, and was it sensitive. As SOC staff rarely have very deep understanding of the sensitivity of the actual data (if you have data categorization fully implemented in your organization, kudos! You are the only organization in the world), it's usually most prudent to look at whether this user is in a position to have access to sensitive data. There are a few approaches to this process: guessing from titles / departments (e.g., research scientist versus customer service representative), pulling a list of privileged users (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>), or others. Very mature organizations will also track authorized USB device (either via encryption or other means), where data copy to unauthorized / unencrypted devices carries different consequences than to devices that are a part of standard operating procedures. Finally, it's often realistic to make some determination of risk based on the file names copied, though it's important to not be overly reliant on that indication (if I were to exfiltrate data, I would likely create a zip file called expense_report_receipts.zip or something mundane).</p><p>Ultimately, with many behavioral detections, you probably don't want to evaluate this alert in a vacuum, as you would end up with an excessive number of false positives. Sure, alert directly if this alert occurs for users who have access to sensitive data, but generally speaking you should combine this alert with other suspicious indications such as HR issues, recent (or future) separation, etc.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/many_usb_file_copies.png",
            "released": "2.2.0",
            "relevance": "<p>Data exfiltration is top of mind for most security organizations. Copying data to USB is a top means for exfiltrating large and small volumes of data, so detecting that type of activity is key.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "monitor_dns_for_brand_abuse": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Brand Monitoring",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-10-08",
                    "description": "This search creates permutations of your existing domains, removes the valid domain names and stores them in a specified lookup file so they can be checked for in the associated detection searches.",
                    "how_to_implement": "To successfully implement this search you need to update the file called domains.csv in the DA-ESS-SOC/lookup directory. Or `cim_corporate_email_domains.csv` and `cim_corporate_web_domains.csv` from **Splunk\\_SA\\_CIM**.",
                    "id": "19f7d2ec-6028-4d01-bcdb-bda9a034c17f",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/brand_monitoring.csv",
                            "default_match": "false",
                            "description": "A file that contains look-a-like domains for brands that you want to monitor",
                            "filename": "brand_monitoring.csv",
                            "match_type": "WILDCARD(domain)",
                            "min_matches": 1,
                            "name": "brandMonitoring_lookup"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "eval domain=trim(domain,\"*\") | search NOT[| inputlookup domains]  NOT[ |inputlookup cim_corporate_email_domain_lookup] NOT[inputlookup cim_corporate_web_domain_lookup] | eval domain=\"*\"+domain+\"*\"",
                            "description": "This macro removes valid domains from the output",
                            "name": "remove_valid_domains"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "dnstwist_domain_names_filter"
                        }
                    ],
                    "name": "DNSTwist Domain Names",
                    "search": "| dnstwist domainlist=domains.csv | `remove_valid_domains` | eval domain_abuse=\"true\" | table domain, domain_abuse | outputlookup brandMonitoring_lookup | stats count",
                    "tags": {
                        "analytics_story": [
                            "Brand Monitoring",
                            "Suspicious Emails"
                        ],
                        "detections": [
                            "Monitor Email For Brand Abuse",
                            "Monitor DNS For Brand Abuse",
                            "Monitor Web Traffic For Brand Abuse"
                        ]
                    },
                    "version": 2
                }
            ],
            "category": "Operations",
            "dashboard": "showcase_security_content?showcaseId=monitor_dns_for_brand_abuse",
            "data_source_categories": "DS002DNS-ET01QueryResponse|DS002DNS-ET01QueryRequest|DS002DNS-ET01Query",
            "datamodel": "Network_Resolution",
            "dataset": "",
            "date": "2017-09-23",
            "description": "This search looks for DNS requests for faux domains similar to the domains that you want to have monitored for abuse.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You need to ingest data from your DNS logs. Specifically you must ingest the domain that is being queried and the IP of the host originating the request. Ideally, you should also be ingesting the answer to the query and the query type. This approach allows you to also create your own localized passive DNS capability which can aid you in future investigations. You also need to have run the search \"ESCU - DNSTwist Domain Names\", which creates the permutations of the domain that will be checked for.",
            "highlight": "No",
            "how_to_implement": "You need to ingest data from your DNS logs. Specifically you must ingest the domain that is being queried and the IP of the host originating the request. Ideally, you should also be ingesting the answer to the query and the query type. This approach allows you to also create your own localized passive DNS capability which can aid you in future investigations. You also need to have run the search \"ESCU - DNSTwist Domain Names\", which creates the permutations of the domain that will be checked for.",
            "icon": "ES_Use_Case.png",
            "id": "monitor_dns_for_brand_abuse",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery|Actions On Objectives",
            "known_false_positives": "None at this time",
            "lookups": "",
            "macros": [
                {
                    "definition": "lookup update=true brandMonitoring_lookup domain as query OUTPUT domain_abuse | search domain_abuse=true",
                    "description": "This macro limits the output to only domains that are in the brand monitoring lookup file",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/brand_monitoring.csv",
                            "default_match": "false",
                            "description": "A file that contains look-a-like domains for brands that you want to monitor",
                            "filename": "brand_monitoring.csv",
                            "match_type": "WILDCARD(domain)",
                            "min_matches": 1,
                            "name": "brandMonitoring_lookup"
                        }
                    ],
                    "name": "brand_abuse_dns"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "monitor_dns_for_brand_abuse_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Monitor DNS For Brand Abuse",
            "references": [],
            "released": "2017-09-23",
            "search": "| tstats `security_content_summariesonly` values(DNS.answer) as IPs min(_time) as firstTime from datamodel=Network_Resolution by DNS.src, DNS.query | `drop_dm_object_name(\"DNS\")` | `security_content_ctime(firstTime)`| `brand_abuse_dns` | `monitor_dns_for_brand_abuse_filter`",
            "search_name": "ESCU - Monitor DNS For Brand Abuse - Rule",
            "security_domain": "network",
            "story": "91c676cf-0b23-438d-abee-f6335e1fce78",
            "tags": {
                "analytics_story": [
                    "Brand Monitoring"
                ],
                "asset_type": "Endpoint",
                "kill_chain_phases": [
                    "Delivery",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "monitor_email_for_brand_abuse": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Brand Monitoring|Suspicious Emails",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-10-08",
                    "description": "This search creates permutations of your existing domains, removes the valid domain names and stores them in a specified lookup file so they can be checked for in the associated detection searches.",
                    "how_to_implement": "To successfully implement this search you need to update the file called domains.csv in the DA-ESS-SOC/lookup directory. Or `cim_corporate_email_domains.csv` and `cim_corporate_web_domains.csv` from **Splunk\\_SA\\_CIM**.",
                    "id": "19f7d2ec-6028-4d01-bcdb-bda9a034c17f",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/brand_monitoring.csv",
                            "default_match": "false",
                            "description": "A file that contains look-a-like domains for brands that you want to monitor",
                            "filename": "brand_monitoring.csv",
                            "match_type": "WILDCARD(domain)",
                            "min_matches": 1,
                            "name": "brandMonitoring_lookup"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "eval domain=trim(domain,\"*\") | search NOT[| inputlookup domains]  NOT[ |inputlookup cim_corporate_email_domain_lookup] NOT[inputlookup cim_corporate_web_domain_lookup] | eval domain=\"*\"+domain+\"*\"",
                            "description": "This macro removes valid domains from the output",
                            "name": "remove_valid_domains"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "dnstwist_domain_names_filter"
                        }
                    ],
                    "name": "DNSTwist Domain Names",
                    "search": "| dnstwist domainlist=domains.csv | `remove_valid_domains` | eval domain_abuse=\"true\" | table domain, domain_abuse | outputlookup brandMonitoring_lookup | stats count",
                    "tags": {
                        "analytics_story": [
                            "Brand Monitoring",
                            "Suspicious Emails"
                        ],
                        "detections": [
                            "Monitor Email For Brand Abuse",
                            "Monitor DNS For Brand Abuse",
                            "Monitor Web Traffic For Brand Abuse"
                        ]
                    },
                    "version": 2
                }
            ],
            "category": "Operations",
            "dashboard": "showcase_security_content?showcaseId=monitor_email_for_brand_abuse",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "Email",
            "dataset": "",
            "date": "2018-01-05",
            "description": "This search looks for emails claiming to be sent from a domain similar to one that you want to have monitored for abuse.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You need to ingest email header data. Specifically the sender's address (src_user) must be populated.  You also need to have run the search \"ESCU - DNSTwist Domain Names\", which creates the permutations of the domain that will be checked for.",
            "highlight": "No",
            "how_to_implement": "You need to ingest email header data. Specifically the sender's address (src_user) must be populated.  You also need to have run the search \"ESCU - DNSTwist Domain Names\", which creates the permutations of the domain that will be checked for.",
            "icon": "ES_Use_Case.png",
            "id": "monitor_email_for_brand_abuse",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "known_false_positives": "None at this time",
            "lookups": [
                {
                    "default_match": "false",
                    "description": "A file that contains look-a-like domains for brands that you want to monitor",
                    "filename": "brand_monitoring.csv",
                    "match_type": "WILDCARD(domain)",
                    "min_matches": 1,
                    "name": "brandMonitoring_lookup"
                }
            ],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "monitor_email_for_brand_abuse_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Monitor Email For Brand Abuse",
            "references": [],
            "released": "2018-01-05",
            "search": "| tstats `security_content_summariesonly` values(All_Email.recipient) as recipients, min(_time) as firstTime, max(_time) as lastTime from datamodel=Email by All_Email.src_user, All_Email.message_id | `drop_dm_object_name(\"All_Email\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | eval temp=split(src_user, \"@\") | eval email_domain=mvindex(temp, 1) | lookup update=true brandMonitoring_lookup domain as email_domain OUTPUT domain_abuse | search domain_abuse=true | table message_id, src_user, email_domain, recipients, firstTime, lastTime | `monitor_email_for_brand_abuse_filter`",
            "search_name": "ESCU - Monitor Email For Brand Abuse - Rule",
            "security_domain": "network",
            "story": "91c676cf-0b23-438d-abee-f6335e1fce78|2b1800dd-92f9-47ec-a981-fdf1351e5d55",
            "tags": {
                "analytics_story": [
                    "Brand Monitoring",
                    "Suspicious Emails"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "monitor_registry_keys_for_print_monitors": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Windows Registry Activities|Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=monitor_registry_keys_for_print_monitors",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "Endpoint.Registry",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1547.010/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-23",
            "description": "This search looks for registry activity associated with modifications to the registry key `HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors`. In this scenario, an attacker can load an arbitrary .dll into the print-monitor registry by giving the full path name to the after.dll. The system will execute the .dll with elevated (SYSTEM) permissions and will persist after reboot.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 5",
            "escu_nist": "PR.PT|DE.CM|PR.AC",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report registry modifications.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report registry modifications.",
            "icon": "ES_Use_Case.png",
            "id": "monitor_registry_keys_for_print_monitors",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "You will encounter noise from legitimate print-monitor registry entries.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "monitor_registry_keys_for_print_monitors_filter"
                }
            ],
            "mitre_sub_technique": "T1547.010",
            "mitre_tactic": "TA0003|TA0004",
            "mitre_tactic_display": "Persistence|Privilege Escalation",
            "mitre_technique": "T1547",
            "mitre_threat_groups": "no",
            "name": "Monitor Registry Keys For Print Monitors",
            "references": [],
            "released": "2020-11-23",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where Registry.action=modified AND Registry.registry_path=\"*CurrentControlSet\\\\Control\\\\Print\\\\Monitors*\" by Registry.dest, Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_name Registry.action | `drop_dm_object_name(Registry)` | `monitor_registry_keys_for_print_monitors_filter`",
            "search_name": "ESCU - Monitor Registry Keys for Print Monitors - Rule",
            "story": "2b1800dd-92f9-47dd-a981-fdf1351e5d55|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Suspicious Windows Registry Activities",
                    "Windows Persistence Techniques"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8",
                    "CIS 5"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1547.010/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1547"
                ],
                "mitre_attack_tactics": [
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Port Monitors"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "PR.AC"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "monitor_web_traffic_for_brand_abuse": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Brand Monitoring",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-10-08",
                    "description": "This search creates permutations of your existing domains, removes the valid domain names and stores them in a specified lookup file so they can be checked for in the associated detection searches.",
                    "how_to_implement": "To successfully implement this search you need to update the file called domains.csv in the DA-ESS-SOC/lookup directory. Or `cim_corporate_email_domains.csv` and `cim_corporate_web_domains.csv` from **Splunk\\_SA\\_CIM**.",
                    "id": "19f7d2ec-6028-4d01-bcdb-bda9a034c17f",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/brand_monitoring.csv",
                            "default_match": "false",
                            "description": "A file that contains look-a-like domains for brands that you want to monitor",
                            "filename": "brand_monitoring.csv",
                            "match_type": "WILDCARD(domain)",
                            "min_matches": 1,
                            "name": "brandMonitoring_lookup"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "eval domain=trim(domain,\"*\") | search NOT[| inputlookup domains]  NOT[ |inputlookup cim_corporate_email_domain_lookup] NOT[inputlookup cim_corporate_web_domain_lookup] | eval domain=\"*\"+domain+\"*\"",
                            "description": "This macro removes valid domains from the output",
                            "name": "remove_valid_domains"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "dnstwist_domain_names_filter"
                        }
                    ],
                    "name": "DNSTwist Domain Names",
                    "search": "| dnstwist domainlist=domains.csv | `remove_valid_domains` | eval domain_abuse=\"true\" | table domain, domain_abuse | outputlookup brandMonitoring_lookup | stats count",
                    "tags": {
                        "analytics_story": [
                            "Brand Monitoring",
                            "Suspicious Emails"
                        ],
                        "detections": [
                            "Monitor Email For Brand Abuse",
                            "Monitor DNS For Brand Abuse",
                            "Monitor Web Traffic For Brand Abuse"
                        ]
                    },
                    "version": 2
                }
            ],
            "category": "Operations",
            "dashboard": "showcase_security_content?showcaseId=monitor_web_traffic_for_brand_abuse",
            "data_source_categories": "DS014WebServer-ET01Access|DS005WebProxyRequest-ET01Requested",
            "datamodel": "Web",
            "dataset": "",
            "date": "2017-09-23",
            "description": "This search looks for Web requests to faux domains similar to the one that you want to have monitored for abuse.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You need to ingest data from your web traffic. This can be accomplished by indexing data from a web proxy, or using a network traffic analysis tool, such as Bro or Splunk Stream. You also need to have run the search \"ESCU - DNSTwist Domain Names\", which creates the permutations of the domain that will be checked for.",
            "highlight": "No",
            "how_to_implement": "You need to ingest data from your web traffic. This can be accomplished by indexing data from a web proxy, or using a network traffic analysis tool, such as Bro or Splunk Stream. You also need to have run the search \"ESCU - DNSTwist Domain Names\", which creates the permutations of the domain that will be checked for.",
            "icon": "ES_Use_Case.png",
            "id": "monitor_web_traffic_for_brand_abuse",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery",
            "known_false_positives": "None at this time",
            "lookups": "",
            "macros": [
                {
                    "definition": "lookup update=true brandMonitoring_lookup domain as urls OUTPUT domain_abuse | search domain_abuse=true",
                    "description": "This macro limits the output to only domains that are in the brand monitoring lookup file",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/brand_monitoring.csv",
                            "default_match": "false",
                            "description": "A file that contains look-a-like domains for brands that you want to monitor",
                            "filename": "brand_monitoring.csv",
                            "match_type": "WILDCARD(domain)",
                            "min_matches": 1,
                            "name": "brandMonitoring_lookup"
                        }
                    ],
                    "name": "brand_abuse_web"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "monitor_web_traffic_for_brand_abuse_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Monitor Web Traffic For Brand Abuse",
            "references": [],
            "released": "2017-09-23",
            "search": "| tstats `security_content_summariesonly` values(Web.url) as urls min(_time) as firstTime from datamodel=Web by Web.src | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `brand_abuse_web` | `monitor_web_traffic_for_brand_abuse_filter`",
            "search_name": "ESCU - Monitor Web Traffic For Brand Abuse - Rule",
            "security_domain": "network",
            "story": "91c676cf-0b23-438d-abee-f6335e1fce78",
            "tags": {
                "analytics_story": [
                    "Brand Monitoring"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "multiple_authentication_failures": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET02Failure",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects outliers in the timeseries of service or machine authentication failures per user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Multiple Authentication Failures",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "multiple_authentications": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "Detects outliers in the timeseries of service or machine authentication successes per user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1078",
            "name": "Multiple Authentications",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "multiple_box_login_errors": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects outliers in the timeseries of Box login failures per Box user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Multiple Box Login Errors",
            "released": "2.2.0",
            "searchKeywords": "dropbox google drive login log in logon log on sign",
            "usecase": "Advanced Threat Detection"
        },
        "multiple_box_logins": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects outliers in the timeseries of Box login successes per Box user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "This is too generic to map to a specific technique. ",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple Box Logins",
            "released": "2.2.0",
            "searchKeywords": "dropbox google drive login log in logon log on sign",
            "usecase": "Advanced Threat Detection"
        },
        "multiple_box_operations": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects outliers in the timeseries of Box events per user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "This is too generic to map to a specific technique.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple Box Operations",
            "released": "2.2.0",
            "searchKeywords": "dropbox google drive",
            "usecase": "Advanced Threat Detection"
        },
        "multiple_external_alarms": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Network Attack",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS012NetworkIntrusionDetection-ET01SigDetection|DS020HostIntrustionDetection-ET01SigDetected|DS004EndPointAntiMalware-ET01SigDetected|DS025IPAddressAssignment-ET01General",
            "deprecated_not_used_anymore_datasource": "DLP|IDS or IPS|Host-based IDS|Anti-Virus|Web Application Firewall",
            "description": "Detects outliers in the timeseries of external alarm per internal device.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_5",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "This is too generic to map to a specific technique. The alarms could be from various systems",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple External Alarms",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "multiple_infections_on_host": {
            "SPLEase": "Basic",
            "advancedtags": "Autobahn",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Multiple Infections on Host - Demo",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Finds hosts that have logged multiple different infections in a short period of time.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Multiple Infections on Host - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Multiple Infections on Host - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Multiple Infections on Host - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "With Symantec logs onboard, these searches should work easily. If you have a different Anti-Virus product, they should be very easy to adapt to the field names and sourcetypes for that product -- particularly if you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Travel|Technology|Government|Defense|Media|Energy|Aerospace|Chemical|Finance|Healthcare",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "knownFP": "No known false positives.",
            "mitre": "Initial Access|Execution",
            "mitre_sub_technique": "T1566.001|T1566.002",
            "mitre_tactic": "TA0001|TA0002",
            "mitre_technique": "|T1189|T1193|T1192|T1204|T1566",
            "name": "Multiple Infections on Host",
            "operationalize": "When multiple infections occur to the same host, your response plan should be the same as any malware event, just with greater urgency.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/multiple_infections_on_host.png",
            "released": "2.0.0",
            "relevance": "Viruses happen, but multiple viruses at once are a greater concern, as it could indicate an exploit kit that tries several techniques where some might succeed, or just a host with multiple unrelated viruses. Those hosts should be prioritized and investigated immediately to see what else might not have been caught.",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "multiple_logins": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects outliers in the timeseries of workstation logins per user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1078",
            "name": "Multiple Logins",
            "relatedUseCases": [
                "multiple_outgoing_connections",
                "excessive_data_transmission"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "multiple_okta_users_with_invalid_credentails_from_the_same_ip": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Okta Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=multiple_okta_users_with_invalid_credentails_from_the_same_ip",
            "data_source_categories": "VendorSpecific-Okta",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search detects Okta login failures due to bad credentials for multiple users originating from the same ip address.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "highlight": "No",
            "how_to_implement": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "icon": "ES_Use_Case.png",
            "id": "multiple_okta_users_with_invalid_credentails_from_the_same_ip",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "None",
            "known_false_positives": "A single public IP address servicing multiple legitmate users may trigger this search. In addition, the threshold of 5 distinct users may be too low for your needs. You may modify the included filter macro XXXXXXXXXXXXX to raise the threshold or except specific IP adresses from triggering this search.",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=okta_log",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "okta"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "multiple_okta_users_with_invalid_credentails_from_the_same_ip_filter"
                }
            ],
            "mitre_sub_technique": "T1078.001",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "no",
            "name": "Multiple Okta Users With Invalid Credentails From The Same IP",
            "references": "",
            "released": "2020-07-21",
            "search": "`okta` outcome.reason=INVALID_CREDENTIALS | rename client.geographicalContext.country as country, client.geographicalContext.state as state, client.geographicalContext.city as city | stats min(_time) as firstTime max(_time) as lastTime dc(user) as distinct_users values(user) as users by src_ip, displayMessage, outcome.reason, country, state, city  | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` |  search distinct_users > 5| `multiple_okta_users_with_invalid_credentails_from_the_same_ip_filter` ",
            "search_name": "ESCU - Multiple Okta Users With Invalid Credentails From The Same IP - Rule",
            "story": "9cbd34af-8f39-4476-a423-bacd126c750b",
            "tags": {
                "analytics_story": [
                    "Suspicious Okta Activity"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 16"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Default Accounts"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "multiple_outgoing_connections": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Multiple Outgoing Connections",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0010|TA0011",
            "mitre_technique": "|T1041|T1048|T1094|T1095|T1032|T1104",
            "name": "Multiple Outgoing Connections",
            "relatedUseCases": [
                "multiple_logins",
                "excessive_data_transmission"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "multiple_primary_functions_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Operations",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Multiple Primary Functions Detected",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "Unclear",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple Primary Functions Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Multiple Primary Functions Detected - Rule",
            "usecase": "Security Monitoring"
        },
        "network_change_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Operations",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS015ConfigurationManagement-ET01General",
            "deprecated_not_used_anymore_datasource": "Configuration Management",
            "description": "Detects changes to policies of the network protection devices (such as firewall policy changes).",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "",
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "|TA0005",
            "mitre_technique": "|T1089",
            "name": "Network Change Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Policy Or Configuration Change - Rule",
            "usecase": "Security Monitoring"
        },
        "network_device_rebooted": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Operations",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS015ConfigurationManagement-ET01General",
            "deprecated_not_used_anymore_datasource": "Configuration Management",
            "description": "Increases the risk score of network devices that have been rebooted.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "|TA0005",
            "mitre_technique": "|T1089",
            "name": "Network Device Rebooted",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Network Device Rebooted - Rule",
            "usecase": "Security Monitoring"
        },
        "new_cloud_provider": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|Insider Threat|Shadow IT",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Cloud Provider for User - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01RequestedWebAppAware",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "<p>Detect a user who is accessing a cloud storage provider they've never used before.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Cloud Provider for User - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Cloud Provider for User - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "New Cloud Provider for User - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Palo Alto Networks events. For this analysis, we are effectively grouping by username and app name after filtering for the category, which will give us a row for each username+appname combination. We check if the first time that has occurred was in the last day.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Energy|Aerospace|Government|Defense|Legal|Technology|Chemical|Healthcare|Telecommunications",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
            "mitre": "Exfiltration",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "|T1048|T1102",
            "name": "New Cloud Provider for User",
            "operationalize": "<p>When this search returns values, validate whether the usage of this cloud provider is permitted by your policy, and investigate to see what data is being stored there. Common allowable scenarios can be uploading into a box folder provided by a vendor for secure support file upload, which might be allowable, versus the backup of data to a personal Google drive account. Ultimately this search will generate many shades of gray, so it's prudent to understand supporting information such as the amount of data transmitted before reaching out to the employee or their manager to determine next steps.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_prompt_and_block_domain"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/new_cloud_provider.png",
            "released": "2.2.0",
            "relevance": "Data exfiltration techniques vary across the world, but certainly a very common approach taken in 2018 is to upload data to a non-corporate file storage solution. Tracking new file storage solutions end up in your environment is a key capability to track where data flows in your organization along with the adoption of Shadow IT.",
            "searchKeywords": "",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "new_container_uploaded_to_aws_ecr": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Container Implantation Monitoring and Investigation",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "AWS ECR container",
            "author": "Rod Soto, Rico Valdez, Splunk",
            "baselines": "",
            "category": "Cloud Security",
            "dashboard": "showcase_security_content?showcaseId=new_container_uploaded_to_aws_ecr",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "datamodel": "Cloud_Infrastructure.Compute",
            "dataset": "",
            "date": "2020-02-20",
            "description": "This searches show information on uploaded containers including source user, image id, source IP user type, http user agent, region, first time, last time of operation (PutImage). These searches are based on Cloud Infrastructure Data Model.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "",
            "escu_nist": "",
            "hasSearch": "Yes",
            "help": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You must also install Cloud Infrastructure data model. Please also customize the `container_implant_aws_detection_filter` macro to filter out the false positives.",
            "highlight": "No",
            "how_to_implement": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your CloudTrail inputs. You must also install Cloud Infrastructure data model. Please also customize the `container_implant_aws_detection_filter` macro to filter out the false positives.",
            "icon": "ES_Use_Case.png",
            "id": "new_container_uploaded_to_aws_ecr",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "Uploading container is a normal behavior from developers or users with access to container registry.",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "new_container_uploaded_to_aws_ecr_filter"
                }
            ],
            "mitre_sub_technique": "T1525",
            "mitre_tactic": "TA0003",
            "mitre_tactic_display": "Persistence",
            "mitre_technique": "T1525",
            "mitre_threat_groups": "no",
            "name": "New Container Uploaded To AWS Ecr",
            "references": [],
            "released": "2020-02-20",
            "search": "| tstats count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Cloud_Infrastructure.Compute where Compute.user_type!=\"AssumeRole\" AND Compute.http_user_agent=\"AWS Internal\" AND Compute.event_name=\"PutImage\" by Compute.image_id Compute.src_user Compute.src Compute.region Compute.msg Compute.user_type | `drop_dm_object_name(\"Compute\")` | `new_container_uploaded_to_aws_ecr_filter` ",
            "search_name": "ESCU - New container uploaded to AWS ECR - Rule",
            "story": "aa0e28b1-0521-4b6f-9d2a-7b87e34af246",
            "tags": {
                "analytics_story": [
                    "Container Implantation Monitoring and Investigation"
                ],
                "asset_type": "AWS ECR container",
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1525"
                ],
                "mitre_attack_tactics": [
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Implant Container Image"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "new_data_exfil_dlp_alerts": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Data Exfil DLP Alerts - Demo",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation",
            "deprecated_not_used_anymore_datasource": "DLP",
            "description": "<p>When you first seen an alert from a user who hasn't generated DLP alerts for data exfiltration before, learn about that.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Data Exfil DLP Alerts - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Data Exfil DLP Alerts - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "New Data Exfil DLP Alerts - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the first time seen search assistant. Our dataset is an anonymized collection of DLP events. For this analysis, we are filtering for data exfiltration alerts.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this rule is straightforward -- the only requirement is to be able to record which DLP alerts represent data exfiltration. That nomenclature or configuration can vary wildly from one organization to another, so this will require coordination with your DLP team. Beyond that, so long as you have a user field and a signature field defined, the search will work.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p>",
            "mitre": "Exfiltration",
            "mitre_tactic": "TA0010",
            "mitre_technique": "|TA0010",
            "name": "New Data Exfil DLP Alerts for User",
            "operationalize": "<p>Because this is a behavioral alert, you should generally not use this in isolation unless the severity of the alert or the priority of the user dictate that it is so crucial it must be looked at in isolation, or your DLP is so carefully tuned that alerts are rare. For everyone else, most alerts should only be considered when in conjunction with other alerts, via a risk aggregation mechanism in Splunk ES or the threat models in Splunk UBA.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/new_data_exfil_dlp_alerts.png",
            "released": "2.2.0",
            "relevance": "<p>When a user who normally does not generate data exfil DLP alerts suddenly starts, it is more notable than a traditional alert. For crucial rules or high privileged users, investigate these events to determine whether sensitive company intelligence is leaving the organization.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "new_domain": {
            "SPLEase": "Medium",
            "alertvolume": "Very High",
            "app": "Splunk_Security_Essentials",
            "category": "Command and Control|Data Exfiltration",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Domain - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Detects when users browse to domains never before seen in your organization.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Threat",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Domain - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Domain - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "New Domain - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the First Seen Assistant. Our example dataset is a collection of anonymized Proxy logs, where browses to a new website. Our live search looks for the same behavior, as detailed in How to Implement.",
            "highlight": "Yes",
            "howToImplement": "Implementing this search is relatively straightforward, as it expects Common Information Model compliant data. Just ingest your proxy data (or other web browsing visibility, such as stream:http or bro), and make sure there is a uri field. The only other step is to make sure that you have the URL Toolbox app installed, which allows us to parse out the domains. When scaling this search to greater volumes of data (or more frequent runs), leverage acceleration capabilities. ",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Legal|Finance|Transportation|Chemical|Government",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "knownFP": "This search will inherently be very noisy. As a percentage of total domains, in most organizations new domains are very small. If you sent all of these events to the analysts though, it would be overwhelming. As a result, there are no known false positives per say, but value of any given alert is so small that you want to treat these alerts differently from most correlation searches. These are mostly appropriate just for contextual data, or to correlate with other indicators.",
            "mitre": "Exfiltration|Command and Control",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "|T1041|T1048|T1071",
            "name": "Connection to New Domain",
            "operationalize": "These events are generally best to look at as contextual data for another event, for example uncleaned malware, new services, or unusual logins. The easiest way to accomplish this is to just record the events in a summary index, and then include searching that index as a part of your investigative actions. Enterprise Security customers can do this easily with the Risk Framework, which is effectively that -- create a risk indicator adaptive response action when saving this search, and it will then adjust the risk score of the assets involved, and show up in investigator workbench when you analyze an asset. Ultimately, to analyze the efficacy of any given alert here, we recommend looking up the domains in an Open Source Intelligence source like <a href=\"http://www.virustotal.com\" target=\"_blank\">VirusTotal</a>, <a href=\"https://www.threatcrowd.org/\" target=\"_blank\">ThreatCrowd</a>, etc.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_threat_hunting",
                "phantom_prompt_and_block_domain"
            ],
            "relatedUseCases": [
                "showcase_first_seen_domain_controller",
                "showcase_new_ad_domain"
            ],
            "released": "2.1.0",
            "relevance": "Savvy Threat Hunters always know when users browse to new domains. This can be relevant in a variety of scenario, but the primary is that when your system connects to a command and control server, or to a staging server containing malware, those are usually on unusual domains. If you believe that a host is infected, checking to see whether it hit new domains is a great indicator to check. For more information on this detection in general, check out the great blog post specifically about this detection by Splunk's own Andrew Dauria (<a href=\"https://www.splunk.com/blog/2018/01/17/finding-new-evil-detecting-new-domains-with-splunk.html\" target=\"_blank\">link</a>).",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "new_privileged_user": {
            "SPLEase": "Basic",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|Privilege Escalation",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New User Taking Privileged Actions - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "Record when a user who hasn't taken privileged actions before suddenly starts.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New User Taking Privileged Actions - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New User Taking Privileged Actions - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "New User Taking Privileged Actions - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search Assistant. Our demo dataset is a list of anonymized Windows events with the EventCode and the tags (which come from the technology add-ons).</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this search depends on one key component -- privileged events. Generating the privileged events is relatively straightforward to get started with as many TAs will define privileged actions by default. You can start by searching out this information with just tag=privileged. Once you have defined privileged events, the First Time Search Assistant makes the rest of the detection very easy to implement.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Energy|Travel|Healthcare",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "knownFP": "The #1 scenario when this alerts falsely is when the events themselves are incorrectly marked with tag=privileged. The Windows TA defines what eventtypes (basically, micro-searches that we evaluate every time you click the search button) is privileged in a file called tags.conf. You can always tune this set of tags, though it's probably easier to just add NOT EventCode=XXXX to block out the event IDs that you don't find valuable.",
            "mitre": "Privilege Escalation",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_technique": "|T1078|T1136",
            "name": "New User Taking Privileged Actions",
            "operationalize": "When this alert fires, you should first analyze whether this particular event is one that you would not expect the user to be able to do with their existing permissions. If that's the case, analyze the groups that the user is a member of, or see if there's a local account with the same username that might be the source of these rights. Evaluate whether this is allowable or not.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/new_privileged_user.png",
            "released": "2.2.0",
            "relevance": "Most larger organizations have strict controls to look for users enacting privileged actions. While most (maybe all!) users who suddenly start taking privileged actions will be legitimate, there is always a certain degree of risk associated with a user who suddenly begins exercising privileged rights they've long had, or uses new rights. Combine these events with other risky behavior to detect users who should be analyzed by your Insider or SOC team.",
            "searchKeywords": "",
            "usecase": "Compliance|Insider Threat"
        },
        "new_user_account_created_on_multiple_hosts": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Lateral Movement|Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS006UserActivity-ET03Create|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Audit Trail|Vendor-Specific Data",
            "description": "Alerts when numerous new accounts are created for a username accounts multiple hosts.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0003",
            "mitre_technique": "|T1078|T1136",
            "name": "New User Account Created On Multiple Hosts",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Anomalous User Account Creation - Rule",
            "usecase": "Security Monitoring"
        },
        "no_windows_updates_in_a_time_frame": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Monitor for Updates",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Compliance",
            "dashboard": "showcase_security_content?showcaseId=no_windows_updates_in_a_time_frame",
            "data_source_categories": "DS019PatchManagement-Applied",
            "datamodel": "Updates",
            "dataset": "",
            "date": "2017-09-15",
            "description": "This search looks for Windows endpoints that have not generated an event indicating a successful Windows update in the last 60 days. Windows updates are typically released monthly and applied shortly thereafter. An endpoint that has not successfully applied an update in this time frame indicates the endpoint is not regularly being patched for some reason.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 18",
            "escu_nist": "PR.PT|PR.MA",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, it requires that the 'Update' data model is being populated. This can be accomplished by ingesting Windows events or the Windows Update log via a universal forwarder on the Windows endpoints you wish to monitor. The Windows add-on should be also be installed and configured to properly parse Windows events in Splunk. There may be other data sources which can populate this data model, including vulnerability management systems.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, it requires that the 'Update' data model is being populated. This can be accomplished by ingesting Windows events or the Windows Update log via a universal forwarder on the Windows endpoints you wish to monitor. The Windows add-on should be also be installed and configured to properly parse Windows events in Splunk. There may be other data sources which can populate this data model, including vulnerability management systems.",
            "icon": "ES_Use_Case.png",
            "id": "no_windows_updates_in_a_time_frame",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "None",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "no_windows_updates_in_a_time_frame_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "No Windows Updates In A Time Frame",
            "references": [],
            "released": "2017-09-15",
            "search": "| tstats `security_content_summariesonly` max(_time) as lastTime from datamodel=Updates where Updates.status=Installed Updates.vendor_product=\"Microsoft Windows\" by Updates.dest Updates.status Updates.vendor_product | rename Updates.dest as Host | rename Updates.status as \"Update Status\" | rename Updates.vendor_product as Product | eval isOutlier=if(lastTime <= relative_time(now(), \"-60d@d\"), 1, 0)  | `security_content_ctime(lastTime)`  | search isOutlier=1 | rename lastTime as \"Last Update Time\", | table Host, \"Update Status\", Product, \"Last Update Time\" | `no_windows_updates_in_a_time_frame_filter`",
            "search_name": "ESCU - No Windows Updates in a time frame - Rule",
            "security_domain": "endpoint",
            "story": "9ef8d677-7b52-4213-a038-99cfc7acc2d8",
            "tags": {
                "analytics_story": [
                    "Monitor for Updates"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 18"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "PR.MA"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Compliance",
            "version": 1
        },
        "o365_suspicious_admin_email_forwarding": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Office 365 Detections",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Office 365",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=o365_suspicious_admin_email_forwarding",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.003/o365_email_forwarding_rule/o365_email_forwarding_rule.json"
            ],
            "date": "2020-12-16",
            "description": "This search detects when an admin configured a forwarding rule for multiple mailboxes to the same destination.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "o365_suspicious_admin_email_forwarding",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=o365:management:activity",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "o365_management_activity"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "o365_suspicious_admin_email_forwarding_filter"
                }
            ],
            "mitre_sub_technique": "T1114.003",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1114",
            "mitre_threat_groups": "no",
            "name": "O365 Suspicious Admin Email Forwarding",
            "references": "",
            "released": "2020-12-16",
            "search": "`o365_management_activity` Operation=Set-Mailbox | spath input=Parameters | rename Identity AS src_user | search ForwardingAddress=* | stats dc(src_user) AS count_src_user earliest(_time) as firstTime latest(_time) as lastTime values(src_user) AS src_user values(user) AS user by ForwardingAddress | where count_src_user > 1 |`security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` |`o365_suspicious_admin_email_forwarding_filter`",
            "search_name": "ESCU - O365 Suspicious Admin Email Forwarding - Rule",
            "story": "1a51dd71-effc-48b2-abc4-3e9cdb61e5b9",
            "tags": {
                "analytics_story": [
                    "Office 365 Detections"
                ],
                "asset_type": "Office 365",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.003/o365_email_forwarding_rule/o365_email_forwarding_rule.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1114"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Email Forwarding Rule"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "o365_suspicious_rights_delegation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Office 365 Detections",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Office 365",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=o365_suspicious_rights_delegation",
            "data_source_categories": "Other",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.002/suspicious_rights_delegation/suspicious_rights_delegation.json"
            ],
            "date": "2020-12-15",
            "description": "This search detects the assignment of rights to accesss content from another mailbox. This is usually only assigned to a service account.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "o365_suspicious_rights_delegation",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Service Accounts",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=o365:management:activity",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "o365_management_activity"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "o365_suspicious_rights_delegation_filter"
                }
            ],
            "mitre_sub_technique": "T1114.002",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1114",
            "mitre_threat_groups": "APT1|FIN4|APT28|Dragonfly 2.0|Ke3chang|Leafminer",
            "name": "O365 Suspicious Rights Delegation",
            "references": "",
            "released": "2020-12-15",
            "search": "`o365_management_activity` Operation=Add-MailboxPermission | spath input=Parameters | rename User AS src_user, Identity AS dest_user | search AccessRights=FullAccess OR AccessRights=SendAs OR AccessRights=SendOnBehalf | stats count earliest(_time) as firstTime latest(_time) as lastTime by user src_user dest_user Operation AccessRights |`security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` |`o365_suspicious_rights_delegation_filter`",
            "search_name": "ESCU - O365 Suspicious Rights Delegation - Rule",
            "story": "1a51dd71-effc-48b2-abc4-3e9cdb61e5b9",
            "tags": {
                "analytics_story": [
                    "Office 365 Detections"
                ],
                "asset_type": "Office 365",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.002/suspicious_rights_delegation/suspicious_rights_delegation.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT1",
                    "FIN4",
                    "APT28",
                    "Dragonfly 2.0",
                    "Ke3chang",
                    "Leafminer"
                ],
                "mitre_attack_id": [
                    "T1114"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Remote Email Collection"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "o365_suspicious_user_email_forwarding": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Office 365 Detections",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Office 365",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=o365_suspicious_user_email_forwarding",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.003/o365_email_forwarding_rule/o365_email_forwarding_rule.json"
            ],
            "date": "2020-12-16",
            "description": "This search detects when multiple user configured a forwarding rule to the same destination.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP|DE.AE",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "o365_suspicious_user_email_forwarding",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=o365:management:activity",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "o365_management_activity"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "o365_suspicious_user_email_forwarding_filter"
                }
            ],
            "mitre_sub_technique": "T1114.003",
            "mitre_tactic": "TA0009",
            "mitre_tactic_display": "Collection",
            "mitre_technique": "T1114",
            "mitre_threat_groups": "no",
            "name": "O365 Suspicious User Email Forwarding",
            "references": "",
            "released": "2020-12-16",
            "search": "`o365_management_activity` Operation=Set-Mailbox | spath input=Parameters | rename Identity AS src_user | search ForwardingSmtpAddress=* | stats dc(src_user) AS count_src_user earliest(_time) as firstTime latest(_time) as lastTime values(src_user) AS src_user values(user) AS user by ForwardingSmtpAddress | where count_src_user > 1 |`security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` |`o365_suspicious_user_email_forwarding_filter`",
            "search_name": "ESCU - O365 Suspicious User Email Forwarding - Rule",
            "story": "1a51dd71-effc-48b2-abc4-3e9cdb61e5b9",
            "tags": {
                "analytics_story": [
                    "Office 365 Detections"
                ],
                "asset_type": "Office 365",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.003/o365_email_forwarding_rule/o365_email_forwarding_rule.json"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1114"
                ],
                "mitre_attack_tactics": [
                    "Collection"
                ],
                "mitre_attack_technique": [
                    "Email Forwarding Rule"
                ],
                "nist": [
                    "DE.DP",
                    "DE.AE"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "okta_account_lockout_events": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Okta Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=okta_account_lockout_events",
            "data_source_categories": "VendorSpecific-Okta",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "Detect Okta user lockout events",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "highlight": "No",
            "how_to_implement": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "icon": "ES_Use_Case.png",
            "id": "okta_account_lockout_events",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "None",
            "known_false_positives": "None. Account lockouts should be followed up on to determine if the actual user was the one who caused the lockout, or if it was an unauthorized actor.",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=okta_log",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "okta"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "okta_account_lockout_events_filter"
                }
            ],
            "mitre_sub_technique": "T1078.001",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "no",
            "name": "Okta Account Lockout Events",
            "references": "",
            "released": "2020-07-21",
            "search": "`okta` displayMessage=\"Max sign in attempts exceeded\" | rename client.geographicalContext.country as country, client.geographicalContext.state as state, client.geographicalContext.city as city | table _time, user, country, state, city, src_ip | `okta_account_lockout_events_filter` ",
            "search_name": "ESCU - Okta Account Lockout Events - Rule",
            "story": "9cbd34af-8f39-4476-a423-bacd126c750b",
            "tags": {
                "analytics_story": [
                    "Suspicious Okta Activity"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 16"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Default Accounts"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "okta_failed_sso_attempts": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Okta Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=okta_failed_sso_attempts",
            "data_source_categories": "VendorSpecific-Okta",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "Detect failed Okta SSO events",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "highlight": "No",
            "how_to_implement": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "icon": "ES_Use_Case.png",
            "id": "okta_failed_sso_attempts",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "None",
            "known_false_positives": "There may be a faulty config preventing legitmate users from accessing apps they should have access to.",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=okta_log",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "okta"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "okta_failed_sso_attempts_filter"
                }
            ],
            "mitre_sub_technique": "T1078.001",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "no",
            "name": "Okta Failed Sso Attempts",
            "references": "",
            "released": "2020-07-21",
            "search": "`okta` displayMessage=\"User attempted unauthorized access to app\" | stats  min(_time) as firstTime max(_time) as lastTime values(app) as Apps count by user, result ,displayMessage, src_ip | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `okta_failed_sso_attempts_filter` ",
            "search_name": "ESCU - Okta Failed SSO Attempts - Rule",
            "story": "9cbd34af-8f39-4476-a423-bacd126c750b",
            "tags": {
                "analytics_story": [
                    "Suspicious Okta Activity"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 16"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Default Accounts"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "okta_user_logins_from_multiple_cities": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Okta Activity",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Infrastructure",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=okta_user_logins_from_multiple_cities",
            "data_source_categories": "VendorSpecific-Okta",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search detects logins from the same user from different states in a 24 hour period.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "highlight": "No",
            "how_to_implement": "This search is specific to Okta and requires Okta logs are being ingested in your Splunk deployment.",
            "icon": "ES_Use_Case.png",
            "id": "okta_user_logins_from_multiple_cities",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "None",
            "known_false_positives": "Users in your enviornment may legitmately be travelling and loggin in from different locations. This search is useful for those users that should *not* be travelling for some reason, such as the COVID-19 pandemic. The search also relies on the geographical information being populated in the Okta logs. It is also possible that a connection from another region may be attributed to a login from a remote VPN endpoint.",
            "lookups": "",
            "macros": [
                {
                    "definition": "eventtype=okta_log",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "okta"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "okta_user_logins_from_multiple_cities_filter"
                }
            ],
            "mitre_sub_technique": "T1078.001",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "no",
            "name": "Okta User Logins From Multiple Cities",
            "references": "",
            "released": "2020-07-21",
            "search": "`okta` displayMessage=\"User login to Okta\" client.geographicalContext.city!=null | stats min(_time) as firstTime max(_time) as lastTime dc(client.geographicalContext.city) as locations values(client.geographicalContext.city) as cities values(client.geographicalContext.state) as states by user | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `okta_user_logins_from_multiple_cities_filter` | search locations > 1",
            "search_name": "ESCU - Okta User Logins From Multiple Cities - Rule",
            "story": "9cbd34af-8f39-4476-a423-bacd126c750b",
            "tags": {
                "analytics_story": [
                    "Suspicious Okta Activity"
                ],
                "asset_type": "Infrastructure",
                "cis20": [
                    "CIS 16"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Default Accounts"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "old_passwords": {
            "SPLEase": "Basic",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Compliance|GDPR",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Old Passwords In Use - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detect active accounts with passwords that haven't been updated in more than 120 days.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Old Passwords In Use - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "Using LDAPSearch",
                    "name": "Old Passwords In Use - LDAPSearch"
                },
                {
                    "label": "Using CSV File",
                    "name": "Old Passwords In Use - CSV"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search Assistant. Our dataset is the anonymized output of running an LDAP Search against a typical domain, pulling out a set of AD attributes. There are several ways to pull this data from live environments, including the Live Search listed below.</p>",
            "highlight": "No",
            "howToImplement": "<p>There are multiple approaches for pulling Active Directory data:<ul><li>Using the Supporting Add-on for Active Directory (aka SA-ldapsearch) which provides the ldapsearch command -- recommended for on premises installations in organizations with fewer than 50,000 users (<a href=\"https://splunkbase.splunk.com/app/1151/\" target=\"_blank\">app link</a>, <a href=\"http://docs.splunk.com/Documentation/SA-LdapSearch/2.1.6/User/AbouttheSplunkSupportingAdd-onforActiveDirectory\" target=\"_blank\">docs link</a>).</li><li>Using data from AD Monitor, which is the Splunk Universal Forwarder's ability to monitor Active Directory for changes -- recommended for large organizations, and for Cloud environments (<a href=\"http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorActiveDirectory\" target=\"_blank\">doc link</a>).</li><li>Using a Powershell script to query Active Directory for this data (<a href=\"https://gallery.technet.microsoft.com/scriptcenter/Powershell-script-to-5edcdaea\" target=\"_blank\">link</a>).</li></ul></p><p>Once the data is ingested, select the search option that matches your data type, and the rest should flow smoothly. The only other consideration you may wish to employ is scheduling the search with throttling on the username, so that while you run the search daily, you don't get repeated alerts. Enterprise Security customers can leverage the suppression rules for more granular control, specifying an event-specific (and so account-specific) suppression period, but all customers can opt to only alert once per week/month/etc, to avoid duplicate alerts.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Energy|Healthcare",
            "journey": "Stage_1",
            "killchain": "",
            "knownFP": "Whether this search generates false positives or not is generally dependent upon your organization's security policy. Some organizations are permissive of service accounts that have older passwords -- this is discouraged by security best practices and many auditors, but it could be permissible. The only scenario where this detection might not function as expected is when the authentication doesn't update the lastLogonTimestamp parameter in Active Directory -- this occurs most frequently for systems that don't authenticate through the standard Windows mechanism (such as Linux systems connecting to Identity Management for Unix). In that scenario, it is prudent to employ basic checks for just old passwords, ignoring the last use timestamp.",
            "mitre": "Credential Access",
            "mitre_notes": "Cyber hygiene to change passwords",
            "mitre_tactic": "TA0006",
            "mitre_technique": "|T1110",
            "name": "Old Passwords in Use",
            "operationalize": "When this search fires, the first thing to do is to determine based on policy whether the account with an old password is expected. If it is, add it to the account whitelist. If it is not, work with the account owner to change the password and update any systems that may be using the saved password.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/old_passwords_in_use.png",
            "released": "2.1.0",
            "relevance": "Accounts that have out-dated passwords leave an organization subject to brute force, or exposed to abuse from ex-employees. It is best practice to change passwords every ninety days for most organizations -- this search will look through Active Directory for accounts with out-of-date passwords.",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Compliance"
        },
        "open_redirect_in_splunk_web": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Splunk Enterprise Vulnerability",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Splunk Server",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Web Attack",
            "dashboard": "showcase_security_content?showcaseId=open_redirect_in_splunk_web",
            "data_source_categories": "VendorSpecific-SplunkInternal",
            "datamodel": "",
            "dataset": "",
            "date": "2017-09-19",
            "description": "This search allows you to look for evidence of exploitation for CVE-2016-4859, the Splunk Open Redirect Vulnerability.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 4|CIS 18",
            "escu_nist": "ID.RA|RS.MI|PR.PT|PR.AC|PR.IP|DE.CM",
            "hasSearch": "Yes",
            "help": "No extra steps needed to implement this search.",
            "highlight": "No",
            "how_to_implement": "No extra steps needed to implement this search.",
            "icon": "ES_Use_Case.png",
            "id": "open_redirect_in_splunk_web",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "open_redirect_in_splunk_web_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Open Redirect In Splunk Web",
            "references": [],
            "released": "2017-09-19",
            "search": "index=_internal sourcetype=splunk_web_access return_to=\"/%09/*\" | `open_redirect_in_splunk_web_filter`",
            "search_name": "ESCU - Open Redirect in Splunk Web - Rule",
            "security_domain": "network",
            "story": "4e692b96-de2d-4bd1-9105-37e2368a8db1",
            "tags": {
                "analytics_story": [
                    "Splunk Enterprise Vulnerability"
                ],
                "asset_type": "Splunk Server",
                "cis20": [
                    "CIS 3",
                    "CIS 4",
                    "CIS 18"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.RA",
                    "RS.MI",
                    "PR.PT",
                    "PR.AC",
                    "PR.IP",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Application Security",
            "version": 1
        },
        "osquery_pack_-_coldroot_detection": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "ColdRoot MacOS RAT",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=osquery_pack_-_coldroot_detection",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Alerts.Alerts",
            "dataset": "",
            "date": "2019-01-29",
            "description": "This search looks for ColdRoot events from the osx-attacks osquery pack.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 4|CIS 8",
            "escu_nist": "DE.DP|DE.CM|PR.PT",
            "hasSearch": "Yes",
            "help": "In order to properly run this search, Splunk needs to ingest data from your osquery deployed agents with the [osx-attacks.conf](https://github.com/facebook/osquery/blob/experimental/packs/osx-attacks.conf#L599) pack enabled. Also the [TA-OSquery](https://github.com/d1vious/TA-osquery) must be deployed across your indexers and universal forwarders in order to have the osquery data populate the Alerts data model",
            "highlight": "No",
            "how_to_implement": "In order to properly run this search, Splunk needs to ingest data from your osquery deployed agents with the [osx-attacks.conf](https://github.com/facebook/osquery/blob/experimental/packs/osx-attacks.conf#L599) pack enabled. Also the [TA-OSquery](https://github.com/d1vious/TA-osquery) must be deployed across your indexers and universal forwarders in order to have the osquery data populate the Alerts data model",
            "icon": "ES_Use_Case.png",
            "id": "osquery_pack_-_coldroot_detection",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Command and Control",
            "known_false_positives": "There are no known false positives.",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "osquery_pack___coldroot_detection_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Osquery Pack - Coldroot Detection",
            "references": [],
            "released": "2019-01-29",
            "search": "| from datamodel Alerts.Alerts | search app=osquery:results (name=pack_osx-attacks_OSX_ColdRoot_RAT_Launchd OR name=pack_osx-attacks_OSX_ColdRoot_RAT_Files) | rename columns.path as path | bucket _time span=30s | stats count(path) by _time, host, user, path | `osquery_pack___coldroot_detection_filter`",
            "search_name": "ESCU - Osquery pack - ColdRoot detection - Rule",
            "security_domain": "threat",
            "story": "bd91a2bc-d20b-4f44-a982-1bea98e86390",
            "tags": {
                "analytics_story": [
                    "ColdRoot MacOS RAT"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 4",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Command and Control"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP",
                    "DE.CM",
                    "PR.PT"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "outbound_emails_from_scanners": {
            "SPLEase": "Hard",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "<p>Detect scanners (or systems that look like scanners) that send data to external systems instead of to your internal users.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": " - Demo"
                },
                {
                    "label": "Live Data",
                    "name": " - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": " - Accelerated"
                }
            ],
            "hasSearch": "No",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of email logs. For this analysis, we are working to track emails from scanners.</p>",
            "highlight": "No",
            "howToImplement": "<p>This search leverages a lookup to keep a behavioral baseline to track how often a host has sent out documents externally in the past, and to track what percentage of emails have attachments. We combine that baseline with the most recent data to alert on devices that are now sending out large volumes of external emails. To implement this search, you need only have email data ingested, with valid attachments.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "",
            "knownFP": "<p>This search has a behavioral component, which means it may catch types of devices that aren't explicitly scanners (or other multi-function devices).</p>",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Outbound Emails from Scanners",
            "operationalize": "<p>Troubleshooting this alert can be very difficult because it's often difficult to know what documents are sent out, and who actually sent them. The process of responding will vary greatly based on factors, but at a high level you should consider attempting to see what documents are actually sent to determine whether they're sensitive or not, and also to see if they provide any indication of who is sending them (e.g., \"Report Generated by John Smith\"). If they are sensitive and there's no indication of who sent them, then look for users printing to that device around the same time, or consult physical security. It's often easiest to just prevent these devices from sending to external destinations to close the gap moving forward.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/outbound_emails_from_scanners.png",
            "released": "2.2.0",
            "relevance": "<p>Particularly in organizations where users don't need to authenticate to a Multi-Function Device (or any scanner), an easy way to send sensitive data outbound without leaving any traces can be to configure a scanner to send a document out to a personal email address. There's no telltale filename that admins can search, oftentimes there are no strings that a DLP can search (without using OCR), and it's not tied to your account. While these alerts can be difficult to track, detecting one of these devices that suddenly starts sending large volumes of sensitive data outbound can be cause for investigation.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "outbreak_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Lateral Movement|Endpoint Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when a potential outbreak is observed based on newly infected systems all exhibiting the same infection",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|TA0002",
            "name": "Outbreak Detected",
            "relatedUseCases": [
                "showcase_first_usb",
                "unusual_usb_activity",
                "Basic_Malware_Outbreak",
                "UC0029"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Outbreak Observed - Rule",
            "usecase": "Security Monitoring"
        },
        "outdated_malware_definitions": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Operations|Compliance|Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Outdated Malware Definitions - Demo",
            "data_source_categories": "DS004EndPointAntiMalware-ET02UpdatedSig|DS004EndPointAntiMalware-ET03UpdatedEng",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Looks for Symantec AV systems where we see Symantec AV events, but don't see a malware definition update in the last few days.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Outdated Malware Definitions - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Outdated Malware Definitions - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
            "highlight": "No",
            "howToImplement": "This particular search usually finds most of its success with just Symantec AV. Many Anti-Virus products are found to provide insufficient logging to be able to see when the definitions are updated (often, just when there is malware found). If you are using Symantec AV and followed the data onboarding guide, this should work automatically. If you did not follow the data onboarding guide, make sure that your sourcetypes and indexes match. Always hard-code your sourcetypes and indexes rather than doing index=* in searches.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "knownFP": "No known false positives at this time.",
            "mitre": "",
            "mitre_notes": "Cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Outdated Malware Definitions",
            "operationalize": "When this fires, look on the host to see why the Anti-Virus isn't updating. If you don't see an obvious reason (e.g., specific and logical error), then it may be worth investigating that host to see if there are any other suspicious events that have occurred to rule out an infection.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/outdated_malware_definitions.png",
            "released": "2.0.0",
            "relevance": "This indicates that a host is not updating its anti-virus definitions, which can be an operational concern (e.g., anti-virus isn't working), or it could be an indication that updates have been shut off by malware itself. Regardless, it is something to fix.",
            "searchKeywords": "",
            "similarUseCases": [
                "UC0030",
                "high_number_of_hosts_not_updating_malware_signatures",
                ""
            ],
            "usecase": "Security Monitoring"
        },
        "overwriting_accessibility_binaries": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Privilege Escalation",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=overwriting_accessibility_binaries",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.008/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "Microsoft Windows contains accessibility features that can be launched with a key combination before a user has logged in. An adversary can modify or replace these programs so they can get a command prompt or backdoor without logging in to the system. This search looks for modifications to these binaries.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "overwriting_accessibility_binaries",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Microsoft may provide updates to these binaries. Verify that these changes do not correspond with your normal software update cycle.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "overwriting_accessibility_binaries_filter"
                }
            ],
            "mitre_sub_technique": "T1546.008",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_tactic_display": "Privilege Escalation|Persistence",
            "mitre_technique": "T1546",
            "mitre_threat_groups": "APT41|APT3|APT29|Deep Panda|Axiom",
            "name": "Overwriting Accessibility Binaries",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem where (Filesystem.file_path=*\\\\Windows\\\\System32\\\\sethc.exe* OR Filesystem.file_path=*\\\\Windows\\\\System32\\\\utilman.exe* OR Filesystem.file_path=*\\\\Windows\\\\System32\\\\osk.exe* OR Filesystem.file_path=*\\\\Windows\\\\System32\\\\Magnify.exe* OR Filesystem.file_path=*\\\\Windows\\\\System32\\\\Narrator.exe* OR Filesystem.file_path=*\\\\Windows\\\\System32\\\\DisplaySwitch.exe* OR Filesystem.file_path=*\\\\Windows\\\\System32\\\\AtBroker.exe*) by Filesystem.file_name Filesystem.dest | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `overwriting_accessibility_binaries_filter`",
            "search_name": "ESCU - Overwriting Accessibility Binaries - Rule",
            "story": "644e22d3-598a-429c-a007-16fdb802cae5",
            "tags": {
                "analytics_story": [
                    "Windows Privilege Escalation"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.008/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT41",
                    "APT3",
                    "APT29",
                    "Deep Panda",
                    "Axiom"
                ],
                "mitre_attack_id": [
                    "T1546"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Accessibility Features"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "period_with_unusual_ad_activity_sequences": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Correlates the rate of subtle changes in Active Directory behavior for each account. The correlation happens with: (a) each account's historic profile, and (b) with the activity of other accounts in the enterprise.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0003|TA0004|TA0001",
            "mitre_technique": "|T1078",
            "name": "Period with Unusual Windows Security Event Sequences",
            "released": "2.0.0",
            "searchKeywords": "markov markovchain chain",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "personally_identifiable_information_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Compliance|Insider Threat|Data Exfiltration|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects personally identifiable information (PII) in log files. Some software can inadvertently provide sensitive information in log files, resulting in potential exposure to those reviewing the log files.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Audit",
            "gdprtext": "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "mitre": "",
            "mitre_notes": "Not an attacker technique.  More for compliance.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Personally Identifiable Information Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Audit - Personally Identifiable Information Detection - Rule",
            "usecase": "Compliance|Insider Threat"
        },
        "phantom_covid_19_indicator_check": {
            "additional_context": [
                {
                    "detail": "Full details on how to implement this use case can be found in the Splunk Blog \"Integrating COVID (or Any) Threat Indicators with MISP and Splunk Enterprise Security\". Use the link below to get the full details. ",
                    "link": "https://www.splunk.com/en_us/blog/security/the-easy-guide-to-adding-covid-19-context-to-any-process.html",
                    "open_panel": true,
                    "title": "The Easy Guide to Adding COVID-19 Context to Any Process"
                }
            ],
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Threat Intelligence",
            "dashboard": "showcase_phantom?showcaseId=phantom_covid_19_indicator_check",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic",
            "description": "The playbook is a self-contained set of actions that takes MD5 file hashes, IPs, domains, and URLs as input. It then leverages the lookups in Splunk provided by TA-covidIOCs to determine if the indicators from the Phantom event are COVID-related.",
            "displayapp": "Splunk Phantom",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and import the playbook from the Splunk Phantom GitHub repo",
            "highlight": "Yes",
            "howToImplement": "",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "COVID-19 Indicator Check",
            "operationalize": "This playbook takes MD5 file hashes, IPs, domains, and URLs as input. It then leverages the lookups in Splunk provided by TA-covidIOCs to determine if the indicators from the Phantom event are COVID-related. If matches are found the playbook will add the matched indicators to HUD Cards by category (URLs, Hashes, IPs, Domains). Additionally, an artifact field \"covid_related = yes\" will be added to the artifact from where the indicator came",
            "printable_image": "https://www.splunk.com/content/dam/splunk-blogs/images/2020/04/playbook_screenshot.png",
            "released": "3.1.1",
            "relevance": "This is a great example of a playbook that is modular in design and can be incorporated into most existing playbooks as a subplaybook.",
            "searchKeywords": "covid covid-19 corona ioc threat intel blog phantom",
            "usecase": "Security Monitoring|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://www.splunk.com/content/dam/splunk-blogs/images/2020/04/playbook_screenshot.png",
                    "title": "COVID-19 Indicator Check",
                    "type": "image"
                }
            ]
        },
        "phantom_ec2_instance_isolation": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Account Compromise|IAM Analytics|Account Sharing|SaaS|Insider Threat|Cloud Security",
            "dashboard": "showcase_phantom?showcaseId=phantom_ec2_instance_isolation",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Isolate an EC2 instance by changing its security group in order to protect it from malicious traffic. This playbook can be started alone or used from another playbook after doing investigation and notification.",
            "displayapp": "Splunk Phantom",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "This playbook can be triggered off of several example searches available in the Security Essentials app to take immediate action to quarantine an instance when suspicious behavior has been detected.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "EC2 Instance Isolation",
            "operationalize": "Depending on the use case, this playbook can be modified using several of the available Phantom apps to increase the scope of the actions taken in this playbook. For example using the AWS WAF or AWS IAM app, additional actions can be added based on the type of alert triggered.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/ec2_instance_isolation.png",
            "released": "3.0.0",
            "relevance": "Compromised AWS credentials can allow a malicious actor access to currently running instances and configurations as well as the ability to start new instances and services. By detecting suspicious behavior early this playbook allows for a security team to react quickly and further investigate any suspicious behavior.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/ec2_instance_isolation.png",
                    "title": "EC2 Instance Isolation",
                    "type": "image"
                }
            ]
        },
        "phantom_ip_investigate_report": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Command and Control|Endpoint Compromise|Data Exfiltration|SaaS|Cloud Security",
            "dashboard": "showcase_phantom?showcaseId=phantom_ip_investigate_report",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "This playbook executes multiple investigative actions to determine if an IP address is malicious and sends a summary of the output in an email.",
            "displayapp": "Splunk Phantom",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "There are multiple searches that can be used in conjunction with this playbook. Using an IP address the playbook performs a number of investigative steps before sending a notification via email.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "IP Investigate and Report",
            "operationalize": "Using the ingested alerts, events can be investigated to get additional contextual information about the artifacts in the alerts. Notice that the playbook will also attempt to find any malicious domains associated with an IP. This data can be used with other playbooks to take action or automate threat hunting. Additional actions to consider adding would be a sandbox action to visit any domains discovered to get further details.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/ip_investigate_and_report.png",
            "released": "3.0.0",
            "relevance": "Using this playbook to investigate an IP address security teams can quickly assess whether or not an IP is malicious as well as additional information if there are any domains pointing at it.",
            "searchKeywords": "",
            "usecase": "Security Monitoring|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/ip_investigate_and_report.png",
                    "title": "IP Investigate and Report",
                    "type": "image"
                }
            ]
        },
        "phantom_malicious_insider_containment": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Account Compromise|IAM Analytics|Account Sharing|SaaS|Insider Threat|Cloud Security",
            "dashboard": "showcase_phantom?showcaseId=phantom_malicious_insider_containment",
            "data_source_categories": "VendorSpecific-aws-cloudtrail",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "This playbook demonstrates an automated response plan to handling malicious insiders within the environment.",
            "displayapp": "Splunk Phantom",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "This playbook can be triggered off of any alert that has a user account that needs to be investigated further. A prompt in the playbook allows an analyst to review the alert and information about the user before deciding on how to proceed.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "Malicious Insider Containment",
            "operationalize": "Although this playbook has actions for Active Directory, it can be easily modified to support investigating users in other systems such as AWS.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/malicious_insider_containment.png",
            "released": "3.0.0",
            "relevance": "An insider threat can range from current employees to contractors, and even former employees that have not had their account access disabled. By detecting suspicious behavior and allowing an analyst to review the alert and user information a decision can be made for how to handle the alert raised.",
            "searchKeywords": "",
            "usecase": "Insider Threat|Security Monitoring|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/malicious_insider_containment.png",
                    "title": "Malicious Insider Containment",
                    "type": "image"
                }
            ]
        },
        "phantom_malware_investigation": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Endpoint Compromise|Lateral Movement",
            "dashboard": "showcase_phantom?showcaseId=phantom_malware_investigation",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "This playbook investigates and remediates malware infections on the endpoint.",
            "displayapp": "Splunk Phantom",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "This playbook starts by performing a reputation lookup against a potentially malicious file hash. Based on the output from the reputation lookup a decision is made on one of two possible branches of actions in the playbook where additional containment actions are performed.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "Malware Investigation",
            "operationalize": "Typically this playbook would be triggered for any suspicious or confirmed malicious processes that require further evaluation. By default the playbook uses a file hash from an alert but can be modified to get a copy of the file off of the endpoint based off of a specified file path. This file can then be detonated in a sandbox to observe it's behavior and get additional contextual information about the file.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/investigate.png",
            "released": "3.0.0",
            "relevance": "Investigating and responding to malware alerts can take 30+ minutes. By automating this investigation and response Phantom validates that the process is malicious and takes immediate action to block the hash on the infected endpoints.",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Advanced Threat Detection|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/investigate.png",
                    "title": "Malware Investigation",
                    "type": "image"
                }
            ]
        },
        "phantom_phishing_remediation_investigation": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Phishing|Adversary Tactics|Account Compromise",
            "dashboard": "showcase_phantom?showcaseId=phantom_phishing_remediation_investigation",
            "data_source_categories": "DS001MAIL-ET02Receive",
            "deprecated_not_used_anymore_datasource": "Email|Vendor-Specific Data",
            "description": "This playbook investigates and remediates phishing emails with Admin approval.",
            "displayapp": "Splunk Phantom",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "This playbook examines the artifacts from an ingested email and performs various reputation checks against the data present. Additional decisions are triggered if further contextual data is needed, i.e. detonating an attachment in a sandbox if there is no information returned from a file reputation lookup. Ultimately this playbook will prompt an analyst with the output from the reputation lookups and let them decide whether or not the email should be deleted.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "Phishing Investigation and Response",
            "operationalize": "A phishing investigation in Phantom is typically triggered by ingesting emails from a specific inbox that users can forward suspicious emails to. This playbook can also be used with email gateways to investigate the output of any suspicious emails.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/phishing_investigate_and_respond.png",
            "released": "3.0.0",
            "relevance": "Phishing emails can be detrimental to an organization if not detected. Investigating each email can be time consuming as an analyst may need to investigate what is in the body of the email, but also the attachments, as well as any users that may have received the email. By automating the investigation, analysts can respond much faster to these attacks.",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Advanced Threat Detection|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/phishing_investigate_and_respond.png",
                    "title": "Phishing Investigation and Response",
                    "type": "image"
                }
            ]
        },
        "phantom_prompt_and_block_domain": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Account Compromise|IAM Analytics|Account Sharing|SaaS|Insider Threat|Cloud Security",
            "dashboard": "showcase_phantom?showcaseId=phantom_prompt_and_block_domain",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "This playbook utilizes a reputation check to generate the risk level of a domain, and, if a high enough score blocks the domain on for 60 minutes after approval via user prompt.",
            "displayapp": "Splunk Phantom",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "Playbooks can be designed to run with full end-to-end automation, but in this example an analyst can be prompted to make a decision on how to procede based on the information returned from the domain reputation check.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "Prompt and Block Domain",
            "operationalize": "This playbook is designed to prompt an analyst about whether or not a domain should be blocked. This playbook can be expanded to support other types of data such as hashes or IP's.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/user_prompt_and_block_domain.png",
            "released": "3.0.0",
            "relevance": "This is a great example of a playbook that automates some actions but prompts and analyst for how to best proceed. This playbook can be expanded to take action automatically based on certain scores and only prompt an analyst for anything in a gray area.",
            "searchKeywords": "",
            "usecase": "Security Monitoring|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/user_prompt_and_block_domain.png",
                    "title": "Prompt and Block Domain",
                    "type": "image"
                }
            ]
        },
        "phantom_ransomware_investigate_contain": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_phantom?showcaseId=phantom_ransomware_investigate_contain",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "This playbook investigates and contains ransomware detected on endpoints.",
            "displayapp": "Splunk Phantom",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "Several searches can be used to detect the presence of ransomware in the environment. This playbook is designed to investigate a file using a sandbox and if determined to be ransomware, immediately take action to block network communications, and quarantine devices.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "Ransomware Investigate and Contain",
            "operationalize": "When potential ransomware is detected this playbook can be used to further investigate, or changes can be made to the playbook to automatically take action to quarantine a device and block network communications. Note also this playbook will hunt for additional infected hosts using any observed file hashes.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/ransomware_investigate_and_contain.png",
            "released": "3.0.0",
            "relevance": "Reacting quickly is imperative when dealing with ransomware. By leveraging this playbook the entire incident response process can be automated, and additional hosts can be found and quarantined.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/ransomware_investigate_and_contain.png",
                    "title": "Ransomware Investigate and Contain",
                    "type": "image"
                }
            ]
        },
        "phantom_threat_hunting": {
            "alertvolume": "Very Low",
            "app": "Splunk_Phantom",
            "category": "Command and Control|Malware",
            "dashboard": "showcase_phantom?showcaseId=phantom_threat_hunting",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS012NetworkIntrusionDetection-ET01SigDetection|DS020HostIntrustionDetection-ET01SigDetected|DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus|IDS or IPS|Host-based IDS",
            "description": "Hunt for internal sightings of malicious files or connections to malicious domains or IP addresses.",
            "displayapp": "Splunk Phantom",
            "domain": "Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Simply deploy Phantom and work with your technical team to deploy this.",
            "highlight": "Yes",
            "howToImplement": "The threat hunting playbook uses Splunk as well as EDR tools to hunt for indicators in the environment. Additional actions in the playbook can be used to get additional information about the indicators and further investigate any malicious files discovered.",
            "icon": "phantom_logo.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "name": "Threat Hunting",
            "operationalize": "This playbook can be used to further investigate any discovered malicious connections or files in the environment. The playbook can also be re-arranged to perform investigative actions first to enrich threat intel data before hunting for it, as well as being used in conjunction with other playbooks.",
            "printable_image": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/hunting.png",
            "released": "3.0.0",
            "relevance": "Threat hunting can be a repetitive process to either enrich threat data or leverage curated data relavent to the network. By automating this process deeper investigations can be performed by easily automating the threat hunting process. ",
            "searchKeywords": "",
            "usecase": "Insider Threat|Advanced Threat Detection|SOC Automation",
            "visualizations": [
                {
                    "panel": "row1cell1",
                    "path": "https://raw.githubusercontent.com/phantomcyber/playbooks/4.5/hunting.png",
                    "title": "Threat Hunting",
                    "type": "image"
                }
            ]
        },
        "phone_call_flight_risk": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
            "deprecated_not_used_anymore_datasource": "Other",
            "description": "<p>Detect your employees who may be considering going to competitors (hopefully not with your data!) by looking for outbound phone calls to their phone ranges.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Audit",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": " - Demo"
                },
                {
                    "label": "Live Data",
                    "name": " - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": " - Accelerated"
                }
            ],
            "hasSearch": "No",
            "help": "<p>This example leverages the first time seen search assistant. Our dataset is an anonymized collection of phone records, that we will filter for just the phone ranges that belong to our competitors.</p>",
            "highlight": "No",
            "howToImplement": "<p>There are a few components to implementing this detection -- handling your CDR logs correctly, and then filtering for just your competitors phone numbers.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "<p></p>",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Competitor Phone Call",
            "operationalize": "<p>Response to this particular type of detection is highly dependent to the organization. For some orgs, this is a potential capital offense that must be immediately investigated to protect against anti-trust concerns (or other issues). For other organizations, it's only really a concern if there are other sorts of events that an employee has seen (maybe this is the straw that breaks the camel's back, so to speak).</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/phone_call_flight_risk.png",
            "released": "2.2.0",
            "relevance": "<p>For some organizations, particularly those that are highly competitive or highly regulated, phone calls to competitors are a potential source of concern. While most employees would not use a tracked company phone if they were really going to reach out to a competitor with malicious intent (or to get a new job), but many times people make very simple mistakes.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "potential_day_trading": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Suspected Day Trading Activity - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01RequestedWebAppAware",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "<p>Detect users who exhibit a large amount of stock trading activity in their proxy logs.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Suspected Day Trading Activity - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Suspected Day Trading Activity - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of proxy logs.</p>",
            "highlight": "No",
            "howToImplement": "<p>Honesty first: this particular rule has had no testing in real world scenarios and should be considered very beta-quality. Ultimately we are trying to infer that a user is exercising day trading from their proxy logs with categorization, which is very tricky. Really what this detection looks for is \"sustained heavy access to websites that are associated with stock trading.\" In most organizations, many users will periodically trade stocks. Some users may even leave a stock website up all day (or leverage widgets that track stock access). The goal is to set the bar high enough that anyone who triggers this particular rule is spending lots of time trading, with traffic to a number of different sites.</p><p>To build the rule, we looked at an organization that did not have any known day trading behavior -- we looked for users who had large amount of trading-related activities, and looked at what a heavy versus light hour was, to try to determine what it would look like when a user was focused on this. However, because we don't have a few bad users to make sure we would detect the right or wrong things, we can't say with confidence that we have exactly the right patterns. That said, this should be a good foundation. If you have the opportunity to tune this in your organization and can offer some real-world experiences, please provide feedback!</p><p>There are three thresholds in this particular search.<ol><li>In the first, we look for connections that last longer than 60 seconds. Most web servers that expect return traffic will keep connections open for prolonged periods of time to improve performance and reduce utilization on their load balancers. In testing, this seems to filter out some advertising.</li><li>For the second filter, we look in a single hour for where there are at least 30 different connections. Thirty different connections lasting longer than a minute indicates a very heavy amount of activity in that hour.</li><li>Finally we count how many hours have that amount of activity over the last week (specifically, looking for at least 20 hours of heavy activity).</li></ol></p><p>Again, we would love to get feedback on the viability of this rule based on real-world experience.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "knownFP": "<p>This search is beta -- refer to <i>How to Implement</i> for details.</p>",
            "mitre": "",
            "mitre_notes": "Not an attacker technique",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Potential Day Trading",
            "operationalize": "<p>Because this search is beta, tread carefully. Your first action should be to inspect the sites that the user was browsing to, to see if they do in fact resemble stock trading activities. If it does, most orgs will pass to HR as desired to deal with it, or just combine it with other activities to indicate a flight risk user. Your final action should be to tell us (dveuve@splunk.com) whether this was a false positive or not, so that we can improve our detections.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_prompt_and_block_domain"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/potential_day_trading.png",
            "released": "2.2.0",
            "relevance": "<p>Users who are day trading rather than focusing on their actual jobs are a risk in many ways to organizations. At a base level, it indicates that the employee is not focused on their job, which is typically an HR issue. Some Splunk customers have discussed this detection to detect flight risks. Some organizations believe employees who do day trading have generally questionable judgment and shouldn't have access to high value resources, though this is typically reserved only for very sensitive and risk adverse organizations.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "potential_gap_in_data": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Operations",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "VendorSpecific-SplunkInternal",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects gaps caused by the failure of the search head. If saved searches do not execute then there may be gaps in summary data.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Audit",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "mitre": "",
            "mitre_notes": "Cyber hygiene for internal Splunk monitoring",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Potential Gap in Data",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Audit - Potential Gap in Data - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "potential_webshell_activity": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Web Attack",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "Detects web shell activity by looking at accesses to internal Web servers (by external IPs only).",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0003",
            "mitre_technique": "|T1100",
            "name": "Potential Webshell Activity",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Application Security"
        },
        "privileged_acts_unprivileged_users": {
            "SPLEase": "Basic",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Compliance|Insider Threat|Privilege Escalation",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Privileged Actions by Unprivileged Users - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "Detect users who shouldn't be able admins taking privileged actions.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Privileged Actions by Unprivileged Users - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Privileged Actions by Unprivileged Users - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search Assistant. Our dataset is a list of anonymized Windows events with the EventCode and the tags (which come from the technology add-ons). The live search leverages the same dataset from the Windows TAs.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this search depends on two key components -- privileged events, and a list of privileged (and not) users.</p><p>Generating the privileged events is relatively straightforward to get started with as many TAs will define privileged actions by default.</p><p>Generating a list of risky users is complicated -- that's why one of the most detailed examples in Splunk Security Essentials takes this on! Check it out! (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>).</p><p>Once you have these components, implementation of this detection is straightforward.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "The #1 scenario when this alerts falsely is when the events themselves are incorrectly marked with tag=privileged. The Windows TA defines what eventtypes (basically, micro-searches that we evaluate every time you click the search button) is privileged in a file called tags.conf. You can always tune this set of tags, though it's probably easier to just add NOT EventCode=XXXX to block out the event IDs that you don't find valuable. If this becomes onerous for you, you can always start alerting on the first time this occurs for a particular user or particular system by using a first time seen detection.",
            "mitre": "Privilege Escalation",
            "mitre_tactic": "TA0004",
            "mitre_technique": "|T1078",
            "name": "Non-Privileged Users taking Privileged Actions",
            "operationalize": "When this alert fires, you should first analyze whether this particular event is one that you would not expect the user to be able to do with their existing permissions. If that's the case, analyze the groups that the user is a member of, or see if there's a local account with the same username that might be the source of these rights. Evaluate whether this is allowable or not.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/privileged_acts_unprivileged_users.png",
            "released": "2.2.0",
            "relevance": "Most larger organizations have strict controls to look for users enacting privileged actions. The other option is to not monitor this activity, potentially leaving you blind to new administrators coming in your environment. Once you have built out a list of privileged users, you can look for any instances of privileged activities from other accounts.",
            "searchKeywords": "",
            "usecase": "Compliance|Insider Threat"
        },
        "process_execution_via_wmi": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious WMI Use",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=process_execution_via_wmi",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-03-16",
            "description": "This search looks for processes launched via WMI.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "process_execution_via_wmi",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Although unlikely, administrators may use wmi to execute commands for legitimate purposes.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "process_execution_via_wmi_filter"
                }
            ],
            "mitre_sub_technique": "T1047",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1047",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Frankenstein|APT41|FIN6|Soft Cell|APT32|MuddyWater|OilRig|Threat Group-3390|FIN8|Leviathan|menuPass|Stealth Falcon|Lazarus Group|APT29|Deep Panda",
            "name": "Process Execution Via WMI",
            "references": [],
            "released": "2020-03-16",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.parent_process_name = *WmiPrvSE.exe by Processes.user Processes.dest Processes.process_name  | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| `process_execution_via_wmi_filter` ",
            "search_name": "ESCU - Process Execution via WMI - Rule",
            "story": "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "tags": {
                "analytics_story": [
                    "Suspicious WMI Use"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT41",
                    "FIN6",
                    "Soft Cell",
                    "APT32",
                    "MuddyWater",
                    "OilRig",
                    "Threat Group-3390",
                    "FIN8",
                    "Leviathan",
                    "menuPass",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1047"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Management Instrumentation"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "processes_created_by_netsh": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Netsh Abuse",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Abuse",
            "dashboard": "showcase_security_content?showcaseId=processes_created_by_netsh",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for processes launching netsh.exe to execute various commands via the netsh command-line utility. Netsh.exe is a command-line scripting utility that allows you to, either locally or remotely, display or modify the network configuration of a computer that is currently running. Netsh can be used as a persistence proxy technique to execute a helper .dll when netsh.exe is executed. In this search, we are looking for processes spawned by netsh.exe that are executing commands via the command line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting logs with the process name, command-line arguments, and parent processes from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting logs with the process name, command-line arguments, and parent processes from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "icon": "ES_Use_Case.png",
            "id": "processes_created_by_netsh",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It is unusual for netsh.exe to have any child processes in most environments. It makes sense to investigate the child process and verify whether the process spawned is legitimate. We explicitely exclude \"C:\\Program Files\\rempl\\sedlauncher.exe\" process path since it is a legitimate process by Mircosoft.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "processes_created_by_netsh_filter"
                }
            ],
            "mitre_sub_technique": "T1059.001|T1059.003",
            "mitre_tactic": "TA0002|TA0002",
            "mitre_tactic_display": "Execution|Execution",
            "mitre_technique": "T1059|T1059",
            "mitre_threat_groups": "Blue Mockingbird|APT39|DarkVishnya|Molerats|Wizard Spider|Frankenstein|Inception|Silence|APT41|Kimsuky|Soft Cell|TA505|WIRTE|TEMP.Veles|APT33|Gallmaker|Turla|APT19|DarkHydrus|APT28|Thrip|Gorgon Group|Cobalt Group|Dragonfly 2.0|Leviathan|TA459|FIN8|MuddyWater|Magic Hound|OilRig|BRONZE BUTLER|CopyKittens|APT32|FIN7|FIN10|Threat Group-3390|menuPass|Patchwork|Stealth Falcon|FIN6|Poseidon Group|APT3|APT29|Deep Panda|TA505|Blue Mockingbird|Tropic Trooper|Frankenstein|OilRig|Lazarus Group|Honeybee|Cobalt Group|FIN7|APT41|Soft Cell|Turla|Silence|APT32|APT39|Darkhotel|MuddyWater|APT18|APT38|Dark Caracal|Gorgon Group|Dragonfly 2.0|Rancor|Ke3chang|APT37|Leviathan|FIN8|APT28|Magic Hound|Sowbug|BRONZE BUTLER|FIN10|Threat Group-3390|menuPass|Gamaredon Group|Suckfly|Patchwork|Threat Group-1314|APT3|admin@338|APT1",
            "name": "Processes Created By Netsh",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.parent_process=\"*C:\\\\Windows\\\\System32\\\\netsh.exe*\" AND Processes.process_path!=\"C:\\\\Program Files\\\\rempl\\\\sedlauncher.exe\") by Processes.user Processes.dest Processes.parent_process Processes.parent_process_name Processes.process_name | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `processes_created_by_netsh_filter`",
            "search_name": "ESCU - Processes created by netsh - Rule",
            "story": "2b1800dd-92f9-47ec-a981-fdf1351e5f65",
            "tags": {
                "analytics_story": [
                    "Netsh Abuse"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "DarkVishnya",
                    "Molerats",
                    "Wizard Spider",
                    "Frankenstein",
                    "Inception",
                    "Silence",
                    "APT41",
                    "Kimsuky",
                    "Soft Cell",
                    "TA505",
                    "WIRTE",
                    "TEMP.Veles",
                    "APT33",
                    "Gallmaker",
                    "Turla",
                    "APT19",
                    "DarkHydrus",
                    "APT28",
                    "Thrip",
                    "Gorgon Group",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "Leviathan",
                    "TA459",
                    "FIN8",
                    "MuddyWater",
                    "Magic Hound",
                    "OilRig",
                    "BRONZE BUTLER",
                    "CopyKittens",
                    "APT32",
                    "FIN7",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Patchwork",
                    "Stealth Falcon",
                    "FIN6",
                    "Poseidon Group",
                    "APT3",
                    "APT29",
                    "Deep Panda",
                    "TA505",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "OilRig",
                    "Lazarus Group",
                    "Honeybee",
                    "Cobalt Group",
                    "FIN7",
                    "APT41",
                    "Soft Cell",
                    "Turla",
                    "Silence",
                    "APT32",
                    "APT39",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "APT38",
                    "Dark Caracal",
                    "Gorgon Group",
                    "Dragonfly 2.0",
                    "Rancor",
                    "Ke3chang",
                    "APT37",
                    "Leviathan",
                    "FIN8",
                    "APT28",
                    "Magic Hound",
                    "Sowbug",
                    "BRONZE BUTLER",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Gamaredon Group",
                    "Suckfly",
                    "Patchwork",
                    "Threat Group-1314",
                    "APT3",
                    "admin@338",
                    "APT1"
                ],
                "mitre_attack_id": [
                    "T1059",
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "PowerShell",
                    "Windows Command Shell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Other",
            "version": 4
        },
        "processes_launching_netsh": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Netsh Abuse|Disabling Security Tools|DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Josef Kuepker, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2019-05-08",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model to characterize the number of SMB connections observed each hour for every day of week. By default, the search uses the last 30 days of data to build the model. The model created by this search is then used in the corresponding detection search to identify outliers in the number of SMB connections for that hour and day of the week.",
                    "how_to_implement": "You must be ingesting network traffic and populating the Network_Traffic data model. In addition, you must have the Machine Learning Toolkit (MLTK) version >= 4.2 installed, along with any required dependencies. To improve your results, you may consider adding \"src\" to the by clause, which will build the model for each unique source in your enviornment. However, if you have a large number of hosts in your environment, this search may be very resource intensive. In this case, you may need to raise the value of max_inputs and/or max_groups in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 30 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data. More information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "df98763b-0b08-4281-8ef9-08db7ac572a9",
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_smb_traffic___mltk_filter"
                        }
                    ],
                    "name": "Baseline of SMB Traffic - MLTK",
                    "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Traffic where All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb by _time span=10m, All_Traffic.src | eval HourOfDay=strftime(_time, \"%H\") | eval DayOfWeek=strftime(_time, \"%A\") | `drop_dm_object_name(\"All_Traffic\")` | fit DensityFunction count by \"HourOfDay,DayOfWeek\" into smb_pdfmodel",
                    "tags": {
                        "analytics_story": [
                            "DHS Report TA18-074A",
                            "Disabling Security Tools",
                            "Emotet Malware  DHS Report TA18-201A ",
                            "Hidden Cobra Malware",
                            "Netsh Abuse",
                            "Ransomware"
                        ],
                        "detections": [
                            "Processes launching netsh",
                            "SMB Traffic Spike - MLTK"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "Bhavin Patel, Splunk",
                    "date": "2019-03-01",
                    "description": "This search looks for command-line arguments where `cmd.exe /c` is used to execute a program, then creates a baseline of the earliest and latest times we have encountered this command-line argument in our dataset within the last 30 days.",
                    "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must be ingesting logs with both the process name and command line from your endpoints. The complete process name with command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
                    "id": "56059acf-50fe-4f60-98d1-b75b51b5c2f3",
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "previously_seen_command_line_arguments_filter"
                        }
                    ],
                    "name": "Previously seen command line arguments",
                    "search": "| tstats `security_content_summariesonly` min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe AND Processes.process=\"* /c *\" by Processes.process | `drop_dm_object_name(Processes)`",
                    "tags": {
                        "analytics_story": [
                            "DHS Report TA18-074A",
                            "Disabling Security Tools",
                            "Hidden Cobra Malware",
                            "Netsh Abuse",
                            "Orangeworm Attack Group",
                            "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
                            "Suspicious Command-Line Executions",
                            "Suspicious MSHTA Activity"
                        ],
                        "detections": [
                            "Detect Prohibited Applications Spawning cmd.exe",
                            "Processes launching netsh",
                            "First time seen command line argument"
                        ]
                    },
                    "version": 2
                }
            ],
            "category": "Abuse",
            "dashboard": "showcase_security_content?showcaseId=processes_launching_netsh",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.004/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-10",
            "description": "This search looks for processes launching netsh.exe. Netsh is a command-line scripting utility that allows you to, either locally or remotely, display or modify the network configuration of a computer that is currently running. Netsh can be used as a persistence proxy technique to execute a helper DLL when netsh.exe is executed. In this search, we are looking for processes spawned by netsh.exe and executing commands via the command line.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model",
            "icon": "ES_Use_Case.png",
            "id": "processes_launching_netsh",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Some VPN applications are known to launch netsh.exe. Outside of these instances, it is unusual for an executable to launch netsh.exe and run commands.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "processes_launching_netsh_filter"
                }
            ],
            "mitre_sub_technique": "T1562.004",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1562",
            "mitre_threat_groups": "Rocke|Lazarus Group|Kimsuky|Dragonfly 2.0|Carbanak",
            "name": "Processes Launching Netsh",
            "references": [],
            "released": "2020-07-10",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) AS Processes.process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process=*netsh* by Processes.parent_process_name Processes.parent_process Processes.process_name Processes.user Processes.dest |`drop_dm_object_name(\"Processes\")` |`security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` |`processes_launching_netsh_filter`",
            "search_name": "ESCU - Processes launching netsh - Rule",
            "story": "2b1800dd-92f9-47ec-a981-fdf1351e5f65|fcc27099-46a0-46b0-a271-5c7dab56b6f1|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "Netsh Abuse",
                    "Disabling Security Tools",
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.004/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Rocke",
                    "Lazarus Group",
                    "Kimsuky",
                    "Dragonfly 2.0",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1562"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Disable or Modify System Firewall"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Other",
            "version": 3
        },
        "processes_tapping_keyboard_events": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "ColdRoot MacOS RAT",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=processes_tapping_keyboard_events",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Alerts.Alerts",
            "dataset": "",
            "date": "2019-01-25",
            "description": "This search looks for processes in an MacOS system that is tapping keyboard events in MacOS, and essentially monitoring all keystrokes made by a user. This is a common technique used by RATs to log keystrokes from a victim, although it can also be used by legitimate processes like Siri to react on human input",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 4|CIS 8",
            "escu_nist": "DE.DP",
            "hasSearch": "Yes",
            "help": "In order to properly run this search, Splunk needs to ingest data from your osquery deployed agents with the [osx-attacks.conf](https://github.com/facebook/osquery/blob/experimental/packs/osx-attacks.conf#L599) pack enabled. Also the [TA-OSquery](https://github.com/d1vious/TA-osquery) must be deployed across your indexers and universal forwarders in order to have the osquery data populate the Alerts data model.",
            "highlight": "No",
            "how_to_implement": "In order to properly run this search, Splunk needs to ingest data from your osquery deployed agents with the [osx-attacks.conf](https://github.com/facebook/osquery/blob/experimental/packs/osx-attacks.conf#L599) pack enabled. Also the [TA-OSquery](https://github.com/d1vious/TA-osquery) must be deployed across your indexers and universal forwarders in order to have the osquery data populate the Alerts data model.",
            "icon": "ES_Use_Case.png",
            "id": "processes_tapping_keyboard_events",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "There might be some false positives as keyboard event taps are used by processes like Siri and Zoom video chat, for some good examples of processes to exclude please see [this](https://github.com/facebook/osquery/pull/5345#issuecomment-454639161) comment.",
            "lookups": "",
            "macros": [
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "processes_tapping_keyboard_events_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Processes Tapping Keyboard Events",
            "references": [],
            "released": "2019-01-25",
            "search": "| from datamodel Alerts.Alerts | search app=osquery:results name=pack_osx-attacks_Keyboard_Event_Taps | rename columns.cmdline as cmd, columns.name as process_name, columns.pid as process_id| dedup host,process_name | table host,process_name, cmd, process_id | `processes_tapping_keyboard_events_filter`",
            "search_name": "ESCU - Processes Tapping Keyboard Events - Rule",
            "security_domain": "threat",
            "story": "bd91a2bc-d20b-4f44-a982-1bea98e86390",
            "tags": {
                "analytics_story": [
                    "ColdRoot MacOS RAT"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 4",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "prohibited_network_traffic_allowed": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Prohibited Traffic Allowed or Protocol Mismatch|Ransomware|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Operations|GDPR",
            "dashboard": "showcase_security_content?showcaseId=prohibited_network_traffic_allowed",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for network traffic defined by port and transport layer protocol in the Enterprise Security lookup table \"lookup_interesting_ports\", that is marked as prohibited, and has an associated 'allow' action in the Network_Traffic data model. This could be indicative of a misconfigured network device.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 9|CIS 12",
            "escu_nist": "DE.AE|PR.AC",
            "hasSearch": "Yes",
            "help": "In order to properly run this search, Splunk needs to ingest data from firewalls or other network control devices that mediate the traffic allowed into an environment. This is necessary so that the search can identify an 'action' taken on the traffic of interest. The search requires the Network_Traffic data model be populated.",
            "highlight": "No",
            "how_to_implement": "In order to properly run this search, Splunk needs to ingest data from firewalls or other network control devices that mediate the traffic allowed into an environment. This is necessary so that the search can identify an 'action' taken on the traffic of interest. The search requires the Network_Traffic data model be populated.",
            "icon": "ES_Use_Case.png",
            "id": "prohibited_network_traffic_allowed",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Delivery|Command and Control",
            "known_false_positives": "None identified",
            "lookups": [],
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "prohibited_network_traffic_allowed_filter"
                }
            ],
            "mitre_sub_technique": "T1048",
            "mitre_tactic": "TA0010",
            "mitre_tactic_display": "Exfiltration",
            "mitre_technique": "T1048",
            "mitre_threat_groups": "no",
            "name": "Prohibited Network Traffic Allowed",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.action = allowed by All_Traffic.src_ip All_Traffic.dest_ip All_Traffic.dest_port All_Traffic.action | lookup update=true interesting_ports_lookup dest_port as All_Traffic.dest_port OUTPUT app is_prohibited note transport | search is_prohibited=true | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(\"All_Traffic\")` | `prohibited_network_traffic_allowed_filter`",
            "search_name": "ESCU - Prohibited Network Traffic Allowed - Rule",
            "story": "6d13121c-90f3-446d-8ac3-27efbbc65218|cf309d0d-d4aa-4fbb-963d-1e79febd3756|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Prohibited Traffic Allowed or Protocol Mismatch",
                    "Ransomware",
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 9",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Delivery",
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1048"
                ],
                "mitre_attack_tactics": [
                    "Exfiltration"
                ],
                "mitre_attack_technique": [
                    "Exfiltration Over Alternative Protocol"
                ],
                "nist": [
                    "DE.AE",
                    "PR.AC"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring|Compliance",
            "version": 2
        },
        "prohibited_port_activity_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Lateral Movement|Endpoint Compromise|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detects the use of ports that are prohibited. Useful for detecting the installation of new software or a successful compromise of a host (such as the presence of a backdoor or a system communicating with a botnet).",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "gdprtext": "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1065",
            "name": "Prohibited Port Activity Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Unapproved Port Activity Detected - Rule",
            "usecase": "Advanced Threat Detection|Compliance"
        },
        "prohibited_process_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Unauthorized Software",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts when a service in the prohibited process list is detected.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_sub_technique": "T1543.003",
            "mitre_tactic": "|TA0004|TA0003",
            "mitre_technique": "|T1050",
            "name": "Prohibited Process Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Prohibited Process Detection - Rule",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "prohibited_service_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Unauthorized Software",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Alerts when a service in the prohibited service list is detected.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_sub_technique": "T1543.003|T1569.002",
            "mitre_tactic": "|TA0002|TA0003|TA0004",
            "mitre_technique": "|T1035|T1031|T1050",
            "name": "Prohibited Service Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Endpoint - Prohibited Service Detection - Rule",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "prohibited_software_on_endpoint": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Monitor for Unauthorized Software|Emotet Malware  DHS Report TA18-201A |SamSam Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2017-09-15",
                    "description": "This search takes the existing interesting process table from ES, filters out any existing additions added by ESCU and then updates the table with processes identified by ESCU that should be prohibited on your endpoints.",
                    "how_to_implement": "This search should be run on each new install of ESCU.",
                    "id": "251930a5-1451-4428-bb13-eed5775be0ce",
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "add_prohibited_processes_to_enterprise_security_filter"
                        }
                    ],
                    "name": "Add Prohibited Processes to Enterprise Security",
                    "search": "| inputlookup interesting_processes_lookup | search note!=ESCU* | inputlookup append=T prohibitedProcesses_lookup | fillnull value=* dest dest_pci_domain | fillnull value=false is_required is_secure | fillnull value=true is_prohibited | outputlookup interesting_processes_lookup | stats count",
                    "tags": {
                        "analytics_story": [
                            "Emotet Malware  DHS Report TA18-201A ",
                            "Monitor for Unauthorized Software",
                            "SamSam Ransomware"
                        ],
                        "detections": [
                            "Prohibited Software On Endpoint"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2017-09-15",
                    "description": "This search takes the existing interesting process table from ES, filters out any existing additions added by ESCU and then updates the table with processes identified by ESCU that should be prohibited on your endpoints.",
                    "how_to_implement": "This search should be run on each new install of ESCU.",
                    "id": "251930a5-1451-4428-bb13-eed5775be0ce",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/prohibited_processes.csv",
                            "description": "A list of processes that have been marked as prohibited",
                            "filename": "prohibited_processes.csv",
                            "name": "prohibited_processes"
                        },
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/prohibited_processes.csv",
                            "description": "A list of processes that have been marked as prohibited",
                            "filename": "prohibited_processes.csv",
                            "name": "prohibited_processes"
                        }
                    ],
                    "macros": [
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "add_prohibited_processes_to_enterprise_security_filter"
                        }
                    ],
                    "name": "Add Prohibited Processes to Enterprise Security",
                    "search": "| inputlookup prohibited_processes | search note!=ESCU* | inputlookup append=T prohibited_processes | fillnull value=* dest dest_pci_domain | fillnull value=false is_required is_secure | fillnull value=true is_prohibited | outputlookup prohibited_processes | stats count",
                    "tags": {
                        "analytics_story": [
                            "Emotet Malware  DHS Report TA18-201A ",
                            "Monitor for Unauthorized Software",
                            "SamSam Ransomware"
                        ],
                        "detections": [
                            "Prohibited Software On Endpoint"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Unauthorized Software",
            "dashboard": "showcase_security_content?showcaseId=prohibited_software_on_endpoint",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2019-10-11",
            "description": "This search looks for applications on the endpoint that you have marked as prohibited.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 2",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. This is typically populated via endpoint detection-and-response products, such as Carbon Black or endpoint data sources, such as Sysmon. The data used for this search is usually generated via logs that report process tracking in your Windows audit settings. In addition, you must also have only the `process_name` (not the entire process path) marked as \"prohibited\" in the Enterprise Security `interesting processes` table. To include the process names marked as \"prohibited\", which is included with ES Content Updates, run the included search <code>Add Prohibited Processes to Enterprise Security</code>.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. This is typically populated via endpoint detection-and-response products, such as Carbon Black or endpoint data sources, such as Sysmon. The data used for this search is usually generated via logs that report process tracking in your Windows audit settings. In addition, you must also have only the `process_name` (not the entire process path) marked as \"prohibited\" in the Enterprise Security `interesting processes` table. To include the process names marked as \"prohibited\", which is included with ES Content Updates, run the included search <code>Add Prohibited Processes to Enterprise Security</code>.",
            "icon": "ES_Use_Case.png",
            "id": "prohibited_software_on_endpoint",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Command and Control|Actions On Objectives",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "lookup prohibited_softwares app as process_name OUTPUT is_prohibited | search is_prohibited=True",
                    "description": "This macro limits the output to process_names that have been marked as prohibited",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/prohibited_softwares.csv",
                            "description": "A list of processes that have been marked as prohibited",
                            "filename": "prohibited_softwares.csv",
                            "name": "prohibited_softwares"
                        }
                    ],
                    "name": "prohibited_softwares"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "prohibited_software_on_endpoint_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Prohibited Software On Endpoint",
            "references": [],
            "released": "2019-10-11",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest Processes.user Processes.process_name | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `prohibited_softwares` | `prohibited_software_on_endpoint_filter`",
            "search_name": "ESCU - Prohibited Software On Endpoint - Rule",
            "security_domain": "endpoint",
            "story": "8892a655-6205-43f7-abba-06460e38c8ae|bb9f5ed2-916e-4364-bb6d-91c310efcf52|c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "tags": {
                "analytics_story": [
                    "Monitor for Unauthorized Software",
                    "Emotet Malware  DHS Report TA18-201A ",
                    "SamSam Ransomware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 2"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Command and Control",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "protocol_or_port_mismatch": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Prohibited Traffic Allowed or Protocol Mismatch|Command and Control",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Operations",
            "dashboard": "showcase_security_content?showcaseId=protocol_or_port_mismatch",
            "data_source_categories": "DS010NetworkCommunication-ET01TrafficAppAware",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for network traffic on common ports where a higher layer protocol does not match the port that is being used. For example, this search should identify cases where protocols other than HTTP are running on TCP port 80. This can be used by attackers to circumvent firewall restrictions, or as an attempt to hide malicious communications over ports and protocols that are typically allowed and not well inspected.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 9|CIS 12",
            "escu_nist": "DE.AE|PR.AC",
            "hasSearch": "Yes",
            "help": "Running this search properly requires a technology that can inspect network traffic and identify common protocols. Technologies such as Bro and Palo Alto Networks firewalls are two examples that will identify protocols via inspection, and not just assume a specific protocol based on the transport protocol and ports.",
            "highlight": "No",
            "how_to_implement": "Running this search properly requires a technology that can inspect network traffic and identify common protocols. Technologies such as Bro and Palo Alto Networks firewalls are two examples that will identify protocols via inspection, and not just assume a specific protocol based on the transport protocol and ports.",
            "icon": "ES_Use_Case.png",
            "id": "protocol_or_port_mismatch",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Command and Control",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "protocol_or_port_mismatch_filter"
                }
            ],
            "mitre_sub_technique": "T1048.003",
            "mitre_tactic": "TA0010",
            "mitre_tactic_display": "Exfiltration",
            "mitre_technique": "T1048",
            "mitre_threat_groups": "APT32|APT33|Thrip|FIN8|OilRig|Lazarus Group",
            "name": "Protocol Or Port Mismatch",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where (All_Traffic.app=dns NOT All_Traffic.dest_port=53) OR ((All_Traffic.app=web-browsing OR All_Traffic.app=http) NOT (All_Traffic.dest_port=80 OR All_Traffic.dest_port=8080 OR All_Traffic.dest_port=8000)) OR (All_Traffic.app=ssl NOT (All_Traffic.dest_port=443 OR All_Traffic.dest_port=8443)) OR (All_Traffic.app=smtp NOT All_Traffic.dest_port=25) by All_Traffic.src_ip, All_Traffic.dest_ip, All_Traffic.app, All_Traffic.dest_port |`security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(\"All_Traffic\")` | `protocol_or_port_mismatch_filter`",
            "search_name": "ESCU - Protocol or Port Mismatch - Rule",
            "story": "6d13121c-90f3-446d-8ac3-27efbbc65218|943773c6-c4de-4f38-89a8-0b92f98804d8",
            "tags": {
                "analytics_story": [
                    "Prohibited Traffic Allowed or Protocol Mismatch",
                    "Command and Control"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 9",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "APT32",
                    "APT33",
                    "Thrip",
                    "FIN8",
                    "OilRig",
                    "Lazarus Group"
                ],
                "mitre_attack_id": [
                    "T1048"
                ],
                "mitre_attack_tactics": [
                    "Exfiltration"
                ],
                "mitre_attack_technique": [
                    "Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"
                ],
                "nist": [
                    "DE.AE",
                    "PR.AC"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "protocols_passing_authentication_in_cleartext": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Use of Cleartext Protocols",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Compliance",
            "dashboard": "showcase_security_content?showcaseId=protocols_passing_authentication_in_cleartext",
            "data_source_categories": "DS010NetworkCommunication-ET03UserAware",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-11-04",
            "description": "This search looks for cleartext protocols at risk of leaking credentials. Currently, this consists of legacy protocols such as telnet, POP3, IMAP, and non-anonymous FTP sessions. While some of these protocols can be used over SSL, they typically run on different assigned ports in those cases.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 9|CIS 14",
            "escu_nist": "PR.PT|DE.AE|PR.AC|PR.DS",
            "hasSearch": "Yes",
            "help": "This search requires you to be ingesting your network traffic, and populating the Network_Traffic data model.",
            "highlight": "No",
            "how_to_implement": "This search requires you to be ingesting your network traffic, and populating the Network_Traffic data model.",
            "icon": "ES_Use_Case.png",
            "id": "protocols_passing_authentication_in_cleartext",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Reconnaissance|Actions On Objectives",
            "known_false_positives": "Some networks may use kerberized FTP or telnet servers, however, this is rare.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "protocols_passing_authentication_in_cleartext_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Protocols Passing Authentication In Cleartext",
            "references": [],
            "released": "2020-11-04",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.transport=\"tcp\" AND (All_Traffic.dest_port=\"23\" OR All_Traffic.dest_port=\"143\" OR All_Traffic.dest_port=\"110\" OR (All_Traffic.dest_port=\"21\" AND All_Traffic.user != \"anonymous\")) by All_Traffic.user All_Traffic.src All_Traffic.dest All_Traffic.dest_port | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(\"All_Traffic\")` | `protocols_passing_authentication_in_cleartext_filter`",
            "search_name": "ESCU - Protocols passing authentication in cleartext - Rule",
            "security_domain": "network",
            "story": "826e6431-aeef-41b4-9fc0-6d0985d65a21",
            "tags": {
                "analytics_story": [
                    "Use of Cleartext Protocols"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 9",
                    "CIS 14"
                ],
                "kill_chain_phases": [
                    "Reconnaissance",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "DE.AE",
                    "PR.AC",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Compliance",
            "version": 2
        },
        "pull_list_of_privileged_users": {
            "SPLEase": "Hard",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Pull List of Privileged Users - Demo",
            "data_source_categories": "VendorSpecific-winsec-domaincontroller",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "To focus detection or response on privileged users, you must first build a list of accounts that have elevated rights or access to privileged information.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Pull List of Privileged Users - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "SysAdmins",
                    "name": "Pull List of Privileged Users - SysAdmins from LDAP"
                },
                {
                    "label": "VIP Employees",
                    "name": "Pull List of Privileged Users - VIP Employees from LDAP"
                },
                {
                    "label": "Privileged Actions",
                    "name": "Pull List of Privileged Users - Users Taking Privileged Acts"
                },
                {
                    "label": "Calculate Risk Scores",
                    "name": "Pull List of Privileged Users - Calculate Risk Scores from LDAP"
                },
                {
                    "label": "Demo Data (Related Accounts)",
                    "name": "Pull List of Privileged Users - Connect Multiple Accounts to Employee - Demo"
                },
                {
                    "label": "Related Accounts",
                    "name": "Pull List of Privileged Users - Connect Multiple Accounts to Employee"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search Assistant. There are several ways to pull this data from live environments -- see the different options for more information.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>There are multiple approaches for pulling lists of Privileged Users, and multiple definitions of what privileged really means for a given scenario.</p><p><b>Pulling Users</b>. In this example we show three different methods for pulling lists of users: querying LDAP, querying a database, or looking for users who take the actions that a privileged user would take. Let's walk through these examples. <ul><li>Pulling from LDAP - there are three different approaches for pulling from LDAP. We generally recommend that most users start by using the Supporting Add-on for Active Directory (aka SA-ldapsearch) which provides the ldapsearch command. This command is native in Splunk, and works great for on premises installations in organizations with fewer than 50,000 users (<a href=\"https://splunkbase.splunk.com/app/1151/\" target=\"_blank\">app link</a>, <a href=\"http://docs.splunk.com/Documentation/SA-LdapSearch/2.1.6/User/AbouttheSplunkSupportingAdd-onforActiveDirectory\" target=\"_blank\">docs link</a>). You can also pull data using AD Monitor, which is the Splunk Universal Forwarder's ability to monitor Active Directory for changes -- recommended for large organizations, and for Cloud environments (<a href=\"http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorActiveDirectory\" target=\"_blank\">doc link</a>). Finally, it is sometimes simpler to use Powershell for this effort (<a href=\"https://gallery.technet.microsoft.com/scriptcenter/Powershell-script-to-5edcdaea\" target=\"_blank\">link</a>).</li><li>Organizations with formal systems for managing privileged users that don't sync to Active Directory will most frequently need to pull a list of users by querying a database (though sometimes an API is available). This frequently occurs when you have an on-prem software application backed by a database that stores a list of privileged users. The process you will walk through to pull that data into Splunk is to first discover the username and password to log into the database along with the query that will return your desired set of users, and then configure Splunk DB Connect (<a href=\"https://splunkbase.splunk.com/app/2686/\" target=\"_blank\">link</a>, <a href=\"http://docs.splunk.com/Documentation/DBX/latest\">doc link</a>) to pull that data. Learning the credentials and the required query is sometimes very easy, and sometimes very difficult, but often you will be able to find help from Splunk Professional Services or on <a href=\"https://answers.splunk.com/\">Splunk Answers</a>.</li><li>Finally, we can always infer a list of privileged users by finding users who take privileged actions. There are many ways to approach this process, but the simplest is by searching for the use of tag=privileged  on authentication events, as defined by the Splunk Common Information Model.</li></ul></p><p>Now we've discussed how to ingest the data in the first place -- but we haven't discussed what data we actually should be ingesting. There are two primary categories of privileged users that we might want to monitor: those who have administrative rights, and those that are privileged. <ul><li>Those who have administrative rights is a very simple question to answer in a smaller organization, but exponentially more difficult with the complexity of the environment. It's best to start with standard privileged AD groups, such as Domain Admins, and then expand into environment-specific groups, such as the custom help desk admin group that had local admin rights on all workstations (every company has at least one of these). It's often easiest to find these types of groups by hunting through LDAP for key terms such as \"*admin*\" or \"*operator*\" etc. Finally, wrap up by searching for users with specific admin rights, such as privileged service accounts and see what groups (if any) they belong to. It's generally advisable to look for known administrative users across the organization (either specific names, or by naming scheme such as jsmith-a) and seeing which groups these users belong to.</li><li>Generally speaking, understanding VIP users in an organization can be dramatically easier than finding all admin accounts. Title will frequently get you all you need, though you may also find that tracking the # of steps away from the CEO based on reporting structure can be very effective. It's important to not forget employees that are associated with highly visible people but aren't themselves as visible, particularly the executive assistants for all your important users. They generally have full access to an exec's calendar, mailboxes, and more often than we would like they will also have a text file somewhere on their computer with the executive's password (or similar).</li></ul></p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "The concept of a false positive versus false negative is slightly different for this example as ultimately we are working to build out a list of users, but both are extremely common. Mapping the organizational structure (and permissions structures) of an organization is inherently very complicated, and will require lots of testing and tuning to get a meaningful list. The benefit though is that since this search does not directly create alarms, some amount of inaccuracy is acceptable.",
            "mitre": "Privilege Escalation|Credential Access",
            "mitre_notes": "This is about building detections and understanding internal environment.  Not about finding indications of attacker behavior. ",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Pull List of Privileged Users",
            "operationalize": "This search does not directly create alarms, but is only used to generate lists of users for use in other searches. See Related Content. ",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/pull_list_of_privileged_users.png",
            "released": "2.2.0",
            "relevance": "Every organization should seek to inform their detections with the relative risk of the users and systems involved. If two users send out a large volume of data but one of those users is a database administrator, you should probably respond to that alert first. Security organizations serious about insider threat should be able to look at different dimensions of privilege and then inform both their detection methods and their response prioritization accordingly. The two easiest of those dimensions are \"users with elevated rights on systems\" (e.g., sysadmins, database admins, etc.) and \"employees who have access to privileged information\" (e.g., executives, employees involved in mergers and acquisitions, etc.). It's entirely possible that you will build out a series of different lists for different scenarios (for example, a list of users read in on a particularly acquisition project, etc.) but it's easiest to start with just accounts that have elevated rights and those that have privileged information.",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "recurring_infection_on_host": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Recurring Infection on Host - Demo",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Looks for the same malware occurring multiple times on the same host.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Recurring Infection on Host - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Recurring Infection on Host - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "With Symantec Endpoint Protection logs onboard, these searches should work easily. If you have a different Anti-Virus product, they should be very easy to adapt to the field names and sourcetypes for that product -- particularly if you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Government|Defense|Media|Legal|Finance|Energy|Aerospace|Technology|Chemical|Healthcare|Travel|Telecommunications",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "knownFP": "No known false positives at this time.",
            "mitre": "Initial Access|Execution",
            "mitre_sub_technique": "T1566.001|T1566.002",
            "mitre_tactic": "TA0001|TA0002",
            "mitre_technique": "|T1189|T1192|T1193|T1204|T1566",
            "name": "Recurring Infection on Host",
            "operationalize": "When repeated infections on the same host, you should strive to understand how the system is being reinfected. If you can see behavior such as proxy logs indicating suspicious activities, or suspicious emails going through the spam filter, that might be an indication that the user needs some education or that your malware solution needs to be strengthened. If you can't determine the reason for the reinfection, consider the possibility that the host still had an infection from the first occurrence and it just reactivated other functionality that AV caught, particularly if you didn't wipe the host the first time around. If you didn't, the time is now.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/recurring_infection_on_host.png",
            "released": "2.0.0",
            "relevance": "If the same malware is detected repeatedly on a host, it could mean repeated attacks or an incomplete clean. Regardless, it is something that we should detect and remediate.",
            "searchKeywords": "",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "high_number_of_infected_hosts",
                "host_with_a_recurring_malware_infection",
                "host_with_multiple_infections",
                "UC0029",
                "UC0028",
                "UC0075",
                "UC0065"
            ],
            "usecase": "Security Monitoring"
        },
        "reg_exe_manipulating_windows_services_registry_keys": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Service Abuse|Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=reg_exe_manipulating_windows_services_registry_keys",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1574.011/change_registry_path_service/windows-sysmon.log"
            ],
            "date": "2020-11-26",
            "description": "The search looks for reg.exe modifying registry keys that define Windows services and their configurations.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 8",
            "escu_nist": "PR.IP|PR.PT|PR.AC|PR.AT|DE.CM",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "reg_exe_manipulating_windows_services_registry_keys",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "It is unusual for a service to be created or modified by directly manipulating the registry. However, there may be legitimate instances of this behavior. It is important to validate and investigate, as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "reg_exe_manipulating_windows_services_registry_keys_filter"
                }
            ],
            "mitre_sub_technique": "T1574.011",
            "mitre_tactic": "TA0003|TA0004|TA0005",
            "mitre_tactic_display": "Persistence|Privilege Escalation|Defense Evasion",
            "mitre_technique": "T1574",
            "mitre_threat_groups": "no",
            "name": "Reg Exe Manipulating Windows Services Registry Keys",
            "references": [],
            "released": "2020-11-26",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process_name) as process_name values(Processes.parent_process_name) as parent_process_name values(Processes.user) as user FROM datamodel=Endpoint.Processes where Processes.process_name=reg.exe Processes.process=*reg* Processes.process=*add* Processes.process=*Services* by Processes.process_id Processes.dest Processes.process | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `reg_exe_manipulating_windows_services_registry_keys_filter`",
            "search_name": "ESCU - Reg exe Manipulating Windows Services Registry Keys - Rule",
            "story": "6dbd810e-f66d-414b-8dfc-e46de55cbfe2|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Windows Service Abuse",
                    "Windows Persistence Techniques"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1574.011/change_registry_path_service/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1574"
                ],
                "mitre_attack_tactics": [
                    "Persistence",
                    "Privilege Escalation",
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Services Registry Permissions Weakness"
                ],
                "nist": [
                    "PR.IP",
                    "PR.PT",
                    "PR.AC",
                    "PR.AT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 5
        },
        "reg_exe_used_to_hide_files_directories_via_registry_keys": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Defense Evasion Tactics|Suspicious Windows Registry Activities|Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=reg_exe_used_to_hide_files_directories_via_registry_keys",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2019-02-27",
            "description": "The search looks for command-line arguments used to hide a file or directory using the reg add command.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "reg_exe_used_to_hide_files_directories_via_registry_keys",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "None at the moment",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "reg_exe_used_to_hide_files_directories_via_registry_keys_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Reg Exe Used To Hide Files Directories Via Registry Keys",
            "references": [],
            "released": "2019-02-27",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = reg.exe Processes.process=\"*add*\" Processes.process=\"*Hidden*\" Processes.process=\"*REG_DWORD*\" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)`| regex process = \"(/d\\s+2)\" | `reg_exe_used_to_hide_files_directories_via_registry_keys_filter`",
            "search_name": "ESCU - Reg exe used to hide files directories via registry keys - Rule",
            "security_domain": "endpoint",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|2b1800dd-92f9-47dd-a981-fdf1351e5d55|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Windows Defense Evasion Tactics",
                    "Suspicious Windows Registry Activities",
                    "Windows Persistence Techniques"
                ],
                "asset_type": "",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "registry_keys_for_creating_shim_databases": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Windows Registry Activities|Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=registry_keys_for_creating_shim_databases",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "Endpoint.Registry",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-26",
            "description": "This search looks for registry activity associated with application compatibility shims, which can be leveraged by attackers for various nefarious purposes.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must populate the Change_Analysis data model. This is typically populated via endpoint detection and response products, such as Carbon Black or other endpoint data sources such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must populate the Change_Analysis data model. This is typically populated via endpoint detection and response products, such as Carbon Black or other endpoint data sources such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "icon": "ES_Use_Case.png",
            "id": "registry_keys_for_creating_shim_databases",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "There are many legitimate applications that leverage shim databases for compatibility purposes for legacy applications",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "registry_keys_for_creating_shim_databases_filter"
                }
            ],
            "mitre_sub_technique": "T1546.011",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_tactic_display": "Privilege Escalation|Persistence",
            "mitre_technique": "T1546",
            "mitre_threat_groups": "FIN7",
            "name": "Registry Keys For Creating Shim Databases",
            "references": [],
            "released": "2020-11-26",
            "search": "| tstats `security_content_summariesonly` count values(Registry.registry_key_name) as registry_key_name min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where Registry.registry_path=*CurrentVersion\\\\AppCompatFlags\\\\Custom* OR Registry.registry_path=*CurrentVersion\\\\AppCompatFlags\\\\InstalledSDB* by Registry.dest Registry.user | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)` | `registry_keys_for_creating_shim_databases_filter`",
            "search_name": "ESCU - Registry Keys for Creating SHIM Databases - Rule",
            "story": "2b1800dd-92f9-47dd-a981-fdf1351e5d55|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Suspicious Windows Registry Activities",
                    "Windows Persistence Techniques"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1546"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Application Shimming"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "registry_keys_used_for_persistence": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Windows Registry Activities|Suspicious MSHTA Activity|DHS Report TA18-074A|Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns|Ransomware|Windows Persistence Techniques|Emotet Malware  DHS Report TA18-201A ",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=registry_keys_used_for_persistence",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "Endpoint.Registry",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1547.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-27",
            "description": "The search looks for modifications to registry keys that can be used to launch an application or service at system startup.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM|DE.AE",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black or endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black or endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "icon": "ES_Use_Case.png",
            "id": "registry_keys_used_for_persistence",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "There are many legitimate applications that must execute on system startup and will use these registry keys to accomplish that task.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "registry_keys_used_for_persistence_filter"
                }
            ],
            "mitre_sub_technique": "T1547.001",
            "mitre_tactic": "TA0003|TA0004",
            "mitre_tactic_display": "Persistence|Privilege Escalation",
            "mitre_technique": "T1547",
            "mitre_threat_groups": "Rocke|Tropic Trooper|Gamaredon Group|Sharpshooter|Molerats|Silence|RTM|Inception|APT41|Machete|Kimsuky|APT33|APT39|APT32|APT18|Turla|Dark Caracal|Cobalt Group|Honeybee|Threat Group-3390|Dragonfly 2.0|Gorgon Group|Ke3chang|APT19|Leviathan|MuddyWater|APT37|BRONZE BUTLER|Magic Hound|APT3|FIN10|FIN7|Patchwork|FIN6|Lazarus Group|Putter Panda|APT29|Darkhotel",
            "name": "Registry Keys Used For Persistence",
            "references": [],
            "released": "2020-11-27",
            "search": "| tstats `security_content_summariesonly` count values(Registry.registry_key_name) as registry_key_name values(Registry.registry_path) as registry_path min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where (Registry.registry_path=*currentversion\\\\run* OR Registry.registry_path=*currentVersion\\\\Windows\\\\Appinit_Dlls* OR Registry.registry_path=CurrentVersion\\\\Winlogon\\\\Shell* OR Registry.registry_path=*CurrentVersion\\\\Winlogon\\\\Userinit* OR Registry.registry_path=*CurrentVersion\\\\Winlogon\\\\VmApplet* OR Registry.registry_path=*currentversion\\\\policies\\\\explorer\\\\run* OR Registry.registry_path=*currentversion\\\\runservices* OR Registry.registry_path=*\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\* OR Registry.registry_path=\"*Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options*\" OR Registry.registry_path=HKLM\\\\SOFTWARE\\\\Microsoft\\\\Netsh\\\\*) by Registry.dest Registry.user | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)` | `registry_keys_used_for_persistence_filter`",
            "search_name": "ESCU - Registry Keys Used For Persistence - Rule",
            "story": "2b1800dd-92f9-47dd-a981-fdf1351e5d55|2b1800dd-92f9-47dd-a981-fdf13w1q5d55|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|988C59C5-0A1C-45B6-A555-0C62276E327E|cf309d0d-d4aa-4fbb-963d-1e79febd3756|30874d4f-20a1-488f-85ec-5d52ef74e3f9|bb9f5ed2-916e-4364-bb6d-91c310efcf52",
            "tags": {
                "analytics_story": [
                    "Suspicious Windows Registry Activities",
                    "Suspicious MSHTA Activity",
                    "DHS Report TA18-074A",
                    "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
                    "Ransomware",
                    "Windows Persistence Techniques",
                    "Emotet Malware  DHS Report TA18-201A "
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1547.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Rocke",
                    "Tropic Trooper",
                    "Gamaredon Group",
                    "Sharpshooter",
                    "Molerats",
                    "Silence",
                    "RTM",
                    "Inception",
                    "APT41",
                    "Machete",
                    "Kimsuky",
                    "APT33",
                    "APT39",
                    "APT32",
                    "APT18",
                    "Turla",
                    "Dark Caracal",
                    "Cobalt Group",
                    "Honeybee",
                    "Threat Group-3390",
                    "Dragonfly 2.0",
                    "Gorgon Group",
                    "Ke3chang",
                    "APT19",
                    "Leviathan",
                    "MuddyWater",
                    "APT37",
                    "BRONZE BUTLER",
                    "Magic Hound",
                    "APT3",
                    "FIN10",
                    "FIN7",
                    "Patchwork",
                    "FIN6",
                    "Lazarus Group",
                    "Putter Panda",
                    "APT29",
                    "Darkhotel"
                ],
                "mitre_attack_id": [
                    "T1547"
                ],
                "mitre_attack_tactics": [
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Registry Run Keys / Startup Folder"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM",
                    "DE.AE"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "registry_keys_used_for_privilege_escalation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Privilege Escalation|Suspicious Windows Registry Activities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Privilege Escalation",
            "dashboard": "showcase_security_content?showcaseId=registry_keys_used_for_privilege_escalation",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "Endpoint.Registry",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.012/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-27",
            "description": "This search looks for modifications to registry keys that can be used to elevate privileges. The registry keys under \"Image File Execution Options\" are used to intercept calls to an executable and can be used to attach malicious binaries to benign system binaries.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records registry activity from your hosts to populate the endpoint data model in the registry node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "icon": "ES_Use_Case.png",
            "id": "registry_keys_used_for_privilege_escalation",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "There are many legitimate applications that must execute upon system startup and will use these registry keys to accomplish that task.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "registry_keys_used_for_privilege_escalation_filter"
                }
            ],
            "mitre_sub_technique": "T1546.012",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_tactic_display": "Privilege Escalation|Persistence",
            "mitre_technique": "T1546",
            "mitre_threat_groups": "TEMP.Veles",
            "name": "Registry Keys Used For Privilege Escalation",
            "references": [
                "https://blog.malwarebytes.com/101/2015/12/an-introduction-to-image-file-execution-options/"
            ],
            "released": "2020-11-27",
            "search": "| tstats `security_content_summariesonly` count  min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where (Registry.registry_path=\"*Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options*\") AND (Registry.registry_key_name=GlobalFlag OR Registry.registry_key_name=Debugger) by Registry.dest  Registry.user Registry.registry_path Registry.registry_key_name | `security_content_ctime(lastTime)`  | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)` | `registry_keys_used_for_privilege_escalation_filter`",
            "search_name": "ESCU - Registry Keys Used For Privilege Escalation - Rule",
            "story": "644e22d3-598a-429c-a007-16fdb802cae5|2b1800dd-92f9-47dd-a981-fdf1351e5d55",
            "tags": {
                "analytics_story": [
                    "Windows Privilege Escalation",
                    "Suspicious Windows Registry Activities"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.012/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "TEMP.Veles"
                ],
                "mitre_attack_id": [
                    "T1546"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Image File Execution Options Injection"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "remote_desktop_network_bruteforce": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware|Ryuk Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=remote_desktop_network_bruteforce",
            "data_source_categories": "DS010NetworkCommunication-ET01TrafficAppAware",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for RDP application network traffic and filters any source/destination pair generating more than twice the standard deviation of the average traffic.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 12|CIS 9|CIS 16",
            "escu_nist": "DE.AE|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "You must ensure that your network traffic data is populating the Network_Traffic data model.",
            "highlight": "No",
            "how_to_implement": "You must ensure that your network traffic data is populating the Network_Traffic data model.",
            "icon": "ES_Use_Case.png",
            "id": "remote_desktop_network_bruteforce",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Reconnaissance|Delivery",
            "known_false_positives": "RDP gateways may have unusually high amounts of traffic from all other hosts' RDP applications in the network.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "remote_desktop_network_bruteforce_filter"
                }
            ],
            "mitre_sub_technique": "T1021.001",
            "mitre_tactic": "TA0008",
            "mitre_tactic_display": "Lateral Movement",
            "mitre_technique": "T1021",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Silence|APT41|TEMP.Veles|Leviathan|APT39|Stolen Pencil|Cobalt Group|Dragonfly 2.0|FIN8|APT3|OilRig|menuPass|FIN10|Patchwork|FIN6|Lazarus Group|APT1|Axiom",
            "name": "Remote Desktop Network Bruteforce",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.app=rdp by All_Traffic.src All_Traffic.dest All_Traffic.dest_port | eventstats stdev(count) AS stdev avg(count) AS avg p50(count) AS p50 | where count>(avg + stdev*2) | rename All_Traffic.src AS src All_Traffic.dest AS dest | table firstTime lastTime src dest count avg p50 stdev | `remote_desktop_network_bruteforce_filter`",
            "search_name": "ESCU - Remote Desktop Network Bruteforce - Rule",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604|507edc74-13d5-4339-878e-b9744ded1f35",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware",
                    "Ryuk Ransomware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 12",
                    "CIS 9",
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Reconnaissance",
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "TEMP.Veles",
                    "Leviathan",
                    "APT39",
                    "Stolen Pencil",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "FIN8",
                    "APT3",
                    "OilRig",
                    "menuPass",
                    "FIN10",
                    "Patchwork",
                    "FIN6",
                    "Lazarus Group",
                    "APT1",
                    "Axiom"
                ],
                "mitre_attack_id": [
                    "T1021"
                ],
                "mitre_attack_tactics": [
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "Remote Desktop Protocol"
                ],
                "nist": [
                    "DE.AE",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "remote_desktop_network_traffic": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware|Ryuk Ransomware|Hidden Cobra Malware|Lateral Movement",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Lateral Movement",
            "dashboard": "showcase_security_content?showcaseId=remote_desktop_network_traffic",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-07",
            "description": "This search looks for network traffic on TCP/3389, the default port used by remote desktop. While remote desktop traffic is not uncommon on a network, it is usually associated with known hosts. This search allows for whitelisting both source and destination hosts to remove them from the output of the search so you can focus on the uncommon uses of remote desktop on your network.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 9|CIS 16",
            "escu_nist": "DE.AE|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to identify systems that commonly originate remote desktop traffic and that commonly receive remote desktop traffic. You can use the included support search \"Identify Systems Creating Remote Desktop Traffic\" to identify systems that originate the traffic and the search \"Identify Systems Receiving Remote Desktop Traffic\" to identify systems that receive a lot of remote desktop traffic. After identifying these systems, you will need to add the \"common_rdp_source\" or \"common_rdp_destination\" category to that system depending on the usage, using the Enterprise Security Assets and Identities framework.  This can be done by adding an entry in the assets.csv file located in SA-IdentityManagement/lookups.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to identify systems that commonly originate remote desktop traffic and that commonly receive remote desktop traffic. You can use the included support search \"Identify Systems Creating Remote Desktop Traffic\" to identify systems that originate the traffic and the search \"Identify Systems Receiving Remote Desktop Traffic\" to identify systems that receive a lot of remote desktop traffic. After identifying these systems, you will need to add the \"common_rdp_source\" or \"common_rdp_destination\" category to that system depending on the usage, using the Enterprise Security Assets and Identities framework.  This can be done by adding an entry in the assets.csv file located in SA-IdentityManagement/lookups.",
            "icon": "ES_Use_Case.png",
            "id": "remote_desktop_network_traffic",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Remote Desktop may be used legitimately by users on the network.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "remote_desktop_network_traffic_filter"
                }
            ],
            "mitre_sub_technique": "T1021.001",
            "mitre_tactic": "TA0008",
            "mitre_tactic_display": "Lateral Movement",
            "mitre_technique": "T1021",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Silence|APT41|TEMP.Veles|Leviathan|APT39|Stolen Pencil|Cobalt Group|Dragonfly 2.0|FIN8|APT3|OilRig|menuPass|FIN10|Patchwork|FIN6|Lazarus Group|APT1|Axiom",
            "name": "Remote Desktop Network Traffic",
            "references": [],
            "released": "2020-07-07",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.dest_port=3389 AND All_Traffic.dest_category!=common_rdp_destination AND All_Traffic.src_category!=common_rdp_source by All_Traffic.src All_Traffic.dest All_Traffic.dest_port | `drop_dm_object_name(\"All_Traffic\")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `remote_desktop_network_traffic_filter` ",
            "search_name": "ESCU - Remote Desktop Network Traffic - Rule",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604|507edc74-13d5-4339-878e-b9744ded1f35|baf7580b-d4b4-4774-8173-7d198e9da335|399d65dc-1f08-499b-a259-aad9051f38ad",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware",
                    "Ryuk Ransomware",
                    "Hidden Cobra Malware",
                    "Lateral Movement"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 9",
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "TEMP.Veles",
                    "Leviathan",
                    "APT39",
                    "Stolen Pencil",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "FIN8",
                    "APT3",
                    "OilRig",
                    "menuPass",
                    "FIN10",
                    "Patchwork",
                    "FIN6",
                    "Lazarus Group",
                    "APT1",
                    "Axiom"
                ],
                "mitre_attack_id": [
                    "T1021"
                ],
                "mitre_attack_tactics": [
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "Remote Desktop Protocol"
                ],
                "nist": [
                    "DE.AE",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "remote_desktop_process_running_on_system": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Hidden Cobra Malware|Lateral Movement",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Lateral Movement",
            "dashboard": "showcase_security_content?showcaseId=remote_desktop_process_running_on_system",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for the remote desktop process mstsc.exe running on systems upon which it doesn't typically run. This is accomplished by filtering out all systems that are noted in the `common_rdp_source category` in the Assets and Identity framework.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 9|CIS 16",
            "escu_nist": "DE.AE|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. The search requires you to identify systems that do not commonly use remote desktop. You can use the included support search \"Identify Systems Using Remote Desktop\" to identify these systems. After identifying them, you will need to add the \"common_rdp_source\" category to that system using the Enterprise Security Assets and Identities framework. This can be done by adding an entry in the assets.csv file located in `SA-IdentityManagement/lookups`.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records process activity from your hosts to populate the endpoint data model in the processes node. The search requires you to identify systems that do not commonly use remote desktop. You can use the included support search \"Identify Systems Using Remote Desktop\" to identify these systems. After identifying them, you will need to add the \"common_rdp_source\" category to that system using the Enterprise Security Assets and Identities framework. This can be done by adding an entry in the assets.csv file located in `SA-IdentityManagement/lookups`.",
            "icon": "ES_Use_Case.png",
            "id": "remote_desktop_process_running_on_system",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Remote Desktop may be used legitimately by users on the network.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "remote_desktop_process_running_on_system_filter"
                }
            ],
            "mitre_sub_technique": "T1021.001",
            "mitre_tactic": "TA0008",
            "mitre_tactic_display": "Lateral Movement",
            "mitre_technique": "T1021",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Silence|APT41|TEMP.Veles|Leviathan|APT39|Stolen Pencil|Cobalt Group|Dragonfly 2.0|FIN8|APT3|OilRig|menuPass|FIN10|Patchwork|FIN6|Lazarus Group|APT1|Axiom",
            "name": "Remote Desktop Process Running On System",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process=*mstsc.exe AND Processes.dest_category!=common_rdp_source by Processes.dest Processes.user Processes.process | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `remote_desktop_process_running_on_system_filter` ",
            "search_name": "ESCU - Remote Desktop Process Running On System - Rule",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335|399d65dc-1f08-499b-a259-aad9051f38ad",
            "tags": {
                "analytics_story": [
                    "Hidden Cobra Malware",
                    "Lateral Movement"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 9",
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "TEMP.Veles",
                    "Leviathan",
                    "APT39",
                    "Stolen Pencil",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "FIN8",
                    "APT3",
                    "OilRig",
                    "menuPass",
                    "FIN10",
                    "Patchwork",
                    "FIN6",
                    "Lazarus Group",
                    "APT1",
                    "Axiom"
                ],
                "mitre_attack_id": [
                    "T1021"
                ],
                "mitre_attack_tactics": [
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "Remote Desktop Protocol"
                ],
                "nist": [
                    "DE.AE",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "remote_process_instantiation_via_wmi": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ransomware|Suspicious WMI Use",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Lateral Movement",
            "dashboard": "showcase_security_content?showcaseId=remote_process_instantiation_via_wmi",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-30",
            "description": "This search looks for wmic.exe being launched with parameters to spawn a process on a remote system.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "remote_process_instantiation_via_wmi",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "The wmic.exe utility is a benign Windows application. It may be used legitimately by Administrators with these parameters for remote system administration, but it's relatively uncommon.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "remote_process_instantiation_via_wmi_filter"
                }
            ],
            "mitre_sub_technique": "T1047",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1047",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Frankenstein|APT41|FIN6|Soft Cell|APT32|MuddyWater|OilRig|Threat Group-3390|FIN8|Leviathan|menuPass|Stealth Falcon|Lazarus Group|APT29|Deep Panda",
            "name": "Remote Process Instantiation Via WMI",
            "references": [],
            "released": "2020-11-30",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = wmic.exe Processes.process=\"*/node*\" Processes.process=\"*process*\" Processes.process=\"*call*\" Processes.process=\"*create*\"   by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `remote_process_instantiation_via_wmi_filter`",
            "search_name": "ESCU - Remote Process Instantiation via WMI - Rule",
            "story": "cf309d0d-d4aa-4fbb-963d-1e79febd3756|c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "tags": {
                "analytics_story": [
                    "Ransomware",
                    "Suspicious WMI Use"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT41",
                    "FIN6",
                    "Soft Cell",
                    "APT32",
                    "MuddyWater",
                    "OilRig",
                    "Threat Group-3390",
                    "FIN8",
                    "Leviathan",
                    "menuPass",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1047"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Management Instrumentation"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "remote_registry_key_modifications": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Defense Evasion Tactics|Suspicious Windows Registry Activities|Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=remote_registry_key_modifications",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Registry",
            "dataset": "",
            "date": "2020-03-02",
            "description": "This search monitors for remote modifications to registry keys.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must populate the `Endpoint` data model. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must populate the `Endpoint` data model. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the registry.",
            "icon": "ES_Use_Case.png",
            "id": "remote_registry_key_modifications",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "This technique may be legitimately used by administrators to modify remote registries, so it's important to filter these events out.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "remote_registry_key_modifications_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Remote Registry Key Modifications",
            "references": [],
            "released": "2020-03-02",
            "search": "| tstats `security_content_summariesonly` count values(Registry.registry_key_name) as registry_key_name values(Registry.registry_path) as registry_path min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where  Registry.registry_path=\"\\\\\\\\*\"  by Registry.dest , Registry.user | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)` | `remote_registry_key_modifications_filter`",
            "search_name": "ESCU - Remote Registry Key modifications - Rule",
            "security_domain": "endpoint",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|2b1800dd-92f9-47dd-a981-fdf1351e5d55|30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Windows Defense Evasion Tactics",
                    "Suspicious Windows Registry Activities",
                    "Windows Persistence Techniques"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "remote_wmi_command_attempt": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious WMI Use",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Lateral Movement",
            "dashboard": "showcase_security_content?showcaseId=remote_wmi_command_attempt",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2018-12-03",
            "description": "This search looks for wmic.exe being launched with parameters to operate on remote systems.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "remote_wmi_command_attempt",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Administrators may use this legitimately to gather info from remote systems.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "remote_wmi_command_attempt_filter"
                }
            ],
            "mitre_sub_technique": "T1047",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1047",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Frankenstein|APT41|FIN6|Soft Cell|APT32|MuddyWater|OilRig|Threat Group-3390|FIN8|Leviathan|menuPass|Stealth Falcon|Lazarus Group|APT29|Deep Panda",
            "name": "Remote WMI Command Attempt",
            "references": [],
            "released": "2018-12-03",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=wmic.exe  AND Processes.process= */node* by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `remote_wmi_command_attempt_filter`",
            "search_name": "ESCU - Remote WMI Command Attempt - Rule",
            "story": "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "tags": {
                "analytics_story": [
                    "Suspicious WMI Use"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 5"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT41",
                    "FIN6",
                    "Soft Cell",
                    "APT32",
                    "MuddyWater",
                    "OilRig",
                    "Threat Group-3390",
                    "FIN8",
                    "Leviathan",
                    "menuPass",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1047"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Management Instrumentation"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "risky_events_from_privileged_users": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|IAM Analytics",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Risky Events from Privileged Users - Demo",
            "data_source_categories": "DS013TicketManagement-ET02LowLevelEvents",
            "deprecated_not_used_anymore_datasource": "Ticketing System",
            "description": "When something generally risky occurs to your most privileged users, you likely should respond more quickly. Fortunately, this is easy to do.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Threat",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Risky Events from Privileged Users - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Risky Events from Privileged Users - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of events from the risk index of a demo environment for Splunk Enterprise Security. The risk index provides a way to track \"risky\" events that aren't necessarily significant enough to send to a SOC analyst (along with aggregating the overall volume of events for a given user). Our live search looks for the same behavior using the standard sourcetypes. See How to Implement if you do not use Enterprise Security.",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this search depends on two key components -- a list of risky events, and a list of privileged users.</p><p>You can use almost anything to generate a list of risky events -- in fact that's the desired intent for most medium-or-higher alert volume searches in Splunk Security Essentials! Most customers who go down this path will use the Enterprise Security Risk Framework to aggregate these events, though you can also 'roll your own' risk framework with Summary Indexing.</p><p>Generating a list of risky users is complicated -- that's why one of the most detailed examples in Splunk Security Essentials takes this on! Check it out! (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>).</p><p>Once you have these components, implementation of this detection is straightforward.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "This search can inherently generate false positives because it opens the door to alerting users to low confidence events that occur to privileged users. You will need to tune the underlying search, or potentially filter for a certain risk score to manage these false positives.",
            "mitre": "",
            "mitre_tactic": "|TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Risky Events from Privileged Users",
            "operationalize": "See the response guidance for the underlying searches that generate the original events.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/risky_events_from_privileged_users.png",
            "released": "2.2.0",
            "relevance": "There are many searches that you would not normally want to analyze... except when they occur to your most privileged users. A high entropy process starting in a weird location is probably software installation that only really matters when combined with other events, but it's best to double check when it's occurring on the laptop belonging to the CEO's Executive Assistant. By combining a list of risky events (generated through the Enterprise Security risk framework, or your own version thereof) with a list of privileged users, you can easily prioritize those events.",
            "searchKeywords": "",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "rundll_loading_dll_by_ordinal": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Unusual Processes",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=rundll_loading_dll_by_ordinal",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.011/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-30",
            "description": "This search looks for executing scripts with rundll32. Adversaries may abuse rundll32.exe to proxy execution of malicious code. Using rundll32.exe, vice executing directly, may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "rundll_loading_dll_by_ordinal",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "known_false_positives": "While not common, loading a DLL under %AppData% and calling a function by ordinal is possible by a legitimate process",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "rundll_loading_dll_by_ordinal_filter"
                }
            ],
            "mitre_sub_technique": "T1218.011",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1218",
            "mitre_threat_groups": "APT32|Sandworm Team|Blue Mockingbird|TA505|MuddyWater|APT29|APT19|CopyKittens|APT3|Carbanak|APT28",
            "name": "Rundll Loading DLL By Ordinal",
            "references": [],
            "released": "2020-11-30",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = rundll32.exe by Processes.process_name Processes.parent_process_name Processes.process Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `rundll_loading_dll_by_ordinal_filter`",
            "search_name": "ESCU - RunDLL Loading DLL By Ordinal - Rule",
            "story": "f4368e3f-d59f-4192-84f6-748ac5a3ddb6",
            "tags": {
                "analytics_story": [
                    "Unusual Processes"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.011/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation"
                ],
                "mitre_attack_groups": [
                    "APT32",
                    "Sandworm Team",
                    "Blue Mockingbird",
                    "TA505",
                    "MuddyWater",
                    "APT29",
                    "APT19",
                    "CopyKittens",
                    "APT3",
                    "Carbanak",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1218"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Rundll32"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "ryuk_test_files_detected": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ryuk Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rod Soto, Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=ryuk_test_files_detected",
            "data_source_categories": "Other",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/ryuk/windows-sysmon.log"
            ],
            "date": "2020-11-06",
            "description": "The search looks for files that contain the key word *Ryuk* under any folder in the C drive, which is consistent with Ryuk propagation.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint Filesystem data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint Filesystem data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "ryuk_test_files_detected",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "If there are files with this keywoord as file names it might trigger false possitives, please make use of our filters to tune out potential FPs.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "ryuk_test_files_detected_filter"
                }
            ],
            "mitre_sub_technique": "T1486",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1486",
            "mitre_threat_groups": "APT41|TA505|APT38",
            "name": "Ryuk Test Files Detected",
            "references": [],
            "released": "2020-11-06",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem WHERE \"Filesystem.file_path\"=C:\\\\*Ryuk* BY \"Filesystem.dest\", \"Filesystem.user\", \"Filesystem.file_path\" | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `ryuk_test_files_detected_filter`",
            "search_name": "ESCU - Ryuk Test Files Detected - Rule",
            "story": "507edc74-13d5-4339-878e-b9744ded1f35",
            "tags": {
                "analytics_story": [
                    "Ryuk Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/ryuk/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "APT41",
                    "TA505",
                    "APT38"
                ],
                "mitre_attack_id": [
                    "T1486"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Data Encrypted for Impact"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "same_error_on_many_servers_detected": {
            "SPLEase": "Basic",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Operations|Lateral Movement",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Alerts when multiple systems are exhibiting the same errors",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Threat",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "Too broad - cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Same Error On Many Servers Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Threat - Same Error On Many Systems - Rule",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "samsam_test_file_write": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=samsam_test_file_write",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1486/sam_sam_note/windows-sysmon.log"
            ],
            "date": "2018-12-14",
            "description": "The search looks for a file named \"test.txt\" written to the windows system directory tree, which is consistent with Samsam propagation.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the file-system activity from your hosts to populate the Endpoint file-system data-model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "samsam_test_file_write",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery",
            "known_false_positives": "No false positives have been identified.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "samsam_test_file_write_filter"
                }
            ],
            "mitre_sub_technique": "T1486",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1486",
            "mitre_threat_groups": "APT41|TA505|APT38",
            "name": "Samsam Test File Write",
            "references": [],
            "released": "2018-12-14",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_name) as file_name from datamodel=Endpoint.Filesystem where Filesystem.file_path=*\\\\windows\\\\system32\\\\test.txt by Filesystem.file_path | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `samsam_test_file_write_filter`",
            "search_name": "ESCU - Samsam Test File Write - Rule",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1486/sam_sam_note/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "APT41",
                    "TA505",
                    "APT38"
                ],
                "mitre_attack_id": [
                    "T1486"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Data Encrypted for Impact"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "sc_exe_manipulating_windows_services": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Service Abuse|DHS Report TA18-074A|Orangeworm Attack Group|Windows Persistence Techniques|Disabling Security Tools|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=sc_exe_manipulating_windows_services",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1543.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for arguments to sc.exe indicating the creation or modification of a Windows service.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 8",
            "escu_nist": "PR.IP|PR.PT|PR.AC|PR.AT|DE.CM",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "sc_exe_manipulating_windows_services",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Using sc.exe to manipulate Windows services is uncommon. However, there may be legitimate instances of this behavior. It is important to validate and investigate as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "sc_exe_manipulating_windows_services_filter"
                }
            ],
            "mitre_sub_technique": "T1543.003",
            "mitre_tactic": "TA0003|TA0004",
            "mitre_tactic_display": "Persistence|Privilege Escalation",
            "mitre_technique": "T1543",
            "mitre_threat_groups": "Blue Mockingbird|DarkVishnya|Wizard Spider|APT32|APT41|Kimsuky|Tropic Trooper|Cobalt Group|Ke3chang|Honeybee|FIN7|Threat Group-3390|APT19|APT3|Lazarus Group|Carbanak",
            "name": "Sc Exe Manipulating Windows Services",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = sc.exe (Processes.process=\"* create *\" OR Processes.process=\"* config *\") by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `sc_exe_manipulating_windows_services_filter`",
            "search_name": "ESCU - Sc exe Manipulating Windows Services - Rule",
            "story": "6dbd810e-f66d-414b-8dfc-e46de55cbfe2|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|bb9f5ed2-916e-4364-bb6d-97c370efcf52|30874d4f-20a1-488f-85ec-5d52ef74e3f9|fcc27099-46a0-46b0-a271-5c7dab56b6f1|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Windows Service Abuse",
                    "DHS Report TA18-074A",
                    "Orangeworm Attack Group",
                    "Windows Persistence Techniques",
                    "Disabling Security Tools",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1543.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "DarkVishnya",
                    "Wizard Spider",
                    "APT32",
                    "APT41",
                    "Kimsuky",
                    "Tropic Trooper",
                    "Cobalt Group",
                    "Ke3chang",
                    "Honeybee",
                    "FIN7",
                    "Threat Group-3390",
                    "APT19",
                    "APT3",
                    "Lazarus Group",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1543"
                ],
                "mitre_attack_tactics": [
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Windows Service"
                ],
                "nist": [
                    "PR.IP",
                    "PR.PT",
                    "PR.AC",
                    "PR.AT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "scanning_activity": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Identifies devices correlated to suspicious vertical and horizontal scanning patters.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0007",
            "mitre_technique": "|T1046",
            "name": "Scanning Activity",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "scheduled_task_deleted_or_created_via_cmd": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DHS Report TA18-074A|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=scheduled_task_deleted_or_created_via_cmd",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-12-17",
            "description": "This search looks for flags passed to schtasks.exe on the command-line that indicate a task was created via command like. This has been associated with the Dragonfly threat actor, and the SUNBURST attack against Solarwinds.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "scheduled_task_deleted_or_created_via_cmd",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Tasks should not be manually created via CLI, this is rarely done by admins as well",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "scheduled_task_deleted_or_created_via_cmd_filter"
                }
            ],
            "mitre_sub_technique": "T1053.005",
            "mitre_tactic": "TA0002|TA0003|TA0004",
            "mitre_tactic_display": "Execution|Persistence|Privilege Escalation",
            "mitre_technique": "T1053",
            "mitre_threat_groups": "Gamaredon Group|Blue Mockingbird|MuddyWater|Wizard Spider|Frankenstein|APT-C-36|BRONZE BUTLER|APT41|Machete|Soft Cell|Silence|TEMP.Veles|APT33|APT39|Dragonfly 2.0|Patchwork|OilRig|Rancor|Cobalt Group|FIN8|menuPass|FIN10|APT32|FIN7|Stealth Falcon|FIN6|APT3|APT29",
            "name": "Scheduled Task Deleted Or Created Via Cmd",
            "references": [],
            "released": "2020-12-17",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=schtasks.exe (Processes.process=*delete* OR Processes.process=*create*) by Processes.user Processes.process_name Processes.parent_process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `scheduled_task_deleted_or_created_via_cmd_filter` ",
            "search_name": "ESCU - Scheduled Task Deleted Or Created via CMD - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "DHS Report TA18-074A",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Blue Mockingbird",
                    "MuddyWater",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT-C-36",
                    "BRONZE BUTLER",
                    "APT41",
                    "Machete",
                    "Soft Cell",
                    "Silence",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Dragonfly 2.0",
                    "Patchwork",
                    "OilRig",
                    "Rancor",
                    "Cobalt Group",
                    "FIN8",
                    "menuPass",
                    "FIN10",
                    "APT32",
                    "FIN7",
                    "Stealth Falcon",
                    "FIN6",
                    "APT3",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1053"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Scheduled Task"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 5
        },
        "scheduled_task_name_used_by_dragonfly_threat_actors": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=scheduled_task_name_used_by_dragonfly_threat_actors",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-12-07",
            "description": "This search looks for flags passed to schtasks.exe on the command-line that indicate a task name associated with the Dragonfly threat actor was created or deleted.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "scheduled_task_name_used_by_dragonfly_threat_actors",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "No known false positives",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "scheduled_task_name_used_by_dragonfly_threat_actors_filter"
                }
            ],
            "mitre_sub_technique": "T1053.005",
            "mitre_tactic": "TA0002|TA0003|TA0004",
            "mitre_tactic_display": "Execution|Persistence|Privilege Escalation",
            "mitre_technique": "T1053",
            "mitre_threat_groups": "Gamaredon Group|Blue Mockingbird|MuddyWater|Wizard Spider|Frankenstein|APT-C-36|BRONZE BUTLER|APT41|Machete|Soft Cell|Silence|TEMP.Veles|APT33|APT39|Dragonfly 2.0|Patchwork|OilRig|Rancor|Cobalt Group|FIN8|menuPass|FIN10|APT32|FIN7|Stealth Falcon|FIN6|APT3|APT29",
            "name": "Scheduled Task Name Used By Dragonfly Threat Actors",
            "references": [],
            "released": "2020-12-07",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=schtasks.exe (Processes.process=*delete* OR Processes.process=*create*) by Processes.user Processes.process_name Processes.parent_process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `scheduled_task_name_used_by_dragonfly_threat_actors_filter` ",
            "search_name": "ESCU - Scheduled Task Name Used by Dragonfly Threat Actors - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Blue Mockingbird",
                    "MuddyWater",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT-C-36",
                    "BRONZE BUTLER",
                    "APT41",
                    "Machete",
                    "Soft Cell",
                    "Silence",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Dragonfly 2.0",
                    "Patchwork",
                    "OilRig",
                    "Rancor",
                    "Cobalt Group",
                    "FIN8",
                    "menuPass",
                    "FIN10",
                    "APT32",
                    "FIN7",
                    "Stealth Falcon",
                    "FIN6",
                    "APT3",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1053"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Scheduled Task"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 5
        },
        "scheduled_tasks_used_in_badrabbit_ransomware": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=scheduled_tasks_used_in_badrabbit_ransomware",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for flags passed to schtasks.exe on the command-line that indicate that task names related to the execution of Bad Rabbit ransomware were created or deleted.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "scheduled_tasks_used_in_badrabbit_ransomware",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "No known false positives",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "scheduled_tasks_used_in_badrabbit_ransomware_filter"
                }
            ],
            "mitre_sub_technique": "T1053.005",
            "mitre_tactic": "TA0002|TA0003|TA0004",
            "mitre_tactic_display": "Execution|Persistence|Privilege Escalation",
            "mitre_technique": "T1053",
            "mitre_threat_groups": "Gamaredon Group|Blue Mockingbird|MuddyWater|Wizard Spider|Frankenstein|APT-C-36|BRONZE BUTLER|APT41|Machete|Soft Cell|Silence|TEMP.Veles|APT33|APT39|Dragonfly 2.0|Patchwork|OilRig|Rancor|Cobalt Group|FIN8|menuPass|FIN10|APT32|FIN7|Stealth Falcon|FIN6|APT3|APT29",
            "name": "Scheduled Tasks Used In Badrabbit Ransomware",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process) as process  from datamodel=Endpoint.Processes where Processes.process_name=schtasks.exe (Processes.process= \"*create*\"  OR Processes.process= \"*delete*\") by Processes.parent_process Processes.process_name Processes.user | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | search (process=*rhaegal* OR process=*drogon* OR *viserion_*) | `scheduled_tasks_used_in_badrabbit_ransomware_filter`",
            "search_name": "ESCU - Scheduled tasks used in BadRabbit ransomware - Rule",
            "story": "cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Blue Mockingbird",
                    "MuddyWater",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT-C-36",
                    "BRONZE BUTLER",
                    "APT41",
                    "Machete",
                    "Soft Cell",
                    "Silence",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Dragonfly 2.0",
                    "Patchwork",
                    "OilRig",
                    "Rancor",
                    "Cobalt Group",
                    "FIN8",
                    "menuPass",
                    "FIN10",
                    "APT32",
                    "FIN7",
                    "Stealth Falcon",
                    "FIN6",
                    "APT3",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1053"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Scheduled Task"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "schtasks_scheduling_job_on_remote_system": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Lateral Movement|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Lateral Movement",
            "dashboard": "showcase_security_content?showcaseId=schtasks_scheduling_job_on_remote_system",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for flags passed to schtasks.exe on the command-line that indicate a job is being scheduled on a remote system.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "schtasks_scheduling_job_on_remote_system",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Administrators may create jobs on remote systems, but this activity is usually limited to a small set of hosts or users. It is important to validate and investigate as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "schtasks_scheduling_job_on_remote_system_filter"
                }
            ],
            "mitre_sub_technique": "T1053.005",
            "mitre_tactic": "TA0002|TA0003|TA0004",
            "mitre_tactic_display": "Execution|Persistence|Privilege Escalation",
            "mitre_technique": "T1053",
            "mitre_threat_groups": "Gamaredon Group|Blue Mockingbird|MuddyWater|Wizard Spider|Frankenstein|APT-C-36|BRONZE BUTLER|APT41|Machete|Soft Cell|Silence|TEMP.Veles|APT33|APT39|Dragonfly 2.0|Patchwork|OilRig|Rancor|Cobalt Group|FIN8|menuPass|FIN10|APT32|FIN7|Stealth Falcon|FIN6|APT3|APT29",
            "name": "Schtasks Scheduling Job On Remote System",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = schtasks.exe Processes.process=\"*/create*\" (Processes.process=\"* /s *\" OR Processes.process=\"* /S *\") by Processes.process_name Processes.process Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `schtasks_scheduling_job_on_remote_system_filter`",
            "search_name": "ESCU - Schtasks scheduling job on remote system - Rule",
            "story": "399d65dc-1f08-499b-a259-aad9051f38ad|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Lateral Movement",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Blue Mockingbird",
                    "MuddyWater",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT-C-36",
                    "BRONZE BUTLER",
                    "APT41",
                    "Machete",
                    "Soft Cell",
                    "Silence",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Dragonfly 2.0",
                    "Patchwork",
                    "OilRig",
                    "Rancor",
                    "Cobalt Group",
                    "FIN8",
                    "menuPass",
                    "FIN10",
                    "APT32",
                    "FIN7",
                    "Stealth Falcon",
                    "FIN6",
                    "APT3",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1053"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Scheduled Task"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "schtasks_used_for_forcing_a_reboot": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Persistence Techniques|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=schtasks_used_for_forcing_a_reboot",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/schtask_shutdown/windows-sysmon.log"
            ],
            "date": "2020-12-07",
            "description": "This search looks for flags passed to schtasks.exe on the command-line that indicate that a forced reboot of system is scheduled.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to be ingesting logs with both the process name and command-line from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to be ingesting logs with both the process name and command-line from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "icon": "ES_Use_Case.png",
            "id": "schtasks_used_for_forcing_a_reboot",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Administrators may create jobs on systems forcing reboots to perform updates, maintenance, etc.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "schtasks_used_for_forcing_a_reboot_filter"
                }
            ],
            "mitre_sub_technique": "T1053.005",
            "mitre_tactic": "TA0002|TA0003|TA0004",
            "mitre_tactic_display": "Execution|Persistence|Privilege Escalation",
            "mitre_technique": "T1053",
            "mitre_threat_groups": "Gamaredon Group|Blue Mockingbird|MuddyWater|Wizard Spider|Frankenstein|APT-C-36|BRONZE BUTLER|APT41|Machete|Soft Cell|Silence|TEMP.Veles|APT33|APT39|Dragonfly 2.0|Patchwork|OilRig|Rancor|Cobalt Group|FIN8|menuPass|FIN10|APT32|FIN7|Stealth Falcon|FIN6|APT3|APT29",
            "name": "Schtasks Used For Forcing A Reboot",
            "references": [],
            "released": "2020-12-07",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=schtasks.exe Processes.process=\"*shutdown*\" Processes.process=\"*/create *\" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `schtasks_used_for_forcing_a_reboot_filter`",
            "search_name": "ESCU - Schtasks used for forcing a reboot - Rule",
            "story": "30874d4f-20a1-488f-85ec-5d52ef74e3f9|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Windows Persistence Techniques",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/schtask_shutdown/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Blue Mockingbird",
                    "MuddyWater",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT-C-36",
                    "BRONZE BUTLER",
                    "APT41",
                    "Machete",
                    "Soft Cell",
                    "Silence",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Dragonfly 2.0",
                    "Patchwork",
                    "OilRig",
                    "Rancor",
                    "Cobalt Group",
                    "FIN8",
                    "menuPass",
                    "FIN10",
                    "APT32",
                    "FIN7",
                    "Stealth Falcon",
                    "FIN6",
                    "APT3",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1053"
                ],
                "mitre_attack_tactics": [
                    "Execution",
                    "Persistence",
                    "Privilege Escalation"
                ],
                "mitre_attack_technique": [
                    "Scheduled Task"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "script_execution_via_wmi": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious WMI Use",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=script_execution_via_wmi",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/execution_scrcons/windows-sysmon.log"
            ],
            "date": "2020-03-16",
            "description": "This search looks for scripts launched via WMI.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "script_execution_via_wmi",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Although unlikely, administrators may use wmi to launch scripts for legitimate purposes.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "script_execution_via_wmi_filter"
                }
            ],
            "mitre_sub_technique": "T1047",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1047",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Frankenstein|APT41|FIN6|Soft Cell|APT32|MuddyWater|OilRig|Threat Group-3390|FIN8|Leviathan|menuPass|Stealth Falcon|Lazarus Group|APT29|Deep Panda",
            "name": "Script Execution Via WMI",
            "references": [],
            "released": "2020-03-16",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.process_name = \"scrcons.exe\" by Processes.user Processes.dest Processes.process_name  | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| `script_execution_via_wmi_filter` ",
            "search_name": "ESCU - Script Execution via WMI - Rule",
            "story": "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "tags": {
                "analytics_story": [
                    "Suspicious WMI Use"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/execution_scrcons/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT41",
                    "FIN6",
                    "Soft Cell",
                    "APT32",
                    "MuddyWater",
                    "OilRig",
                    "Threat Group-3390",
                    "FIN8",
                    "Leviathan",
                    "menuPass",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1047"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Management Instrumentation"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "sensitive_kubernetes_mount_pod_detected": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Cloud Security|Abuse|Account Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Sensitive%20Kubernetes%20Mount%20Pod%20Detected%20-%20Live",
            "data_source_categories": "VendorSpecific-kubernetes",
            "description": "<p>This search looks for pod start events with a mount host path that is classified as sensitive. Some pods will do this as part of normal operations but this is also a way for an attacker to do privilege escalation and lateral movement.</p><p><b>Alert:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "is_live_version": true,
                    "label": "Live Data",
                    "live_split_eligible": true,
                    "name": "Sensitive Kubernetes Mount Pod Detected - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>The basic idea behind this search is to take a set of known sensitive mount host paths and checking if any pods are started with these. The last lines of the search are more concerened with renaming and formatting and making it look understandable for an analyst.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>The data is coming from Pod logs which you can get if you deploy Splunk Connect for Kubernetes. These logs are generated from the Pods themselves and reveals the image, container and repository information. While implementing, make sure you follow the best practice of specifying the index for your data. ",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p>This search should trigger very few false positives, because it's filtered to just very specific events. The keyword list does not use wildcards but some pods have genuine reasons to have these sensitive mount paths. If that is the case in your environment you can add these pods to the allow list directly in the search or via a lookup. </p>",
            "mitre": "Discovery|Lateral Movement|Execution",
            "mitre_tactic": "TA0040",
            "mitre_technique": "T1496",
            "name": "Sensitive Kubernetes Mount Pod Detected",
            "operationalize": "<p>This alert is very clearly tied to a known threat, so when it fires your concern is that this represents an attacker inside of one of your systems. Recommended steps are to begin incident response on the host where this alert fired from, to look for signs of other suspicious activities. The first step in that process will be to look for other events that involve the same IP or user name, and see what other activities the attacker might have done. That should guide you to the underlying problem. </p>",
            "relatedUseCases": [
                "detection_kubernetes_aws_scan_fingerprint",
                "detection_kubernetes_pods_aws_scan_fingerprint",
                "detection_kubernetes_gcp_scan_fingerprint_attack",
                "image_from_new_repository_detected",
                "suspicious_container_image_name"
            ],
            "released": "3.2.0",
            "relevance": "Using this technique is is possible for an attacker to abuse hostPath volume mounts for a Pod to escape the namespace constraints and gain access to Pods in any other namespace. This ability can in turn be leveraged to eventually gain maximum privilege in the cluster i.e. Cluster Admin. Reference scenarios include these <a target=\"_blank\" href=\"https://blog.appsecco.com/kubernetes-namespace-breakout-using-insecure-host-path-volume-part-1-b382f2a6e216\">Kubernetes Namespace Breakout using Insecure Host Path Volume</a> ",
            "searchKeywords": "kubernetes|k8s|docker|container",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "shim_database_file_creation": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=shim_database_file_creation",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-12-08",
            "description": "This search looks for shim database files being written to default directories. The sdbinst.exe application is used to install shim database files (.sdb). According to Microsoft, a shim is a small library that transparently intercepts an API, changes the parameters passed, handles the operation itself, or redirects the operation elsewhere.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "shim_database_file_creation",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Because legitimate shim files are created and used all the time, this event, in itself, is not suspicious. However, if there are other correlating events, it may warrant further investigation.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "shim_database_file_creation_filter"
                }
            ],
            "mitre_sub_technique": "T1546.011",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_tactic_display": "Privilege Escalation|Persistence",
            "mitre_technique": "T1546",
            "mitre_threat_groups": "FIN7",
            "name": "Shim Database File Creation",
            "references": [],
            "released": "2020-12-08",
            "search": "| tstats `security_content_summariesonly` count values(Filesystem.action) values(Filesystem.file_hash) as file_hash values(Filesystem.file_path) as file_path  min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem where Filesystem.file_path=*Windows\\\\AppPatch\\\\Custom* by Filesystem.file_name Filesystem.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` |`drop_dm_object_name(Filesystem)` | `shim_database_file_creation_filter`",
            "search_name": "ESCU - Shim Database File Creation - Rule",
            "story": "30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Windows Persistence Techniques"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1546"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Application Shimming"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "shim_database_installation_with_suspicious_parameters": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Persistence Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=shim_database_installation_with_suspicious_parameters",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-11-23",
            "description": "This search detects the process execution and arguments required to silently create a shim database.  The sdbinst.exe application is used to install shim database files (.sdb). A shim is a small library which transparently intercepts an API, changes the parameters passed, handles the operation itself, or redirects the operation elsewhere.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "shim_database_installation_with_suspicious_parameters",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "shim_database_installation_with_suspicious_parameters_filter"
                }
            ],
            "mitre_sub_technique": "T1546.011",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_tactic_display": "Privilege Escalation|Persistence",
            "mitre_technique": "T1546",
            "mitre_threat_groups": "FIN7",
            "name": "Shim Database Installation With Suspicious Parameters",
            "references": [],
            "released": "2020-11-23",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = sdbinst.exe by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `shim_database_installation_with_suspicious_parameters_filter`",
            "search_name": "ESCU - Shim Database Installation With Suspicious Parameters - Rule",
            "story": "30874d4f-20a1-488f-85ec-5d52ef74e3f9",
            "tags": {
                "analytics_story": [
                    "Windows Persistence Techniques"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "FIN7"
                ],
                "mitre_attack_id": [
                    "T1546"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Application Shimming"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "short_lived_windows_accounts": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Account Monitoring and Controls",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Best Practices",
            "dashboard": "showcase_security_content?showcaseId=short_lived_windows_accounts",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "Change",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-security.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-system.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-06",
            "description": "This search detects accounts that were created and deleted in a short time period.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "This search requires you to have enabled your Group Management Audit Logs in your Local Windows Security Policy and be ingesting those logs.  More information on how to enable them can be found here: http://whatevernetworks.com/auditing-group-membership-changes-in-active-directory/",
            "highlight": "No",
            "how_to_implement": "This search requires you to have enabled your Group Management Audit Logs in your Local Windows Security Policy and be ingesting those logs.  More information on how to enable them can be found here: http://whatevernetworks.com/auditing-group-membership-changes-in-active-directory/",
            "icon": "ES_Use_Case.png",
            "id": "short_lived_windows_accounts",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "None",
            "known_false_positives": "It is possible that an administrator created and deleted an account in a short time period.  Verifying activity with an administrator is advised.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "short_lived_windows_accounts_filter"
                }
            ],
            "mitre_sub_technique": "T1136.001",
            "mitre_tactic": "TA0003",
            "mitre_tactic_display": "Persistence",
            "mitre_technique": "T1136",
            "mitre_threat_groups": "APT39|APT41|Dragonfly 2.0|Leafminer|APT3",
            "name": "Short Lived Windows Accounts",
            "references": [],
            "released": "2020-07-06",
            "search": "| tstats `security_content_summariesonly` values(All_Changes.result_id) as result_id count min(_time) as firstTime max(_time) as lastTime from datamodel=Change where All_Changes.result_id=4720 OR All_Changes.result_id=4726 by _time span=4h All_Changes.user All_Changes.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(\"All_Changes\")` | search result_id = 4720 result_id=4726 | transaction user connected=false maxspan=240m | table firstTime lastTime count user dest result_id | `short_lived_windows_accounts_filter`",
            "search_name": "ESCU - Short Lived Windows Accounts - Rule",
            "story": "8892a655-6205-55f7-abba-06460e38c8ae",
            "tags": {
                "analytics_story": [
                    "Account Monitoring and Controls"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 16"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-security.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-system.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.001/atomic_red_team/windows-sysmon.log"
                ],
                "mitre_attack_groups": [
                    "APT39",
                    "APT41",
                    "Dragonfly 2.0",
                    "Leafminer",
                    "APT3"
                ],
                "mitre_attack_id": [
                    "T1136"
                ],
                "mitre_attack_tactics": [
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Local Account"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "access"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "shortlived_account_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Account Compromise",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS006UserActivity-ET03Create|DS006UserActivity-ET05Delete",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "Detects when a account or credential is created and then removed a short time later. This may be an indication of malicious activities.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0003|TA0004",
            "mitre_technique": "|T1136|T1078",
            "name": "Short-lived Account Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Access - Short-lived Account Detected - Rule",
            "usecase": "Security Monitoring"
        },
        "showcase_emails_with_lookalike_domains": {
            "SPLEase": "Advanced",
            "advancedtags": "Autobahn|Cool Search|Useful SPL Documentation",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|SaaS|Cloud Security",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Emails With Lookalike Domains - Demo",
            "data_source_categories": "DS001MAIL-ET02Receive",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "<p>Emailing from a domain name that is similar to your own is a common phishing technique, such as splunk.com receiving an email from spiunk.com. This search will detect those similar domains.</p><p><b>Alert Volume:</b> Very Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Emails With Lookalike Domains - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Emails With Lookalike Domains - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Emails With Lookalike Domains - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
            "highlight": "Yes",
            "howToImplement": "Implementing this search is generally fairly straightforward. If you have CIM compliant data onboarded, it should work out of the box, however you are always better off specifying the index and sourcetype of your email data (think particularly when you have multiple email log sources, such as a perimeter ESA and a core Exchange environment). If you have the right index, sourcetype, you have the src_user field, and you've installed the URL Toolbox app, it should work like a charm. ",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Delivery",
            "knownFP": "<p>This search will through incoming emails for any domains similar to your domain names, much like running dnstwist on a domain name. If there are any incoming emails with source domain names that are very similar to but not the same, they would create alerts which could be false positives. One might imagine a scenario where a company who manufactures wooden planks for pirate ships, plank.com, emails their sales rep at splunk.com. That would create a difference of 2 (u->a, extra s) and would be flagged (Arrrr!). Known examples of this could be filtered out in the search, or you could pipe this into a First Time Seen detection to automatically remove past examples. </p>",
            "mitre": "Initial Access",
            "mitre_sub_technique": "T1566.002",
            "mitre_tactic": "TA0001",
            "mitre_technique": "|T1192",
            "name": "Emails with Lookalike Domains",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, the sender, recipient, subject or the mail and attachments, if any. Contact the sender. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_phishing_remediation_investigation"
            ],
            "released": "1.2.0",
            "searchKeywords": "typo",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_external_emails_with_internal_domain": {
            "SPLEase": "Medium",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New External IPs Sending Company Emails - Demo",
            "data_source_categories": "DS001MAIL-ET02Receive",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "<p>Phishers will often try to send emails where the from address uses your organization's domain name, e.g., emailing finance from yourceo@yourcompany.com. Detect that now!</p><p><b>Alert Volume:</b> Very Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New External IPs Sending Company Emails - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New External IPs Sending Company Emails - Live"
                },
                {
                    "label": "Cisco ESA Live Data",
                    "name": "New External IPs Sending Company Emails - Cisco ESA Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "New External IPs Sending Company Emails - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Make sure that you specify the correct domain name (or domain names) that belong to your company.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>Sending emails from your organization's domain from outside the organization is not uncommon, but new sources should be rare and investigated. Because this search has a behavioral component, only new sources (or very rare sources you haven't seen before, such as maybe quarter-end notifications) should show up and be investigated. Those can be filtered out, or you can use the lookup cache to build a long baseline that allows for it. </p></p>The only other source of false positives here will be more IP addresses from known and trusted vendors -- you can filter out entire cidr ranges, or just quickly dismiss the alerts based on forward and reverse DNS matching both matching an allowed source.</p>",
            "mitre": "Initial Access",
            "mitre_sub_technique": "T1566.002",
            "mitre_tactic": "TA0001",
            "mitre_technique": "|T1192",
            "name": "Emails from Outside the Organization with Company Domains",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, the system that originated the incoming mail and if possible identify the sender, recipient, subject of the mail and attachments, if any. Contact the recipient and mail administrator. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_phishing_investigation",
                "phantom_ip_investigate_report"
            ],
            "relatedUseCases": [
                "detection_email_attachments_with_spaces",
                "showcase_spike_in_outgoing_email",
                "high_volume_email_activity_to_noncorporate_domains_by_user",
                "detection_suspicious_email_attachments",
                "UC0004"
            ],
            "released": "1.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_first_git": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Accessing New Git Repositories - Demo",
            "data_source_categories": "DS014WebServer-ET03SourceCode",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "<p>Find users who accessed a git repository for the first time.</p><p><b>Alert Volume:</b> High</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Accessing New Git Repositories - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Accessing New Git Repositories - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Accessing New Git Repositories - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is the Splunk-internal git source source checkout history for a couple of our Splunk UBA software developers, anonymized to Alice and Chuck. On the last day, I added in a few more developers who visit other repositories, but set their usernames to Chuck so that it looks like he started downloading from a bunch of repositories that he's never touched before. We also have a user Bob, who has checked out from a few other repositories in the past, and is on Chuck's team. For this analysis, we are looking at the first time a username has checked out from a repository names, and alerting if that was in the last day. We can always also filter for peer groups, to exclude those repositories that Bob (on Chuck's team) had viewed before.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p><p><i>Note</i>: We include an accelerated version to show how this would work, but there is no data model for this out of the box, so you would need to build one yourself.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for access to extremely sensitive repositories), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213",
            "name": "First Time Accessing an Internal Git Repository",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user account accessing the specific repo. Contact the user and manager to determine if they are accessing the repo with authorization. If they did not access this repo, attempt to determine if the user credentials have been used by another party by stealing a users credentials.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "released": "1.0.0",
            "relevance": "This is an insider threat use case. Your developers are often granted access to the Git (or other software life cycle repository) that their responsibilities require, but one condition to be aware of is the first time a user accesses a given repository. This could be perfectly normal, or if the repository contains code not relevant to the developers role, could be an anomaly to investigate.",
            "searchKeywords": "",
            "usecase": "Insider Threat|Advanced Threat Detection"
        },
        "showcase_first_git_peer": {
            "SPLEase": "Advanced",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Accessing New Git Repositories With Peer - Demo",
            "data_source_categories": "DS014WebServer-ET03SourceCode",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "<p>Find users who accessed a git repository for the first time, where their peer group also hasn't accessed it before.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Accessing New Git Repositories With Peer - Demo"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is the Splunk-internal git source source checkout history for a couple of our Splunk UBA software developers, anonymized to Alice and Chuck. On the last day, I added in a few more developers who visit other repositories, but set their usernames to Chuck so that it looks like he started downloading from a bunch of repositories that he's never touched before. We also have a user Bob, who has checked out from a few other repositories in the past, and is on Chuck's team. Under the peer group, git_peer_group is selected, which includes that chuck and bob are on the same team. For this analysis, we are looking at the first time a username, or anyone in that user's peer group, has checked out from a repository names, and alerting if that was in the last day. </p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple, though the peer group makes things slightly more complicated.<ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>To configure the Peer Group:<ol><li>Start with a data source that gives you visibility into the peer group -- easiest is usually querying Active Directory via the <a href=\"https://splunkbase.splunk.com/app/1151/\">SA-ldapsearch add-on</a>, but you could get lists of users and their teams / departments / etc from any source you have.</li><li>Next you will need to convert that log source into a format that this lookup is expecting, which is as follows:<table class=\"table\" style=\"width: 300px\"><tr><td>user</td><td>peergroup (order not important)</td></tr><tr><td>john</td><td>john|sarah</td></tr><tr><td>sarah</td><td>john|sarah</td></tr><tr><td>mark</td><td>mark</td></tr></table>The easiest way to do this is with a search like <span class=\"spl\">| inputlookup LDAPSearch.csv | stats values(user) as user by department | eval peergroup=mvjoin(user, \"|\") | mvexpand user</span></li></ol></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise (even though the peer groups help manage noise).</p><p> You should not review these alerts directly except for access to extremely sensitive repositories, but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213",
            "name": "First Time Accessing an Internal Git Repository Not Viewed by Peers",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user account accessing the specific repo. Contact the user and manager to determine if they are accessing the repo with authorization. If they did not access this repo, attempt to determine if the user credentials have been used by another party by stealing a user's credentials.</p>",
            "released": "1.0.0",
            "relevance": "This is an insider threat use case that builds off of the \"Accessing New Git Repositories\" example. Your developers are often granted access to the Git (or other software life cycle repository) that they require, but why would they be gaining access to other repos that other members of their team (e.g. peer group) never access? This could be an alertable condition. In order to perform searches like this you must map your users into peer groups - we have done this via a simple Splunk lookup in the example, but this could be done via more automated fashion, and Splunk UBA contains its own methods of discovering peer groups for individual users.",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "showcase_first_logon": {
            "SPLEase": "Medium",
            "alertvolume": "Very High",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement|GDPR",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=First Log On to Server - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "<p>Find users who logged into a new server for the first time.</p><p><b>Alert Volume:</b> Very High</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "First Log On to Server - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "First Log On to Server - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "First Log On to Server - Accelerated"
                }
            ],
            "gdprtext": "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Windows Logon events. For this analysis, we are effectively grouping by username and system name, which will give us a row for each username+systemname combination. We check if the first time that has occurred was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Energy|Chemical|Aerospace|Healthcare|Education|Legal|Finance|Construction|Media|Transportation|Defense|Travel",
            "journey": "Stage_1",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
            "mitre": "Lateral Movement",
            "mitre_sub_technique": "T1021.001",
            "mitre_tactic": "TA0008",
            "mitre_technique": "|T1021|T1076",
            "name": "First Time Logon to New Server",
            "operationalize": "<p>When this search returns values, initiate your incident response process and validate the user account accessing the specific system. Determine who the system owner is and contact them. If it is authorized, document it as such and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as a first time logon to a server that was never logged into before could suggest compromised credentials gaining access to other systems.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "relatedUseCases": [
                "Basic_Scanning",
                "excessive_failed_logins",
                "detection_no_win_updates_in_timeframe"
            ],
            "released": "1.0.0",
            "relevance": "By monitoring and alerting on first time log ins to a server, you are able to detect if/when an adversary is able to escalate permissions or add new accounts to AD, or to endpoints directly. This should be a priority particularly for critical infrastructure, high-value and mission critical assets or those systems containing sensitive data. In addition to external adversary, this type of behavior can also be indicative of a potential insider threat issue, where an employee is probing their access, or potentially testing new accounts they may have created for malicious purposes.",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Compliance|Security Monitoring"
        },
        "showcase_first_logon_jump_server": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement|Insider Threat",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=First Log On to Jump Server - Peer Group - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "<p>Detect a user who is logging into a jump server that neither they nor any of their peers have accessed before.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data (No Peer Group)",
                    "name": "First Log On to Jump Server - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "Live Data (No Peer Group)",
                    "name": "First Log On to Jump Server - Live"
                },
                {
                    "label": "Accelerated Data (No Peer Group)",
                    "name": "First Log On to Jump Server - Accelerated"
                },
                {
                    "label": "Demo Data (With Peer Group)",
                    "name": "First Log On to Jump Server - Peer Group - Demo"
                },
                {
                    "label": "Live Data (With Peer Group)",
                    "name": "First Log On to Jump Server - Peer Group - Live"
                },
                {
                    "label": "Accelerated Data (With Peer Group)",
                    "name": "First Log On to Jump Server - Peer Group - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Windows Logon events. For this analysis, we are effectively grouping by username and system name, which will give us a row for each username+systemname combination. We check if the first time that has occurred was in the last day, and if the hostname matches our designation for jump servers.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p><p>For the specific scenario of jump server detection, you will need a way to prioritize jump servers in your environment. For customers that have a standard naming scheme for jump servers, that is easy to implement. If instead you have a list of random hostnames that can be jump servers, it's generally easiest to put them into a lookup and then use a subsearch to bring them in (e.g., | tstats ... where [| inputlookup jumpservers | table Authentication.dest | format] ).</p><p>The final piece of implementing this is to build out a departmental peer group. Follow here for an example: (DVREMINDER -- ADD THIS IN).</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
            "mitre": "Lateral Movement",
            "mitre_sub_technique": "T1021.001",
            "mitre_tactic": "TA0008|TA0001",
            "mitre_technique": "|T1078|T1076|T1021",
            "name": "First Time Access to Jump Server for Peer Group",
            "operationalize": "<p>When this search returns values, initiate your incident response process and validate the user account accessing the specific system. Determine who the system owner is and contact them. If it is authorized, document it as such and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as a first time logon to a server that was never logged into before could suggest compromised credentials gaining access to other systems.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/showcase_first_logon_jump_server.png",
            "released": "2.2.0",
            "relevance": "By monitoring and alerting on first time log ins to a jump server, you are able to detect if/when an adversary is able to escalate permissions or add new accounts to AD, or to endpoints directly. This should be a priority particularly for critical infrastructure, high-value and mission critical assets or those systems containing sensitive data. In addition to external adversary, this type of behavior can also be indicative of a potential insider threat issue, where an employee is probing their access, or potentially testing new accounts they may have created for malicious purposes.",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Insider Threat|Advanced Threat Detection"
        },
        "showcase_first_seen_domain_controller": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=First Connection to Domain Controller - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>A common indicator for lateral movement is when a user starts logging into new domain controllers.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "First Connection to Domain Controller - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "First Connection to Domain Controller - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of Windows domain controller logon events (Event ID 4776). For this analysis, we are effectively grouping by username and domain controller name, which will give us a row for each username+domaincontrollername combination. We check if the first time that has occurred was in the last day.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Travel|Technology",
            "journey": "Stage_1",
            "killchain": "Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Lateral Movement",
            "mitre_tactic": "TA0008",
            "mitre_technique": "|T1021",
            "name": "Authentication Against a New Domain Controller",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user account accessing the specific domain controller. Contact the user and system owner about this action. If it is authorized, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine that lateral movement is not occurring.</p>",
            "relatedUseCases": [
                "New_Domain",
                "showcase_new_ad_domain"
            ],
            "released": "1.0.0",
            "relevance": "Once an attacker gains access to a network either through a compromised asset or credentials, most will attempt to then move laterally within the network targeting critical infrastructure. As domain controllers provide the physical storage for the Active Directory Domain Services (AD DS) database, in addition to providing the services and data that allow enterprises to effectively manage endpoints (servers and workstations), users, and applications. If privileged access to a domain controller is obtained by a malicious user, that adversary can modify, corrupt, or destroy the AD DS database and, along with all of the systems and accounts that are managed by Active Directory. By monitoring both successful and unsuccessful authentication attempts organizations can identify anomalies such as time of day, frequency and other suspicious patters that may indicate compromised assets or credentials.",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_first_usb": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=First USB Usage - Demo",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "deprecated_not_used_anymore_datasource": "DLP|Endpoint Detection and Response",
            "description": "<p>Find systems the first time they generate Windows Event ID 20001, which for some customers occurs when a USB drive is plugged in.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "First USB Usage - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "First USB Usage - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "First USB Usage - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Windows Event ID 20001 logs, which correlated on that system with when USB drives were used. (You may also get value from using endpoint DLP, etc -- we have also seen at a larger customer where their Splunk installation did not have 20001 logs showing up). For this analysis, we are looking at the first time that Event ID is showing up from that system and alerting if that was in the last day. </p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. <b>For this example</b> this is tricky, since in our testing some systems generate system EventCode 20001 when a USB drive is plugged in, and others do not, and it is not clear why. You may wish to switch the base dataset here with endpoint DLP if available, as it would more reliably track USB key usage.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This will obviously fire any time there is a USB key inserted for the first time, which is not an explicit indicator of suspicious activities. Instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
            "mitre": "Lateral Movement|Collection|Exfiltration",
            "mitre_sub_technique": "T1052.001",
            "mitre_tactic": "TA0008|TA0009|TA0010",
            "mitre_technique": "|T1091|T1025|T1052",
            "name": "First Time USB Usage",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the physical location of the system. Determine the system owner and inform them of this action. Work with the system owner to determine next steps or note that this is authorized and by whom. USB insertions that are unauthorized could be used as a mechanism to infect a machine.</p>",
            "relatedUseCases": [
                "unusual_usb_activity",
                "Basic_Malware_Outbreak",
                "outbreak_detected",
                "UC0029"
            ],
            "released": "1.0.0",
            "relevance": "USB is a common attack vector for many different kinds of malicious deliverables. Your corporation may have a policy of not allowing removable media at all, or may only allow approved media to be used. By Splunking USB activity from Windows and other endpoints using the Universal Forwarder, we can get a feeling for what systems might be vulnerable to attack, or what users might need a security training refresher. This example demonstrates that if we have the USB usage data in Splunk, we can determine the first time a \u201cnew device\u201d is used on an endpoint. This activity might result in an alert or a notable event so that security personnel can conduct follow-up.",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "showcase_git_downloads": {
            "SPLEase": "Hard",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Git File Views or Downloads Per Day - Demo",
            "data_source_categories": "DS014WebServer-ET03SourceCode",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "<p>Find users who have downloaded more files from git than normal.</p><p><b>Alert Volume:</b> High</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Git File Views or Downloads Per Day - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Git File Views or Downloads Per Day - Live"
                },
                {
                    "label": "Accelerated with Data Models",
                    "name": "Git File Views or Downloads Per Day - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is an anonymized collection of source code checkout logs from a git server. For this analysis, we are tracking the total number of files the user has downloaded per day 'count by user _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>This search will have a high number of noise based on the bursty nature of source code access. When someone first clones a repository, they will go off the map. This search provides contextual data to record when these big bursts of activity occur.</p>",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213",
            "name": "Increase in Source Code (Git) Downloads",
            "operationalize": "<p>When this search returns values, initiate your incident response process and validate the user account accessing the specific repos. Contact the user and their manager to determine if it is authorized, and make a note if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as repositories hold sensitive source code.</p><p><i>Note</i>: We include an accelerated version to show how this would work, but there is no data model for this out of the box, so you would need to build one yourself.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "released": "1.0.0",
            "relevance": "Similar to some of the other examples, like <a href=\"/app/Splunk_Security_Essentials/showcase_standard_deviation?ml_toolkit.dataset=Pages%20Printed%20Per%20User%20Per%20Day%20-%20Demo\">Increase in Pages Printed</a>, the behavior of users with access to sensitive intellectual property like source code should be monitored for patterns of data exfiltration. Developers are always going to interact with source code repositories like Git, but if their accesses increase in a statistically significant manner this may represent the exfiltration of source code. It is particularly interesting to correlate this behavior to a watchlist which may contain the user IDs of personnel that are considered higher risk: contractors, new employees, employees that never go on vacation, employees with access to particularly sensitive source code.",
            "searchKeywords": "",
            "usecase": "Insider Threat|Advanced Threat Detection"
        },
        "showcase_high_entropy_processes": {
            "SPLEase": "Hard",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Processes With High Entropy Names in Users Directory - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Some malware will launch processes with randomized filenames.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Processes With High Entropy Names in Users Directory - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Processes With High Entropy Names in Users Directory - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of process launch logs (either Sysmon EventCode 1, or Windows Event ID 4688 -- either works). The search then leverages the URL Toolbox app from apps.splunk.com to determine entropy in the filename or file path. It takes filenames with the highest entropy, and surfaces them.</p>",
            "highlight": "No",
            "howToImplement": "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events. For the demo and live version of this search we use Windows Security Event ID 4688, as it tends to be the most common, but you could apply it to any other data source that shows you launched processes -- just adjust the file path field (New_Process_Name) to match (it is not a CIM field).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "knownFP": "<p>This search looks for potentially randomized filenames using Shannon Entropy. Entropy is a basic measure of randomness, but tends to become less accurate with longer strings. You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Defense Evasion",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1027",
            "name": "Processes with High Entropy Names",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the file, path, user and system associated with this alert. Contact the user and system owner to determine if it is authorized, and document if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as randomized file names on a system may serve as a way to mask malware.</p>",
            "released": "1.0.0",
            "relevance": "To avoid detection, malware often will launch malicious code with random filenames and/or paths. In this example, we use Shannon Entropy, provided by the URL Toolbox app, to identify these probable random names and report on them. Files with non-human-created character patterns are returned.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_hosts_where_sourcetypes_go_silent": {
            "SPLEase": "Advanced",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Hosts That Stop Reporting Sourcetypes - Live",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>A frequent concern of SOCs is that their data feeds will disappear. This search will look on a host-by-host basis for when your security sources stop reporting home.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "is_live_version": true,
                    "label": "Live Data (Auto Accelerated)",
                    "name": "Hosts That Stop Reporting Sourcetypes - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Here we are looking through all Splunk logs for hosts that are sending logs, but not sending Windows Security logs. We track that percentage over time, and look to see how many instances where the percentage = 0 (no Windows Logs) in the past we've seen, and whether yesterday the percentage was zero.</p>",
            "highlight": "No",
            "howToImplement": "This search should work universally on all Splunk environments, since it uses Splunk internal fields. The only implementation detail to be aware of is specifying the index and sourcetype for the security events you care about.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "<p>This alert could generate false positives depending on how noisy the security log sources in your environment are. For example, if you are looking for AV to be disabled, but you typically only get an AV message every few days, this would be difficult to reliably search for. Checking for the silence of sparse data sources is tricky to implement, and should only be attempted for advanced SPL users.</p> ",
            "mitre": "Defense Evasion",
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1089",
            "name": "Hosts Where Security Sources Go Quiet",
            "operationalize": "<p>When this search returns values, capture the time of the event and the sourcetype that is missing. Contact the system owner. If it is known behavior, document this as well as when it is expected to be resolved. If not, further investigation is warranted to determine if the collection capability was modified, stopped, deleted or compromised.</p>",
            "released": "1.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_hosts_with_many_timestamps": {
            "SPLEase": "Advanced",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Systems with Timestamps Far Into the Future - Live",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>One technique for foiling correlation searches is to alter the system time. This search will detect this scenario.</p><p><b>Alert Volume:</b> Low (and should be fixed)</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "is_live_version": true,
                    "label": "Live Data (Auto Accelerated)",
                    "name": "Systems with Timestamps Far Into the Future - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Here we are looking through all Splunk logs for hosts that begin sending logs at very different timestamps. The goal is to detect an attacker who suddenly sets the year to 2020 or some point in the future to evade detection. We use the tstats command here, because we are only looking at indexed field, and it is super fast for those use cases. If we find a broad range of time for any host, the search surfaces it. We use 21 years into the future for the time range, because that is the maximum time range you can put into a Splunk search. We're looking for a range of more than one hour, just to make sure we're above chance.</p>",
            "highlight": "No",
            "howToImplement": "This search should work universally on all Splunk environments, since it uses Splunk internal fields.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "This should not fire often -- the idea is it should only fire when the system time changes, which should not happen often. The only known false positives are hosts that are sending data with multiple timestamps simultaneously, which is usually an instance of an incorrect _time extraction (which should be fixed) or a data source with known lag (which should be filtered out).",
            "mitre": "Defense Evasion",
            "mitre_sub_technique": "T1070.006",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1099",
            "name": "Hosts with Varied and Future Timestamps",
            "operationalize": "<p>When timestamps are detected as being incorrect, it should be noted which system's timestamps are off and when it started. Notification of the system owner needs to be made to correct this condition, but additional investigation may be required to determine if this was an accidental or malicious configuration change and by whom.</p>",
            "released": "1.0.0",
            "relevance": "Splunk uses the timestamps in the logs generated on an endpoint in order to log an accurate time when an event actually happened. This is why having all of the systems reporting into Splunk leverage an authoritative time source, like NTP, is so important. Attackers may realize that your correlation rules are based on time boundaries, e.g. 'search the last five minutes of data' but if a system is logging time 'in the future\u2019 then your correlation rules may not trip when suspicious behavior is logged. It is important to find the systems with inaccurate system times and fix them.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_huge_volume_dns_requests": {
            "SPLEase": "Medium",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Huge Volume of DNS Requests - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "<p>A common method for Data Exfiltration is to send out many DNS or Ping requests, embedding data into the payload. This is often not logged.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Huge Volume of DNS Requests - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Huge Volume of DNS Requests - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Huge Volume of DNS Requests - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of firewall logs (with DNS app detection) from the last day or so. In it, we track per hour how many DNS requests are sent per source IP (you should exclude actual DNS servers from this analysis). We then look to see if it is dramatically higher than the history for that source IP, but also dramatically higher than the organization overall, so that we can to some extent account for DHCP ranges. You may need to tune this for just servers, if this produces too much noise for your environment, or build two separate searches for user-subnet and server-subnet ranges, so that the organization-wide average can be separate.</p>",
            "highlight": "No",
            "howToImplement": "This search is intended to be an easy-to-implement one, as firewall data is usually the first to be Common Information Model compliant, and the fields are very easy to understand. To implement in your environment, first you should specify the correct index and sourcetype for your firewall data (we've included many different options in the search string, but it's not best practice to keep them). Then make sure that the standard fields (src_ip, dest_port, bytes_*) match. You might need to filter out particularly high volume sources (particularly: DNS servers). With that, you should be good to go.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Legal|Finance|Government|Energy|Chemical",
            "journey": "Stage_1",
            "killchain": "Command and Control|Actions On Objectives",
            "knownFP": "<p>False positives for this search should be rare for hosts with static IPs. In one testing environment, a curiously configured free-standing IOT webcam was the only host that hit, and was easy to filter out.</p><p>If you have a small number of DHCP hosts that routinely send a large volume of DNS (first off, why?) you may need to filter out those destinations to reduce noise.</p>",
            "mitre": "Exfiltration|Command and Control",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "|T1041|T1043|T1071",
            "name": "Sources Sending Many DNS Requests",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the other systems that the alerting system is communicating with. Capture the time, applications, destination systems, ports, byte count and other pertinent information. Contact the system owner of this action. If systems being communicated to are internal, contact the owner(s) of those systems as well. If it is authorized, document that this is authorized and by whom. If not, additional investigation is warranted to determine if DNS is being used as a covert channel to exfiltrate data.</p>",
            "released": "1.0.0",
            "relevance": "Similar to monitoring high volumes of data being transferred via DNS, organizations should also monitor for higher volume of DNS transactions, as some advanced malware will not only transfer data via DNS, but also issue and respond to commands via DNS tunneling. It is important to note that you should monitor both volume and frequency of DNS requests, and not rely on detecting specific strings in the data transferred as the data is often encrypted in transit. To test your DNS tunneling detection capabilities you can use tools such as dnscat2 (https://github.com/iagox86/dnscat2).",
            "searchKeywords": "",
            "similarUseCases": [
                "showcase_huge_volume_dns_volume",
                "detection_long_dns_text_response"
            ],
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "showcase_huge_volume_dns_volume": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Huge Volume of DNS Traffic - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "<p>A common method of data exfiltration is to send out a huge volume (in bytes) of DNS or ping requests, embedding data into the payload. This is often not logged.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Huge Volume of DNS Traffic - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Huge Volume of DNS Traffic - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Huge Volume of DNS Traffic - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of firewall logs (with DNS app detection) from the last day or so. In it, we track per hour how much DNS traffic are sent per source IP (you should exclude actual DNS servers from this analysis). We then look to see if it is dramatically higher than the history for that source IP, but also dramatically higher than the organization overall, so that we can to some extent account for DHCP ranges. You may need to tune this for just servers, if this produces too much noise for your environment, or build two separate searches for user-subnet and server-subnet ranges, so that the organization-wide average can be separate.</p>",
            "highlight": "Yes",
            "howToImplement": "This search is intended to be an easy-to-implement one, as firewall data is usually the first to be Common Information Model compliant, and the fields are very easy to understand. To implement in your environment, first you should specify the correct index and sourcetype for your firewall data (we've included many different options in the search string, but it's not best practice to keep them). Then make sure that the standard fields (src_ip, dest_port, bytes_*) match. You might need to filter out particularly high volume sources (particularly: DNS servers). With that, you should be good to go.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Legal|Finance|Energy|Chemical",
            "journey": "Stage_1",
            "killchain": "Command and Control|Actions On Objectives",
            "knownFP": "<p>False positives for this search should be rare for hosts with static IPs. In one testing environment, a curiously configured free-standing IOT webcam was the only host that hit, and was easy to filter out.</p><p>If you have a small number of DHCP hosts that routinely send a large volume of DNS (first off, why?) you may need to filter out those destinations to reduce noise.</p>",
            "mitre": "Exfiltration|Command and Control",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "|T1048|T1071|T1041",
            "name": "Sources Sending a High Volume of DNS Traffic",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the other systems that the alerting system is communicating with. Capture the time, applications, destination systems, ports, byte count and other pertinent information. Contact the system owner of this action. If systems being communicated to are internal, contact the owner(s) of those systems as well. If it is authorized, make a note that this is authorized and by whom. If not, additional investigation is warranted to determine if DNS is being used as a covert channel to exfiltrate data.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_phishing_investigation"
            ],
            "relatedUseCases": [
                "sser_tor_traffic",
                "Large_Web_Upload",
                "detection_long_dns_text_response"
            ],
            "released": "1.0.0",
            "relevance": "DNS Exfiltration is a sophisticated, but increasingly common technique used by malware authors, as well as adversaries inside of a network to exfiltrate data. The technique is becoming popular due to organizations increased monitoring of data exfiltration, but limiting their monitoring to common protocols, yet failing to monitor DNS as an exfiltration vector. There are several methods to exfiltrate data via DNS, however one way to monitor activity is to gauge the total bytes transferred and looking for anomalies and deviations from normal traffic levels.",
            "searchKeywords": "",
            "similarUseCases": [
                "showcase_huge_volume_dns_requests",
                "detection_long_dns_text_response"
            ],
            "usecase": "Insider Threat"
        },
        "showcase_increase_in_interactively_logged_on_users": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Increase in Interactively Logged In Users - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Most systems will have a relatively predictable number of interactively logged on users. This search will look for systems that have dramatically more than they typically do, with a per-user baseline.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Increase in Interactively Logged In Users - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Increase in Interactively Logged In Users - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows Logon events, filtered to interactive logon types (Local: 2, RemoteInteractive: 10, Cached Local: 11). For this analysis, we are tracking the number of unique users log into each system per day 'dc(user) by host _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any systems where the most recent is within the configurable number of standard deviations from average.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Energy|Travel",
            "journey": "Stage_1",
            "killchain": "Command and Control|Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection is relatively unique amongst the behavioral searches in that there can be special tuning required for it. Generally, you can choose a high standard deviation if you do not want to receive much noise, but for this particular search we will see many systems where 99% of days there is only one user logged on. For this reason, you will likely be alerting effectively on when any other user logs onto the system. It might be prudent to exclude help desk staff from the search, or filter specifically for where 3 or more users log on if you're receiving too much noise. In any event, this is generally most useful as a contextual search technique.</p>",
            "mitre": "Privilege Escalation|Persistence",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_technique": "|T1078",
            "name": "Significant Increase in Interactively Logged On Users",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of events created, as well as the user accounts logged into the system, processes executed and other pertinent information. Contact the users and owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "released": "1.0.0",
            "relevance": "<p>By monitoring the number of interactively logged in users to assets, security teams can identify anomalies that may indicate the compromise of an asset or credentials. A spike in users on a particular asset could be an indicate that the asset was compromised and additional system level user accounts are being created for malicious purposes, or if they are valid credentials in AD that accounts have been compromised and the adversary is testing the accounts against a particular asset or groups of assets to test and or escalate privileges to gain deeper access to critical assets and infrastructure.</p>",
            "searchKeywords": "login log in logon log on sign",
            "similarUseCases": [
                "showcase_many_hosts",
                "showcase_increase_interactive_logon"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "showcase_increase_in_runas": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Increase in Windows Privilege Escalation - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Privilege escalation (either via RunAs or Scheduled Tasks) create Windows Security EventID 4648 events. This search will baseline per (original, unprivileged) user and then track deviations.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Increase in Windows Privilege Escalation - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Increase in Windows Privilege Escalation - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows logon with explicit credentials events (Event ID 4648, as you would see with RunAs). For this analysis, we are tracking the number of times the originating (unprivileged) user initiates an authentication with explicit credentials. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average. Notably, it might be more useful here to track the privileged account, for different use cases -- that's easy to do, just switch the dropdown from Unprivileged to Privileged. If you have a strong background and opinion on which is relevant in what scenarios, let us know so that we can improve this content for everyone.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Government|Energy",
            "journey": "Stage_1",
            "killchain": "Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
            "mitre": "Privilege Escalation",
            "mitre_tactic": "TA0004",
            "mitre_technique": "|T1053|T1134",
            "name": "Increase in Windows Privilege Escalations",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the creation, as well as the user account and system, credentials that were used, process executed and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "released": "1.0.0",
            "relevance": "Building upon the simpler example of reporting against 4648 events, this example tracks the privileged executions on a per-credential basis. It may be perfectly normal for a certain amount of privileged executions to happen from a given account, but when these spike against a certain account, this may be an indicator of account compromise.",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Security Monitoring"
        },
        "showcase_increase_interactive_logon": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Increase in Interactive Logons - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Typically non-admin users will only interactively log into one system per day. A user who starts loggin into many can indicate account compromise and lateral movement. (<a href=\"https://car.mitre.org/wiki/CAR-2013-02-012\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Increase in Interactive Logons - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Increase in Interactive Logons - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows Logon events, filtered to interactive logon types (Local: 2, RemoteInteractive: 10, Cached Local: 11). For this analysis, we are tracking the number of unique hosts the user has interactively logged into per day 'dc(host) by user _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Energy|Travel",
            "journey": "Stage_1",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
            "mitre": "Lateral Movement",
            "mitre_tactic": "TA0008|TA0004|TA0003",
            "mitre_technique": "|TA0008|T1078|T1021",
            "name": "Significant Increase in Interactive Logons",
            "operationalize": "When this search returns values, initiate your incident response process and capture the event times, the user account and systems, process and other pertinent information. Contact the owners of the systems. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.",
            "released": "1.0.0",
            "relevance": "By monitoring the number of interactively logged in users to assets, security teams can identify anomalies that may indicate the compromise of an asset or credentials. A spike in users on a particular asset could be an indicate that the asset was compromised and additional system level user accounts are being created for malicious purposes, or if they are valid credentials in AD that accounts have been compromised and the adversary is testing the accounts against a particular asset or groups of assets to test and or escalate privileges to gain deeper access to critical assets and infrastructure.",
            "searchKeywords": "login log in logon log on sign",
            "similarUseCases": [
                "showcase_many_hosts",
                "showcase_increase_in_interactively_logged_on_users"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "showcase_lookalike_filenames": {
            "SPLEase": "Hard",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Processes With Lookalike Filenames - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>To evade analysts, attackers will create a service with a name similar to that of a standard Windows service. This search looks for small differences. Idea from David Bianco, formerly of Sqrrl (<a href=\"http://detect-respond.blogspot.com/2016/11/hunting-for-malware-critical-process.html\">link</a>).</p><p><b>Alert Volume:</b> Very Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Processes With Lookalike Filenames - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Processes With Lookalike Filenames - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launches (EventID 4688), with one injected to use scvhost.exe instead of svchost.exe. The search then leverages the URL Toolbox app from apps.splunk.com to run a levenshtein distance calculation against multiple different common Windows processes. It filters by making sure that there's no exact matches (distance=0), and then filters for where any of the matches was 1 or 2 away from the normal (e.g., svdhost.exe or scvhost.exe). There are a few other techniques used in the search to provide more context to the analyst -- the most interesting of those is the use of curly braces \"{score}\" -- that will insert the value of the score field (e.g., \"2\") into the variable name (so, score2). The rest of the more complicated aspects of the search are just formatting -- in particular, the use of foreach to pull out all suspicious filenames from the dataset.</p>",
            "highlight": "No",
            "howToImplement": "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events. For the demo and live version of this search we use Microsoft Sysmon logs, but you could apply it to any other data source that shows you launched processes -- just adjust the file path field (Image) to match (it is not a CIM field).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Installation",
            "knownFP": "<p>This search will find any launched executable with filenames similar to standard Windows processes, much like running dnstwist on a domain name. If there are valid processes with names similar to standard Windows processes, they would create false positives. One might imagine a system speed up service creating a process like svchaste.exe, which would have a difference of 2 and would trigger (one for the o->a, one for the added e).</p>",
            "mitre": "Defense Evasion",
            "mitre_sub_technique": "T1569.002",
            "mitre_tactic": "TA0005|TA0002",
            "mitre_technique": "|T1036|T1035|T1569",
            "name": "Processes with Lookalike (typo) Filenames",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, filename and path of the suspect file, the system it executed on and the user and other pertinent information. Contact the user and owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_many_hosts": {
            "SPLEase": "Hard",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Unique Hosts Logged Into Per Day - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "<p>Find users who log into more hosts than they typically do.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Unique Hosts Logged Into Per Day - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Unique Hosts Logged Into Per Day - Live"
                },
                {
                    "label": "Accelerated with Data Models",
                    "name": "Unique Hosts Logged Into Per Day - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows Logon events (of all kinds). For this analysis, we are tracking the number of unique hosts the user has logged into per day 'dc(host) by user _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Travel|Technology",
            "journey": "Stage_1",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
            "mitre": "Lateral Movement",
            "mitre_tactic": "TA0008",
            "mitre_technique": "|T1021",
            "name": "Increase in # of Hosts Logged into",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the account name associated with the suspicious domain. Establish the time the event occurred and from what system the login attempt occurred. Contact the user and system owners to determine if it is authorized, and if so document it as such and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted because compromised credentials may be used to gain access to a broad set of systems.</p>",
            "relatedUseCases": [
                "basic_brute_force",
                "Basic_Scanning",
                "detection_excessive_user_account_lockouts",
                "detection_excessive_lockouts_from_endpoint"
            ],
            "released": "1.0.0",
            "searchKeywords": "login log in logon log on sign",
            "similarUseCases": [
                "showcase_increase_in_interactively_logged_on_users",
                "showcase_increase_interactive_logon"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "showcase_network_dc_dest": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Scanning|Endpoint Compromise",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Distinct Hosts Communicated With Per Day - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "<p>This will typically detect scanning activity, along with lateral movement activity.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Distinct Hosts Communicated With Per Day - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Distinct Hosts Communicated With Per Day - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Distinct Hosts Communicated With Per Day - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is an anonymized set of firewall logs. For this analysis, we are tracking the total number of unique destinations the source IP has reached out to per day 'dc(dest) by src _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average. Note that this use case is only reliable for servers -- users will move around too much due to DHCP and it won't be reliable. Look to a more advanced product, such as Splunk UBA.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Travel|Healthcare",
            "journey": "Stage_1",
            "killchain": "Reconnaissance",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information . If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
            "mitre": "Discovery",
            "mitre_tactic": "TA0007",
            "mitre_technique": "|T1018|T1046",
            "name": "Hosts Sending To More Destinations Than Normal",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the other systems that the alerting system is communicating with. Capture the time, applications, destination systems, ports, byte count and other pertinent information. Contact the system owner and user if the logs have the appropriate fidelity of this action. If systems being communicated to are internal, contact the owner(s) of those systems as well. If it is authorized, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine why additional systems are being communicated with.</p>",
            "released": "1.0.0",
            "relevance": "The first phase of the Lockheed Martin Kill Chain is reconnaissance, which can include initial scanning of a target network to map out assets, as well as vulnerabilities for potential entry points using known exploits. It is important to note that this type of activity can happen both on the perimeter as well as inside of a network once an initial foothold has been made. Monitoring for this type of activity can help identify precursors to an attack as well as be an indicator that assets within an organization, or credentials have been compromised.",
            "searchKeywords": "",
            "similarUseCases": [
                "Basic_Scanning",
                "vulnerability_scanner_detected_by_events",
                "vulnerability_scanner_detected_by_targets"
            ],
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "showcase_new_ad_domain": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Domain Name Detected - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>New AD domain names in your normal domain controller logs are a symptom of many Pass the Hash tools. While some of the latest don't produce these artifacts, this remains a very valuable detection mechanism.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Domain Name Detected - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Domain Name Detected - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of Windows logon events from a domain controller. For this analysis, we are looking for the earliest time for a domain name. We check if the first time that domain was seen was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Energy|Chemical|Aerospace|Healthcare|Education|Legal|Finance|Construction|Media|Transportation|Government",
            "journey": "Stage_1",
            "killchain": "Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This search is designed to find older versions of Mimikatz (or other tools with similar techniques), and is not known to have any other false positives.</p>",
            "mitre": "Lateral Movement",
            "mitre_sub_technique": "T1550.002",
            "mitre_tactic": "TA0008",
            "mitre_technique": "|T1075",
            "name": "New AD Domain Detected",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the account name associated with the new domain. Determine at what time the event occurred and from what system the login attempt occurred from. Contact the user and system owner(s) to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine is a pass the hash attack has been attempted and generated this new domain in the event log.</p>",
            "relatedUseCases": [
                "showcase_first_seen_domain_controller",
                "user_login_local_credentials",
                "New_Domain"
            ],
            "released": "1.0.0",
            "relevance": "<p>In Windows logs, the domain name is often reported when it's not explicitly required for the authentication. Under normal operation, the domain name reported will be totally normal, but when someone is intentionally modifiying authentication (such as with Pass the Hash), you can see incorrect, or empty domains. Pass the Hash is used by attackers to move laterally within the organization, connecting to new servers. While not all Pass the Hash techniques will demonstrate this vulnerability, tracking new domains in your Windows logs is very valuable.</p>",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Compliance"
        },
        "showcase_new_host_with_suspicious_cmd_launch": {
            "SPLEase": "Medium",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New cmd.exe or regedit or powershell launched by services.exe - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Very rarely would cmd.exe, regedit.exe, or powershell.exe be launched by services.exe. This search will detect that malware persistence strategy. (<a href=\"https://car.mitre.org/wiki/CAR-2014-05-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Very Low (for most companies)</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New cmd.exe or regedit or powershell launched by services.exe - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New cmd.exe or regedit or powershell launched by services.exe - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) where known suspicious tools are launched as a service. For this analysis, we are effectively grouping by process name and host, which will give us a row for each process_name+hostname combination. We check if the first time that has occurred was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection should have relatively few false positives given the rarity of having any of these programs launched as services. It's possible some system management scripts might flag for this, but those should be rare and easily filtered out of the search.</p>",
            "mitre": "Execution|Privilege Escalation",
            "mitre_sub_technique": "T1543.003",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_technique": "|T1050|T1543",
            "name": "New Suspicious cmd.exe / regedit.exe / powershell.exe Service Launch",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the system demonstrating this behavior. Determine the time and process that is being executed and by what account on the system. Contact the user and system owner to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine why services.exe is triggering cmd.exe, regedit.exe or powershell.exe.</p>",
            "released": "1.0.0",
            "relevance": "There are some very powerful executables on Windows endpoints that should be carefully audited. Most are legit when they execute, but it is a useful exercise to monitor the parent process that does the launching. The Service Control Manager, or services.exe, has no legitimate reason to launch commands like cmd.exe, powershell.exe, or regedit.exe. Incidentally, a common way for malware to masquerade as something legitimate is to call itself service.exe.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_new_interactive_service_logon": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Interactive Logon from a Service Account - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "<p>In most environments, service accounts should not log on interactively. This search finds new user/host combinations for accounts starting with \"svc_.\" </p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Interactive Logon from a Service Account - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Interactive Logon from a Service Account - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of interactive logon events, and then we apply a filter for when the account name starts with svc_ -- obviously you could adjust this, or leverage a lookup as applicable in your environment. We check the first time that each user has logged interactively onto each server. Notably, this search is probably one of the most difficult in the environment from a performance perspective. Searching for Logon Types requires pulling back almost all of the data off of disk -- it would be highly recommended to leverage a lookup to cache your baseline (on the roadmap for a future version of this app). That said, for most organizations you could likely dispense with the baseline and just whitelist known good service account / host combinations as well.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li><b>For this search</b> it is also key to verify that the username format of service accounts (or a lookup, if appropriate) is accurate so that you are just looking at service accounts.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Energy|Travel",
            "journey": "Stage_1",
            "killchain": "Command and Control",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>In most environments, you should be able to directly respond to this event because service accounts should not suddenly start logging on interactively.</p>",
            "mitre": "Privilege Escalation|Persistence|Lateral Movement|Defense Evasion",
            "mitre_tactic": "TA0004|TA0003|TA0008|TA0005",
            "mitre_technique": "|T1078|T1021",
            "name": "New Interactive Logon from a Service Account",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, as well as the user account and system, credentials that were used, process executed and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "relatedUseCases": [
                "sser_fake_windows_processes",
                "showcase_new_local_admin_account"
            ],
            "released": "1.0.0",
            "relevance": "<p>Service accounts are more than likely privileged accounts in organizations. However, they should almost never log on interactively (e.g., via Remote Desktop, or by physically sitting at a keyboard and monitor). Because of their privilege and the fact that their usernames often describe their level of access (e.g., svc_exchange_admin), they're a big target for account compromise. Mature organizations should monitor for this activity, and investigate any new logon activity.",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_new_local_admin_account": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=New Local Admin - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Local admin accounts are used by legitimate technicians, but they're also used by attackers. This search looks for newly created accounts that are elevated to local admins.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Local Admin - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Local Admin - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows security logs for user creation and group modification. We then use the transaction command to group an account create, and an addition to the local administrators group, in a short period of time. Anything that matches, we will surface.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>First, verify that you have Windows Security Logs coming in, and that you have implemented account change auditing (see the <a href=\"/app/Splunk_Security_Essentials/data_source?datasource=Windows%20Security?technology=Windows%20Security%20Logs\">Windows Security data source documentation</a>). Once your logs are coming in, you should be able to search for <span class=\"spl\">source=\"*WinEventLog:Security\" EventCode=4720 OR EventCode=4732</span> to see account creation or change events. Finally, make sure that your local admin group name is \"administrators\" so that we are looking for the right group membership changes.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Command and Control",
            "knownFP": "<p>The only real source of false positives for this search would be for help desk admins who create local admin accounts. If this is common practice in your environment, you should filter out their admin account creation messages by excluding their usernames from the base search.</p><p>If your local admin group doesn't include the term \"administrators\" then it would potentially generate false negatives.</p>",
            "mitre": "Defense Evasion|Persistence",
            "mitre_sub_technique": "T1078.003|T1136.001",
            "mitre_tactic": "TA0005|TA0003",
            "mitre_technique": "|T1078|T1136",
            "name": "New Local Admin Account",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the creation, as well as the user accounts that created the account and the account name itself, the system that initiated the request and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted.</p>",
            "relatedUseCases": [
                "sser_fake_windows_processes",
                "showcase_new_interactive_service_logon"
            ],
            "released": "1.0.0",
            "relevance": "New local admin accounts are often a source of concern. Most organizations will deploy a small number of local admin accounts, used for particular applications or for access in the case of an issue contacting their network domain controller. On the other hand, malware, malicious intruders, and even insiders love to create local admin accounts because it allows them to maintain access through password changes, account deactivations, or in the case of malicious insiders, leaving the company. Whenever a local admin account is created on a host, particularly a privileged host, it is important to make sure that it is valid.",
            "searchKeywords": "login log in logon log on sign",
            "similarUseCases": [
                "showcase_short_lived_accounts"
            ],
            "usecase": "Advanced Threat Detection|Security Monitoring|Compliance"
        },
        "showcase_new_logon_type": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Logon Type for User - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Windows defines several logon types (Interactive, RemoteInteractive, Network, etc.). Established users rarely generate new logon types. This search will look for that scenario. (<a href=\"https://car.mitre.org/wiki/CAR-2013-02-012\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Logon Type for User - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Logon Type for User - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of logon events. We check the first time that each user has performed each logon type and then alert if that was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Energy|Travel",
            "journey": "Stage_1",
            "killchain": "Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Privilege Escalation|Persistence|Defense Evasion",
            "mitre_tactic": "|TA0004|TA0003",
            "mitre_technique": "|T1078",
            "name": "New Logon Type for User",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event creation, as well as the user account and systems that were logged into and in the case of remote login, where they initiated the logon from, credentials that were used, process executed and other pertinent information. Contact the user and owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "released": "1.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Security Monitoring|Compliance"
        },
        "showcase_new_parent_process_for_cmd": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Parent Process for cmd.exe or regedit.exe - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>cmd.exe and regedit.exe tend to be used in the same ways. New parent processes can be suspicious. (<a href=\"https://car.mitre.org/wiki/CAR-2013-02-003\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Parent Process for cmd.exe or regedit.exe - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Parent Process for cmd.exe or regedit.exe - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch logs from Microsoft Sysmon (EventCode=1). For this analysis, we are looking at the processes that spawned cmd.exe, regedit.exe, and powershell.exe. If we've seen that ParentProcess before, then all is fine, but if we've never seen it before we'll raise an alert.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. <b>For this search</b> you may wish to alter the process names that are tracked.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection should have relatively few false positives given the rarity of new parent processes for these standard Windows processes. Most noise that will come from new systems management scripts, or from new software installers. These can be whitelisted in the search.</p>",
            "mitre": "Discovery|Lateral Movement|Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "|T1059",
            "name": "New Parent Process for cmd.exe or regedit.exe",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the parent process that initiated cmd.exe or regedit.exe. Determine the user account this is running under and the system it is running on. Contact the user and system owner of this action. If it is authorized, document that this is and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to ensure that processes are not spawning these commands.</p>",
            "released": "1.0.0",
            "relevance": "As described above, we want to carefully monitor certain executables on our Windows endpoints and understand what is calling them. For example, if we see a program like Word or Excel launching cmd.exe, it is probably up to no good especially if we\u2019ve never seen it do that before. Programs that behave in this way legitimately should be whitelisted - others should be immediately investigated.",
            "searchKeywords": "sysmon",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_new_path_for_common_filename": {
            "SPLEase": "Medium",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Paths for Common Executables - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Simpler malware will hide in plain sight with a filename like explorer.exe, running in the user profile. This detection will look for new paths, for common / expected executables. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Very Low (for most companies)</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Paths for Common Executables - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Paths for Common Executables - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for known good filenames, running from atypical directories. We find the first time that filename has launched from that path, and then alert if that was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This search should almost never fire, except for suspicious events, as it's virtually guaranteed that any events firing are specifically trying to deceive the operator.</p>",
            "mitre": "Defense Evasion",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1036",
            "name": "Common Filename Launched from New Path",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the system demonstrating this behavior. Determine the time, process and parent process that is being executed and by what account on the system. Contact the user and system owner to determine if it is authorized, and make a note that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine why an executable is starting from a path not previously executed from.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "released": "1.0.0",
            "relevance": "There are certain processes that everyone expects to see running on their Windows hosts, like iexplore.exe or svchost.exe. But they\u2019re supposed to run from very specific places. This fairly simple search looks to find when legitimate looking filenames are found running, but out of unusual paths never seen before.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_new_path_for_familiar_filename": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Path for Process On Host - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Processes are typically launched from the same path. When those paths change, it can be a malicious process masquerading as a valid one, to hide in task manager. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-004\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Path for Process On Host - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Path for Process On Host - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688). Then we separate the filename from the file path, and look to see if the same filename (e.g., svchost.exe) is run from multiple places by using dc(Image) by filename (where Image is the full path). For each file with multiple paths, we check to see if the the first time that occurred was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This search should very rarely generate false positives. In testing, it has been seen that the base search will detect several executables that launch from both an x64 path and x86 path, but because the search has a behavioral component, we will only alert on this if it occurs for the first time.</p>",
            "mitre": "Defense Evasion",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1036",
            "name": "Familiar Filename Launched with New Path on Host",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, executable, its associated path, the system, user and other pertinent information. Contact the owner of the systems. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to determine why common files are launching from a different path.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "released": "1.0.0",
            "relevance": "A common technique employed by malware is to have a benign looking executable launch out of an unusual directory. Normal executions for the file will come out of a standard operating system path, but when we see the same filename launched out of multiple paths, it is time to investigate. Process whitelisting or lookup tables containing names of known-good executables can provide further fidelity here.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_new_runas": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New RunAs - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Privilege escalation (either via RunAs or Scheduled Tasks) create Windows Security EventID 4648 events. This search will find new usernames / host combinations, which will track privilege escalation.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New RunAs - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New RunAs - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch with explicit credentials events (Windows Event ID 4648). We check the first time that's occurred per username, per host, and then alert if that was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Government|Energy|Travel",
            "journey": "Stage_1",
            "killchain": "Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts or systems), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Privilege Escalation",
            "mitre_tactic": "TA0004",
            "mitre_technique": "|T1053|T1078",
            "name": "New RunAs Host / Privileged Account Combination",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the creation, as well as the user account and system, credentials that were used, process executed and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "released": "1.0.0",
            "relevance": "Privileged escalation on a Windows endpoint is often done via scheduled tasks, the at command, or RunAs. Since malware often requires elevated privileges to install or to perform certain actions, any unusual occurrence of the 4648 event should be tracked. 4648 will always precede a 4624 event assuming that the escalation is successful. Sometimes you will see \u2018consent.exe\u2019 in the process name for the 4648 event - this is the UAC pop-up dialog.",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "showcase_new_service_creations": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Service Creation - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>New service creations are uncommon for most hosts. This search will look for both new executables and executables running from new paths launched by services.exe.</p><p><b>Alert Volume:</b> High</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Service Creation - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Service Creation - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for service launches. We check the first time that's occurred per path, per host, and then alert if that was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation|Installation|Command and Control",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>New Service Creations should be fairly rare for most systems, occurring only when new software is installed or there is a Windows upgrade. You may want to filter out tools that you know help desk staff often install (for example, the Wireshark libpcap service), and any other common tools in your environment, but ultimately the efficacy of this search depends on how much change there is in your particular environment, and may or may not be that reliable. In the worst case, you can use it as a background contextual item for notable events.</p> ",
            "mitre": "Persistence|Defense Evasion|Privilege Escalation",
            "mitre_sub_technique": "T1543.003",
            "mitre_tactic": "TA0003|TA0005|TA0004",
            "mitre_technique": "|T1036|T1050|T1543",
            "name": "New Service Paths for Host",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, executable, its associated path, the system, user and other pertinent information. Contact the owner of the systems. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to determine if services.exe has spawned new executables on new paths.</p>",
            "released": "1.0.0",
            "relevance": "Although it is useful to know what paths are involved with services launched on an endpoint, unless the system is considered \u201clocked down\u201d such as a single-purpose system (POS, kiosk, etc) this will result in significant noise because new services are being created on endpoints all of the time. Therefore, this type of search is best applied with a whitelist so that only \u2018unapproved\u2019 service paths are reported.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_new_sfdc_clients": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|GDPR|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Applications Contacting SFDC - Demo",
            "data_source_categories": "VendorSpecific-sfdc-elf",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Salesforce.com contains the most critical information for many companies. This search looks for users who connect to SFDC's reporting API with new clients. </p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Applications Contacting SFDC - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Applications Contacting SFDC - Live"
                }
            ],
            "gdprtext": "<h4>Problem:</h4><p>Many organizations maintain business-critical information within SaaS applications such as Salesforce.com. Salesforce is an example of a CRM business application which is used to store and process personal data relating to customers, partners, prospects and often employees. As part of a Salesforce.com deployment, other applications interact with this sensitive data, via push or pull APIs that automate data exchange - for example integrations into finance and human resources applications such as Workday, or marketing automation tools such as Eloqua and Marketo. Attackers can attempt to use the Salesforce.com API as a vector to gain access to sensitive data. Because Salesforce.com is a cloud application with a publicly accessible domain, this vector only requires valid credentials, and can be exploited for access to sensitive data by adversaries, even if they lack access to internal resources.</p><h4>Impact:</h4><p>Under the GDPR Article 30, organizations are required to maintain a record of processing activities including contact details of the controller, the purposes of processing, description of the categories of data subjects and personal data processed -- as well as the categories of recipients to whom the personal data has been or will be disclosed including recipients in any other countries. Interactions from new applications -- whether for legitimate purposes or as a result of malicious activity -- can create a non-compliance condition if they are not documented properly. This situation may not impact organizations who employ fewer than 250 persons and therefore may not have critical categories of personal data for processing.</p><h4>Resolution Path:</h4><p>Monitoring Salesforce.com API activity can help identify connections from new applications or clients that might not be whitelisted or documented. The timely and accurate reporting of a non-compliance state can prompt the Data Privacy Officer to proactively follow up and update documentation, and report to the authorities in a timely manner if appropriate.</p>",
            "hasSearch": "Yes",
            "help": "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213",
            "name": "New Application Accessing Salesforce.com API",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and application. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_app.png",
            "released": "1.4.0",
            "searchKeywords": "salesforce sfdc",
            "usecase": "Compliance|Insider Threat"
        },
        "showcase_new_sfdc_event_type": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|GDPR|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New Risky Event Types Per User - Demo",
            "data_source_categories": "VendorSpecific-sfdc-elf",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Salesforce.com supports a variety of different event types in their event logs. This search detects users who suddenly query event types associated with data exfiltration</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Risky Event Types Per User - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Risky Event Types Per User - Live"
                }
            ],
            "gdprtext": "<h4>Impact:</h4><p>First-time seen events, specifically high-risk types, can indicate unauthorized, non-compliant, and potentially malicious behavior. </p><p>Specific to GDPR, detecting first-time occurrences of high-risk behavior and proving that individuals within the organization are not abusing or misusing legitimate access to assets that store and process personal data is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
            "hasSearch": "Yes",
            "help": "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Collection",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "|TA0010|T1102",
            "name": "New High Risk Event Types for Salesforce.com User",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, application and number of rows exported or viewed. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_event_type.png",
            "released": "1.4.0",
            "searchKeywords": "salesforce sfdc",
            "usecase": "Compliance|Insider Threat"
        },
        "showcase_new_sfdc_tables": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|GDPR|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New SFDC Tables Queried by User - Demo",
            "data_source_categories": "VendorSpecific-sfdc-elf",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Salesforce.com supports a simplified query language called SOQL. This search detects users who begin querying new sensitive tables.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New SFDC Tables Queried by User - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New SFDC Tables Queried by User - Live"
                }
            ],
            "gdprtext": "<h4>Impact:</h4><p>Detecting first-time query attempts to sensitive tables by a user who has previously not accessed the tables in question, can help prove that individuals within the organization are not abusing or misusing legitimate access to assets.</p><p>This can relate to GDPR in that in-scope assets will store and process personal data. This method is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
            "hasSearch": "Yes",
            "help": "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Discovery|Collection",
            "mitre_tactic": "TA0007|TA0009",
            "mitre_technique": "|T1213|T1018",
            "name": "New Tables Queried by Salesforce.com User",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and tables queried. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_table_user.png",
            "released": "1.4.0",
            "searchKeywords": "salesforce sfdc",
            "usecase": "Compliance|Insider Threat"
        },
        "showcase_new_sfdc_tables_peer": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|GDPR|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=New SFDC Tables Queried by Peer Group - Demo",
            "data_source_categories": "VendorSpecific-sfdc-elf",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Salesforce.com supports a simplified query language called SOQL. This search detects users who begin querying sensitive tables that have never been contacted by peer group.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New SFDC Tables Queried by Peer Group - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New SFDC Tables Queried by Peer Group - Live"
                }
            ],
            "gdprtext": "<h4>Impact:</h4><p>Detecting first-time query attempts to sensitive tables by a peer group that has previously not accessed the tables in question, can help prove that individuals within the organization are not abusing or misusing legitimate access to assets that store and process personal data. This method is an industry best practice.</p><p>Specific to GDPR, this can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
            "hasSearch": "Yes",
            "help": "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple, though the peer group makes things slightly more complicated.<ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>To configure the Peer Group:<ol><li>Start with a data source that gives you visibility into the peer group -- easiest is usually querying Active Directory via the <a href=\"https://splunkbase.splunk.com/app/1151/\">SA-ldapsearch add-on</a>, but you could get lists of users and their teams / departments / etc from any source you have.</li><li>Next you will need to convert that log source into a format that this lookup is expecting, which is as follows:<table class=\"table\" style=\"width: 300px\"><tr><td>user</td><td>peergroup (order not important)</td></tr><tr><td>john</td><td>john|sarah</td></tr><tr><td>sarah</td><td>john|sarah</td></tr><tr><td>mark</td><td>mark</td></tr></table>The easiest way to do this is with a search like <span class=\"spl\">| inputlookup LDAPSearch.csv | stats values(user) as user by department | eval peergroup=mvjoin(user, \"|\") | mvexpand user</span></li></ol></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Discovery|Collection",
            "mitre_tactic": "TA0007|TA0009",
            "mitre_technique": "|T1213|T1018",
            "name": "New Tables Queried by Salesforce.com Peer Group",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and tables queried. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_table_peer_group.png",
            "released": "1.4.0",
            "searchKeywords": "salesforce sfdc",
            "usecase": "Compliance|Insider Threat"
        },
        "showcase_new_suspicious_exe_launch_for_user": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Suspicious Command Launch - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Some files rarely get used by legitimate activities, such as at.exe. This search will detect those executables being launched, regardless of the circumstance. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-004\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Suspicious Command Launch - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Suspicious Command Launch - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for suspicious filenames (from a lookup called tools.csv). We check the first time that's occurred per path, per user, and then alert if that was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>There are no known false positives for this search apart from some custom-designed scripts and the occasional sysadmin familiar with it. Both of these should be very easy to filter out.</p>",
            "mitre": "Discovery|Lateral Movement|Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "|TA0002|T1059",
            "name": "New Suspicious Executable Launch for User",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, executable, its associated path, the system, user and other pertinent information. Contact the owner of the systems. If it is authorized, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_malware_investigation"
            ],
            "released": "1.0.0",
            "relevance": "There are certain executables launched on endpoints that generally mean that someone, or something, is up to no good. For this example, we have provided a lookup file \u2018tools.csv\u2019 that among other things identifies binaries by executable name as being used for discovery or attack purposes. It may be perfectly normal for one or more of these executables to launch on a given endpoint, but if one of these executables is seen where it hasn\u2019t been seen before, this can be considered an alert-able condition.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_remote_powershell_launches": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Remote Powershell Launches - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>It's unusual for new users to remotely launch PowerShell on another system. This will track the first time per  user + host combination that powershel is remotely started.</p><p><b>Alert Volume:</b> Low (for most companies)</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Remote Powershell Launches - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Remote Powershell Launches - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for the Image and ParentImage that show up when Powershell is remotely triggered. We check the first time that's occurred per host, and then alert if that was in the last day.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Travel|Technology",
            "journey": "Stage_1",
            "killchain": "Installation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This type of event should only occur for remote management, or potentially some systems management tools. It would be recommended to filter out the users who typically perform these actions (or alternatively you could alter the search to look for user + sourcetype instead of user + host, so that you will be alerted the first time a user takes this action, instead of the first time a user takes it on a particular host).</p>",
            "mitre": "Lateral Movement",
            "mitre_tactic": "TA0008",
            "mitre_technique": "|T1021",
            "name": "Remote PowerShell Launches",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user and system responsible for initiating this behavior. Determine the time of the event and what process and associated parent processes where triggered. Contact the user and system owner to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_threat_hunting"
            ],
            "released": "1.0.0",
            "relevance": "Remote execution of PowerShell is something that should rarely occur if at all within an network, and if it does should be associated with known executables or users. Therefore, unique instances of user and host combinations should be monitored and alerted upon for further investigation by security teams. This type of activity could be an indicator of compromised assets, user credentials, or a potential insider threat scenario.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_renamed_executables": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Find Processes with Renamed Executables - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Oftentimes, attackers will execute a temporary file, and rename it to something innocuous (e.g. svchost.exe) to maintain persistence. This search will look for renamed executables. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-009\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Find Processes with Renamed Executables - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Find Processes with Renamed Executables - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), where we have hashing turned on (look for tools like WLS, or Sysmon to help here). It then looks for the number of filenames per system, per file hash, and surfaces files that have been renamed.</p>",
            "highlight": "No",
            "howToImplement": "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events with the file hash information. For the demo and live version of this search we use Microsoft Sysmon with the CommandLine field, but you could adjust that to another data source and match the field names (extract filename, sha1 or change the field names to match that datasource).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "<p>This search will look for any time an executable file is renamed, which should be rare but could occur during software installations. If you see false positives here, you should be able to filter out the noise by looking the final filename and filter out those instances. Generally, you should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).",
            "mitre": "Defense Evasion",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1036",
            "name": "Find Processes with Renamed Executables",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the system(s) with the matching hashes. Determine which system(s) are executing the renamed executables by observing the user, image and parent image values, amongst others. Contact the user and system owner and contact them regarding this action. If it is authorized, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine if executables have been loaded onto the system with common names.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "released": "1.0.0",
            "relevance": "Often when we investigate malware, we look for filenames that have different hashes, but the same filenames. This could point to either a legitimate binary update activity, or it could be a malicious process masquerading as a legitimate one. But what about executables that have different filenames, but the same hash? This could be malware renaming itself to masquerade as something benign. In the example here, we see a .tmp file dumped into a roaming directory that later on gets renamed as a legitimate Windows executable - but it has the same hash as before. This warrants investigation.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_series_attacker_tools_filename": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Series of Hacker Filenames - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>It's uncommon to see attacker tools used in rapid succession on an endpoint. This search will identify tools by filename, and look for multiple executions. (<a href=\"https://car.mitre.org/wiki/CAR-2013-04-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "eli5Disabled": "<p>The basic idea behind this search is to take a set of filenames, and then look for them in a larger dataset. It's also one of the searches in SSE where the live version is way simpler than the demo version, because we can take advantage of simple keyword searching.</p><p>There are three phases to this search. <ul><li>First we run a subsearch to collect a list of filenames from a CSV file (also called a lookup) that contains a list of tools that are labeled as discovery, attacker, suspicious. If you've never used a subsearch before, the basic idea is that you take a search that works on its own, usually one that returns just one column. When you put brackets around that and add it into a new search, Splunk will run the subsearch first, take those columns and add them to the main search. For example, if your subsearch had a single field called \"name\" with a value \"David\", name=\"David\" would be added into your main search. If it returned two rows, and the second row had \"name\" with the value \"John\", then the main search would use (name=\"David\" OR name=\"John\"). They're pretty simple once you get used to them. For more info, check out the <a href=\"https://docs.splunk.com/Documentation/Splunk/7.0.1/SearchTutorial/Useasubsearch\">docs</a>, or explore <a href=\"https://www.splunk.com/view/SP-CAAAPX9\">Free Splunk Training</a>.</li>\n<li>Next we search in our process launch logs for any of those filenames. This is straightforward Splunk searching.</li><li>Finally, the other fancy part of this search is using the transaction command. Transaction takes all the logs in and groups them together by whatever field you specify, in this case host. So functionally, we are grouping together all the process launches for attacker tools (since we already filtered for them) per host. Transaction can be slow with really big datasets, but it works great for relatively small datasets like this. It also has tons of knobs and levers -- check out the <a href=\"http://docs.splunk.com/Documentation/Splunk/latest/SearchReference/transaction\">docs</a> for more. </li></ul>",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Series of Hacker Filenames - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Series of Hacker Filenames - Live"
                }
            ],
            "fullSolutionDisabled": "<div><p><img src=\"/static/app/Splunk_Security_Essentials/images/content_thumbnails/ES_Use_Case.png\" style=\"display:inline; float: right;\" />This use case is ultimately looking for specific filenames that we know are concerning. While here we have a limited list that we pull in via a lookup (a CSV file), Splunk Enterprise Seurity has a full threat intelligence framework that allows you to leverage both public and private threat intelligence sources and look for hosts that trigger on many different sources, all in an automatic way. In addition, many of the related capabilities that you will look for to operationalize the output of these alerts (such as a risk framework, a investigator workflow, and more) come with Enterprise Security.</p><p>Find out more about Splunk Enterprise Security <a href=\"https://www.splunk.com/en_us/products/premium-solutions/splunk-enterprise-security.html\" target=\"_blank\">on our website</a> or by <a href=\"https://www.splunk.com/en_us/about-us/contact.html\" target=\"_blank\">contacting your local Splunk team</a>.",
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688). It then filters for a set of filenames that are known to be hacker related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>",
            "highlight": "Yes",
            "howToImplement": "The hardest part of implementing this correctly, once you have process launch logs ingested, will be to make sure that the fields correctly set. <ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your process launch logs live (index=oswinsec if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the last field you have to think about, which if you use our Splunk_TA_windows on your Search Head, will also work automatically for you (again, docs are key!)</li></ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p>This search should trigger very few false positives, because it's filtered to just very specific launches, and even more, looking for multiple process launches in a short period of time. The only scenario where you would expect to see this happen is if your organization happens to use some of those unusual tools for normal sysadmin tasks, and have them scripted. Beyond that, be suspicious!</p>",
            "mitre": "Discovery|Lateral Movement|Execution",
            "mitre_sub_technique": "T1543.003|T1569.002|T1562.006|T1574.011|T1518.001|T1021.002|T1562.001",
            "mitre_tactic": "TA0007|TA0008|TA0002|TA0006|TA0003|TA0004|TA0010|TA0005",
            "mitre_technique": "|T1087|T1069|T1057|T1018|T1063|T1082|T1016|T1049|T1010|T1033|T1007|T1012|T1046|T1003|T1021|T1050|T1031|T1058|T1053|T1035|T1029|T1098|T1089|T1054|T1059|T1569|T1543",
            "name": "Concentration of Attacker Tools by Filename",
            "operationalize": "<p>This alert is very clearly tied to a known threat, so when it fires your concern is that this represents an attacker inside of one of your systems. Recommended steps are to begin incident response on the host where this alert fired from, to look for signs of other suspicious activities. The first step in that process will be to look at the parent process that launched these suspicious processes, and see what other activities that process has done. That should guide you to the underlying problem. As you get more information about this particular system (for example, how did malware end up on it, what websites has it communicated with, etc.), make sure to pivot and look across your entire organization for other indications, and to look in Open Source Intelligence sites like VirusTotal to learn more about the attacker.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_threat_hunting"
            ],
            "relatedUseCases": [
                "showcase_series_attacker_tools_hashes",
                "showcase_series_discovery_tools_filename",
                "showcase_series_discovery_tools_hashes"
            ],
            "released": "1.0.0",
            "relevance": "These days, there are a lot of executables one can install and run on a Windows machine in order to cause mischief. The thing is, many amateur hackers will run a lot of these tools in succession (or automated scripts will run them, too). By correlating the process names being executed on endpoints with a list of 'known hacker tool executable names' we can detect this suspicious activity.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring",
            "youtubeDisabled": "https://www.youtube.com/embed/EErha1BpjMA"
        },
        "showcase_series_attacker_tools_hashes": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Series of Hacker Hashes - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "<p>It's uncommon to see attacker tools used in rapid succession on an endpoint. This search will identify tools by file hash, and look for multiple executions. (<a href=\"https://car.mitre.org/wiki/CAR-2013-04-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Series of Hacker Hashes - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Series of Hacker Hashes - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), where we have hashing turned on (look for tools like WLS, or Sysmon to help here). It then filters for a set of file hashes that are known to be hacker related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>",
            "highlight": "No",
            "howToImplement": "The hardest part of implementing this correctly, once you have EDR logs ingested, will be to make sure that the fields correctly set. (Why EDR? The boundary between EDR logs and Windows Security Logs for <b>most</b> Splunk customers is that Windows Process Launch Logs won't contain hashes, or the right variety of hashes, but EDR tools including the free Sysmon tool will.)<ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your EDR logs live (index=epintel if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the second to last field you have to think about, which if you use our <a href=\"https://splunkbase.splunk.com/app/1914/\">Splunk Add-on for Sysmon</a> on your Search Head, will also work automatically for you (again, docs are key!)</li><li>Finally, Sysmon will return multiple different hashes. In order for the hashes to show up correctly in the table, make sure that you have a field named sha1 (or change the search to match what you see in the events).</ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p>This search should trigger very few false positives, because it's filtered to just very specific launches, and even more, looking for multiple process launches in a short period of time. The only scenario where you would expect to see this happen is if your organization happens to use some of those unusual tools for normal sysadmin tasks, and have them scripted. Beyond that, be suspicious!</p>",
            "mitre": "Discovery|Lateral Movement|Execution",
            "mitre_sub_technique": "T1543.003|T1569.002|T1562.006|T1574.011|T1518.001|T1021.002|T1562.001",
            "mitre_tactic": "TA0007|TA0008|TA0002|TA0006|TA0004|TA0003|TA0010|TA0005",
            "mitre_technique": "|T1087|T1010|T1069|T1057|T1012|T1082|T1016|T1063|T1007|T1033|T1049|T1003|T1021|T1050|T1031|T1058|T1035|T1029|T1053|T1089|T1098|T1059|T1054|T1569|T1543",
            "name": "Concentration of Attacker Tools by SHA1 Hash",
            "operationalize": "<p>This alert is very clearly tied to a known threat, so when it fires your concern is that this represents an attacker inside of one of your systems. Recommended steps are to begin incident response on the host where this alert fired from, to look for signs of other suspicious activities. The first step in that process will be to look at the parent process that launched these suspicious processes, and see what other activities that process has done. That should guide you to the underlying problem. As you get more information about this particular system (for example, how did malware end up on it, what websites has it communicated with, etc.), make sure to pivot and look across your entire organization for other indications, and to look in Open Source Intelligence sites like VirusTotal to learn more about the attacker.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "released": "1.0.0",
            "relevance": "Building on the two examples of surfacing concentrations of attacker or discovery tools via filename, a more accurate method for doing this is to use the SHA1 cryptographic hashes for these tools, because tools can always be renamed before executing. By correlating the process hashes being executed on endpoints with a list of 'known hacker tool executable hashes' we can detect this suspicious activity.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "showcase_series_discovery_tools_filename": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Scanning|Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Series of Discovery Filenames - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>It's uncommon to see many host discovery tools launched on an endpoint, except in very specific situations. This search will identify tools by filename, and look for many launches. (<a href=\"https://car.mitre.org/wiki/CAR-2016-03-001\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low (unless your company specifically does this)</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Series of Discovery Filenames - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Series of Discovery Filenames - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), though you could also use any other process launch logs from EDR tools. It then filters for a set of filenames that are known to be discovery related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>",
            "highlight": "No",
            "howToImplement": "The hardest part of implementing this correctly, once you have process launch logs ingested, will be to make sure that the fields correctly set. <ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your process launch logs live (index=oswinsec if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the last field you have to think about, which if you use our Splunk_TA_windows on your Search Head, will also work automatically for you (again, docs are key!)</li></ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p>The most likely source of false positives for this script would be normal admin activity, particularly if you have login scripts (or periodic scripts) that enumerate information about hosts, they could show up here. The easy way to filter out these situations is to look at that scripted fingerprint and filter that out. For example, using <span class=\"code\">| where</span> (which has eval-style syntax different from <span class=\"code\">| search</span>) you could filter out <span class=\"code\">| where mvcount(filename)=4 AND filename=\"net.exe\" AND filename=\"ipconfig.exe\" AND filename=\"sc.exe\" AND filename=\"tasklist.exe\"</span>.</p>",
            "mitre": "Discovery",
            "mitre_tactic": "TA0007",
            "mitre_technique": "|T1087|T1069|T1057|T1016|T1033|T1082|T1007",
            "name": "Concentration of Discovery Tools by Filename",
            "operationalize": "<p>This alert is intended to corroborate other suspicious actions in most environments, rather than being a major flag on its own. You might send this alert to your alert manager as a low or information alert so that you can search for the asset and find it later. More advanced organizations might send this alert into the ES Risk Framework (so that you can aggregate low level risk elements) or to Splunk UBA (so that the threat models can incorporate this event into their calculations).</p>",
            "released": "1.0.0",
            "relevance": "These days, there are a lot of executables one can install and run on a Windows machine in order to cause mischief. The thing is, many amateur hackers will run a lot of these tools in succession (or automated scripts will run them, too). By correlating the process names being executed on endpoints with a list of 'known discovery tool executable names' we can detect this suspicious activity.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "showcase_series_discovery_tools_hashes": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Scanning|Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Series of Discovery Hashes - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "<p>It's uncommon to see many discovery tools launched on an endpoint, except in specific situations. This search will identify tools by file hash, and look for several in quick succession. (<a href=\"https://car.mitre.org/wiki/CAR-2016-03-001\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low (unless your company specifically does this)</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Series of Discovery Hashes - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Series of Discovery Hashes - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), where we have hashing turned on (look for tools like WLS, or Sysmon to help here). It then filters for a set of filenames that are known to be discovery related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>",
            "highlight": "No",
            "howToImplement": "The hardest part of implementing this correctly, once you have EDR logs ingested, will be to make sure that the fields correctly set. (Why EDR? The boundary between EDR logs and Windows Security Logs for <b>most</b> Splunk customers is that Windows Process Launch Logs won't contain hashes, or the right variety of hashes, but EDR tools including the free Sysmon tool will.)<ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your EDR logs live (index=epintel if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the second to last field you have to think about, which if you use our <a href=\"https://splunkbase.splunk.com/app/1914/\">Splunk Add-on for Sysmon</a> on your Search Head, will also work automatically for you (again, docs are key!)</li><li>Finally, Sysmon will return multiple different hashes. In order for the hashes to show up correctly in the table, make sure that you have a field named sha1 (or change the search to match what you see in the events).</ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p>The most likely source of false positives for this script would be normal admin activity, particularly if you have login scripts (or periodic scripts) that enumerate information about hosts, they could show up here. The easy way to filter out these situations is to look at that scripted fingerprint and filter that out. For example, using <span class=\"code\">| where</span> (which has eval-style syntax different from <span class=\"code\">| search</span>) you could filter out <span class=\"code\">| where mvcount(sha1)=4 AND sha1=\"430AA43010EEF3CD43ED445777F3D5CCF6BC4C27\" AND sha1=\"4445BC58D64BCE3322F80690AF5405876D01C0AC\" AND sha1=\"9A544E2094273741AA2D3E7EA0AF303AF2B587EA\" AND sha1=\"EA18043FEDAF888F04C07F71F2006F3F479C0B41\"</span>.</p>",
            "mitre": "Discovery",
            "mitre_tactic": "TA0007",
            "mitre_technique": "|T1087|T1069|T1016|T1082|T1033|T1057|T1007",
            "name": "Concentration of Discovery Tools by SHA1 Hash",
            "operationalize": "<p>This alert is intended to corroborate other suspicious actions in most environments, rather than being a major flag on its own. You might send this alert to your alert manager as a low or information alert so that you can search for the asset and find it later. More advanced organizations might send this alert into the ES Risk Framework (so that you can aggregate low level risk elements) or to Splunk UBA (so that the threat models can incorporate this event into their calculations).</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "released": "1.0.0",
            "relevance": "Building on the two examples of surfacing concentrations of hacker or discovery tools via filename, a more accurate method for doing this is to use the SHA1 cryptographic hashes for these tools, because tools can always be renamed before executing. By correlating the process hashes being executed on endpoints with a list of 'known discovery tool executable hashes' we can detect this suspicious activity.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "showcase_short_lived_accounts": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Short Lived Accounts - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>A technique used by attackers is to create an account, take some actions, and then delete it right away. This search will find those accounts on the local system.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Short Lived Accounts - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Short Lived Accounts - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Short Lived Accounts - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows security logs for user creation and user deletion. We filter for that, and then use the transaction command to group a create and delete in a short period of time. Anything that matches, we will surface. </p>",
            "highlight": "No",
            "howToImplement": "This search relies on the standard Windows Security events coming from a Windows Forwarder on a workstation or member server (so: not domain controllers). Implementation is as easy as just ingesting that data, specifying the correct index, and then running the search. If you are using a log source other than the Splunk TA for Windows (e.g., snare, WMI, etc.), you might need to adjust field names to match those in the search itself.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Healthcare",
            "journey": "Stage_1",
            "killchain": "Command and Control",
            "knownFP": "<p>The biggest potential false positive from this detection is that technically it will fire for any account creation, not just admin accounts. It's difficult to put sufficient logic into a single search to detect admin accounts while also detecting short lived accounts (though it may be possible to combine with the new admin account detection in this app), and wasn't a big priority given how rare short lived accounts are in general.</p><p>Beyond that, there are no known sources of false positives for this search.</p>",
            "mitre": "Defense Evasion|Persistence",
            "mitre_tactic": "TA0005|TA0003",
            "mitre_technique": "|T1136|TA0005",
            "name": "Short Lived Admin Accounts",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the creation and deletion events, as well as the user accounts that created the account and the account name itself, the system that initiated the request and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted.</p>",
            "released": "1.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "showcase_new_local_admin_account"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "showcase_significant_printing": {
            "SPLEase": "Hard",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Pages Printed Per User Per Day - Demo",
            "data_source_categories": "DS006UserActivity-ET03Create",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "<p>Find users who printed more pages than normal.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Pages Printed Per User Per Day - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Pages Printed Per User Per Day - Live"
                },
                {
                    "label": "Accelerated with Data Models",
                    "name": "Pages Printed Per User Per Day - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is an anonymized collection of Print Server logs from a Uniflow print server. For this analysis, we are tracking the total number of pages the user has printed per day 'sum(NumPages) by User _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
            "mitre": "Exfiltration",
            "mitre_tactic": "TA0010",
            "mitre_technique": "|T1052",
            "name": "Increase in Pages Printed",
            "operationalize": "<p>When this search returns values, initiate your incident response process and validate the user account running these print jobs. If possible, determine which printer and what files are being printed and the time frame during which the printing occurred. Contact the user to determine if it is authorized, and document if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as excessive page prints might be a way to exfiltrate sensitive data.</p>",
            "released": "1.0.0",
            "relevance": "It may seem inefficient and old-fashioned, but users that suddenly start printing a lot more pages from networked printers than is \u201cnormal\u201d could be a sign of data exfiltration. Sensitive data could be leaving your corporation, literally in black-and-white! It is particularly interesting to correlate this behavior to a watchlist which may contain the user IDs of personnel that are considered higher risk: contractors, new employees, employees that never go on vacation, employees with access to particularly sensitive data. Often, the data gathered by Splunk can include the destination printer(s), the source of the print jobs, the names of files printed, and even whether or not the output was black-and-white or color.",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "showcase_spike_in_outgoing_email": {
            "SPLEase": "Hard",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|Endpoint Compromise|SaaS|Cloud Security",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Spike in Email from Address - Demo",
            "data_source_categories": "DS001MAIL-ET03Send",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "<p>Both to detect data exfiltration and compromised account, we can analyze users that are sending out dramatically more data than normal. This search looks per source email address for big increases in volume.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Spike in Email from Address - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Spike in Email from Address - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
            "mitre": "Exfiltration",
            "mitre_tactic": "TA0010",
            "mitre_technique": "|T1048",
            "name": "User with Increase in Outgoing Email",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, the sender, recipient, subject or the mail and attachments, if any. Contact the sender. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "relatedUseCases": [
                "detection_email_attachments_with_spaces",
                "showcase_external_emails_with_internal_domain",
                "high_volume_email_activity_to_noncorporate_domains_by_user",
                "detection_suspicious_email_attachments",
                "UC0004"
            ],
            "released": "1.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "showcase_spike_in_password_reset_emails": {
            "SPLEase": "Hard",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|SaaS|Cloud Security",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Spike in Password Reset Emails - Demo",
            "data_source_categories": "DS001MAIL-ET02Receive",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "<p>Sending password reset emails is a common phishing technique. Protect your users by identifying spikes in the number of suspicious emails entering your environment.</p><p><b>Alert Volume:</b> Very Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Spike in Password Reset Emails - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Spike in Password Reset Emails - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Spike in Password Reset Emails - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
            "mitre": "Initial Access",
            "mitre_sub_technique": "T1566.002",
            "mitre_tactic": "TA0001",
            "mitre_technique": "|T1192",
            "name": "Spike in Password Reset Emails",
            "operationalize": "<p>When this search returns values, initiate your incident response process and capture the time of the event, the sender, recipient, subject or the mail and attachments, if any. Contact the sender. If it is authorized behavior, make a document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_phishing_remediation_investigation"
            ],
            "released": "1.2.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "showcase_spike_in_sfdc_document_downloads": {
            "SPLEase": "Hard",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|SaaS|Cloud Security",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Spike in SFDC Documents Downloaded - Demo",
            "data_source_categories": "VendorSpecific-sfdc-elf",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Salesforce.com contains the most critical information for many companies. This example tracks the number of documents downloaded per day per user, to detect exfiltration.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Spike in SFDC Documents Downloaded - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Spike in SFDC Documents Downloaded - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized data collection from an actual customer environment.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213",
            "name": "Spike in Downloaded Documents Per User from Salesforce.com",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and number of documents downloaded. If possible, determine the system the user is using to download this data and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_spike_downloaded_docs.png",
            "released": "1.4.0",
            "searchKeywords": "salesforce sfdc",
            "usecase": "Insider Threat"
        },
        "showcase_spike_in_sfdc_exports": {
            "SPLEase": "Hard",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|GDPR|SaaS|Cloud Security",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Spike in SFDC Records Exported - Demo",
            "data_source_categories": "VendorSpecific-sfdc-elf",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>For many organizations, Salesforce.com contains the most critical information in their company. This use case tracks the number of records exported per day (and is based on a real set of data collection).</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Spike in SFDC Records Exported - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Spike in SFDC Records Exported - Live"
                }
            ],
            "gdprtext": "<h4>Impact:</h4><p>A sudden, high-volume increase in exported records can indicate unauthorized, non-compliant, and potentially malicious behavior. </p><p>Specific to GDPR, detecting and proving that individuals within the organization are not abusing or misusing legitimate access to assets that store and process personal data is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized data collection from an actual customer environment.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213",
            "name": "Spike in Exported Records from Salesforce.com",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and number of rows exported. If possible, determine the system the user is using to download this data and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_spike_exported_records.png",
            "released": "1.4.0",
            "searchKeywords": "salesforce sfdc",
            "usecase": "Compliance|Insider Threat"
        },
        "showcase_unique_patient_records_viewed": {
            "SPLEase": "Advanced",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Data Exfiltration|Insider Threat",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Number of Unique Patient Records Viewed Per Day - Demo",
            "data_source_categories": "VendorSpecific-Cerner",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>If a healthcare worker views more patient records than normal or more than their peers, it could be a sign that their system is infected, or that they are exfiltrating patient data.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Data",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Number of Unique Patient Records Viewed Per Day - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Number of Unique Patient Records Viewed Per Day - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is a set of manufactured logs based on a Cerner patient record system, which tracked the number of unique patient whose records a particular doctor, nurse, DBA, or etc. opened per day, 'dc(PatientID) as NumOpens by EmployeeName _time'. (In effect, if you worked with one patient all day, and opened their chart 100 times, you would have a NumOpens of 1, because you only viewed one patient). Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average. Notably, the daily dc() is already done in this dataset -- this is akin to analyzing a summary index, as is explained in the High Cardinality Alert dialog.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information . If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
            "mitre": "Collection",
            "mitre_tactic": "TA0009",
            "mitre_technique": "|T1213|T1039",
            "name": "Healthcare Worker Opening More Patient Records Than Usual",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Determine the time, role, and number of accesses occurring and from what address if possible. Contact the user and manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine if patient data is being collected.</p>",
            "released": "1.0.0",
            "relevance": "Healthcare organizations need to be particularly concerned about privacy laws (HIPAA/HITECH) and data exfiltration of financially lucrative patient records. Patient records are worth 10x or 20x what credit card numbers are worth on the black market, as the more you know about an individual the more useful that individuals' information is for identity theft. This data can also be used so that an individual can impersonate the victim and obtain healthcare services, and then the bill for said services goes to the \u201creal\u201d individual. Therefore, tracking who is accessing patient records in a \u201cnormal\u201d manner vs anomalous access patterns is be critical to detecting this activity before records are exfiltrated. Note that this search could find true insiders acting maliciously, or detection of users that have had their credentials compromised, and those user accounts are now being hijacked for data exfiltration.",
            "searchKeywords": "",
            "usecase": "Insider Threat|Advanced Threat Detection|Compliance"
        },
        "showcase_unusual_child_process_for_spoolsv_or_connhost": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Unusual Child Process for spoolsv.exe or connhost.exe - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "<p>In late August 2018, a new Windows Zero Day was announced via Twitter, and the only apparent defense is to detect unusual child processes from spoolsv.exe or connhost.exe. SSE already detected the POC, but this specifically looks for any potential detection.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Unusual Child Process for spoolsv.exe or connhost.exe - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Unusual Child Process for spoolsv.exe or connhost.exe - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch logs from Microsoft Sysmon (EventCode=1). For this analysis, we are looking at the processes spawned by spoolsv.exe or connhost.exe and comparing them against our baseline. If we've seen that process be spawned before, then all is fine, but if we've never seen it before we'll raise an alert.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. <b>For this search</b> you may wish to alter the process names that are tracked.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection should have relatively few false positives given the rarity of new parent processes for these standard Windows processes. Most noise that will come from new systems management scripts, or from new software installers. These can be whitelisted in the search.</p>",
            "mitre": "Discovery|Lateral Movement|Execution",
            "mitre_tactic": "TA0004",
            "mitre_technique": "|T1068",
            "name": "Unusual Child Process for spoolsv.exe or connhost.exe",
            "operationalize": "<p>When this search returns values, initiate your incident response process and identify what the child process did. Determine the system it is running on. Contact the user and system owner of this action. If it is authorized, document that this is and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to ensure that processes are not spawning these commands.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/showcase_unusual_child_process_for_spoolsv_or_connhost.png",
            "released": "2.2.0",
            "relevance": "As described above, this detection is in response to a particular zero day exploit, described <a href=\"https://doublepulsar.com/task-scheduler-alpc-exploit-high-level-analysis-ff08cda6ad4f\" class=\"external\" target=\"_blank\">here</a>. This exploit allows a user (either legitimate or an attacker-owned account) with limited privileges to escalate to the SYSTEM account. In practical terms, this would allow an attacker who gets the ability to log into a system to be able to permanently maintain persistence on that system, compromise any data persence, and more easily move laterally.",
            "searchKeywords": "spoolsv connhost sysmon",
            "usecase": "Advanced Threat Detection"
        },
        "showcase_unusually_long": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Find Unusually Long CLI Commands - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "datasources": "Endpoint Detection and Response",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Oftentimes we're able to detect malware by looking for unusually long command line strings.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Find Unusually Long CLI Commands - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Find Unusually Long CLI Commands - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Sysmon process launch logs (EventCode 1). The search then looks for unusually long command line strings, and surfaces those.</p>",
            "highlight": "No",
            "howToImplement": "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events, and know the full command line string (so the file path, process name, and the command line arguments). For the demo and live version of this search we use Microsoft Sysmon with the CommandLine field, but you could adjust that to another data source and change the field name (it is not a CIM field).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Exploitation|Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect a spike in the length of the CLI commands, but that doesn't mean you really want to put it in front of an analyst. So while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
            "mitre": "Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "|T1059",
            "name": "Find Unusually Long CLI Commands",
            "operationalize": "<p>When this search returns values, initiate your incident response process and determine the user account that is generating the alert. Contact the user and system owner to determine if it is authorized, and document if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as excessively long command lines commands could house malicious scripts.</p>",
            "released": "1.0.0",
            "relevance": "To avoid detection by file integrity monitoring solutions or similar, malware will often execute code 'in memory' and never write the code to disk. But if you're watching process executions in some detail via windows process command line auditing or via Sysmon or similar, you can often pick up anomalous behavior such as statistically significant command line execution lengths. The example given here shows a command interpreter executing a large amount of .vbs code to download a ransomware encryption binary.",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "single_letter_process_on_endpoint": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=single_letter_process_on_endpoint",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1204.002/single_letter_exe/windows-sysmon.log"
            ],
            "date": "2020-12-08",
            "description": "This search looks for process names that consist only of a single letter.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 2",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "single_letter_process_on_endpoint",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Single-letter executables are not always malicious. Investigate this activity with your normal incident-response process.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "single_letter_process_on_endpoint_filter"
                }
            ],
            "mitre_sub_technique": "T1204.002",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1204",
            "mitre_threat_groups": "Magic Hound|Windshift|APT33|Sandworm Team|Naikon|Whitefly|Tropic Trooper|Gamaredon Group|Sharpshooter|Molerats|Wizard Spider|Mofang|Frankenstein|RTM|Inception|BlackTech|APT-C-36|Machete|admin@338|APT12|TA505|Silence|The White Company|APT39|FIN4|Darkhotel|Gallmaker|APT19|Dragonfly 2.0|BRONZE BUTLER|Cobalt Group|DarkHydrus|Gorgon Group|Patchwork|OilRig|Dark Caracal|MuddyWater|Lazarus Group|FIN7|APT32|Rancor|APT37|FIN8|APT28|Elderwood|TA459|APT29|Leviathan|menuPass|PLATINUM",
            "name": "Single Letter Process On Endpoint",
            "references": [],
            "released": "2020-12-08",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest, Processes.user, Processes.process, Processes.process_name | `drop_dm_object_name(Processes)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | eval process_name_length = len(process_name), endExe = if(substr(process_name, -4) == \".exe\", 1, 0) | search process_name_length=5 AND endExe=1 | table count, firstTime, lastTime, dest, user, process, process_name | `single_letter_process_on_endpoint_filter`",
            "search_name": "ESCU - Single Letter Process On Endpoint - Rule",
            "story": "0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 2"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1204.002/single_letter_exe/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Magic Hound",
                    "Windshift",
                    "APT33",
                    "Sandworm Team",
                    "Naikon",
                    "Whitefly",
                    "Tropic Trooper",
                    "Gamaredon Group",
                    "Sharpshooter",
                    "Molerats",
                    "Wizard Spider",
                    "Mofang",
                    "Frankenstein",
                    "RTM",
                    "Inception",
                    "BlackTech",
                    "APT-C-36",
                    "Machete",
                    "admin@338",
                    "APT12",
                    "TA505",
                    "Silence",
                    "The White Company",
                    "APT39",
                    "FIN4",
                    "Darkhotel",
                    "Gallmaker",
                    "APT19",
                    "Dragonfly 2.0",
                    "BRONZE BUTLER",
                    "Cobalt Group",
                    "DarkHydrus",
                    "Gorgon Group",
                    "Patchwork",
                    "OilRig",
                    "Dark Caracal",
                    "MuddyWater",
                    "Lazarus Group",
                    "FIN7",
                    "APT32",
                    "Rancor",
                    "APT37",
                    "FIN8",
                    "APT28",
                    "Elderwood",
                    "TA459",
                    "APT29",
                    "Leviathan",
                    "menuPass",
                    "PLATINUM"
                ],
                "mitre_attack_id": [
                    "T1204"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Malicious File"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "smb_traffic_spike": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Emotet Malware  DHS Report TA18-201A |Hidden Cobra Malware|Ransomware|DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=smb_traffic_spike",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This search looks for spikes in the number of Server Message Block (SMB) traffic connections.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search requires you to be ingesting your network traffic logs and populating the `Network_Traffic` data model.",
            "highlight": "No",
            "how_to_implement": "This search requires you to be ingesting your network traffic logs and populating the `Network_Traffic` data model.",
            "icon": "ES_Use_Case.png",
            "id": "smb_traffic_spike",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "known_false_positives": "A file server may experience high-demand loads that could cause this analytic to trigger.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "smb_traffic_spike_filter"
                }
            ],
            "mitre_sub_technique": "T1021.002",
            "mitre_tactic": "TA0008",
            "mitre_tactic_display": "Lateral Movement",
            "mitre_technique": "T1021",
            "mitre_threat_groups": "Blue Mockingbird|APT39|APT32|Orangeworm|FIN8|APT3|Lazarus Group|Threat Group-1314|Turla|Deep Panda|Ke3chang",
            "name": "SMB Traffic Spike",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Traffic where All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb by _time span=1h, All_Traffic.src | `drop_dm_object_name(\"All_Traffic\")` | eventstats max(_time) as maxtime | stats count as num_data_samples max(eval(if(_time >= relative_time(maxtime, \"-70m@m\"), count, null))) as count avg(eval(if(_time<relative_time(maxtime, \"-70m@m\"), count, null))) as avg stdev(eval(if(_time<relative_time(maxtime, \"-70m@m\"), count, null))) as stdev by src | eval upperBound=(avg+stdev*2), isOutlier=if(count > upperBound AND num_data_samples >=50, 1, 0) | where isOutlier=1 | table src count | `smb_traffic_spike_filter` ",
            "search_name": "ESCU - SMB Traffic Spike - Rule",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52|baf7580b-d4b4-4774-8173-7d198e9da335|cf309d0d-d4aa-4fbb-963d-1e79febd3756|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "Emotet Malware  DHS Report TA18-201A ",
                    "Hidden Cobra Malware",
                    "Ransomware",
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "APT32",
                    "Orangeworm",
                    "FIN8",
                    "APT3",
                    "Lazarus Group",
                    "Threat Group-1314",
                    "Turla",
                    "Deep Panda",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1021"
                ],
                "mitre_attack_tactics": [
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "SMB/Windows Admin Shares"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "smb_traffic_spike_-_mltk": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Emotet Malware  DHS Report TA18-201A |Hidden Cobra Malware|Ransomware|DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2019-05-08",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model to characterize the number of SMB connections observed each hour for every day of week. By default, the search uses the last 30 days of data to build the model. The model created by this search is then used in the corresponding detection search to identify outliers in the number of SMB connections for that hour and day of the week.",
                    "how_to_implement": "You must be ingesting network traffic and populating the Network_Traffic data model. In addition, you must have the Machine Learning Toolkit (MLTK) version >= 4.2 installed, along with any required dependencies. To improve your results, you may consider adding \"src\" to the by clause, which will build the model for each unique source in your enviornment. However, if you have a large number of hosts in your environment, this search may be very resource intensive. In this case, you may need to raise the value of max_inputs and/or max_groups in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 30 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data. More information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "df98763b-0b08-4281-8ef9-08db7ac572a9",
                    "macros": [
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_smb_traffic___mltk_filter"
                        }
                    ],
                    "name": "Baseline of SMB Traffic - MLTK",
                    "search": "| tstats `security_content_summariesonly` count from datamodel=Network_Traffic where All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb by _time span=10m, All_Traffic.src | eval HourOfDay=strftime(_time, \"%H\") | eval DayOfWeek=strftime(_time, \"%A\") | `drop_dm_object_name(\"All_Traffic\")` | fit DensityFunction count by \"HourOfDay,DayOfWeek\" into smb_pdfmodel",
                    "tags": {
                        "analytics_story": [
                            "DHS Report TA18-074A",
                            "Disabling Security Tools",
                            "Emotet Malware  DHS Report TA18-201A ",
                            "Hidden Cobra Malware",
                            "Netsh Abuse",
                            "Ransomware"
                        ],
                        "detections": [
                            "Processes launching netsh",
                            "SMB Traffic Spike - MLTK"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=smb_traffic_spike_-_mltk",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This search uses the Machine Learning Toolkit (MLTK) to identify spikes in the number of Server Message Block (SMB) connections.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you will need to ensure that DNS data is populating the Network_Resolution data model. In addition, the Machine Learning Toolkit (MLTK) version 4.2 or greater must be installed on your search heads, along with any required dependencies. Finally, the support search \"Baseline of SMB Traffic - MLTK\" must be executed before this detection search, because it builds a machine-learning (ML) model over the historical data used by this search. It is important that this search is run in the same app context as the associated support search, so that the model created by the support search is available for use. You should periodically re-run the support search to rebuild the model with the latest data available in your environment.\\\nThis search produces a field (Number of events,count) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. This field contributes additional context to the notable. To see the additional metadata, add the following field, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry): \\\n1. **Label:** Number of events, **Field:** count\\\nDetailed documentation on how to create a new field within Incident Review is found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you will need to ensure that DNS data is populating the Network_Resolution data model. In addition, the Machine Learning Toolkit (MLTK) version 4.2 or greater must be installed on your search heads, along with any required dependencies. Finally, the support search \"Baseline of SMB Traffic - MLTK\" must be executed before this detection search, because it builds a machine-learning (ML) model over the historical data used by this search. It is important that this search is run in the same app context as the associated support search, so that the model created by the support search is available for use. You should periodically re-run the support search to rebuild the model with the latest data available in your environment.\\\nThis search produces a field (Number of events,count) that are not yet supported by ES Incident Review and therefore cannot be viewed when a notable event is raised. This field contributes additional context to the notable. To see the additional metadata, add the following field, if not already present, to Incident Review - Event Attributes (Configure > Incident Management > Incident Review Settings > Add New Entry): \\\n1. **Label:** Number of events, **Field:** count\\\nDetailed documentation on how to create a new field within Incident Review is found here: `https://docs.splunk.com/Documentation/ES/5.3.0/Admin/Customizenotables#Add_a_field_to_the_notable_event_details`",
            "icon": "ES_Use_Case.png",
            "id": "smb_traffic_spike_-_mltk",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "If you are seeing more results than desired, you may consider reducing the value of the threshold in the search. You should also periodically re-run the support search to re-build the ML model on the latest data. Please update the `smb_traffic_spike_mltk_filter` macro to filter out false positive results",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "smb_traffic_spike___mltk_filter"
                }
            ],
            "mitre_sub_technique": "T1021.002",
            "mitre_tactic": "TA0008",
            "mitre_tactic_display": "Lateral Movement",
            "mitre_technique": "T1021",
            "mitre_threat_groups": "Blue Mockingbird|APT39|APT32|Orangeworm|FIN8|APT3|Lazarus Group|Threat Group-1314|Turla|Deep Panda|Ke3chang",
            "name": "SMB Traffic Spike - MLTK",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count values(All_Traffic.dest_ip) as dest values(All_Traffic.dest_port) as port from datamodel=Network_Traffic where All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb by _time span=1h, All_Traffic.src | eval HourOfDay=strftime(_time, \"%H\") | eval DayOfWeek=strftime(_time, \"%A\") | `drop_dm_object_name(All_Traffic)` | apply smb_pdfmodel threshold=0.001 | rename \"IsOutlier(count)\" as isOutlier | search isOutlier > 0 | sort -count | table _time src dest port count | `smb_traffic_spike___mltk_filter` ",
            "search_name": "ESCU - SMB Traffic Spike - MLTK - Rule",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52|baf7580b-d4b4-4774-8173-7d198e9da335|cf309d0d-d4aa-4fbb-963d-1e79febd3756|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "Emotet Malware  DHS Report TA18-201A ",
                    "Hidden Cobra Malware",
                    "Ransomware",
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "APT39",
                    "APT32",
                    "Orangeworm",
                    "FIN8",
                    "APT3",
                    "Lazarus Group",
                    "Threat Group-1314",
                    "Turla",
                    "Deep Panda",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1021"
                ],
                "mitre_attack_tactics": [
                    "Lateral Movement"
                ],
                "mitre_attack_technique": [
                    "SMB/Windows Admin Shares"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "spectre_and_meltdown_vulnerable_systems": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Spectre And Meltdown Vulnerabilities",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2018-01-08",
                    "description": "Some AV applications can cause the Spectre/Meltdown patch for Windows not to install successfully. This registry key is supposed to be created by the AV engine when it has been patched to be able to handle the Windows patch. If this key has been written, the system can then be patched for Spectre and Meltdown.",
                    "how_to_implement": "You need to be ingesting logs with both the process name and command-line from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
                    "id": "fc0edc95-ff2b-48b0-9f6f-63da3789fd61",
                    "macros": [
                        {
                            "arguments": [
                                "field"
                            ],
                            "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                            "description": "convert epoch time to string",
                            "name": "security_content_ctime"
                        },
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "systems_ready_for_spectre_meltdown_windows_patch_filter"
                        }
                    ],
                    "name": "Systems Ready for Spectre-Meltdown Windows Patch",
                    "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Change_Analysis.All_Changes where All_Changes.object_category=registry AND (All_Changes.object_path=\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\QualityCompat*\") by All_Changes.dest, All_Changes.command, All_Changes.user, All_Changes.object, All_Changes.object_path | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(\"All_Changes\")`",
                    "tags": {
                        "analytics_story": [
                            "Spectre And Meltdown Vulnerabilities"
                        ],
                        "detections": [
                            "Spectre and Meltdown Vulnerable Systems"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Vulnerability",
            "dashboard": "showcase_security_content?showcaseId=spectre_and_meltdown_vulnerable_systems",
            "data_source_categories": "DS018VulnerabilityDetection-ET01SigDetected",
            "datamodel": "Vulnerabilities",
            "dataset": "",
            "date": "2017-01-07",
            "description": "The search is used to detect systems that are still vulnerable to the Spectre and Meltdown vulnerabilities.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 4",
            "escu_nist": "ID.RA|RS.MI|PR.IP|DE.CM",
            "hasSearch": "Yes",
            "help": "The search requires that you are ingesting your vulnerability-scanner data and that it reports the CVE of the vulnerability identified.",
            "highlight": "No",
            "how_to_implement": "The search requires that you are ingesting your vulnerability-scanner data and that it reports the CVE of the vulnerability identified.",
            "icon": "ES_Use_Case.png",
            "id": "spectre_and_meltdown_vulnerable_systems",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "None",
            "known_false_positives": "It is possible that your vulnerability scanner is not detecting that the patches have been applied.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "spectre_and_meltdown_vulnerable_systems_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Spectre And Meltdown Vulnerable Systems",
            "references": [],
            "released": "2017-01-07",
            "search": "| tstats `security_content_summariesonly` min(_time) as firstTime max(_time) as lastTime from datamodel=Vulnerabilities where Vulnerabilities.cve =\"CVE-2017-5753\" OR Vulnerabilities.cve =\"CVE-2017-5715\" OR Vulnerabilities.cve =\"CVE-2017-5754\" by Vulnerabilities.dest | `drop_dm_object_name(Vulnerabilities)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `spectre_and_meltdown_vulnerable_systems_filter`",
            "search_name": "ESCU - Spectre and Meltdown Vulnerable Systems - Rule",
            "security_domain": "endpoint",
            "story": "6d3306f6-bb2b-4219-8609-8efad64032f2",
            "tags": {
                "analytics_story": [
                    "Spectre And Meltdown Vulnerabilities"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 4"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.RA",
                    "RS.MI",
                    "PR.IP",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "spike_in_file_writes": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SamSam Ransomware|Ryuk Ransomware|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=spike_in_file_writes",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": "",
            "date": "2020-03-16",
            "description": "The search looks for a sharp increase in the number of files written to a particular host",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "In order to implement this search, you must populate the Endpoint file-system data model node. This is typically populated via endpoint detection and response products, such as Carbon Black or endpoint data sources such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the file system.",
            "highlight": "No",
            "how_to_implement": "In order to implement this search, you must populate the Endpoint file-system data model node. This is typically populated via endpoint detection and response products, such as Carbon Black or endpoint data sources such as Sysmon. The data used for this search is typically generated via logs that report reads and writes to the file system.",
            "icon": "ES_Use_Case.png",
            "id": "spike_in_file_writes",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It is important to understand that if you happen to install any new applications on your hosts or are copying a large number of files, you can expect to see a large increase of file modifications.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "spike_in_file_writes_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Spike In File Writes",
            "references": [],
            "released": "2020-03-16",
            "search": "| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Filesystem where Filesystem.action=created by _time span=1h, Filesystem.dest | `drop_dm_object_name(Filesystem)` | eventstats max(_time) as maxtime | stats count as num_data_samples max(eval(if(_time >= relative_time(maxtime, \"-1d@d\"), count, null))) as \"count\" avg(eval(if(_time<relative_time(maxtime, \"-1d@d\"), count,null))) as avg stdev(eval(if(_time<relative_time(maxtime, \"-1d@d\"), count, null))) as stdev by \"dest\" | eval upperBound=(avg+stdev*4), isOutlier=if((count > upperBound) AND num_data_samples >=20, 1, 0) | search isOutlier=1 | `spike_in_file_writes_filter` ",
            "search_name": "ESCU - Spike in File Writes - Rule",
            "security_domain": "endpoint",
            "story": "c4b89506-fbcf-4cb7-bfd6-527e54789604|507edc74-13d5-4339-878e-b9744ded1f35|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "SamSam Ransomware",
                    "Ryuk Ransomware",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring|Advanced Threat Detection",
            "version": 3
        },
        "splunk_access_provisioning": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|IAM Analytics|Operations",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Splunk Role Check GDPR - Demo",
            "data_source_categories": "VendorSpecific-SplunkInternal",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Alerts the first time a user gains rights to search an index that they're not supposed to according to the output of a GDPR data source and GDPR user mapping exercise.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Splunk Role Check GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Splunk Role Check GDPR - Live"
                }
            ],
            "gdpr": "32|58",
            "gdprtext": "<h4>Impact</h4><p>Per Article 6, data can only be accessed and used for the legitimate reason it needed to be collected and lawfully processed. This lawful processing requires meeting specific criteria, such as the data subject has consented to processing, or processing is necessary for the performance of a contract with the data subject, or for compliance and legal obligations, or for protecting the vital interests of individuals, or for public interest reasons or the legitimate interests by the controller or a third party. Machine data that is stored within a central logging tool can include personal data -- in the case of Splunk, as stored within indexes or as the result of functions performed within Splunk such as enrichment or correlations across data sources. Therefore it is critical to be aware of when a user has access to in-scope Splunk indexes when they should not, to maintain compliance and / or to document and report to authorities as required.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is the output of very long and complicated macro (see the live search). ",
            "highlight": "Yes",
            "howToImplement": "First, use the results of the data mapping exercise from your data privacy officer to build a lookup that associates systems to a GDPR category. Then do the same for users. Then the search should work smoothly. Importantly though, this information is held on the search head, so if you have multiple search heads in your environment you will need to run this search on every one of them (only one cluster member from a search head cluster must be used).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
            "mitre": "Privilege Escalation|Credential Access",
            "mitre_notes": "Incorrect privilege assignment, not an attacker technique",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "User Has Access to In-Scope Splunk Indexes They Should Not",
            "operationalize": "When this search fires, the immediate concern is that the brute force attack was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_splunk_indexes.png",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat|Compliance"
        },
        "splunk_enterprise_information_disclosure": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Splunk Enterprise Vulnerability CVE-2018-11409",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Splunk Server",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Vulnerability",
            "dashboard": "showcase_security_content?showcaseId=splunk_enterprise_information_disclosure",
            "data_source_categories": "VendorSpecific-SplunkInternal",
            "datamodel": "",
            "dataset": "",
            "date": "2018-06-14",
            "description": "This search allows you to look for evidence of exploitation for CVE-2018-11409, a Splunk Enterprise Information Disclosure Bug.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 4|CIS 18",
            "escu_nist": "ID.RA|RS.MI|PR.PT|PR.AC|PR.IP|DE.CM",
            "hasSearch": "Yes",
            "help": "The REST endpoint that exposes system information is also necessary for the proper operation of Splunk clustering and instrumentation. Whitelisting your Splunk systems will reduce false positives.",
            "highlight": "No",
            "how_to_implement": "The REST endpoint that exposes system information is also necessary for the proper operation of Splunk clustering and instrumentation. Whitelisting your Splunk systems will reduce false positives.",
            "icon": "ES_Use_Case.png",
            "id": "splunk_enterprise_information_disclosure",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Delivery",
            "known_false_positives": "Retrieving server information may be a legitimate API request. Verify that the attempt is a valid request for information.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "splunk_enterprise_information_disclosure_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Splunk Enterprise Information Disclosure",
            "references": [],
            "released": "2018-06-14",
            "search": "index=_internal sourcetype=splunkd_ui_access server-info | search clientip!=127.0.0.1 uri_path=\"*raw/services/server/info/server-info\" | rename clientip as src_ip, splunk_server as dest | stats earliest(_time) as firstTime, latest(_time) as lastTime, values(uri) as uri, values(useragent) as http_user_agent, values(user) as user by src_ip, dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `splunk_enterprise_information_disclosure_filter`",
            "search_name": "ESCU - Splunk Enterprise Information Disclosure - Rule",
            "security_domain": "network",
            "story": "1fc34cbc-34e9-43ba-87ab-6811c9e95400",
            "tags": {
                "analytics_story": [
                    "Splunk Enterprise Vulnerability CVE-2018-11409"
                ],
                "asset_type": "Splunk Server",
                "cis20": [
                    "CIS 3",
                    "CIS 4",
                    "CIS 18"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.RA",
                    "RS.MI",
                    "PR.PT",
                    "PR.AC",
                    "PR.IP",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "sql_injection_with_long_urls": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "SQL Injection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Database Server",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Web Attack",
            "dashboard": "showcase_security_content?showcaseId=sql_injection_with_long_urls",
            "data_source_categories": "DS014WebServer-ET01Access",
            "datamodel": "Web",
            "dataset": "",
            "date": "2020-07-21",
            "description": "This search looks for long URLs that have several SQL commands visible within them.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 4|CIS 13|CIS 18",
            "escu_nist": "PR.DS|ID.RA|PR.PT|PR.IP|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you need to be monitoring network communications to your web servers or ingesting your HTTP logs and populating the Web data model. You must also identify your web servers in the Enterprise Security assets table.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you need to be monitoring network communications to your web servers or ingesting your HTTP logs and populating the Web data model. You must also identify your web servers in the Enterprise Security assets table.",
            "icon": "ES_Use_Case.png",
            "id": "sql_injection_with_long_urls",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Delivery",
            "known_false_positives": "It's possible that legitimate traffic will have long URLs or long user agent strings and that common SQL commands may be found within the URL. Please investigate as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "sql_injection_with_long_urls_filter"
                }
            ],
            "mitre_sub_technique": "T1190",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1190",
            "mitre_threat_groups": "Blue Mockingbird|Rocke|APT39|BlackTech|APT41|Soft Cell|Night Dragon|Axiom",
            "name": "Sql Injection With Long Urls",
            "references": [],
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count from datamodel=Web where Web.dest_category=web_server AND (Web.url_length > 1024 OR Web.http_user_agent_length > 200) by Web.src Web.dest Web.url Web.url_length Web.http_user_agent | `drop_dm_object_name(\"Web\")` | eval num_sql_cmds=mvcount(split(url, \"alter%20table\")) + mvcount(split(url, \"between\")) + mvcount(split(url, \"create%20table\")) + mvcount(split(url, \"create%20database\")) + mvcount(split(url, \"create%20index\")) + mvcount(split(url, \"create%20view\")) + mvcount(split(url, \"delete\")) + mvcount(split(url, \"drop%20database\")) + mvcount(split(url, \"drop%20index\")) + mvcount(split(url, \"drop%20table\")) + mvcount(split(url, \"exists\")) + mvcount(split(url, \"exec\")) + mvcount(split(url, \"group%20by\")) + mvcount(split(url, \"having\")) + mvcount(split(url, \"insert%20into\")) + mvcount(split(url, \"inner%20join\")) + mvcount(split(url, \"left%20join\")) + mvcount(split(url, \"right%20join\")) + mvcount(split(url, \"full%20join\")) + mvcount(split(url, \"select\")) + mvcount(split(url, \"distinct\")) + mvcount(split(url, \"select%20top\")) + mvcount(split(url, \"union\")) + mvcount(split(url, \"xp_cmdshell\")) - 24 | where num_sql_cmds > 3 | `sql_injection_with_long_urls_filter`",
            "search_name": "ESCU - SQL Injection with Long URLs - Rule",
            "story": "4f6632f5-449c-4686-80df-57625f59bab3",
            "tags": {
                "analytics_story": [
                    "SQL Injection"
                ],
                "asset_type": "Database Server",
                "cis20": [
                    "CIS 4",
                    "CIS 13",
                    "CIS 18"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Rocke",
                    "APT39",
                    "BlackTech",
                    "APT41",
                    "Soft Cell",
                    "Night Dragon",
                    "Axiom"
                ],
                "mitre_attack_id": [
                    "T1190"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Exploit Public-Facing Application"
                ],
                "nist": [
                    "PR.DS",
                    "ID.RA",
                    "PR.PT",
                    "PR.IP",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Application Security",
            "version": 2
        },
        "sse_dyndns": {
            "SPLEase": "Basic",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Command and Control",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=DynDNS - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|DS002DNS-ET01Query",
            "deprecated_not_used_anymore_datasource": "Web Proxy|DNS",
            "description": "<p>Detect outbound communication to Dynamic DNS servers, which are frequently leveraged for command and control by all types of attackers.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "DynDNS - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "DynDNS - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "DynDNS - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an collection of outbound network communications, and a lookup of common command and control servers. For this analysis, we are pulling the outbound proxy requests (though you could also use DNS requests), using URL Toolbox to extract just the domain name, and then looking it up in the file pulled from Malware-Domains.</p>",
            "highlight": "No",
            "howToImplement": "<p>The first step in implementing this detection is to acquire a list of dyndns providers. During our research for this use case, Malware-Domains* seemed to provide a comprehensive list, but there are other lists discoverable from Google*. Once you download a list, you will need to format it to fit the Splunk lookup format:</p><ol><li>First, download the file. If you are using Malware-Domains, you can find it here: <a href=\"http://www.malware-domains.com/files/dynamic_dns.zip\">Malware-Domains Download</a></li><li>Second, clean it and put it into the proper location:<ul><li>Windows <p>In notepad, use Find and Replace to change each sequence of \"#from...\" to \",true\" so that they all say things like chickenkiller.com,true. Add the line \"domain,inlist\" at the top of the file.</p></li><li>Linux / OSX:<pre>echo \"domain,inlist\" > $SPLUNK_HOME/etc/apps/Splunk_Security_Essentials/lookups/dynamic_dns_lookup.csv && cat dynamic_dns.txt | grep -v \"^#\" | egrep -v \"^\\s*$\" | sed 's/[^a-zA-Z]*#.*/,true/' >> $SPLUNK_HOME/etc/apps/Splunk_Security_Essentials/lookups/dynamic_dns_lookup.csv</pre></li><ul></li></ol><p>Once you have the file in place, the rest should move on smoothly!</p><p class=\"disclaimer\">* Information regarding third-party sites are provided solely as a convenience to Splunk customers, but Splunk neither controls nor endorses, nor is Splunk responsible for, such sites or any content therein.  Customer\u2019s use of the sites is at customer\u2019s own risk and may be subject to additional terms, conditions and policies applicable to such sites (such as license terms, terms of service or privacy policies of the providers of the sites).</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Energy|Chemical|Aerospace|Healthcare|Education|Legal|Finance|Construction|Media|Transportation|Defense",
            "journey": "Stage_1",
            "killchain": "Command and Control",
            "knownFP": "Production services that use dynamic DNS, while rare, do happen. Those will cause some base level of false positives, though they should never be business-critical services. The most common scenario for dynamic DNS is for users reaching out to their homes to see their dogs via webcam, or etc. Whether to allow tune out these users (most common) or prohibit that activity is ultimately a policy decision.",
            "mitre": "Command and Control",
            "mitre_notes": "",
            "mitre_sub_technique": "T1568.002",
            "mitre_tactic": "TA0011",
            "mitre_technique": "T1568.002|T1071",
            "name": "Basic Dynamic DNS Detection",
            "operationalize": "<p>When this alert fires, look for the common allowable scenarios, particularly that of users who are accessing their home networks (see Known False Positives). If that does not seem to be the case, consult data from Splunk Stream or from your packet capture to determine what type of data was sent, and review the dns name and IP in open source intelligence to see if there is anything of note (though that is often hard for this scenario). If this is a critical host, consider endpoint logging via Microsoft Sysmon that will indicate the process that is creating these connections, or other endpoint response mechanisms.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_threat_hunting",
                "phantom_prompt_and_block_domain"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sse_dyndns.png",
            "released": "2.2.0",
            "relevance": "<p>Attackers desire flexibility in their command and control capabilities (along with other parts of their infrastructure), and dynamic DNS can provide that flexibility. While there are legitimate uses of dynamic DNS (many IT professionals use it to access home networks), the risks of not monitoring the practice can be significant. Fortunately, between Splunk and a list provided by Malware Domains, finding dynamic DNS in your environment is easy.</p>",
            "searchKeywords": "dyndns ddns",
            "usecase": "Security Monitoring|Advanced Threat Detection"
        },
        "sse_hostnotincmdb": {
            "SPLEase": "Basic",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Best Practices|Compliance|Shadow IT",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Hosts Not in CMDB - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "<p>Find internal addresses that aren't in your Asset database.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Hosts Not in CMDB - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "Accelerated Data",
                    "name": "Hosts Not in CMDB - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of network traffic logs. For this analysis, we are aggregating by source_ip, and then looking it up in an asset database to determine the owner of each asset. When we don't have a match in the asset database, that is cause for an alert..</p>",
            "highlight": "No",
            "howToImplement": "<p>Accurate CMDB information is a life-long effort, and is the hard part of this query. Given the goal of this search, it probably makes the most sense to implement it in phases, starting with a production data center and then moving elsewhere. A primary goal here is to detect shadow IT, so it's often useful to augment this detection with DHCP data (either as a lookup, combined | stats, or even as a different dashboard panel or adaptive response action) to weed out authorized devices being plugged into unusual locations.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "Because of invariably incomplete CMDB data and the challenges with DHCP scopes, this search will likely produce a large volume of noise. It's use is only recommended in very clean environments, such as companies that believe they've conquered the CMDB challenge or in particular enclaves where shadow IT is a risk and there is relatively minimal change.",
            "mitre": "",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1200",
            "name": "RFC1918 IP Not in CMDB",
            "operationalize": "<p>When this alert fires, leverage DHCP to determine what device is plugged in, to see if there is any record of it. Work with the network team to track down the location of the device and determine whether it is allowable or not. If you have a large volume of these alerts, consider automating this process with a SOAR product like Splunk Phantom.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sse_hostnotincmdb.png",
            "released": "2.2.0",
            "relevance": "<p>In many organizations, chaos reigns free, but if you have controlled the chaos they you may want to know when your rules are being broken. The key concern here for most organizations is Shadow IT where a user plugs in a switch or wireless AP for their own convenience, to the detriment of your security controls, though it may also catch a bold physical security penetration tester (or a reckless digital intruder). When a new Source IP shows up that isn't a part of any address ranges or known hosts in the CMDB, this can indicate trouble.</p>",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "sser_detect_journal_clearing": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Deleting USN Journal Log - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>This use case looks for the fsutil process clearing the update sequence number (USN) change journal.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Deleting USN Journal Log - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Deleting USN Journal Log - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case looks for the fsutil process clearing the update sequence number (USN) change journal.",
            "highlight": "No",
            "howToImplement": "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "None at the moment",
            "mitre": "Defense Evasion",
            "mitre_sub_technique": "T1070.001",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1070",
            "name": "Detect Journal Clearing",
            "operationalize": "When this search fires, you will want to start your incident response process for dealing with a ransomware infection. You should verify with the system owner if this was an action taken on their part. You will want to investigate the parent process of fsutil and its activities as well.",
            "released": "1.1.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_fsutil_deleting_journals"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "sser_detect_lateral_movement_with_wmi": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Detecting WMI Remote Process Creation - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>This use case looks for WMI being used for lateral movement.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Detecting WMI Remote Process Creation - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Detecting WMI Remote Process Creation - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case looks for WMI being used for lateral movement.",
            "highlight": "No",
            "howToImplement": "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "knownFP": "None at the moment",
            "mitre": "Lateral Movement|Execution",
            "mitre_tactic": "TA0008|TA0002",
            "mitre_technique": "|T1021|T1047",
            "name": "Detect Lateral Movement With WMI",
            "operationalize": "When this search fires, you will want to start your incident response process and investigate the actions taken by this process.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "released": "1.1.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_remote_wmi_process_instantiation"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "sser_detect_log_clearing_with_wevtutil": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Log Clearing With wevtutil - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>This use case looks for the wevutil process clearing the Windows Audit Logs</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Log Clearing With wevtutil - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Log Clearing With wevtutil - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case looks for the wevutil process clearing the Windows Audit Logs",
            "highlight": "No",
            "howToImplement": "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "None at the moment",
            "mitre": "Defense Evasion",
            "mitre_sub_technique": "T1070.001",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1070",
            "name": "Detect Log Clearing With wevtutil",
            "operationalize": "When this search fires, you will want to verify with the owner of the account responsible for clearing the Windows Logs that it was a legitimate action taken on their part.",
            "released": "1.1.0",
            "searchKeywords": "",
            "similarUseCases": [
                "sser_windows_event_log_clearing_events",
                "detection_suspicious_wevtutil_usage",
                "detection_windows_event_log_cleared"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "sser_fake_windows_processes": {
            "SPLEase": "Medium",
            "advancedtags": "Autobahn",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Fake Windows Processes - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>This example finds processes normally run from Windows\\System32 or Windows\\SysWOW64, running from some other location. This can indicate a malicious process trying to hide as a legitimate process.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Fake Windows Processes - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Fake Windows Processes - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case looks for system processes that normally run out of Windows\\System32 or Windows\\SysWOW64, but are running from some other location. This can indicate a malicious process that is trying to hide as a legitimate process. Ransomware often spawns processes that use a legitimate process name as a disguise.",
            "highlight": "Yes",
            "howToImplement": "This use case requires one of two options. Option one consists of having Sysmon installed on the endpoints you wish to monitor and the Sysmon add-on installed on both the Splunk forwarders and search heads. Or option two, to have your AD Administrator turn on Process Tracking in your Windows Audit logs (<a href=\"https://technet.microsoft.com/en-us/library/cc976411.aspx\" class=\"external\">docs</a>).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "knownFP": "None at the moment",
            "mitre": "Defense Evasion",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1036",
            "name": "Fake Windows Processes",
            "operationalize": "When this search fires, you will want to start your incident response process and investigate the actions taken by this process.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_threat_hunting"
            ],
            "relatedUseCases": [
                "detection_registry_persistence",
                "detection_malicious_powershell_process_obfuscation_techniques",
                "suspicious_network_exploration"
            ],
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "sser_malicious_command_line_executions": {
            "SPLEase": "Basic",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Command line length statistical analysis - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Ransomware and other malware variants often execute long commands using command line arguments. This search performs statistical analysis of these CLI arguments to detect potentially malicious executions.</p><p><b>Alert Volume:</b> Medium</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Command line length statistical analysis - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Command line length statistical analysis - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "Ransomware and other malware variants often execute long commands using command line arguments. This search performs statistical analysis of these CLI arguments to detect potentially malicious executions.",
            "highlight": "No",
            "howToImplement": "In order to run this search you need to index Sysmon data from your Windows endpoints. However, you can modify the search o use data from other sources that capture command lines, such as endpoint products like Carbon Black, or Windows process creation events. Process creation events are not enabled by default, but can be enabled via GPO.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "knownFP": "None at the moment",
            "mitre": "Execution|Defense Evasion",
            "mitre_sub_technique": "T1059.001|T1059.003",
            "mitre_tactic": "TA0002|TA0005",
            "mitre_technique": "|T1059|T1064",
            "name": "Malicious Command Line Executions",
            "operationalize": "When this search fires, you want to validate that the process and the command line are legitimate. You should begin a standard incident response process by validating the process is legitimate and the command-line options for the process are also legitimate.  You should investigate what actions were taking by this process and verify any action taken by the process.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "sser_monitor_autorun_registry_keys": {
            "SPLEase": "Basic",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Suspicious Windows Registry activity - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "<p>Attackers often add malware to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa376977(v=vs.85).aspx\">Windows Autorun</a> registry keys to maintain persistence. This search looks through registry data for suspicious activities.</p><p><b>Alert Volume:</b> High</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Suspicious Windows Registry activity - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Suspicious Windows Registry activity - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "Often, attackers add malware to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa376977(v=vs.85).aspx\">Windows Autorun</a> registry keys. This allows the malware to execute after a restart of the computer, which enables it to persist across reboots, and potentially delays the execution of the code until after a reboot to make its activities harder to detect. While legitimate applications also write to these keys, it is a good idea to monitor them and investigate anything that appears suspicious.",
            "highlight": "No",
            "howToImplement": "This use case requires a universal forwarder on the Windows endpoints you wish to monitor as well as the Windows add-on configured to send your logs to Splunk. Alternatively, data from endpoint solutions such as Carbon Black can also report registry modifications for this use case.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation",
            "knownFP": "None at the moment",
            "mitre": "Persistence",
            "mitre_sub_technique": "T1547.001",
            "mitre_tactic": "TA0003",
            "mitre_technique": "|T1547",
            "name": "Monitor AutoRun Registry Keys",
            "operationalize": "When this search fires, you will want to start your incident response process for dealing and verify the activities of the process that wrote the registry key.",
            "released": "1.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_registry_persistence"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "sser_monitor_successful_backups": {
            "SPLEase": "Basic",
            "alertvolume": "Very High",
            "app": "Splunk_Security_Essentials",
            "category": "Operations|GDPR|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Successful Backups - Demo",
            "data_source_categories": "DS027EndpointBackup-ET01General",
            "deprecated_not_used_anymore_datasource": "Backup",
            "description": "<p>With good backups, a ransomware attack goes from unrecoverable losses to a manageable nuisance. This shows how you can track successful backups.</p><p><b>Alert Volume:</b> Very High</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Operations",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Successful Backups - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Successful Backups - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "With sufficient backups that are maintained outside the local network, ransomware goes from unrecoverable losses to a manageable nuisance that consumes time. Organizations must track their back-up posture as a part of their overall corporate data availability and resiliency plan. This means knowing that routine backups are taking place and notifying the appropriate personnel when they are not. This use case helps Splunk users manage and verify that data resiliency processes are being conducted, specifically looking for indications of successful backups.",
            "highlight": "No",
            "howToImplement": "Because there are so many different strategies for backups and data resiliency, this search is provided as an example. In order to implement this, you need to obtain data from the backup logs on your endpoints, or from a central server responsible for performing the backups. In this case, we used netbackup as an example. Feel free to modify this search according to your backup solution and strategy.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "knownFP": "None at the moment",
            "mitre": "",
            "mitre_notes": "Cyber hygiene monitoring",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Monitor Successful Backups",
            "operationalize": "This search will let you know when one of your systems has been backed up. It will help you understand your environment and how often systems are backed up. You can use this knowledge in your risk assessment for your environment.",
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "sser_monitor_successful_windows_updates": {
            "SPLEase": "Basic",
            "alertvolume": "Very High",
            "app": "Splunk_Security_Essentials",
            "category": "Operations|GDPR|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Windows Successful Updates Install - Demo",
            "data_source_categories": "DS019PatchManagement-Applied",
            "deprecated_not_used_anymore_datasource": "Patch Management",
            "description": "<p>Malware often uses operating system vulnerabilities to infect an endpoint or to spread. This example verifies the Windows updates for specific vulnerabilities exploited by the WannaCry ransomware.</p><p><b>Alert Volume:</b> Very High</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Operations",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Windows Successful Updates Install - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Windows Successful Updates Install - Live"
                }
            ],
            "gdprtext": "<h4>Problem:</h4><p>Similar to \u201cHigh Number of Hosts Not Updating Malware Signatures,\u201d \u201cDetection of Uncleaned Malware on Endpoint,\u201d and \u201cIn-Scope Device with Outdated Anti-Malware Found\u201d, infections can occur or persist if the operating system is not updating with the latest security patches. Even a single host with outdated patch level can indicate a potential infection. </p><p>If that host is tagged under the GDPR category, then immediate remediation is required to address that non-compliant condition.</p><h4>Impact:</h4><p>Unpatched systems are at higher risk of infection than unpatched. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58) -- therefore, showcase that patching was properly managed and continuously monitored becomes an important capability. If the organization faces a personal data breach and individuals are impacted, those individuals affected have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><p>Resolution Path: Generally speaking, it is critical to keep all systems up to date. </p><p>Specific to GDPR, the data mapping exercise from the DPO can inform which systems are in-scope -- that is, those systems that are associated with the GDPR category. From there, identify the in-scope systems needing updates, pinpoint the root issue for updates not occurring, and remediate those hosts by configuring them or the environment appropriately, depending on what the root issue turns out to be. </p>",
            "hasSearch": "Yes",
            "help": "Ransomware often leverages operating system vulnerabilities to infect an endpoint or to spread to other systems. This use case verifies that Windows updates for specific vulnerabilities exploited by the WannaCry ransomware are installed correctly on your Windows endpoints.",
            "highlight": "No",
            "howToImplement": "This use case requires a universal forwarder on the Windows endpoints you wish to monitor as well as the Windows add-on configured to send your logs to Splunk. You can also implement this use case using Windows event logs.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "knownFP": "None at the moment",
            "mitre": "",
            "mitre_notes": "Cyber hygiene monitoring",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Monitor Successful Windows Updates",
            "operationalize": "This search will let you know when one of your systems has had an update successfully applied. It will help you understand how long it takes from when a patch is available to when it is applied in your environment.",
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "sser_monitor_unsuccessful_backups": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Operations|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Unsuccessful Backups - Demo",
            "data_source_categories": "DS027EndpointBackup-ET01General",
            "deprecated_not_used_anymore_datasource": "Backup",
            "description": "<p>With good backups, a ransomware attack goes from unrecoverable losses to a manageable nuisance. This shows how you can analyze failed backups.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Operations",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Unsuccessful Backups - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Unsuccessful Backups - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "When you maintain sufficient backups outside your local network, you reduce the impact of a ransomware attack from unrecoverable losses to a manageable nuisance. Organizations must track their backup posture as a part of their overall corporate data availability and resiliency plan. This means knowing that routine backups are taking place and notifying the appropriate personnel when they are not. This use case helps Splunk customers manage and verify that data resiliency processes are running, specifically looking for indications of failed backups.",
            "highlight": "No",
            "howToImplement": "Because there are so many different strategies for backups and data resiliency, this search is provided primarily as an example. In order to implement this use case, you need to index data from the backup logs on your endpoints, or from a central server responsible for performing the backups. In this case, we used netbackup as an example. You can modify this search according to your specific backup solution and strategy.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "knownFP": "None at the moment",
            "mitre": "",
            "mitre_notes": "Cyber hygiene monitoring",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Monitor Unsuccessful Backups",
            "operationalize": "When this search fires, you will to investigate why backups from these hosts have been failing.",
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "sser_monitor_unsuccessful_windows_updates": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Operations|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Windows Updates Install Failure - Demo",
            "data_source_categories": "DS019PatchManagement-Failed",
            "deprecated_not_used_anymore_datasource": "Patch Management",
            "description": "<p>Keeping current with Microsoft updates for Windows is one of the best ways to prevent malware. This example identifies hosts that have failed to implement appropriate updates.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Operations",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Windows Updates Install Failure - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Windows Updates Install Failure - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "Keeping current with Microsoft updates for Windows is one of the best ways to prevent WannaCry and other ransomware attacks. This use case evaluates Windows event logs and Windows update logs to identify hosts that have failed to implement the appropriate updates.",
            "highlight": "No",
            "howToImplement": "This use case requires a universal forwarder on the Windows endpoints you wish to monitor as well as the Windows add-on configured to send your logs to Splunk. You can also implement this use case using Windows event logs.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "knownFP": "None at the moment",
            "mitre": "",
            "mitre_notes": "Cyber hygiene monitoring",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Monitor Unsuccessful Windows Updates",
            "operationalize": "When this search files, you'll want to investigate why the update was not successfully applied to the system.",
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "sser_ransomware_extensions": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Ransomware Extensions - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>This example queries your endpoint data to find encrypted files that ransomware will create. You can often even use these extensions to identify the ransomware affecting a given endpoint.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Ransomware Extensions - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Ransomware Extensions - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case is designed to query your endpoint data to look for encrypted files that ransomware creates. Most ransomware families use a consistent extension for the encrypted files they generate, so you can use those extensions to identify the ransomware affecting a given endpoint.",
            "highlight": "No",
            "howToImplement": "This search requires Sysmon to be installed on your endpoints with the Sysmon add-on installed on your forwarders and search heads. Common ransomware extensions and the associated ransomware families are located in the ransomware_extensions.csv lookup file. You can update this list to reflect the latest intelligence without the need to modify the search.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "None at the moment",
            "mitre": "Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "|T1204",
            "name": "Ransomware Extensions",
            "operationalize": "When this search fires, you will want to start your incident response process for dealing with a ransomware infection.  You should check for recent backups for the systems effected by the infection.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ransomware_investigate_contain"
            ],
            "released": "1.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_common_ransomware_extensions"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "sser_ransomware_note_files": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Ransomware Notes - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response|Vendor-Specific Data",
            "description": "<p>Most ransomware leaves a note on the endpoint containing directions for the victim to pay a ransom. This use case looks for these note files.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Ransomware Notes - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Ransomware Notes - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "Most ransomware leaves a note on the endpoint containing directions for the victim to pay a ransom. This use case looks for these note files.",
            "highlight": "No",
            "howToImplement": "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads. The search uses the ransomware_notes.csv lookup file, which contains the names of common ransomware note files.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "None at the moment",
            "mitre": "Execution",
            "mitre_tactic": "TA0002",
            "mitre_technique": "|T1204",
            "name": "Ransomware Note Files",
            "operationalize": "When this search fires, you will want to start your incident response process for dealing with a ransomware infection.  You should check for recent backups for the systems effected by the infection.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ransomware_investigate_contain"
            ],
            "released": "1.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_common_ransomware_notes"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "sser_ransomware_vulnerabilities": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Vulnerability|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Vulnerabilities Exploited by Ransomwares - Demo",
            "data_source_categories": "DS018VulnerabilityDetection-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Vulnerability Detection",
            "description": "<p>This use case queries your Vulnerability Management logs from solutions like Nessus in order to identify the hosts in your environment that might be vulnerable to ransomware.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Vulnerabilities Exploited by Ransomwares - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Vulnerabilities Exploited by Ransomwares - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case queries your Vulnerability Management logs from solutions like Nessus in order to identify the hosts in your environment that might be vulnerable to ransomware.",
            "highlight": "No",
            "howToImplement": "Index data from your vulnerability management system to search for or alert on systems with vulnerabilities that ransomware families often exploit. In this example, we use Nessus data with the Splunk Add-on for Tenable.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "None at the moment",
            "mitre": "Privilege Escalation|Lateral Movement",
            "mitre_notes": "Cyber hygiene monitoring",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Ransomware Vulnerabilities",
            "operationalize": "When this search fires, you will want to verify that the patches for these vulnerabilities have not been applied yet.  If they have not been applied, then you should start your update process to remove these vulnerabilities from your environment.",
            "relatedUseCases": [
                ""
            ],
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "sser_smb_traffic_allowed": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Operations|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Detect SMB Traffic Allowed - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "<p>This use case looks for any SMB traffic allowed through your firewall.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Detect SMB Traffic Allowed - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Detect SMB Traffic Allowed - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Detect SMB Traffic Allowed - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case looks for any SMB traffic allowed through your firewall.",
            "highlight": "No",
            "howToImplement": "To run this search, you need data from firewalls or other access control devices that mediate what traffic is allowed into your environment. This is necessary so that the search can identify an 'action' taken on the traffic of interest.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Reconnaissance|Delivery",
            "knownFP": "This search does not filter for outgoing traffic, and assumes a firewall at the perimeter. You will need to exclude any company-owned subnets where you have firewall visibility, in order to remove false positives.",
            "mitre": "Execution|Lateral Movement",
            "mitre_sub_technique": "T1569.002|T1021.002",
            "mitre_tactic": "TA0002|TA0008",
            "mitre_technique": "|T1210|T1077|T1035",
            "name": "SMB Traffic Allowed",
            "operationalize": "When this search fires, you will to verify with your firewall block policy to see if SMB should be allowed through to your network. It is a best practice to not allow SMB from the Internet int your network.",
            "released": "1.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "sser_spike_in_smb_traffic": {
            "SPLEase": "Hard",
            "alertvolume": "Very Low",
            "app": "Splunk_Security_Essentials",
            "category": "Lateral Movement|Scanning|Ransomware",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Detect Spike in SMB Traffic - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "<p>This search looks for hosts with an unusually high increase in SMB network connections.</p><p><b>Alert Volume:</b> Very Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Detect Spike in SMB Traffic - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Detect Spike in SMB Traffic - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This search looks for hosts with an unusually high increase in SMB network connections.",
            "highlight": "No",
            "howToImplement": "To run this search, you must index data from sources that observe network traffic, such as Bro, Splunk Stream, or firewalls. You can then identify spikes in the number of SMB connection attempts.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Energy|Chemical|Aerospace|Healthcare|Education|Legal|Finance|Construction|Media|Transportation|Defense|Travel",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "No known false positives.",
            "mitre": "Discovery|Execution|Lateral Movement",
            "mitre_tactic": "TA0007|TA0008",
            "mitre_technique": "|T1135|T1105|T1021",
            "name": "Spike in SMB Traffic",
            "operationalize": "When this search fires, you will to start your incident response process to verify the activity of the system is legitimate.  You should investigate and determine the process that initiated this traffic and verify its activities.",
            "released": "1.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_smb_traffic_spike"
            ],
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "sser_tor_traffic": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Command and Control|Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Monitor TOR traffic - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01TrafficAppAware",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "<p>The anonymity of TOR makes it the perfect place to hide C&C, exfiltration, or ransomware payment via bitcoin. This example looks for ransomware activity based on FW logs.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Monitor TOR traffic - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Monitor TOR traffic - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Monitor TOR traffic - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "The anonymity of TOR makes it the perfect place for hackers who want to anonymize command and control or network connections. Many forms of ransomware install a TOR client to facilitate their payment via bitcoin. This use case analyzes your network traffic data to identify hosts that are generating TOR traffic within your environment.",
            "highlight": "Yes",
            "howToImplement": "This use case requires you to index data from a source that does protocol analysis to determine the type of network traffic being used, regardless of the port associated with the traffic. This data is often available from next-generation firewalls or other traffic analysis tools such as Splunk Stream or Bro.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Legal|Finance|Government|Energy|Chemical",
            "journey": "Stage_1",
            "killchain": "Command and Control",
            "knownFP": "None at the moment",
            "mitre": "Exfiltration|Command and Control",
            "mitre_sub_technique": "T1090.003",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "|T1041|T1048|T1071|T1095|T1188|T1090",
            "name": "Basic TOR Traffic Detection",
            "operationalize": "When this search fires, you will to verify with the system owner that the traffic generated was by them.  Verify with corporate policies if TOR is allowed in your environment.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ransomware_investigate_contain"
            ],
            "relatedUseCases": [
                "Large_Web_Upload",
                "showcase_huge_volume_dns_volume",
                "detection_long_dns_text_response"
            ],
            "released": "1.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_tor_traffic"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "sser_windows_event_log_clearing_events": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise|Ransomware",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Windows Event Log Clearing Events - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>This use case looks for Windows event codes that indicate the Windows Audit Logs were tampered with.</p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Windows Event Log Clearing Events - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Windows Event Log Clearing Events - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This use case looks for Windows event codes that indicate the Windows Audit Logs were tampered with.",
            "highlight": "Yes",
            "howToImplement": "To run this search, you need to be logging Windows event logs from your Windows Systems.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Government|Finance|Telecommunications|Technology|Healthcare",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "None at the moment",
            "mitre": "Defense Evasion",
            "mitre_sub_technique": "T1070.001",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1070",
            "name": "Windows Event Log Clearing Events",
            "operationalize": "When this search fires, you will want to verify with the owner of the account responsible for clearing the Windows Logs that it was a legitimate action taken on their part. You will want to analyze the parent process to wevtutil and verify its activities.",
            "relatedUseCases": [
                "showcase_new_local_admin_account",
                "UC0006"
            ],
            "released": "1.1.0",
            "searchKeywords": "",
            "similarUseCases": [
                "detection_suspicious_wevtutil_usage",
                "detection_windows_event_log_cleared",
                "sser_detect_log_clearing_with_wevtutil"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "stale_account_usage": {
            "SPLEase": "Medium",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|IAM Analytics|Account Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Stale Account Used - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "<p>Detect long-inactive accounts that suddenly become active.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Stale Account Used - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Stale Account Used - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Stale Account Used - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of authentication logs. For this analysis, we are creating a lookup with the historical record of the first and last recorded login time per user. When a user logs in on a day, but the last login we tracked was from months earlier, we create an alert.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Building this detection is relatively straightforward. The actual data source is authentication logs, and the search automatically populates that lookup with content. The only step you'll need to take is to create a lookup called account_status_tracker, and have authentication data in Common Information Model format (or by default we'll just use Windows logs as well).</p><p>There is on key business decision that you must make to implement this detection -- the definition of stale. Most commonly we hear about the desire to detect logins from accounts that are more than 90 days old, though some organizations will also look at 45 days. Generally speaking you want to target more than once per month, as some services or tasks will only run that often.</p><p>One good note is that this search will automatically store usernames in lowercase format, as lookups are case sensitive by default (adjustable via transforms.conf). If you have case sensitive usernames (e.g., jsmith and Jsmith are different users) then.. first, I'm sorry to hear how you suffer.. but you can remove the lowercase eval function.</p>",
            "icon": "Core_Use_Case.png",
            "implementationNotes_Internal": "create a lookup to cache, and automatically lowercase the username 'cause lookups are case sensitive. Also make sure we're filtering for successful authentications.",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Transportation|Energy|Travel",
            "journey": "Stage_2",
            "killchain": "Actions On Objectives",
            "knownFP": "<p>This search doesn't have false positives in the sense of accounts where the search would alert even though the account had recently been active. However, there can be scenarios where this alerts and it is not an account compromise or other malicious act. Particularly when this is a new detection for your organization, you may find accounts that are only active once every month, once every quarter, or even once per year (often associated with closing out the financial quarter / year). Beyond periodic accounts, the most likely scenario for a benign alert will be an employee who is on long term leave.</p>",
            "mitre": "Privilege Escalation|Credential Access|Lateral Movement",
            "mitre_tactic": "TA0004|TA0003|TA0001",
            "mitre_technique": "|T1078",
            "name": "Stale Account Usage",
            "operationalize": "<p>When this search fires, your first instinct should be to look for legitimate cause. See the Known False Positives for more detail. Whenever a service account becomes active suddenly, your best bet is to reach out to the service owners to determine whether they expected it while simultaneously looking to ensure that the systems where that account is active (and/or the actions being taken if you have that visibility) are what would be expected. For suspicious scenarios or high risk services you may also wish to look for employees who left under unfriendly scenarios, who might have left a backdoor. For users where this fires, it should be relatively straightforward to see whether they still work at the company and if they do not, reach out to their manager to determine if there was a reason the account remained (or consult any notes about their separation).</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/stale_account_usage.png",
            "released": "2.2.0",
            "relevance": "<p>There are two primary scenarios where the activation of a stale account can be a concern. The first, and usually the first to come to mind, is a former employee or contractor who wants to gather sensitive information or compromise systems. They may check to see if their old user account was accidentally left active, or if a service account that they managed did not have a password reset (or even if there were API keys they had access to that weren't terminated). The other, is that an adversary does a brute force to find some accounts laying around, often service accounts that aren't actively used and so no admin had the opportunity to think \"say, we probably shouldn't use admin / changeme on our production system.\" In either case, you likely want to know.</p>",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "substantial_increase_in_events": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Endpoint Compromise|Operations",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Alerts when a statistically significant increase in a particular event is observed.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "Not an attacker technique",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Substantial Increase In Events",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "substantial_increase_in_port_activity": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Data Exfiltration",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Alerts when a statistically significant increase in events on a given port is observed.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1065",
            "name": "Substantial Increase In Port Activity",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Substantial Increase in Port Activity (By Destination) - Rule",
            "usecase": "Insider Threat|Advanced Threat Detection"
        },
        "sunburst_correlation_dll_and_network_event": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=sunburst_correlation_dll_and_network_event",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": "",
            "date": "2020-12-14",
            "description": "The malware sunburst will load the malicious dll by SolarWinds.BusinessLayerHost.exe. After a period of 12-14 days, the malware will attempt to resolve a subdomain of avsvmcloud.com. This detections will correlate both events.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 6|CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This detection relies on sysmon logs with the Event ID 6, Driver loaded. Please tune your sysmon config that you DriverLoad event for SolarWinds.Orion.Core.BusinessLayer.dll is captured by Sysmon. Additionally, you need sysmon logs for Event ID 22, DNS Query. We suggest to run this detection at least once a day over the last 14 days.",
            "highlight": "No",
            "how_to_implement": "This detection relies on sysmon logs with the Event ID 6, Driver loaded. Please tune your sysmon config that you DriverLoad event for SolarWinds.Orion.Core.BusinessLayer.dll is captured by Sysmon. Additionally, you need sysmon logs for Event ID 22, DNS Query. We suggest to run this detection at least once a day over the last 14 days.",
            "icon": "ES_Use_Case.png",
            "id": "sunburst_correlation_dll_and_network_event",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "unknown",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "sunburst_correlation_dll_and_network_event_filter"
                }
            ],
            "mitre_sub_technique": "T1203",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1203",
            "mitre_threat_groups": "Sandworm Team|MuddyWater|Frankenstein|Inception|BlackTech|APT41|admin@338|Threat Group-3390|APT12|The White Company|APT33|APT32|APT28|Tropic Trooper|Lazarus Group|BRONZE BUTLER|Cobalt Group|APT37|Patchwork|Leviathan|Elderwood|TA459|APT29",
            "name": "Sunburst Correlation DLL And Network Event",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
            ],
            "released": "2020-12-14",
            "search": "(`sysmon` EventCode=7 ImageLoaded=*SolarWinds.Orion.Core.BusinessLayer.dll) OR (`sysmon` EventCode=22 QueryName=*avsvmcloud.com) | eventstats dc(EventCode) AS dc_events | where dc_events=2 | stats min(_time) as firstTime max(_time) as lastTime values(ImageLoaded) AS ImageLoaded values(QueryName) AS QueryName by host | rename host as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `sunburst_correlation_dll_and_network_event_filter` ",
            "search_name": "ESCU - Sunburst Correlation DLL and Network Event - Rule",
            "story": "758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Sunburst Malware"
                ],
                "asset_type": "Windows",
                "cis20": [
                    "CIS 6",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "MuddyWater",
                    "Frankenstein",
                    "Inception",
                    "BlackTech",
                    "APT41",
                    "admin@338",
                    "Threat Group-3390",
                    "APT12",
                    "The White Company",
                    "APT33",
                    "APT32",
                    "APT28",
                    "Tropic Trooper",
                    "Lazarus Group",
                    "BRONZE BUTLER",
                    "Cobalt Group",
                    "APT37",
                    "Patchwork",
                    "Leviathan",
                    "Elderwood",
                    "TA459",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1203"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Exploitation for Client Execution"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "suspicious_account_lockout": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for suspicious account lockouts that do not have any associations with password changes, password resets, password expiry within a specific time interval in and around the lockout period.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0006",
            "mitre_technique": "|T1110",
            "name": "Suspicious Account Lockout",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "suspicious_box_usage": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Threat Intelligence",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for combinations of actions performed by a Box user or against a Box resource that are suspicious.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0010|TA0005",
            "mitre_technique": "|T1011|T1102|TA0010",
            "name": "Suspicious Box Usage",
            "released": "2.2.0",
            "searchKeywords": "dropbox google drive",
            "usecase": "Advanced Threat Detection"
        },
        "suspicious_changes_to_file_associations": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Windows Registry Activities|Windows File Extension and Association Abuse",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=suspicious_changes_to_file_associations",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Registry",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This search looks for changes to registry values that control Windows file associations, executed by a process that is not typical for legitimate, routine changes to this area.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 8",
            "escu_nist": "DE.CM|PR.PT|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to be ingesting information on registry changes that include the name of the process responsible for the changes from your endpoints into the `Endpoint` datamodel in the `Processes` and `Registry` nodes.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to be ingesting information on registry changes that include the name of the process responsible for the changes from your endpoints into the `Endpoint` datamodel in the `Processes` and `Registry` nodes.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_changes_to_file_associations",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "There may be other processes in your environment that users may legitimately use to modify file associations. If this is the case and you are finding false positives, you can modify the search to add those processes as exceptions.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_changes_to_file_associations_filter"
                }
            ],
            "mitre_sub_technique": "T1546.001",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_tactic_display": "Privilege Escalation|Persistence",
            "mitre_technique": "T1546",
            "mitre_threat_groups": "Kimsuky",
            "name": "Suspicious Changes To File Associations",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process_name) as process_name values(Processes.parent_process_name) as parent_process_name FROM datamodel=Endpoint.Processes where Processes.process_name!=Explorer.exe AND Processes.process_name!=OpenWith.exe by Processes.process_id Processes.dest | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | join [| tstats `security_content_summariesonly` values(Registry.registry_path) as registry_path count  FROM datamodel=Endpoint.Registry where Registry.registry_path=*\\\\Explorer\\\\FileExts* by Registry.process_id Registry.dest | `drop_dm_object_name(\"Registry\")` | table process_id dest registry_path]| `suspicious_changes_to_file_associations_filter` ",
            "search_name": "ESCU - Suspicious Changes to File Associations - Rule",
            "story": "2b1800dd-92f9-47dd-a981-fdf1351e5d55|30552a76-ac78-48e4-b3c0-de4e34e9563d",
            "tags": {
                "analytics_story": [
                    "Suspicious Windows Registry Activities",
                    "Windows File Extension and Association Abuse"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Kimsuky"
                ],
                "mitre_attack_id": [
                    "T1546"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Change Default File Association"
                ],
                "nist": [
                    "DE.CM",
                    "PR.PT",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "suspicious_container_image_name": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=AWS%20Suspicious%20Container%20Image%20Name%20-%20Live",
            "data_source_categories": "VendorSpecific-gcp-gke-audit|VendorSpecific-aws-cloudwatch-eks|VendorSpecific-azure-aks-audit",
            "description": "<p>This search looks for image creation events in Kubernetes Audit logs and compares the image names against a known list of names that is likely to be suspicious. This technique is particularly useful for cryptomining attacks. </p><p><b>Alert Volume:</b> Low</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "AWS Suspicious Container Image Name - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "GCP Suspicious Container Image Name - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Azure Suspicious Container Image Name - Live"
                }
            ],
            "fullSolutionDisabled": "<div><p><img src=\"/static/app/Splunk_Security_Essentials/images/content_thumbnails/ES_Use_Case.png\" style=\"display:inline; float: right;\" />This use case is ultimately looking for specific filenames that we know are concerning. While here we have a limited list that we pull in via a lookup (a CSV file), Splunk Enterprise Seurity has a full threat intelligence framework that allows you to leverage both public and private threat intelligence sources and look for hosts that trigger on many different sources, all in an automatic way. In addition, many of the related capabilities that you will look for to operationalize the output of these alerts (such as a risk framework, a investigator workflow, and more) come with Enterprise Security.</p><p>Find out more about Splunk Enterprise Security <a href=\"https://www.splunk.com/en_us/products/premium-solutions/splunk-enterprise-security.html\" target=\"_blank\">on our website</a> or by <a href=\"https://www.splunk.com/en_us/about-us/contact.html\" target=\"_blank\">contacting your local Splunk team</a>.",
            "hasSearch": "Yes",
            "help": "<p>The basic idea behind this search is to take a set of container images names and cross reference them against a set of known bad keywords. </p><p>There are three phases to this search. <ul><li>First we run a search to find image creation events.</li><li>Then we match the image names with the list of keywords from a CSV file (also called a lookup).</li><li>Lastly, we filter the events on ones where we have a match against the lookup and we rename some of the files to make it easier to read. </li></ul>",
            "highlight": "Yes",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data. ",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "knownFP": "<p>This search should trigger very few false positives, because it's filtered to just very specific events. The keyword list uses wildcards so some of the matches might include benign words that contain bad words like \"coin\" or \"mining\". You can modify the lookup to get around this in your environment.  </p>",
            "mitre": "Discovery|Lateral Movement|Execution",
            "mitre_tactic": "TA0040",
            "mitre_technique": "T1496",
            "name": "Suspicious Container Image Name",
            "operationalize": "<p>This alert is very clearly tied to a known threat, so when it fires your concern is that this represents an attacker inside of one of your systems. Recommended steps are to begin incident response on the host where this alert fired from, to look for signs of other suspicious activities. The first step in that process will be to look for other events that involve the same IP or user name, and see what other activities the attacker might have done. That should guide you to the underlying problem. </p>",
            "relatedUseCases": [
                "detection_kubernetes_aws_scan_fingerprint",
                "detection_kubernetes_pods_aws_scan_fingerprint",
                "detection_kubernetes_gcp_scan_fingerprint_attack"
            ],
            "released": "3.2.0",
            "relevance": "Kubernetes and containers are becoming more and more common and we are seeing more attacks and exploits targetting this platform. Reference scenarios include these <a target=\"_blank\" href=\"https://azure.microsoft.com/en-us/blog/detect-largescale-cryptocurrency-mining-attack-against-kubernetes-clusters/\">Azure Security Center detected a new crypto mining campaign that targets Kubernetes environments</a> and <a target=\"_blank\" href=\"https://azure.microsoft.com/en-us/blog/azure-security-center-exposes-crypto-miner-campaign/\">Azure Security Center exposes crypto miner campaign</a>",
            "searchKeywords": "kubernetes|k8s|docker|container",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "suspicious_data_movement": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Endpoint Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Analyzes different types of data transfers per device and per account, both LAN and WAN, to identify unusual data movements. For example, the model monitors both inter firewall-zones LAN transfers and transfers to different countries and marks transfers that deviate from baseline.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0008|TA0009|TA0010",
            "mitre_technique": "|T1105|T1213|T1039|T1041|T1048",
            "name": "Suspicious Data Movement",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "suspicious_domain_communication": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Detects covert and malicious communication patterns in network traffic.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1071|T1095",
            "name": "Suspicious Domain Communication",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "suspicious_domain_name": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS002DNS-ET01QueryRequest|DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "DNS|Web Proxy",
            "description": "Detects algorithmically generated domain names using a machine learning model.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0021",
            "mitre_technique": "|T1323",
            "name": "Suspicious Domain Name",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "suspicious_email_-_uba_anomaly": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Emails",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=suspicious_email_-_uba_anomaly",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "UEBA",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This detection looks for emails that are suspicious because of their sender, domain rareness, or behavior differences. This is an anomaly generated by Splunk User Behavior Analytics (UBA).",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data from email logs and have Splunk integrated with UBA. This anomaly is raised by a UBA detection model called  \"SuspiciousEmailDetectionModel.\" Ensure that this model is enabled on your UBA instance.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data from email logs and have Splunk integrated with UBA. This anomaly is raised by a UBA detection model called  \"SuspiciousEmailDetectionModel.\" Ensure that this model is enabled on your UBA instance.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_email_-_uba_anomaly",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "known_false_positives": "This detection model will alert on any sender domain that is seen for the first time. This could be a potential false positive. The next step is to investigate and whitelist the URL if you determine that it is a legitimate sender.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_email___uba_anomaly_filter"
                }
            ],
            "mitre_sub_technique": "T1566",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1566",
            "mitre_threat_groups": "no",
            "name": "Suspicious Email - UBA Anomaly",
            "references": "",
            "released": "2020-07-22",
            "search": "|tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(All_UEBA_Events.category) as category from datamodel=UEBA where nodename=All_UEBA_Events.UEBA_Anomalies All_UEBA_Events.UEBA_Anomalies.uba_model = \"SuspiciousEmailDetectionModel\" by All_UEBA_Events.description All_UEBA_Events.severity All_UEBA_Events.user All_UEBA_Events.uba_event_type All_UEBA_Events.link All_UEBA_Events.signature All_UEBA_Events.url All_UEBA_Events.UEBA_Anomalies.uba_model | `drop_dm_object_name(All_UEBA_Events)` | `drop_dm_object_name(UEBA_Anomalies)`| `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `suspicious_email___uba_anomaly_filter`",
            "search_name": "ESCU - Suspicious Email - UBA Anomaly - Rule",
            "story": "2b1800dd-92f9-47ec-a981-fdf1351e5d55",
            "tags": {
                "analytics_story": [
                    "Suspicious Emails"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1566"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Phishing"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "suspicious_email_attachment_extensions": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Emotet Malware  DHS Report TA18-201A |Suspicious Emails",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=suspicious_email_attachment_extensions",
            "data_source_categories": "DS001MAIL-ET03Send|DS001MAIL-ET02Receive",
            "datamodel": "Email",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This search looks for emails that have attachments with suspicious file extensions.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 7|CIS 12",
            "escu_nist": "DE.AE|PR.IP",
            "hasSearch": "Yes",
            "help": "You need to ingest data from emails. Specifically, the sender's address and the file names of any attachments must be mapped to the Email data model. \\\n **Splunk Phantom Playbook Integration**\\\nIf Splunk Phantom is also configured in your environment, a Playbook called \"Suspicious Email Attachment Investigate and Delete\" can be configured to run when any results are found by this detection search. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, and add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search. The notable event will be sent to Phantom and the playbook will gather further information about the file attachment and its network behaviors. If Phantom finds malicious behavior and an analyst approves of the results, the email will be deleted from the user's inbox.",
            "highlight": "No",
            "how_to_implement": "You need to ingest data from emails. Specifically, the sender's address and the file names of any attachments must be mapped to the Email data model. \\\n **Splunk Phantom Playbook Integration**\\\nIf Splunk Phantom is also configured in your environment, a Playbook called \"Suspicious Email Attachment Investigate and Delete\" can be configured to run when any results are found by this detection search. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, and add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search. The notable event will be sent to Phantom and the playbook will gather further information about the file attachment and its network behaviors. If Phantom finds malicious behavior and an analyst approves of the results, the email will be deleted from the user's inbox.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_email_attachment_extensions",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "lookup update=true is_suspicious_file_extension_lookup file_name OUTPUT suspicious | search suspicious=true",
                    "description": "This macro limits the output to email attachments that have suspicious extensions",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/is_suspicious_file_extension_lookup.csv",
                            "description": "A list of suspicious extensions for email attachments",
                            "filename": "is_suspicious_file_extension_lookup.csv",
                            "match_type": "WILDCARD(file_name)",
                            "name": "is_suspicious_file_extension_lookup"
                        }
                    ],
                    "name": "suspicious_email_attachments"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_email_attachment_extensions_filter"
                }
            ],
            "mitre_sub_technique": "T1566.001",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1566",
            "mitre_threat_groups": "Magic Hound|Windshift|APT33|Sandworm Team|Naikon|Gamaredon Group|Sharpshooter|Molerats|Mofang|Wizard Spider|RTM|Frankenstein|Inception|BlackTech|APT-C-36|APT41|Machete|admin@338|Kimsuky|APT12|TA505|Silence|The White Company|APT39|FIN4|Darkhotel|Gallmaker|Tropic Trooper|Turla|Gorgon Group|Rancor|DarkHydrus|Cobalt Group|FIN7|OilRig|Lazarus Group|APT19|Dragonfly 2.0|BRONZE BUTLER|APT32|FIN8|MuddyWater|APT28|TA459|Leviathan|Patchwork|PLATINUM|Elderwood|APT29|APT37|menuPass",
            "name": "Suspicious Email Attachment Extensions",
            "references": "",
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Email where All_Email.file_name=\"*\" by All_Email.src_user, All_Email.file_name All_Email.message_id | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(\"All_Email\")` | `suspicious_email_attachments` | `suspicious_email_attachment_extensions_filter` ",
            "search_name": "ESCU - Suspicious Email Attachment Extensions - Rule",
            "story": "bb9f5ed2-916e-4364-bb6d-91c310efcf52|2b1800dd-92f9-47ec-a981-fdf1351e5d55",
            "tags": {
                "analytics_story": [
                    "Emotet Malware  DHS Report TA18-201A ",
                    "Suspicious Emails"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 7",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "Magic Hound",
                    "Windshift",
                    "APT33",
                    "Sandworm Team",
                    "Naikon",
                    "Gamaredon Group",
                    "Sharpshooter",
                    "Molerats",
                    "Mofang",
                    "Wizard Spider",
                    "RTM",
                    "Frankenstein",
                    "Inception",
                    "BlackTech",
                    "APT-C-36",
                    "APT41",
                    "Machete",
                    "admin@338",
                    "Kimsuky",
                    "APT12",
                    "TA505",
                    "Silence",
                    "The White Company",
                    "APT39",
                    "FIN4",
                    "Darkhotel",
                    "Gallmaker",
                    "Tropic Trooper",
                    "Turla",
                    "Gorgon Group",
                    "Rancor",
                    "DarkHydrus",
                    "Cobalt Group",
                    "FIN7",
                    "OilRig",
                    "Lazarus Group",
                    "APT19",
                    "Dragonfly 2.0",
                    "BRONZE BUTLER",
                    "APT32",
                    "FIN8",
                    "MuddyWater",
                    "APT28",
                    "TA459",
                    "Leviathan",
                    "Patchwork",
                    "PLATINUM",
                    "Elderwood",
                    "APT29",
                    "APT37",
                    "menuPass"
                ],
                "mitre_attack_id": [
                    "T1566"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Spearphishing Attachment"
                ],
                "nist": [
                    "DE.AE",
                    "PR.IP"
                ],
                "security_domain": "network"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "suspicious_file_write": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Hidden Cobra Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Malware",
            "dashboard": "showcase_security_content?showcaseId=suspicious_file_write",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": "",
            "date": "2019-04-25",
            "description": "The search looks for files created with names that have been linked to malicious activity.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file system reads and writes. In addition, this search leverages an included lookup file that contains the names of the files to watch for, as well as a note to communicate why that file name is being monitored. This lookup file can be edited to add or remove file the file names you want to monitor.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the filesystem activity from your hosts to populate the Endpoint file-system data model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or via other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file system reads and writes. In addition, this search leverages an included lookup file that contains the names of the files to watch for, as well as a note to communicate why that file name is being monitored. This lookup file can be edited to add or remove file the file names you want to monitor.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_file_write",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It's possible for a legitimate file to be created with the same name as one noted in the lookup file. Filenames listed in the lookup file should be unique enough that collisions are rare. Looking at the location of the file and the process responsible for the activity can help determine whether or not the activity is legitimate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "lookup suspicious_writes_lookup file as file_name OUTPUT note as \"Reference\" | search \"Reference\" != False",
                    "description": "This macro limites the output to file names that have been marked as suspicious",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/suspicious_files.csv",
                            "default_match": "false",
                            "description": "A list of suspicious file names",
                            "filename": "suspicious_files.csv",
                            "match_type": "WILDCARD(file)",
                            "min_matches": 1,
                            "name": "suspicious_writes_lookup"
                        }
                    ],
                    "name": "suspicious_writes"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_file_write_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Suspicious File Write",
            "references": [],
            "released": "2019-04-25",
            "search": "| tstats `security_content_summariesonly` count values(Filesystem.action) as action values(Filesystem.file_path) as file_path min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem by Filesystem.file_name Filesystem.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(Filesystem)` | `suspicious_writes` | `suspicious_file_write_filter`",
            "search_name": "ESCU - Suspicious File Write - Rule",
            "security_domain": "endpoint",
            "story": "baf7580b-d4b4-4774-8173-7d198e9da335",
            "tags": {
                "analytics_story": [
                    "Hidden Cobra Malware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "suspicious_http_redirects": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Detects sequences of HTTP requests within a short period of time that suggests infection has taken place.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0009",
            "mitre_technique": "|T1185",
            "name": "Suspicious HTTP redirects",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "suspicious_ip_address_communication": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Command and Control|Endpoint Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Suspicious IP Address Communication",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1094|T1071|T1095",
            "name": "Suspicious IP Address Communication",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "suspicious_java_classes": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Apache Struts Vulnerability",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Vulnerability|",
            "dashboard": "showcase_security_content?showcaseId=suspicious_java_classes",
            "data_source_categories": "DS014WebServer-ET01Access",
            "datamodel": "",
            "dataset": "",
            "date": "2018-12-06",
            "description": "This search looks for suspicious Java classes that are often used to exploit remote command execution in common Java frameworks, such as Apache Struts.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7|CIS 12",
            "escu_nist": "DE.AE",
            "hasSearch": "Yes",
            "help": "In order to properly run this search, Splunk needs to ingest data from your web-traffic appliances that serve or sit in the path of your Struts application servers. This can be accomplished by indexing data from a web proxy, or by using network traffic-analysis tools, such as Splunk Stream or Bro.",
            "highlight": "No",
            "how_to_implement": "In order to properly run this search, Splunk needs to ingest data from your web-traffic appliances that serve or sit in the path of your Struts application servers. This can be accomplished by indexing data from a web proxy, or by using network traffic-analysis tools, such as Splunk Stream or Bro.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_java_classes",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Exploitation",
            "known_false_positives": "There are no known false positives.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=stream:http",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "stream_http"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_java_classes_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Suspicious Java Classes",
            "references": [],
            "released": "2018-12-06",
            "search": "`stream_http` http_method=POST http_content_length>1 | regex form_data=\"(?i)java\\.lang\\.(?:runtime|processbuilder)\" | rename src_ip as src | stats count earliest(_time) as firstTime, latest(_time) as lastTime, values(url) as uri, values(status) as status, values(http_user_agent) as http_user_agent by src, dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `suspicious_java_classes_filter`",
            "search_name": "ESCU - Suspicious Java Classes - Rule",
            "security_domain": "threat",
            "story": "2dcfd6a2-e7d2-4873-b6ba-adaf819d2a1e",
            "tags": {
                "analytics_story": [
                    "Apache Struts Vulnerability"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 7",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.AE"
                ],
                "security_domain": "threat"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "suspicious_lnk_file_launching_a_process": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Phishing Payloads",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=suspicious_lnk_file_launching_a_process",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1566.002/lnk_file_temp_folder/windows-sysmon.log"
            ],
            "date": "2020-07-21",
            "description": "This search looks for a ``*.lnk` file under `C:\\User*` or `*\\Local\\Temp\\*` executing a process. This is common behavior used by various spear phishing tools.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 7|CIS 8",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records filesystem and process activity from your hosts to populate the Endpoint data model. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records filesystem and process activity from your hosts to populate the Endpoint data model. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or endpoint data sources, such as Sysmon.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_lnk_file_launching_a_process",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Installation|Actions On Objectives",
            "known_false_positives": "This detection should yield little or no false positive results. It is uncommon for LNK files to execute process from temporary or user directories.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_lnk_file_launching_a_process_filter"
                }
            ],
            "mitre_sub_technique": "T1566.002",
            "mitre_tactic": "TA0001",
            "mitre_tactic_display": "Initial Access",
            "mitre_technique": "T1566",
            "mitre_threat_groups": "Windshift|Molerats|Mofang|BlackTech|Machete|Kimsuky|TA505|Stolen Pencil|APT39|FIN4|APT32|Night Dragon|Turla|APT28|Cobalt Group|Dragonfly 2.0|OilRig|APT33|Elderwood|Leviathan|Magic Hound|Patchwork|APT29|FIN8",
            "name": "Suspicious Lnk File Launching A Process",
            "references": "",
            "released": "2020-07-21",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem where Filesystem.file_name=\"*.lnk\" AND Filesystem.file_path=\"C:\\\\Temp*\"  by _time span=1h Filesystem.process_id Filesystem.file_name Filesystem.file_path Filesystem.file_hash Filesystem.user | `drop_dm_object_name(Filesystem)` | rename process_id as lnk_pid | join lnk_pid, _time [| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where Processes.process_name=*  by _time span=1h Processes.parent_process_id Processes.process_id Processes.process_name Processes.dest Processes.process_path Processes.process | `drop_dm_object_name(Processes)` | rename parent_process_id as lnk_pid | fields _time lnk_pid process_id dest process_name process_path process] | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table firstTime, lastTime, lnk_pid, process_id, user, dest, file_name, file_path, process_name, process, process_path, file_hash | `suspicious_lnk_file_launching_a_process_filter` ",
            "search_name": "ESCU - Suspicious LNK file launching a process - Rule",
            "story": "57226b40-94f3-4ce5-b101-a75f67759c27",
            "tags": {
                "analytics_story": [
                    "Phishing Payloads"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 7",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1566.002/lnk_file_temp_folder/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Installation",
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Windshift",
                    "Molerats",
                    "Mofang",
                    "BlackTech",
                    "Machete",
                    "Kimsuky",
                    "TA505",
                    "Stolen Pencil",
                    "APT39",
                    "FIN4",
                    "APT32",
                    "Night Dragon",
                    "Turla",
                    "APT28",
                    "Cobalt Group",
                    "Dragonfly 2.0",
                    "OilRig",
                    "APT33",
                    "Elderwood",
                    "Leviathan",
                    "Magic Hound",
                    "Patchwork",
                    "APT29",
                    "FIN8"
                ],
                "mitre_attack_id": [
                    "T1566"
                ],
                "mitre_attack_tactics": [
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Spearphishing Link"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "network"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "suspicious_network_exploration": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects users systematically increasing the number of devices that they access over time.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1078",
            "name": "Suspicious Network Exploration",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "relatedUseCases": [
                "detection_registry_persistence",
                "sser_fake_windows_processes",
                "detection_malicious_powershell_process_obfuscation_techniques"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring"
        },
        "suspicious_powershell_activity": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Endpoint Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec-powershell",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects Powershell based attacks",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|T1086",
            "name": "Suspicious Powershell Activity",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "suspicious_privilege_escalation": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Endpoint Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects suspicious privilege escalation by correlating login and privilege escalation events.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0002",
            "mitre_technique": "|T1086",
            "name": "Suspicious Privilege Escalation",
            "released": "2.2.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "suspicious_reg_exe_process": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Defense Evasion Tactics|Disabling Security Tools|DHS Report TA18-074A",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=suspicious_reg_exe_process",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1112/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-22",
            "description": "This search looks for reg.exe being launched from a command prompt not started by the user. When a user launches cmd.exe, the parent process is usually explorer.exe. This search filters out those instances.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_reg_exe_process",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "It's possible for system administrators to write scripts that exhibit this behavior. If this is the case, the search will need to be modified to filter them out.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_reg_exe_process_filter"
                }
            ],
            "mitre_sub_technique": "T1112",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1112",
            "mitre_threat_groups": "Gamaredon Group|Blue Mockingbird|Wizard Spider|Silence|APT41|Turla|APT32|APT38|Dragonfly 2.0|APT19|Threat Group-3390|Honeybee|Patchwork|Gorgon Group|FIN8",
            "name": "Suspicious Reg Exe Process",
            "references": [
                "https://car.mitre.org/wiki/CAR-2013-03-001"
            ],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.parent_process_name != explorer.exe Processes.process_name =cmd.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest Processes.process_id Processes.parent_process_id | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search [| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where Processes.parent_process_name=cmd.exe Processes.process_name= reg.exe by Processes.parent_process_id Processes.dest Processes.process_name | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename parent_process_id as process_id |dedup process_id| table process_id dest] | `suspicious_reg_exe_process_filter` ",
            "search_name": "ESCU - Suspicious Reg exe Process - Rule",
            "story": "56e24a28-5003-4047-b2db-e8f3c4618064|fcc27099-46a0-46b0-a271-5c7dab56b6f1|0c016e5c-88be-4e2c-8c6c-c2b55b4fb4ef",
            "tags": {
                "analytics_story": [
                    "Windows Defense Evasion Tactics",
                    "Disabling Security Tools",
                    "DHS Report TA18-074A"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1112/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Turla",
                    "APT32",
                    "APT38",
                    "Dragonfly 2.0",
                    "APT19",
                    "Threat Group-3390",
                    "Honeybee",
                    "Patchwork",
                    "Gorgon Group",
                    "FIN8"
                ],
                "mitre_attack_id": [
                    "T1112"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Modify Registry"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "suspicious_wevtutil_usage": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Log Manipulation|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=suspicious_wevtutil_usage",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-22",
            "description": "The wevtutil.exe application is the windows event log utility. This searches for wevtutil.exe with parameters for clearing the application, security, setup, or system event logs.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 6",
            "escu_nist": "DE.DP|PR.IP|PR.PT|PR.AC|PR.AT|DE.AE",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_wevtutil_usage",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "The wevtutil.exe application is a legitimate Windows event log utility. Administrators may use it to manage Windows event logs.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_wevtutil_usage_filter"
                }
            ],
            "mitre_sub_technique": "T1070.001",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1070",
            "mitre_threat_groups": "APT41|APT38|Dragonfly 2.0|APT32|FIN8|FIN5|APT28",
            "name": "Suspicious Wevtutil Usage",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = wevtutil.exe Processes.process=\"*cl*\" (Processes.process=\"*System*\" OR Processes.process=\"*Security*\" OR Processes.process=\"*Setup*\" OR Processes.process=\"*Application*\") by Processes.process_name Processes.parent_process_name Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `suspicious_wevtutil_usage_filter`",
            "search_name": "ESCU - Suspicious wevtutil Usage - Rule",
            "story": "b6db2c60-a281-48b4-95f1-2cd99ed56835|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Windows Log Manipulation",
                    "Ransomware"
                ],
                "asset_type": "",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 6"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT41",
                    "APT38",
                    "Dragonfly 2.0",
                    "APT32",
                    "FIN8",
                    "FIN5",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1070"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Clear Windows Event Logs"
                ],
                "nist": [
                    "DE.DP",
                    "PR.IP",
                    "PR.PT",
                    "PR.AC",
                    "PR.AT",
                    "DE.AE"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 3
        },
        "suspicious_writes_to_system_volume_information": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Collection and Staging",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=suspicious_writes_to_system_volume_information",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This search detects writes to the 'System Volume Information' folder by something other than the System process.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You need to be ingesting logs with both the process name and command-line from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "highlight": "No",
            "how_to_implement": "You need to be ingesting logs with both the process name and command-line from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_writes_to_system_volume_information",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "It is possible that other utilities or system processes may legitimately write to this folder. Investigate and modify the search to include exceptions as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_writes_to_system_volume_information_filter"
                }
            ],
            "mitre_sub_technique": "T1036",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1036",
            "mitre_threat_groups": "Windshift|APT32|BRONZE BUTLER|menuPass|Dragonfly 2.0",
            "name": "Suspicious Writes To System Volume Information",
            "references": [],
            "released": "2020-07-22",
            "search": "(`sysmon` OR tag=process) EventCode=11 process_id!=4 file_path=*System\\ Volume\\ Information* | stats count min(_time) as firstTime max(_time) as lastTime by dest, Image, file_path | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `suspicious_writes_to_system_volume_information_filter`",
            "search_name": "ESCU - Suspicious writes to System Volume Information - Rule",
            "story": "8e03c61e-13c4-4dcd-bfbe-5ce5a8dc031a",
            "tags": {
                "analytics_story": [
                    "Collection and Staging"
                ],
                "asset_type": "Windows",
                "cis20": [
                    "CIS 8"
                ],
                "mitre_attack_groups": [
                    "Windshift",
                    "APT32",
                    "BRONZE BUTLER",
                    "menuPass",
                    "Dragonfly 2.0"
                ],
                "mitre_attack_id": [
                    "T1036"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Masquerading"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "suspicious_writes_to_windows_recycle_bin": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Collection and Staging",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=suspicious_writes_to_windows_recycle_bin",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036/write_to_recycle_bin/windows-sysmon.log"
            ],
            "date": "2020-07-22",
            "description": "This search detects writes to the recycle bin by a process other than explorer.exe.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to be ingesting information on filesystem and process logs responsible for the changes from your endpoints into the `Endpoint` datamodel in the `Processes` and `Filesystem` nodes.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to be ingesting information on filesystem and process logs responsible for the changes from your endpoints into the `Endpoint` datamodel in the `Processes` and `Filesystem` nodes.",
            "icon": "ES_Use_Case.png",
            "id": "suspicious_writes_to_windows_recycle_bin",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "None",
            "known_false_positives": "Because the Recycle Bin is a hidden folder in modern versions of Windows, it would be unusual for a process other than explorer.exe to write to it. Incidents should be investigated as appropriate.",
            "lookups": "",
            "macros": [
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "suspicious_writes_to_windows_recycle_bin_filter"
                }
            ],
            "mitre_sub_technique": "T1036",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1036",
            "mitre_threat_groups": "Windshift|APT32|BRONZE BUTLER|menuPass|Dragonfly 2.0",
            "name": "Suspicious Writes To Windows Recycle Bin",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.file_path) as file_path values(Filesystem.file_name) as file_name FROM datamodel=Endpoint.Filesystem where Filesystem.file_path = \"*$Recycle.Bin*\" by Filesystem.process_id Filesystem.dest | `drop_dm_object_name(\"Filesystem\")`| search [| tstats `security_content_summariesonly` values(Processes.user) as user values(Processes.process_name) as process_name values(Processes.parent_process_name) as parent_process_name FROM datamodel=Endpoint.Processes where Processes.process_name != \"explorer.exe\" by Processes.process_id Processes.dest| `drop_dm_object_name(\"Processes\")` | table process_id dest] | `suspicious_writes_to_windows_recycle_bin_filter`",
            "search_name": "ESCU - Suspicious writes to windows Recycle Bin - Rule",
            "story": "8e03c61e-13c4-4dcd-bfbe-5ce5a8dc031a",
            "tags": {
                "analytics_story": [
                    "Collection and Staging"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036/write_to_recycle_bin/windows-sysmon.log"
                ],
                "mitre_attack_groups": [
                    "Windshift",
                    "APT32",
                    "BRONZE BUTLER",
                    "menuPass",
                    "Dragonfly 2.0"
                ],
                "mitre_attack_id": [
                    "T1036"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Masquerading"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "system_information_discovery_detection": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Discovery Techniques",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=system_information_discovery_detection",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1082/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-10-12",
            "description": "Detect system information discovery techniques used by attackers to understand configurations of the system to further exploit it.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 6|CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "highlight": "No",
            "how_to_implement": "",
            "icon": "ES_Use_Case.png",
            "id": "system_information_discovery_detection",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "Administrators debugging servers",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "system_information_discovery_detection_filter"
                }
            ],
            "mitre_sub_technique": "T1082",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1082",
            "mitre_threat_groups": "Rocke|Sandworm Team|Blue Mockingbird|Tropic Trooper|Frankenstein|Inception|Kimsuky|Darkhotel|MuddyWater|APT18|Honeybee|APT19|APT37|APT32|Magic Hound|OilRig|APT3|Sowbug|Gamaredon Group|Patchwork|Stealth Falcon|Lazarus Group|admin@338|Turla|Ke3chang",
            "name": "System Information Discovery Detection",
            "references": [
                "https://oscp.infosecsanyam.in/priv-escalation/windows-priv-escalation"
            ],
            "released": "2020-10-12",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process=\"*wmic* qfe*\" OR Processes.process=*systeminfo* OR Processes.process=*hostname*) by Processes.user Processes.process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | eventstats dc(process) as dc_processes_by_dest by dest | where dc_processes_by_dest > 2 | stats values(process) min(firstTime) as firstTime max(lastTime) as lastTime by user, dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `system_information_discovery_detection_filter`",
            "search_name": "ESCU - System Information Discovery Detection - Rule",
            "story": "",
            "tags": {
                "analytics_story": [
                    "Discovery Techniques"
                ],
                "asset_type": "Windows",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 6",
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1082/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Rocke",
                    "Sandworm Team",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "Inception",
                    "Kimsuky",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "Honeybee",
                    "APT19",
                    "APT37",
                    "APT32",
                    "Magic Hound",
                    "OilRig",
                    "APT3",
                    "Sowbug",
                    "Gamaredon Group",
                    "Patchwork",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "admin@338",
                    "Turla",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1082"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "System Information Discovery"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "system_processes_run_from_unexpected_locations": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Command-Line Executions|Unusual Processes|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=system_processes_run_from_unexpected_locations",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-12-08",
            "description": "This search looks for system processes that normally run out of C:\\Windows\\System32\\ or C:\\Windows\\SysWOW64 that are not run from that location.  This can indicate a malicious process that is trying to hide as a legitimate process.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to ingest details about process execution from your hosts. Specifically, this search requires the process name and the full path to the process executable.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to ingest details about process execution from your hosts. Specifically, this search requires the process name and the full path to the process executable.",
            "icon": "ES_Use_Case.png",
            "id": "system_processes_run_from_unexpected_locations",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "lookup update=true is_windows_system_file filename as process_name OUTPUT systemFile | search systemFile=true",
                    "description": "This macro limits the output to process names that are in the Windows System directory",
                    "lookups": [
                        {
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/is_windows_system_file.csv",
                            "default_match": "false",
                            "description": "A list of executable files in Windows\\System32",
                            "filename": "is_windows_system_file.csv",
                            "min_matches": 1,
                            "name": "is_windows_system_file"
                        }
                    ],
                    "name": "is_windows_system_file"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "system_processes_run_from_unexpected_locations_filter"
                }
            ],
            "mitre_sub_technique": "T1036.003",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1036",
            "mitre_threat_groups": "menuPass|APT32|Soft Cell|PLATINUM",
            "name": "System Processes Run From Unexpected Locations",
            "references": [],
            "released": "2020-12-08",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.process_path !=\"C:\\\\Windows\\\\System32*\" Processes.process_path !=\"C:\\\\Windows\\\\SysWOW64*\" by Processes.user Processes.dest Processes.process_name Processes.process_id Processes.process_path Processes.parent_process_name Processes.process_hash| `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| `is_windows_system_file` | `system_processes_run_from_unexpected_locations_filter`",
            "search_name": "ESCU - System Processes Run From Unexpected Locations - Rule",
            "story": "f4368ddf-d59f-4192-84f6-778ac5a3ffc7|f4368e3f-d59f-4192-84f6-748ac5a3ddb6|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Suspicious Command-Line Executions",
                    "Unusual Processes",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "menuPass",
                    "APT32",
                    "Soft Cell",
                    "PLATINUM"
                ],
                "mitre_attack_id": [
                    "T1036"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Rename System Utilities"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "threat_activity_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Threat Intelligence|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS001MAIL-ET02Receive|DS002DNS-ET01QueryRequest|DS005WebProxyRequest-ET01Requested|DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET04ProcessLaunchWithHash|DS010NetworkCommunication-ET01Traffic|DS011MalwareDetonation-ET01Detection",
            "deprecated_not_used_anymore_datasource": "Email|DNS|Web Proxy|Endpoint Detection and Response|Network Communication|Malware Detonation",
            "description": "Alerts when any activity matching threat intelligence is detected.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Threat",
            "gdprtext": "<h4>Problem:</h4><p>Threat activity can indicate a high-priority risk. As an example, compromised hosts may be attempting to communicate with malicious command and control servers. Threat activity detected can represent a range of potential security issues that may be unpredictable and difficult to know how to handle \u2013 in the above example, it may not be clear whether the communication is simply beaconing or sensitive data is being exfiltrated.</p><h4>Impact:</h4><p>Early detection of threat activity is critical to effective and timely response. This is a security best practice.</p><p>Specific to the GDPR, organizations must collect the full audit trail of data processing activities of involved systems and applications, and document, investigate, and report any data breach. Threat activity indicates a potential breach and therefore high-risk situation for personal data. Detection and awareness of threat activity is critical to respond in a timely manner, within the 72-hr deadline of GDPR, as well as to maintain compliance requirements of GDPR. If detection indicates a condition of high risk and non-compliance, then it needs to be documented, remediated, and potentially investigated and reported. Lacking the ability to detect personal data can impact the organization via a wide array of GDPR articles, including Article 15 (individuals have the right to ask an organization where their data is stored); proving that only authorized individuals have accessed personal data (Article 28), and documenting and reporting unauthorized access to the data privacy authorities; regularly testing, assessing and evaluating effectiveness of implemented technical and organizational security controls (Article 32); and demonstrating compliance within the scope of a privacy audit (Article 58); maintaining a record of processing activities (Article 30); ensuring legitimate access and lawful intended use and processing (Article 6); verifying and proving erasure of data (Article 17); restricting the processing of personal data to a limited set of reasons (Article 18 and Article 21); compliance to right of access requirements including by contractors or sub-processors (Article 15); compliance to subject rights regarding automated decision making processes (Article 22); </p><p>If the organization faces a personal data breach, potential impact includes reporting within the 72-hr deadline with full context of what happened within the incident, as well as proving to individuals demanding compensation that the organizations has understood and addressed the risk appropriately and deployed proper countermeasures (Article 82); and Article 33 requires organizations to inform the authorities, including details about the nature of the breach -- the same requirement exists within Article 34, that organizations must identify which individuals are affected.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1071|T1094",
            "name": "Threat Activity Detected",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting",
                "phantom_prompt_and_block_domain",
                "phantom_phishing_remediation_investigation"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Threat - Threat List Activity - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "tor_traffic": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Prohibited Traffic Allowed or Protocol Mismatch|Ransomware|Command and Control|Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Data Exfiltration",
            "dashboard": "showcase_security_content?showcaseId=tor_traffic",
            "data_source_categories": "DS010NetworkCommunication-ET01TrafficAppAware",
            "datamodel": "Network_Traffic",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This search looks for network traffic identified as The Onion Router (TOR), a benign anonymity network which can be abused for a variety of nefarious purposes.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 9|CIS 12",
            "escu_nist": "DE.AE",
            "hasSearch": "Yes",
            "help": "In order to properly run this search, Splunk needs to ingest data from firewalls or other network control devices that mediate the traffic allowed into an environment. This is necessary so that the search can identify an 'action' taken on the traffic of interest. The search requires the Network_Traffic data model be populated.",
            "highlight": "No",
            "how_to_implement": "In order to properly run this search, Splunk needs to ingest data from firewalls or other network control devices that mediate the traffic allowed into an environment. This is necessary so that the search can identify an 'action' taken on the traffic of interest. The search requires the Network_Traffic data model be populated.",
            "icon": "ES_Use_Case.png",
            "id": "tor_traffic",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "killchain": "Command and Control",
            "known_false_positives": "None at this time",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "tor_traffic_filter"
                }
            ],
            "mitre_sub_technique": "T1071.001",
            "mitre_tactic": "",
            "mitre_tactic_display": "Command And Control",
            "mitre_technique": "T1071",
            "mitre_threat_groups": "Sandworm Team|TA505|Rocke|APT39|Tropic Trooper|MuddyWater|Wizard Spider|Inception|APT41|SilverTerrier|Machete|APT28|WIRTE|APT33|FIN4|Night Dragon|APT18|APT38|Cobalt Group|APT19|Threat Group-3390|Rancor|Orangeworm|APT37|Ke3chang|Dark Caracal|Turla|Lazarus Group|BRONZE BUTLER|APT32|OilRig|Magic Hound|Gamaredon Group|Stealth Falcon",
            "name": "Tor Traffic",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.app=tor AND All_Traffic.action=allowed by All_Traffic.src_ip All_Traffic.dest_ip All_Traffic.dest_port All_Traffic.action | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(\"All_Traffic\")` | `tor_traffic_filter`",
            "search_name": "ESCU - TOR Traffic - Rule",
            "story": "6d13121c-90f3-446d-8ac3-27efbbc65218|cf309d0d-d4aa-4fbb-963d-1e79febd3756|943773c6-c4de-4f38-89a8-0b92f98804d8|758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Prohibited Traffic Allowed or Protocol Mismatch",
                    "Ransomware",
                    "Command and Control",
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 9",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "TA505",
                    "Rocke",
                    "APT39",
                    "Tropic Trooper",
                    "MuddyWater",
                    "Wizard Spider",
                    "Inception",
                    "APT41",
                    "SilverTerrier",
                    "Machete",
                    "APT28",
                    "WIRTE",
                    "APT33",
                    "FIN4",
                    "Night Dragon",
                    "APT18",
                    "APT38",
                    "Cobalt Group",
                    "APT19",
                    "Threat Group-3390",
                    "Rancor",
                    "Orangeworm",
                    "APT37",
                    "Ke3chang",
                    "Dark Caracal",
                    "Turla",
                    "Lazarus Group",
                    "BRONZE BUTLER",
                    "APT32",
                    "OilRig",
                    "Magic Hound",
                    "Gamaredon Group",
                    "Stealth Falcon"
                ],
                "mitre_attack_id": [
                    "T1071"
                ],
                "mitre_attack_tactics": [
                    "Command And Control"
                ],
                "mitre_attack_technique": [
                    "Web Protocols"
                ],
                "nist": [
                    "DE.AE"
                ],
                "security_domain": "network"
            },
            "usecase": "Insider Threat|Security Monitoring",
            "version": 2
        },
        "tt01": {
            "alertvolume": "Low",
            "anomalies": [
                "at12",
                "at17",
                "at61",
                "at24",
                "at08",
                "at28",
                "at40",
                "at55",
                "at58",
                "at01",
                "at02",
                "at03",
                "at14",
                "at34",
                "at36",
                "at43",
                "at05",
                "at62",
                "at64",
                "at65",
                "at07",
                "at35",
                "at06",
                "at33",
                "at53",
                "at29",
                "at39",
                "at31",
                "at19",
                "at24",
                "at38",
                "at49",
                "at41"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec|DS003Authentication-ET02Failure|DS014WebServer-ET01Access|VendorSpecific-winsec-powershell|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET03UserAware|DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS017PhysicalSecurity-ET01Access|VendorSpecific-Box|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS002DNS-ET01Query|DS010NetworkCommunication-ET01TrafficAppAware|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "description": "This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline that indicates a compromise.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "tt01",
            "includeSSE": "Yes",
            "internal_id": "Account_Compromise_with_Suspicious_Internal_Activity",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including suspicious internal activity associated with that account. Indicators of compromise could be something as simple as number of logins per day or as complex as lateral movement or beaconing. An example of suspicious internal activity is data movement from one internal resource to another, or RDP hopping. This threat contains a number of possible anomalies.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Account Compromise with Suspicious Internal Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt02": {
            "alertvolume": "Low",
            "anomalies": [
                "at12",
                "at17",
                "at24",
                "at61",
                "at08",
                "at28",
                "at40",
                "at55",
                "at58",
                "at36",
                "at43",
                "at05",
                "at62",
                "at64",
                "at65",
                "at06",
                "at33",
                "at53",
                "at14",
                "at34",
                "at29",
                "at39",
                "at19",
                "at31",
                "at38",
                "at49",
                "at21",
                "at41",
                "at58"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec|DS003Authentication-ET02Failure|DS014WebServer-ET01Access|VendorSpecific-winsec-powershell|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET03UserAware|DS005WebProxyRequest-ET01Requested|DS017PhysicalSecurity-ET01Access|VendorSpecific-Box|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS010NetworkCommunication-ET01TrafficAppAware|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "description": "This threat is generated when an account or multiple accounts exhibit behavior outside of the normal baseline that indicates a compromise.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt02",
            "includeSSE": "Yes",
            "internal_id": "Account_Compromised_followed_by_Exfiltration",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when an account  or multiple accounts exhibit behavior outside of the normal baseline that indicates a compromise. It further includes data exfiltration activity associated with that account. Indicators of compromise could be something as simple as number of logins per day or as complex as lateral movement or beaconing. An example of data exfiltration is data movement from an internal server to an external server, or emailing to self. This threat contains a number of possible anomalies.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Account Compromised followed by Exfiltration",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt03": {
            "alertvolume": "Low",
            "anomalies": [
                "at19",
                "at15",
                "at13",
                "at21",
                "at26",
                "at29",
                "at32",
                "at33",
                "at38",
                "at40",
                "at42",
                "at46",
                "at49",
                "at61"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box|VendorSpecific-winsec|DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|VendorSpecific-winsec-powershell|DS003Authentication-ET02Failure",
            "description": "This threat is generated when a single account or multiple accounts have repeated login failures followed by malicious activity such as data movement or scanning activity.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt03",
            "includeSSE": "Yes",
            "internal_id": "Brute_Force",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is generated when a single account or multiple accounts have repeated login failures followed by malicious activity such as data movement or scanning activity. Please see the associated anomalies to see what malicious activity the threat is looking for.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Brute Force",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Security Monitoring"
        },
        "tt04": {
            "alertvolume": "High",
            "anomalies": [
                "at12",
                "at55",
                "at07",
                "at13",
                "at26",
                "at29",
                "at31",
                "at32",
                "at38",
                "at40",
                "at42",
                "at49",
                "at50",
                "at61"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|VendorSpecific-winsec|VendorSpecific-Box|VendorSpecific-winsec-powershell|DS010NetworkCommunication-ET01TrafficAppAware|DS003Authentication-ET02Failure",
            "description": "This is a threat that looks for login anomalies such as a land speed violation followed by malicious activity like unusual machine access or unusual access time.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt04",
            "includeSSE": "Yes",
            "internal_id": "Compromised_Account",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This is a threat that looks for login anomalies such as a land speed violation followed by malicious activity like unusual machine access or unusual access time. Please see the associated anomalies to see what malicious activity the threat is looking for.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Compromised Account",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt05": {
            "alertvolume": "Low",
            "anomalies": [
                "at08",
                "at28",
                "at05",
                "at06",
                "at33",
                "at48",
                "at60"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS016DataLossPrevention-ET01Violation|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested",
            "description": "This is a threat rule that looks for potential webshell or external traffic followed up by data movement or unusual data access. Please see the associated anomalies to see what malicious data movement the threat rule is looking for.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt05",
            "includeSSE": "Yes",
            "internal_id": "Compromised_Web_Server",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This is a threat rule that looks for potential webshell or external traffic followed up by data movement or unusual data access. Please see the associated anomalies to see what malicious data movement the threat rule is looking for.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Compromised Web Server",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Application Security"
        },
        "tt06": {
            "alertvolume": "Low",
            "anomalies": [
                "at06",
                "at64",
                "at65",
                "at33",
                "at53"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested",
            "description": "This threat is created by data exfiltration by excessive data transmissions by a device or user in a traditional network setting or via VPN.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt06",
            "includeSSE": "Yes",
            "internal_id": "Exfiltration",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is created by data exfiltration by excessive data transmissions by a device or user in a traditional network setting or via VPN. Note: There are other exfiltration threats that contain other behavior, this is just the activity of data exfiltration. This may be seen in tandem with other threats that have been created by UBA.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Exfiltration",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt07": {
            "alertvolume": "Low",
            "anomalies": [
                "at12",
                "at55",
                "at06",
                "at32",
                "at33",
                "at37"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|VendorSpecific-Box|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested",
            "description": "This threat is based on the compromised account threat, however looks for data exfiltration after account takeover instead of suspicious behavior.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt07",
            "includeSSE": "Yes",
            "internal_id": "Data_Exfiltration_after_Account_Takeover,_High",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is based on the compromised account threat, however looks for data exfiltration after account takeover instead of suspicious behavior. This threat has a higher confidence than \"Data Exfiltration after Account Takeover, Medium\" due to the limited anomaly set that UBA looks at. Please see the associated anomalies to see what account takeover and data exfiltration behaviors UBA is scanning for.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Data Exfiltration after Account Takeover, High",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt08": {
            "alertvolume": "Medium",
            "anomalies": [
                "at19",
                "at20",
                "at42",
                "at49",
                "at06",
                "at32",
                "at33",
                "at37",
                "at61"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box|VendorSpecific-winsec|DS003Authentication-ET01Success|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic|DS003Authentication-ET02Failure",
            "description": "This threat is based on the compromised account threat, however looks for data exfiltration after account takeover instead of suspicious behavior.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt08",
            "includeSSE": "Yes",
            "internal_id": "Data_Exfiltration_after_Account_Takeover,_Medium",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is based on the compromised account threat, however looks for data exfiltration after account takeover instead of suspicious behavior. This threat has a lower confidence than \"Data Exfiltration after Account Takeover, High\" due to the expanded anomaly set that UBA looks at. Please see the associated anomalies to see what account takeover and data exfiltration behaviors UBA is scanning for.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Data Exfiltration after Account Takeover, Medium",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt09": {
            "alertvolume": "Low",
            "anomalies": [
                "at60",
                "at05",
                "at62",
                "at21",
                "at32",
                "at45",
                "at06",
                "at51",
                "at54",
                "at59"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|VendorSpecific-Box|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS010NetworkCommunication-ET01TrafficAppAware|DS034ApplicationLogs-ET01General|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "description": "This threat combines staging data and data exfiltration.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "tt09",
            "includeSSE": "Yes",
            "internal_id": "Data_Exfiltration_after_Data_Staging",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat combines staging data and data exfiltration. Data staging includes copying or moving data from one location to another, often times cloud file systems or through email. Once the data is staged the malicious user then uses different methods to exfiltrate the data. This again can be through email or suspicious data movement.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Data Exfiltration after Data Staging",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "tt10": {
            "alertvolume": "Low",
            "anomalies": [
                "at26",
                "at15",
                "at49",
                "at57",
                "at41",
                "at42",
                "at24",
                "at38",
                "at50",
                "at07",
                "at13",
                "at67",
                "at30",
                "at25",
                "at06",
                "at64",
                "at65",
                "at33",
                "at53",
                "at44"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS001MAIL-ET03Send|DS010NetworkCommunication-ET03UserAware|DS034ApplicationLogs-ET01General|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested|VendorSpecific-Box",
            "description": "This threat is generated when an account or device exhibits behavior outside of the normal baseline. It further includes data exfiltration activity associated with that account.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt10",
            "includeSSE": "Yes",
            "internal_id": "Data_Exfiltration_by_suspicious_user_or_device",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when an account or device exhibits behavior outside of the normal baseline. It further includes data exfiltration actiivity associated with that account. Indicators of suspicious activity could be something as simple as number of logins per day or unusual Wiindows event logs attributed to that account or device. An example of data exfiltration is data movement from an internal server to an external server, or emaiiling to self. This threat contains a number of possible anomalies.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Data Exfiltration by suspicious user or device",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt11": {
            "alertvolume": "Low",
            "anomalies": [
                "at08",
                "at28",
                "at40",
                "at12",
                "at55",
                "at58",
                "at36",
                "at64",
                "at06",
                "at65",
                "at53",
                "at33"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access|VendorSpecific-winsec-powershell|DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET03UserAware|DS005WebProxyRequest-ET01Requested|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS010NetworkCommunication-ET01TrafficAppAware|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS001MAIL-ET03Send",
            "description": "This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including data exfiltration associated with that account.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt11",
            "includeSSE": "Yes",
            "internal_id": "Exfiltration_after_Account_Compromise",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including data exfiltration associated with that account. Indicators of compromise could be something as simple as number of logins per day or as complex as lateral movement or beaconing. An example of data exfiltration is data movement from an internal server to an external server, or emaiiling to self. This threat contains a number of possible anomalies.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Exfiltration after Account Compromise",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt12": {
            "alertvolume": "Low",
            "anomalies": [
                "at08",
                "at12",
                "at28",
                "at55",
                "at58",
                "at01",
                "at02",
                "at03",
                "at14",
                "at34",
                "at64",
                "at40",
                "at42",
                "at43",
                "at52",
                "at17",
                "at61",
                "at26",
                "at31",
                "at38",
                "at06",
                "at65",
                "at33",
                "at53"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Account Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access|DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET03UserAware|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|VendorSpecific-winsec-powershell|DS017PhysicalSecurity-ET01Access|DS003Authentication-ET02Failure|DS010NetworkCommunication-ET01TrafficAppAware|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "description": "This threat is generated when a device exhibits behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including data exfiltration associated with that device.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt12",
            "includeSSE": "Yes",
            "internal_id": "Exfiltration_after_Infection",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a device exhibits behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including data exfiltration associated with that device. Indicators of infection could be something as simple as data movement or as complex as visiting multiple malicious URIs or beaconing. An example of data exfiltration is data movement from an internal server to an external server, or DNS data transfers. This threat contains a number of possible anomalies.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Exfiltration after Infection",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt13": {
            "alertvolume": "Low",
            "anomalies": [
                "at12",
                "at17",
                "at24",
                "at61",
                "at08",
                "at28",
                "at40",
                "at01",
                "at02",
                "at03",
                "at14",
                "at34",
                "at36",
                "at31",
                "at38",
                "at49",
                "at21",
                "at29",
                "at41",
                "at64",
                "at06",
                "at65",
                "at53",
                "at33",
                "at35",
                "at05",
                "at39"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Account Compromise",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec|DS003Authentication-ET02Failure|DS014WebServer-ET01Access|VendorSpecific-winsec-powershell|DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic|VendorSpecific-Box|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS001MAIL-ET03Send|DS002DNS-ET01Query",
            "description": "This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline. It further differentiates itself by including data exfiltration associated with that account.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt13",
            "includeSSE": "Yes",
            "internal_id": "Exfiltration_after_Suspicious_Internal_Activity",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline. It further differentiates itself by including data exfiltration associated with that account. Indicators of suspicious activity could be something as simple as number of logins per day or as complex as multiple event codes never seen before. An example of data exfiltration is data movement from one internal resource to an external or DNS data transfer. This threat contains a number of possible anomalies.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Exfiltration after Suspicious Internal Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt14": {
            "alertvolume": "Low",
            "anomalies": [
                "at07",
                "at40",
                "at46",
                "at53",
                "at01",
                "at12",
                "at13",
                "at15",
                "at26",
                "at30",
                "at33",
                "at34",
                "at35",
                "at37",
                "at42",
                "at48",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|VendorSpecific-winsec-powershell|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS003Authentication-ET01Success|DS001MAIL-ET03Send|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS002DNS-ET01Query|DS010NetworkCommunication-ET01Traffic",
            "description": "This threat looks for a suspicious first step such as a suspicious powershell command or USB insertion.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt14",
            "includeSSE": "Yes",
            "internal_id": "Infected_Host",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat looks for a suspicious first step such as a suspicious powershell command or USB insertion. It then goes on to detect any suspicious network activity or processes that are performing actions on the host, such as local account creation or malicious AD activity. The threat is created from a device perspective, although any users who have utilized that device will be associated with the threat. This is often coupled with one of the malware focused threats.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Infected Host",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt15": {
            "alertvolume": "Low",
            "anomalies": [
                "at12",
                "at17",
                "at24",
                "at61",
                "at08",
                "at28",
                "at40",
                "at55",
                "at58",
                "at01",
                "at02",
                "at03",
                "at14",
                "at34",
                "at36",
                "at53",
                "at64",
                "at18",
                "at42",
                "at43",
                "at52",
                "at26",
                "at31",
                "at38",
                "at49",
                "at21",
                "at41",
                "at29",
                "at06",
                "at65",
                "at33",
                "at35",
                "at05",
                "at39"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec|DS003Authentication-ET02Failure|DS014WebServer-ET01Access|VendorSpecific-winsec-powershell|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET03UserAware|DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS017PhysicalSecurity-ET01Access|VendorSpecific-Box|DS010NetworkCommunication-ET01TrafficAppAware|DS001MAIL-ET03Send|DS002DNS-ET01Query",
            "description": "This threat is generated when a device exhibits behavior outside of the normal baseline that indicates a compromise.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt15",
            "includeSSE": "Yes",
            "internal_id": "Infection_followed_by_Exfiltration",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a device exhibits behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including data exfiltration associated with that device. Indicators of infection could be something as simple as data movement or as complex as visiting multiple malicious URIs or beaconing. An example of data exfiltration is data movement from an internal server to an external server, or DNS data transfers. This threat contains a number of possible anomalies.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Infection followed by Exfiltration",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt16": {
            "alertvolume": "Medium",
            "anomalies": [
                "at26",
                "at15",
                "at49",
                "at57",
                "at41",
                "at42",
                "at24",
                "at38",
                "at50",
                "at07",
                "at13",
                "at67",
                "at30"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS001MAIL-ET03Send",
            "description": "This threat is generated when UBA detects activity from a user (or users) that looks like possible lateral movement in the network.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "tt16",
            "includeSSE": "Yes",
            "internal_id": "Lateral_Movement",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when UBA detects activity from a user (or users) that looks like possible lateral movement in the network. Examples of activity that may be included in this threat are: multiple logins, unusual machine access, network exploration, and unusual login times.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Lateral Movement",
            "released": "3.0.0",
            "searchKeywords": "UBA mimikatz",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt17": {
            "alertvolume": "Low",
            "anomalies": [
                "at34",
                "at01",
                "at15",
                "at26",
                "at30",
                "at33",
                "at36",
                "at37",
                "at42",
                "at46",
                "at48",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS003Authentication-ET01Success|DS001MAIL-ET03Send|DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This threat looks detects network communication to malicious domains followed by suspicious activity by the device or user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt17",
            "includeSSE": "Yes",
            "internal_id": "Malicious_URI_with_Potential_Malware",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat looks detects network communication to malicious domains followed by suspicious activity by the device or user. Suspicious activity in this instance can be anything from data movement and staging to network exploration or unusual machine access. This threat is often see with other malware focused threats.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Malicious URI with Potential Malware",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt18": {
            "alertvolume": "Low",
            "anomalies": [
                "at07",
                "at40",
                "at46",
                "at53",
                "at01",
                "at02",
                "at03",
                "at12",
                "at13",
                "at14",
                "at15",
                "at26",
                "at30",
                "at33",
                "at34",
                "at37",
                "at42",
                "at48",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|VendorSpecific-winsec-powershell|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic|DS003Authentication-ET01Success|DS001MAIL-ET03Send|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware",
            "description": "This threat is generated when a device exhibits behavior that could be attributed to malware. Examples of indicators of malware are beaconing, suspicous data movement, and unusual VPN access.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt18",
            "includeSSE": "Yes",
            "internal_id": "Malware",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a device exhibits behavior that could be attributed to malware. Examples of indicators of malware are beaconing, suspicous data movement, and unusual VPN access.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Malware",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt19": {
            "alertvolume": "Low",
            "anomalies": [
                "at52",
                "at09",
                "at10",
                "at43"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "This threat is a simple rule to look for unusual badge access time as well as multiple failed badge accesses. UBA has the ability to create simple correlation threat rules based on anomalies. This threat is one such rule.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "tt19",
            "includeSSE": "Yes",
            "internal_id": "Multiple_failed_badge_attempts_and_unusual_badge_access_time",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is a simple rule to look for unusual badge access time as well as multiple failed badge accesses. UBA has the ability to create simple correlation threat rules based on anomalies. This threat is one such rule.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Multiple failed badge attempts and unusual badge access time",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "tt20": {
            "alertvolume": "Low",
            "anomalies": [
                "at11",
                "at06",
                "at32",
                "at33",
                "at51",
                "at53",
                "at54",
                "at59"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|VendorSpecific-Box|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS034ApplicationLogs-ET01General",
            "description": "This threat brings to light users who are possible flight risks.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "tt20",
            "includeSSE": "Yes",
            "internal_id": "Potential_Flight_Risk_Exfiltration",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat brings to light users who are possible flight risks. However, in addition to being a flight risk, this user has also performed actions that signal that it may be possible he will exfiltrate data. Actions that lead to exfiltration of data in this instance are events such as: suspicious data movement, upload of information to a cloud file system, or a DLP external alarm. ",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Potential Flight Risk Exfiltration",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "tt21": {
            "alertvolume": "Low",
            "anomalies": [
                "at11",
                "at60",
                "at05",
                "at62",
                "at21",
                "at32",
                "at45"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|VendorSpecific-Box|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This threat is generated when a potential flight risk user has staged data but not yet exfiltrated it.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt21",
            "includeSSE": "Yes",
            "internal_id": "Potential_Flight_Risk_Staging",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is generated when a potential flight risk user has staged data but not yet exfiltrated it. Data staging includes copying a large amount of data or downloading large volumes of data. This is different than \"Potential Flight Risk Exfiltration\" due to the collection of data rather than the exfiltration of it.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Potential Flight Risk Staging",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "tt22": {
            "alertvolume": "Low",
            "anomalies": [
                "at27",
                "at12",
                "at15",
                "at26",
                "at30",
                "at33",
                "at34",
                "at36",
                "at40",
                "at42",
                "at46",
                "at49",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Phishing",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET02Receive|DS003Authentication-ET01Success|VendorSpecific-winsec|DS001MAIL-ET03Send|DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|VendorSpecific-winsec-powershell|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS010NetworkCommunication-ET01Traffic",
            "description": "This threat is generated when UBA detects a potential phishing attempt (email inbound or spear phishing) followed up by suspicious activity from the user or device.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "tt22",
            "includeSSE": "Yes",
            "internal_id": "Potential_Phishing_Attack",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is generated when UBA detects a potential phishing attempt (email inbound or spear phishing) followed up by suspicious activity from the user or device. Suspicious activity in this instance may include visiting a blacklisted website or machine beaconing. ",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Potential Phishing Attack",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt23": {
            "alertvolume": "Low",
            "anomalies": [
                "at40",
                "at41"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec-powershell|VendorSpecific-winsec",
            "description": "This threat is a simple rule to look for privilege escalation occurring after a suspicious powershell command. UBA has the ability to create simple correlation threat rules based on anomalies. This threat is one such rule.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "id": "tt23",
            "includeSSE": "Yes",
            "internal_id": "Privilege_Escalation_after_Powershell_Activity",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is a simple rule to look for privilege escalation occurring after a suspicious powershell command. UBA has the ability to create simple correlation threat rules based on anomalies. This threat is one such rule.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Privilege Escalation after Powershell Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt24": {
            "alertvolume": "Low",
            "anomalies": [
                "at08"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Web Attack",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "description": "This threat is generated when a publicly facing website is possibly under attack. Typical indicators in this threat are things like SQL injection.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt24",
            "includeSSE": "Yes",
            "internal_id": "Public_facing_Website_Attack",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a publicly facing website is possibly under attack. Typical indicators in this threat are things like SQL injection.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Public facing Website Attack",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Application Security"
        },
        "tt25": {
            "alertvolume": "Low",
            "anomalies": [
                "at26",
                "at15",
                "at49",
                "at57",
                "at41",
                "at42",
                "at24",
                "at38",
                "at50",
                "at07",
                "at13",
                "at67",
                "at30",
                "at25",
                "at44",
                "at37",
                "at09",
                "at10",
                "at18",
                "at23",
                "at43",
                "at52",
                "at61",
                "at17",
                "at16"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS003Authentication-ET01Success|DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS001MAIL-ET03Send|VendorSpecific-Box|DS017PhysicalSecurity-ET01Access|DS003Authentication-ET02Failure",
            "description": "This threat is generated when a user (or group of users) exhibit behavior that indicates their account has been compromised or taken over by a remote adversary.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt25",
            "includeSSE": "Yes",
            "internal_id": "Remote_Account_Takeover",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a user (or group of users) exhibit behavior that indicates their account has been compromised or taken over by a remote adversary. This is different than the normal compromised account threat in that it also exhibits activity that indicates malicious intent, outgoing connections, and internal expansion.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Remote Account Takeover",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt26": {
            "alertvolume": "Low",
            "anomalies": [
                "at12",
                "at17",
                "at24",
                "at61",
                "at08",
                "at28",
                "at40",
                "at58",
                "at48",
                "at01",
                "at02",
                "at03",
                "at14",
                "at34",
                "at36",
                "at31",
                "at38",
                "at49",
                "at21",
                "at29",
                "at41",
                "at64",
                "at06",
                "at65",
                "at33",
                "at53",
                "at14",
                "at35",
                "at05",
                "at62",
                "at39"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec|DS003Authentication-ET02Failure|DS014WebServer-ET01Access|VendorSpecific-winsec-powershell|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|VendorSpecific-Box|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS010NetworkCommunication-ET01TrafficAppAware|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS002DNS-ET01Query",
            "description": "Threat is generated when a user or device exhibits suspicious behavior after an intrusion.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt26",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Activity_After_Intrusion",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a user or device exhibits suspicious behavior after an intrusion. Intrusions occur when there is any unauthorized network access by a program, device, or user. This could be anything from a simple malware outbreak to a full on attack. This threat will display the suspicious activity that occurs after that intrusion and will most likely be associated with another threat detailing the intrusion (e.g., malware, account compromise).",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious Activity After Intrusion",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt27": {
            "alertvolume": "Low",
            "anomalies": [
                "at52",
                "at09",
                "at10",
                "at18",
                "at23",
                "at43"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "description": "This threat is generated when a user (or a group of users) exhibit suspicious behavior involving badge systems.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt27",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Badge_Activity",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a user (or a group of users) exhibit suspicious behavior involving badge systems.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious Badge Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Insider Threat"
        },
        "tt28": {
            "alertvolume": "Medium",
            "anomalies": [
                "at01",
                "at02",
                "at03",
                "at12",
                "at17",
                "at61",
                "at24",
                "at08",
                "at27",
                "at40",
                "at14",
                "at34",
                "at36",
                "at15",
                "at05",
                "at62",
                "at64",
                "at06",
                "at65",
                "at07",
                "at35",
                "at29",
                "at39",
                "at31",
                "at38",
                "at49",
                "at41"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware|IAM Analytics|Account Compromise|Lateral Movement",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01Traffic|DS003Authentication-ET01Success|DS003Authentication-ET02Failure|DS014WebServer-ET01Access|DS001MAIL-ET02Receive|VendorSpecific-winsec-powershell|VendorSpecific-Box|DS034ApplicationLogs-ET01General|DS016DataLossPrevention-ET01Violation|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS002DNS-ET01Query",
            "description": "This threat is generated when a user (or group of users) exhibit general suspicious behavior, specifically patterns of behavior that are outside the normal baseline for the user.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt28",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Behavior",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a user (or group of users) exhibit general suspicious behavior, specifically patterns of behavior that are outside the normal baseline for the user. This threat is a general threat that may accompany other threats. ",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious Behavior",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt29": {
            "alertvolume": "Low",
            "anomalies": [
                "at11",
                "at06",
                "at32",
                "at33",
                "at51",
                "at53",
                "at54",
                "at59",
                "at60",
                "at05",
                "at62",
                "at21",
                "at45"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware|Insider Threat",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS001MAIL-ET03Send|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|VendorSpecific-Box|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS034ApplicationLogs-ET01General|DS010NetworkCommunication-ET01Traffic",
            "description": "This threat is generated when a user (or group of users) exhibit behavior that indicates the user is involved in data collection.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt29",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Data_Collection",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when a user (or group of users) exhibit behavior that indicates the user is involved in data collection. This data collection needs to be outside the normal baseline of that user. This activity could include: unusual machine access, data staging, data download or upload to cloud, or even USB injections and copy actions. This threat may be included with other data exfiltration threats or account compromise threats.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious Data Collection",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "tt30": {
            "alertvolume": "Low",
            "anomalies": [
                "at34",
                "at35",
                "at01",
                "at26",
                "at30",
                "at33",
                "at37",
                "at40",
                "at46",
                "at48",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware|Insider Threat",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|DS002DNS-ET01Query|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS001MAIL-ET03Send|DS003Authentication-ET01Success|DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|VendorSpecific-winsec-powershell|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This threat is generated when a suspicious domain or IP address is visited by a user; after which that user or device starts to display \"malware like\" activity.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt30",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_Domain_Communication_followed_by_Malware_Activity",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is generated when a suspicious domain or IP address is visited by a user; after which that user or device starts to display \"malware-like\" activity. Malware activity could be anything from beaconing to continuous URI visits. This threat will most likely be accompanied by other malware threats.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious Domain Communication followed by Malware Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt31": {
            "alertvolume": "Low",
            "anomalies": [
                "at07",
                "at22",
                "at46"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware|IAM Analytics|Account Compromise|Lateral Movement",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This threat is a catch all threat that contains external alarms from third party tools (e.g., IDS, IPS, DLP).",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Access|Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt31",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_External_Alarm_Activity",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is a catch all threat that contains external alarms from third party tools (e.g., IDS, IPS, DLP).",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious External Alarm Activity",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "tt32": {
            "alertvolume": "Low",
            "anomalies": [
                "at36",
                "at01",
                "at15",
                "at26",
                "at30",
                "at33",
                "at37",
                "at40",
                "at42",
                "at46",
                "at48",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS003Authentication-ET01Success|DS001MAIL-ET03Send|DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|VendorSpecific-winsec-powershell|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This threat is generated when there is suspicious malware activity following strange HTTP redirects.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt32",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_HTTP_Redirects_followed_by_Suspected_Infection",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is generated when there is suspicious malware activity following strange HTTP redirects. Suspicious malware activity may include: data movement, unusual machine access, or blacklisted applications launching. This threat will most likely be accompanied by other malware threats.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious HTTP Redirects followed by Suspected Infection",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt33": {
            "alertvolume": "Low",
            "anomalies": [
                "at34",
                "at01",
                "at15",
                "at26",
                "at30",
                "at33",
                "at36",
                "at37",
                "at40",
                "at42",
                "at46",
                "at48",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS003Authentication-ET01Success|DS001MAIL-ET03Send|DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|VendorSpecific-winsec-powershell|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected",
            "description": "This threat is generated when there is suspicious malware activity following a blacklisted or malicious domain visit.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt33",
            "includeSSE": "Yes",
            "internal_id": "Suspicious_URL_Communications_and_Redirects",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is generated when there is suspicious malware activity following a blacklisted or malicious domain visit. Suspicious malware activity may include: data movement, unusual machine access, or blacklisted applications launching. This threat will most likely be accompanied by other malware threats.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Suspicious URL Communications and Redirects",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "tt34": {
            "alertvolume": "Low",
            "anomalies": [
                "at32",
                "at01",
                "at15",
                "at26",
                "at30",
                "at33",
                "at36",
                "at37",
                "at40",
                "at42",
                "at46",
                "at46",
                "at48",
                "at49",
                "at55"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Adversary Tactics|Endpoint Compromise|Malware",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-Box|DS016DataLossPrevention-ET01Violation|DS020HostIntrustionDetection-ET01SigDetected|DS012NetworkIntrusionDetection-ET01SigDetection|DS004EndPointAntiMalware-ET01SigDetected|VendorSpecific-winsec|DS009EndPointIntel-ET01ProcessLaunch|DS003Authentication-ET01Success|DS001MAIL-ET03Send|DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS005WebProxyRequest-ET01Requested|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware|DS010NetworkCommunication-ET01Traffic|VendorSpecific-winsec-powershell",
            "description": "This threat is generated when there is suspicious activity surrounding a public cloud file share followed by malware activity.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt34",
            "includeSSE": "Yes",
            "internal_id": "Watering_Hole_Infection",
            "is_custom": "Yes",
            "journey": "Stage_4",
            "long_description": "This threat is generated when there is suspicious activity surrounding a public cloud file share followed by malware activity. Suspicious malware activity may include: data movement, unusual machine access, or blacklisted applications launching. This threat will most likely be accompanied by other malware threats.",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Watering Hole Infection",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Advanced Threat Detection"
        },
        "tt35": {
            "alertvolume": "Low",
            "anomalies": [
                "at28"
            ],
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Web Attack",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS014WebServer-ET01Access",
            "description": "This threat is generated when an internal website is accessed from outside the network. ",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "id": "tt35",
            "includeSSE": "Yes",
            "internal_id": "Web_Site_Compromised_(Webshell)",
            "is_custom": "No",
            "journey": "Stage_6",
            "long_description": "This threat is generated when an internal website is accessed from outside the network. ",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Web Site Compromised (Webshell)",
            "released": "3.0.0",
            "searchKeywords": "UBA",
            "usecase": "Application Security"
        },
        "uc0001": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Unauthorized Software|Data Exfiltration|Compliance",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Prohibited web applications such as file sharing platforms (i.e. Box, Dropbox, etc.), and games can be detected, and filtered by modern web proxy solutions/next generation firewalls. Existing exceptions, or new application instances should be reviewed to ensure appropriate usage.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detection of new/prohibited web application",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance|Insider Threat"
        },
        "uc0002": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Unauthorized Software|Data Exfiltration|Compliance",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Prohibited protocols such as IRC, FTP, or Gopher could indicate malicious activity on insecure systems located on the network. Consider Intra-network communication, and organization accepted communications from the Internet.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detection of prohibited protocol (application)",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance|Insider Threat"
        },
        "uc0003": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Data Exfiltration|Lateral Movement|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "Server Operating Systems, and Application services often generate email to support general purpose, or application specific functions. Configuration management is often used to identify servers generating e-mails, as well as maintaining recipient lists.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Server generating email outside of approved usage",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "uc0004": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Data Exfiltration|Lateral Movement|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "Excessive email generation by authorized users could indicate the presence of malware designed to send spam, or abuse company resources. An application owner, or admin could also be attempting to solve a business problem outside of company policy. This use case focuses on email that is generated from endpoint networks. Operating systems should also be considered since servers can use user credentials to send messages; when this is allowed, false positives could be generated.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Excessive number of emails sent from internal user",
            "relatedUseCases": [
                "detection_email_attachments_with_spaces",
                "showcase_external_emails_with_internal_domain",
                "showcase_spike_in_outgoing_email",
                "high_volume_email_activity_to_noncorporate_domains_by_user",
                "detection_suspicious_email_attachments"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "uc0005": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Unauthorized Software|Compliance|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Any Host Logs",
            "description": "Authorized, or unauthorized users may attempt to modify existing hardened configuration policies, or disable monitoring tools.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "System modification to insecure state",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Compliance"
        },
        "uc0006": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "Manually clearing the security event log on a windows system is a violation of policy and could indicate an attempt to cover malicious actions.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Windows security event log purged",
            "relatedUseCases": [
                "showcase_new_local_admin_account",
                "sser_windows_event_log_clearing_events"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0007": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Compliance",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Logon event properties could indicate account misuse, or as an indication of compromise. Compare the identified purpose of the account with the context of the logon to determine its authority.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Account logon successful method outside of policy",
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Compliance"
        },
        "uc0008": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise|Lateral Movement",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Excluding computer accounts in active directory, an account with new activity that has not been active in the previous thirty days is suspicious.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Activity on previously inactive account",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "uc0009": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise|IAM Analytics",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "An Internet facing authentication system has allowed authenticated access from a risky source network.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Authenticated communication from a risky source network",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0010": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise|Compliance|Unauthorized Software",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Identify users gaining access via an unapproved or unknown access control. This could indicate malicious activity or an internal control failure.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detect unauthorized use of remote access technologies",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0012": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Insider Threat",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "HR System",
            "description": "Increase the risk score of users who have indication of adverse separation.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Increase Risk Score of Employees before Adverse Separation",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "uc0013": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Insider Threat|Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "Detection of change for groups used to control access for sensitive, regulated, or critical infrastructure systems.",
            "displayapp": "Splunk Professional Services",
            "domain": "Audit",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Monitor change for high value groups",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Insider Threat"
        },
        "uc0014": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Insider Threat",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "A human user may own multiple accounts. When the primary account of the human is expired, disabled, or deleted, we should expect no further activity from any other account owned by the user.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Monitor Secondary Accounts after Primary Disabled",
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "activity_from_expired_user_identity",
                "Basic_Expired_Account"
            ],
            "usecase": "Insider Threat"
        },
        "uc0015": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Insider Threat|Lateral Movement|Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Privileged user authenticates to more than X number of new targets successfully or is denied access to more than Y targets in the prior Z hours.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Privileged User Accessing More Systems than Usual",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "uc0016": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Lateral Movement|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Batch, Windows Services, App Pools, and specially constructed Windows shells can access network resources. A small number of technical solutions will require this type of behavior, however, after excluding a white list of hosts or shares (such as sysvol or netlogon), such access attempts (success or fail) could indicate the presence of malware or attempts to elevate access.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Computer Accounts Accessing Network Resources",
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection"
        },
        "uc0018": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Scanning|Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Single IP address attempting authentication of more than two valid users within ten minutes where one or more unique accounts is successful, and one or more accounts is not successful against an approved SSO System.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Unauthorized access SSO brute force",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0019": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise|Insider Threat|Account Sharing",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication|HR System",
            "description": "A user on leave, vacation, sabbatical, or other types of leave should not access business systems.  This could indicate malicious activity by the employee or a compromised account.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "User authenticated to routine business systems while on extended absence",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Insider Threat"
        },
        "uc0020": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|Data Exfiltration|Scanning",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=FW Default Rules - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Any communication through the firewall not explicitly granted by policy could indicate either a misconfiguration or even malicious actions, putting your security and compliance at risk.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "FW Default Rules - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "FW Default Rules - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Firewall or the Common Information Model.",
            "highlight": "No",
            "howToImplement": "This search should work out of the box with Palo Alto Networks firewalls, and with any other device that uses the Splunk common information model. Just make sure you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!)",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Government|Energy|Chemical|Healthcare|Travel",
            "journey": "Stage_1",
            "killchain": "Command and Control",
            "knownFP": "No known false positives.",
            "mitre": "Exfiltration|Discovery|Command and Control",
            "mitre_tactic": "TA0010|TA0007|TA0011",
            "mitre_technique": "|T1041|T1048|T1094|T1032|T1095|T1046",
            "name": "Unauthorized Connection Through Firewall",
            "operationalize": "A default allow firewall rule should never be used. If the connection should be allowed, go document it and then add a specific allow rule.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_threat_hunting",
                "phantom_prompt_and_block_domain",
                "phantom_ip_investigate_report"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_connection_through_firewall.png",
            "released": "2.0.0",
            "relevance": "In addition to the general security benefits, this detection will help the data privacy officer of an organization in their GDPR requirements to detect if any new applications or service providers have been connected to push or pull personal data without the proper documentation. This helps to trigger the update of the documentation and engage the DPO, enabling continuous monitoring to detect unauthorized and undocumented new applications that do not follow corporate processes. In addition, GDPR Article 32 requires that you regularly test, assess and evaluate the effectiveness of your implemented technical and organizational security controls. If the Authority executes their powers and your Organization is in the scope of a Privacy Audit you need to demonstrate compliance (Article 58). Also in case you face a breach and individuals are impacted they have the right to compensation of the damage - if an organization can prove that they have done everything appropriate to the risk and deployed proper countermeasures, they shouldn't be liable (Article 82).",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0021": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Command and Control|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "IDS or IPS",
            "description": "Outbound communication with servers hosted in regions where the organization does not expect to have employees, customers, or suppliers. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Communication outbound to regions without business relationship",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0022": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Scanning|Lateral Movement|Data Exfiltration",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Endpoints attempting to communicate with an excessive number of unique hosts over a given time period may indicate malicious code. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Endpoint communicating with an excessive number of unique hosts",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "uc0023": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Scanning|Lateral Movement|Data Exfiltration",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Endpoints communicating with an excessive number of unique destination ports could indicate malicious code probing for vulnerabilities. Certain server applications will arrange for communication on a high number port with the client such as ftp in passive mode and RPC on windows server.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Endpoint communicating with an excessive number of unique ports",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "uc0024": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Email|DNS|Web Proxy|Network Communication",
            "description": "The endpoint has attempted (success or fail) to communicate with an external server identified on a threat list using any protocol. An attempted communication could indicate activity generated by malicious code. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Endpoint communicating with external service identified on a threat list.",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0028": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Multiple infections detected on the same endpoint in a short period of time could indicate the presence of an undetected loader malware component (apt).",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Endpoint Multiple infections over short time",
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "Recurring_Infection_on_Host",
                "high_number_of_infected_hosts",
                "host_with_a_recurring_malware_infection",
                "host_with_multiple_infections",
                "UC0029",
                "UC0075",
                "UC0065"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "uc0029": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "When a new malware variant is detected by endpoint antivirus technology it is possible the configuration or capability of other controls are deficient. Review the sequence of events leading to the infection to determine if additional preventive measures can be put in place.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "New malware detected by signature",
            "relatedUseCases": [
                "showcase_first_usb",
                "unusual_usb_activity",
                "Basic_Malware_Outbreak",
                "outbreak_detected"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "Recurring_Infection_on_Host",
                "high_number_of_infected_hosts",
                "host_with_a_recurring_malware_infection",
                "host_with_multiple_infections",
                "UC0028",
                "UC0075",
                "UC0065"
            ],
            "usecase": "Advanced Threat Detection"
        },
        "uc0030": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Endpoint Uncleaned Malware - Demo",
            "data_source_categories": "DS004EndPointAntiMalware-ET01SigDetected",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Detect a system with a malware detection that was not properly cleaned, as they carry a high risk of damage or disclosure of data.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Endpoint Uncleaned Malware - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Endpoint Uncleaned Malware - Live"
                }
            ],
            "gdprtext": "<h4>Problem</h4><p>Despite initial detection from traditional anti-malware tools, malware often persists undetected on endpoints. This can occur when malware uses evasive techniques to spread to other endpoints without triggering an alert, or if an infection or re-infection occurs due to incomplete remediation or a response that does not address the root of the infection.</p><h4>Impact</h4><p>Uncleaned malware puts digital systems at risk. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. <b>Article 32</b> of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (<b>Article 58</b>). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (<b>Article 82</b>). </p><h4>Resolution Path</h4><p>Removing malware infections that antivirus and other legacy endpoint protection software cannot remove (whether due to file permissions or other configurations that prevents easy quarantine or cleaning) can be considered in many cases appropriate, and helps to demonstrate compliance</p>.",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which a virus is not cleaned. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "With Anti-Malware logs onboard, these searches should work easily, particularly if you use a Splunk Add-on that maps the logs to the Common Information Model (search on Splunkbase!).",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Government|Defense|Media|Legal|Finance|Energy|Aerospace|Technology|Chemical|Healthcare|Telecommunications|Travel|Education",
            "journey": "Stage_1",
            "knownFP": "No known false positives at this time.",
            "mitre": "",
            "mitre_sub_technique": "T1566.001|T1566.002",
            "mitre_tactic": "|TA0002|TA0001",
            "mitre_technique": "|T1204|T1189|T1193|T1192|T1566",
            "name": "Endpoint Uncleaned Malware Detection",
            "operationalize": "When this occurs, you should begin a standard incident response process on this host.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malware_investigation"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/endpoint_uncleaned_malware.png",
            "relatedUseCases": [
                "Large_Web_Upload",
                "showcase_huge_volume_dns_volume",
                "detection_long_dns_text_response",
                "detection_malicious_powershell_process_obfuscation_techniques",
                "sser_tor_traffic"
            ],
            "released": "2.0.0",
            "relevance": "For all the environments, uncleaned malware means that there is still malware located in your environment. For environments that are handling GDPR, article 32 requires that you regularly test, assess and evaluate the effectiveness of your implemented technical and organizational security controls. If the Authority executes their powers and your Organization is in the scope of a Privacy Audit you need to demonstrate compliance (Article 58). Also in case you face a breach and individuals are impacted they have the right to compensation of the damage - if an organization can prove that they have done everything appropriate to the risk and deployed proper countermeasures, they shouldn't be liable (Article 82). Clearing out viruses can be considered in most cases as appropriate and your organization should be able to prove compliance.",
            "searchKeywords": "",
            "similarUseCases": [
                "Outdated_Malware_Definitions",
                "high_number_of_hosts_not_updating_malware_signatures",
                ""
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0031": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Accounts designated for use by services and batch process should start a limited set of child processes. Creation of new child processes other than the process name defined in the service or batch definition may indicate compromise.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Service Account Starting Unexpected Processes",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0035": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Following a successful authentication, an attacker will attempt to determine what resources may be accessed without causing host intrusion or DLP technologies to detect activity. Commonly the attacker will enumerate and browse to shares, access email, access web applications, or connect to databases yet perform minimal or no activity.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Compromised account access testing",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0036": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Following a successful authentication, an attacker will attempt to determine what resources may be accessed without causing host intrusion or DLP technologies to detect activity. Commonly the attacker will enumerate and browse to shares, access email, access web applications, or connect to databases yet not perform any or minimal activity. Typically Critical and Sensitive systems (during routine use) would not log access denied events.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Compromised account access testing (Critical/Sensitive Resource)",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0037": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Network Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "IDS or IPS",
            "description": "IDS devices reporting an attack using a signature not previously encountered are more likely be successful as new signatures are prompted by newly know attacks in the wild.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Network Intrusion - New Signatures",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0041": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Unauthorized Software|Compliance",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication|Network Communication",
            "description": "Authentication using insecure protocol SSHv1 detected. The legacy SSH protocol is inherently insecure indication of accepted SSHv1 sessions indicate a mis-configured system. Attempted and denied sessions indicate system probing or scanning.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "SSH v1 detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0042": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Compliance|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "The public key utilized for authentication is recorded in the SSHD authentication log. Detection of a new key should be investigated to determine the owner of the key and validate authorization to access the resource.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "SSH Authentication using unknown key",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Compliance"
        },
        "uc0044": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise|Compliance|Network Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Even using SSH encryption, allowing password authentication to Linux/Unix systems over the network increases the attack surface and the possible impact of a compromised account. Investigate and resolve all instances of network authentication utilizing password.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Network authentication using password auth",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0046": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Operations",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "Failure to synchronize time will impact the usefulness of security log data from the endpoint, and potentially prevent valid authentication.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Endpoint failure to sync time",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0049": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Data Exfiltration|Command and Control|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "DNS",
            "description": "Endpoint utilizing DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls. Detected by large total size of DNS traffic OR large number of unique queries.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detection of DNS Tunnel",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "uc0050": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Compliance|Operations|Scanning",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Communication to an enclave network should only occur from another enclave network or sanitizing servers such as proxy or jump systems.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Communication to an enclave network from an non-enclave network",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0051": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Insider Threat",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Physical Security",
            "description": "A user with continuous physical access failures could be someone searching for a physical vulnerability within the organization.  When this occurs in an area that is protecting CIP assets, it is something that should be followed up on immediately. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Excessive physical access failures to CIP assets",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "uc0052": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Insider Threat",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "CIP assets require special protections; therefore, users that have not been vetted for CIP access, or should have had their access removed, should not have access.  System owners should be notified immediately should a non-CIP user attempt to access a CIP asset. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Non-CIP user attempts to access CIP asset",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "uc0053": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "IDS or IPS",
            "description": "Detect attempted network intrusions by src_ip when the same source is observed with two or more unique destinations or one destination and two or more signatures",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Network Intrusion Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0054": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Command and Control",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Detect communication with command and control system from a compromised endpoint by identifying traffic allowed by the forward proxy with unknown or uncategorized sites where the endpoint communicates in at least 15 of the last 60 minutes (bins) and the destination is not on a noise suppression white list, the Alexa top 1M, or advertising domains list.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Communication with command and control over HTTP(s)",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0055": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Unauthorized Software|Compliance",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Detect when an endpoint is permitted external access by the web proxy where the category is known it indicate high risk by category. This list should not include undesirable but frequent categories such as social media, porn, time wasting, or advertising.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Allowed Communication from a endpoint with external &quot;risky&quot; category",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0057": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Operations|Compliance|Unauthorized Software",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Email",
            "description": "Utilize email logs to identify users being welcomed to a cloud service on an identified risky list for the first time, notify the user to be aware the service is not approved and notify the users manager if known by identity. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Audit",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Identify users of Cloud Services that may not be approved",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0065": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Compliance|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Malware detection on an asset designated as compliance such as PCI, CIP or HIPPA requires review even when automatic cleaning has occurred.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Malware detected compliance asset",
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "Recurring_Infection_on_Host",
                "high_number_of_infected_hosts",
                "host_with_a_recurring_malware_infection",
                "host_with_multiple_infections",
                "UC0029",
                "UC0028",
                "UC0075"
            ],
            "usecase": "Advanced Threat Detection|Compliance"
        },
        "uc0071": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "For employers that allow remote external connectivity the detection of two or more distinct values of external source IP address for successful authentications to a remote access solution in a short period of time indicates a likely compromise of credentials.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Fast IP Change Between Remote Authentications",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0072": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Operations|Network Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "DNS",
            "description": "Detection of an endpoint utilizing DNS as a method of proxying by querying for wpad.registrationdomain. Search for reply NXDOMAIN replies for A/AAA queries for wpad (bare host) and wpad.* where the domain portion is not a company owned domain.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detection of unauthorized using DNS resolution for WPAD",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0073": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Endpoint anti-malware detection event occurred where the malicious content was retrieved from an external URL. Possible indication of gaps in protection by web proxy, intrusion prevention, or advanced threat prevention. Use the information available for the event and determine how existing prevention controls can be modified to prevent future infections.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Endpoint detected malware infection from URL",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0074": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Network Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "IDS or IPS",
            "description": "IDS/IPS detecting or blocking an attack based on a known signature.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Network Intrusion Internal Network",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0075": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Network Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Malware Detonation",
            "description": "Internal malware detection system such as FireEye devices reporting an attack.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Network Malware Detection",
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "Basic_Malware_Outbreak",
                "Recurring_Infection_on_Host",
                "high_number_of_infected_hosts",
                "host_with_a_recurring_malware_infection",
                "host_with_multiple_infections",
                "UC0029",
                "UC0028",
                "UC0065"
            ],
            "usecase": "Security Monitoring"
        },
        "uc0077": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Unauthorized Software",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Email|Web Server",
            "description": "Maintain a tracking list of public domain suffix and data source &quot;seen&quot; by first epoch. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detection Risky Referral Domains",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0079": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Insider Threat|Lateral Movement|Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Use of an identity identified as privileged to access a system for the first time within a rolling time period will trigger a notable event for review of access reason.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Privileged Identity accessing New or Rare Sensitive Resource",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "uc0082": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Lateral Movement|Scanning|Network Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Communication from an enclave network may indicate a misconfiguration that could weaken the security posture of the organization or actual/attempted compromise. Communication filtered by the default rule implies no explicit permission for communication has been granted and should be reviewed. Consider ingress communication allowed by the default rule, and egress communication allowed or blocked.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Communication with enclave by default rule",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "uc0083": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Scanning|Network Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Communication from a enclave network may indicate a misconfiguration that could weaken the security posture of the organization or actual/attempted compromise. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "New Rule allowing Traffic to or from Protected Network",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0084": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Operations",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Ticketing System",
            "description": "Define and maintain event types for unsuppressed notable events separately identifying review workflow, and triage SLA required.",
            "displayapp": "Splunk Professional Services",
            "domain": "Operations",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_5",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Monitor Execution of Triage Activity",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0085": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Web Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "Communication to any web application server without filtering by a network web application firewall indicates a security misconfiguration.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "WAF Logs Show Unexpected Source IP",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Application Security"
        },
        "uc0087": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Compliance|Operations",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Malware signature last updated on a asset designated as compliance such as PCI, CIP or HIPAA beyond SLA limits.  SLA in this use case refers to policy levels more than the traditional service level agreement. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Malware signature not updated by SLA for compliance asset",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0088": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Sharing",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detection of logon device by asset name (may require resolution from IP) when logon user does not match the owner and the number of unique owned devices is greater than two in the prior 24 hours.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "User account sharing detection by source device ownership",
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Security Monitoring"
        },
        "uc0090": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Lateral Movement|Compliance|Account Compromise|Account Sharing",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detection of logon with the same account to a production and a non production environment. If an account (not user) has logged into more than one account, access management controls have failed and must be remediated.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "User account cross enclave access",
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Security Monitoring|Compliance"
        },
        "uc0091": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Operations",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication|Host-based IDS",
            "description": "Using host based logs such as firewall or host intrusion detection for each asset with a governance category verify communication (accept or reject) has occurred with origination from one or more authorized platform vulnerability scanners (e.g. Rapid7, Nessus, OpenVAS).",
            "displayapp": "Splunk Professional Services",
            "domain": "Operations",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Validate Execution of Platform Vulnerability Scan",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0092": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Web Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication|Host-based IDS",
            "description": "Using web application access logs for assets deemed high/critical or with the governance attributed ensure the source IP address is one of the approved NLB or WAF devices. If WAF devices are placed in front of NLB devices ensure the first &quot;x-forwardedfor&quot; entry is the address of the WAF.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Exception to Approved Flow for Web Applications",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Application Security"
        },
        "uc0095": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Web Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "High numbers of http error codes likely indicate a problem with the web application or server, or can be an indicator of malicious action. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detect Excessive Increase in HTTP Error Codes by Src",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Application Security"
        },
        "uc0096": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Network Attack|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Anti-Virus|IDS or IPS|Host-based IDS",
            "description": "Hosts with multiple indicators are likely infected with malware or successfully compromised. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Network Intrusion Event Detected on Malware Infected Host",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "uc0097": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise|Account Sharing",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Executive or VIP user credentials should be limited to assets that can be attributed to them. Any unusual or newly seen authentication activity should be considered suspect, where their credentials may be compromised.",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "Yes",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Newly Seen Authentication Behavior from VIP or Executive User",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0098": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise|Insider Threat|Data Exfiltration",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Excessive proxy blocks can be a good indicator of a potential automated beacon or malware phone home. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Excessive Proxy Denies by Single Host",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "uc0099": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Web Attack|Scanning",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "Detect excessive number of http status messages indicating error (400/500 errors), followed by an http status of 200 by src and uri. Can be a high indicator of unauthorized access or attempt to execute malicious commands.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "HTTP Brute Force Activity Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "basic_brute_force",
                "brute_force_access_behavior_detected",
                "brute_force_access_behavior_detected_over_one_day",
                "excessive_failed_logins",
                "UC0108",
                "UC0109"
            ],
            "usecase": "Security Monitoring|Application Security"
        },
        "uc0100": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Web Attack",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Server",
            "description": "Host and Network IDS event categories, detect events with a category of 'backdoor' or 'trojan' followed by a signature categorized as 'post exploit' on a given host or network within a given time period.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Newly Seen File Successfully Executed by Web Application",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Application Security"
        },
        "uc0101": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Privilege Escalation|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detect attempts to gain persistence through newly seen/unauthorized scheduled tasks per host.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Newly Seen Scheduled Task Detected by Host",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0102": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Scanning|Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Traditional brute force attacks generate hundreds or thousands of failed access attempts against a single host. This is a variation of brute force, where the objective is to detect password guessing attempts that do not cause account lockouts or will not trigger other &quot;failed access&quot; notable events. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Slow/Controlled Password Guessing Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0103": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Scanning|Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detect lateral movement by searching for hosts with an unusually high number of connections to hosts it has never connected to before, within a given time period.",
            "displayapp": "Splunk Professional Services",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "High Number of Newly Seen Connections to Internal Hosts",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "uc0104": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "IDS or IPS|Host-based IDS",
            "description": "Host and Network IDS event categories, detect events with a category of 'backdoor' or 'trojan' followed by a signature categorized as 'post exploit' on a given host or network with a given time period.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_3",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Chained Exploit Followed by Suspicious Events Detected",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0105": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Endpoint Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Web Server|Web Application Firewall",
            "description": "Internal web applications often contain sensitive information and should be controlled. Multiple technologies can be used to detect rogue web applications, including Imperva WAF and/or Splunk App for Stream. Use one of these technologies to detect web applications in the environment that have not been seen internally before.",
            "displayapp": "Splunk Professional Services",
            "domain": "Endpoint",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Detect Newly Seen Public Web Application (Internal)",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection"
        },
        "uc0106": {
            "SPLEase": "None",
            "alertvolume": "Other",
            "app": "Splunk_Professional_Services",
            "category": "Account Compromise",
            "dashboard": "PS_Use_Case",
            "deprecated_not_used_anymore_datasource": "Audit Trail",
            "description": "Detect evasion/escalation technique where the password of a privileged user reset by another authorized account this should be rare and supported by appropriate trouble ticketing and authentication of the requesting user. ",
            "displayapp": "Splunk Professional Services",
            "domain": "Access",
            "hasSearch": "No",
            "help": "Help not needed -- PS Use Case",
            "highlight": "No",
            "icon": "PS_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_2",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Reset of password other than by self for privileged user",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "uc0107": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Activity Expired Identity GDPR - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "The GDPR requires that only authorized individuals access personal data. Alert when the account of a past employee is used to log into GDPR-tagged systems",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Activity Expired Identity GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Activity Expired Identity GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Impact:</h4><p>Detecting and proving that only individuals who are authorized to access, handle, and process personal data is an industry best practice and can be considered an effective security control, as required by Article 32. Demonstrating that any unauthorized attempts -- both failed and successful -- from past employees or employees whose authorization has expired -- as well as demonstration that any non-compliant conditions resulting in unauthorized use are properly scoped, investigated, and remediated properly, is required to prove compliance for data privacy audits from authorities (Article 58) or to counteract any compensation claims (Article 82). Additionally, data processors working on behalf of a controller within the organization need to ensure, per Article 28, that only authorized individuals have access to personal data.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
            "highlight": "No",
            "howToImplement": "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "If you are still using an account after the user is disabled, you will see alerts (e.g., if you provide the manager with access to log in as the user).",
            "mitre": "Credential Access|Privilege Escalation",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_technique": "|T1078",
            "name": "Activity from Expired User Identity - on Category",
            "operationalize": "The first thing to understand after this alert fires is whether this was some continuation of normal system operations (e.g., the desktop under their desk was still logged in, or iPhone account still active) versus a deliberate action. Obviously success or failure also carries weight. Finally, particularly for sysadmin type employees in less structured organizations, it's important to make sure that there are no services or scheduled jobs running under that account where disabling the account outright might impact operations.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_activity_from_expired_account.png",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Compliance"
        },
        "uc0108": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Brute Force GDPR - Demo",
            "data_source_categories": "DS003Authentication-ET02Failure|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "Monitor your security controls and prove your GDPR compliance by detecting brute force (or password guessing) attacks on GDPR-tagged systems.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Brute Force GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Brute Force GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Problem:</h4><p>Attackers leverage brute-force authentication attempts to bypass weak cryptographic standards, or to exploit infrastructure or applications where password best practices are not consistently applied. </p><h4>Impact:</h4><p>Brute force access is a common attack vector. Under the GDPR, monitoring and demonstrating that security controls are effective is required by Article 32, therefore immediate awareness of any brute force attempts is critical to maintaining compliance posture. Demonstrating that any such attempts have not been successful will help to prove compliance for data privacy audits initiated by data privacy authorities (Article 58) and also help counteract compensation claims (Article 82).</p><h4>Resolution Path:</h4><p>Identify GDPR-relevant resources and systems and monitor for a large number of authentication failures within a short time period, on any of those resources or systems. It is important to adjust for the scenario where a single source (such as a web app) might centralize the authentication for a large number of users, to reduce false positives.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
            "highlight": "Yes",
            "howToImplement": "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
            "mitre": "Credential Access|Privilege Escalation",
            "mitre_tactic": "TA0006|TA0004",
            "mitre_technique": "|T1110|T1078",
            "name": "Brute Force Access Behavior Detected - Against Category",
            "operationalize": "When this search fires, the immediate concern is that the brute force search was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_brute_force.png",
            "released": "2.0.0",
            "relevance": "Monitoring that your security controls are effective is required by Article 32 and will help you to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82). ",
            "searchKeywords": "",
            "similarUseCases": [
                "basic_brute_force",
                "brute_force_access_behavior_detected",
                "brute_force_access_behavior_detected_over_one_day",
                "excessive_failed_logins",
                "UC0099",
                "UC0109"
            ],
            "usecase": "Compliance"
        },
        "uc0109": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Brute Force Slow and Low GDPR - Demo",
            "data_source_categories": "DS003Authentication-ET02Failure|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "Monitor your security controls and prove your GDPR compliance by detecting slow and low brute force (or password guessing) attacks on GDPR-tagged systems that occur gradually over the day.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Brute Force Slow and Low GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Brute Force Slow and Low GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Problem:</h4><p>Attackers leverage brute-force authentication attempts to bypass weak cryptographic standards, or to exploit infrastructure or applications where password best practices are not consistently applied. </p><h4>Impact:</h4><p>Brute force access is a common attack vector. Under the GDPR, monitoring and demonstrating that security controls are effective is required by Article 32, therefore immediate awareness of any brute force attempts is critical to maintaining compliance posture. Demonstrating that any such attempts have not been successful will help to prove compliance for data privacy audits initiated by data privacy authorities (Article 58) and also help counteract compensation claims (Article 82).</p><h4>Resolution Path:</h4><p>Identify GDPR-relevant resources and systems and monitor for a large number of authentication failures within a short time period, on any of those resources or systems. It is important to adjust for the scenario where a single source (such as a web app) might centralize the authentication for a large number of users, to reduce false positives.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
            "highlight": "No",
            "howToImplement": "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
            "mitre": "Credential Access|Privilege Escalation",
            "mitre_tactic": "TA0006|TA0004",
            "mitre_technique": "|T1110|T1078",
            "name": "Brute Force Access Behavior Detected Over One Day - Against Category",
            "operationalize": "When this search fires, the immediate concern is that the brute force search was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_brute_force_one_day.png",
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "basic_brute_force",
                "brute_force_access_behavior_detected",
                "brute_force_access_behavior_detected_over_one_day",
                "excessive_failed_logins",
                "UC0099",
                "UC0108"
            ],
            "usecase": "Compliance"
        },
        "uc0110": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Expected Host GDPR - Demo",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "GDPR requires an audit trail for all activities, which means we should be receiving events constantly. Find GDPR-tagged systems that are no longer reporting events but should be.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Expected Host GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Expected Host GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Problem:</h4><p>Many compliance and regulatory frameworks contain clauses specifying requirements for central logging of event data, as well as retention periods and use of that data to assist in detecting data breaches and investigation and handling of threats. These regulations also specify that a mechanism exist to notify when critical systems stop forwarding event data. For example, tracking of \u201cinitialization, stopping, or pausing of audit logs\u201d. This is directly related to the fact that commonly, the intent behind disruption to event data forwarding is malicious, e.g. an attempt to evade a preventive measure or to avoid detection. </p><h4>Impact:</h4><p>The GDPR requires that organizations collect the full audit trail of data processing activities of involved systems and applications. This can impact the organization via a wide array of GDPR articles. If breached, Article 33 requires organizations to inform the authorities, including details about the nature of the breach, such as how many individuals have been affected. The same requirement is in Article 34 for when organizations must identify which individuals are affected, in order to notify them if there is a high risk related to their individual data. If organizations do not store the requisite logs and are therefore not able to proper scope the impact, data privacy officers will need to assume the worst case scenario: all personal data that was stored or processed in the breached environment or accessible by the breached user was affected. In addition, Article 32 requires implementation of proper security controls, and for organizations to monitor, test, and demonstrate their effectiveness. If an organization experiences that logging stops for a particular host or set of hosts, then the organization will not be able to prove the status and effectiveness of the applied security controls on those systems, in the event of damage claims (Article 82) or privacy audits (Article 58). If the organization lacks host logs and corresponding application logs, they will not be able to prove which records have been processed, such as proving that a record was deleted according to an individual's delete request (Article 17) or proving compliance with a processing restriction requested by an individual (Article 18 and Article 21). If a host does not report event data, a processor cannot prove that only authorized individuals have accessed the data (Article 28).</p><h4>Resolution Path:</h4><p>Identify all GDPR-relevant IT assets from the data mapping exercise conducted by the Data Privacy Officer\u2019s team -- that is, all IT assets that are relevant to the full audit trail of data processing activities. This includes not only data stores and repositories that house sensitive PD / PII, but also any technologies that are involved in the processing, storage, transmission, receipt, rendering, encrypt/decrypt, relaying, and any other function that involves handling that data in any capacity. Ensure that those assets are configured properly to report logging activity to an appropriate central repository. Monitor for changes in logging status, adjust for known outages, and prioritize incident response for any failures to report by hosts that are not scheduled for downtime.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is the result of the live search (querying basic logs in Splunk), after a host goes offline.",
            "highlight": "Yes",
            "howToImplement": "First, use your data mapping results to build a lookup that associates systems to their GDPR category. All that is required for this search is to have a valid GDPR lookup, and then any logs in Splunk.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "The only known situation is where the host goes offline, but you are still tracking it as being required and in scope.",
            "mitre": "",
            "mitre_notes": "GDPR related, not ATT&CK",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Expected Host Not Reporting - in Category",
            "operationalize": "When this alert fires, the first task will be to see if the host is still alive. If it is, you will need to see if Splunk is still running, or if there are other interruptions to logging. Stopped logging services can indicate an intrusion, so keep an eye out for any indications of malicious behavior.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_expected_host.png",
            "released": "2.0.0",
            "relevance": "GDPR requires that you collect the full audit trail of data processing activities and involved systems. If you're breached - Article 33 requires you to inform the authorities including details about the nature of the breach such as how many individuals have been affected. The same requirement is in Article 34 for when your organization has to identify which individuals are affected. If you do not have the logs and can't scope it down, you have to assume the worst case scenario: that all the data was affected. In addition: article 32 requires that you implement proper security controls and test their effectiveness. If you stop seeing logs for a host, then you will not be able to prove the status of the applied security controls on their machine, in case of damage claims (82) or privacy audits (58). Penultimately: if you lack host logs, you can't prove which records have been processed, such as proving that you delete a record according an individual's delete request (Article 17) or proving that you complied with a processing restriction requested by an individual (Article 18 and Article 21). Finally: if a host does not report it's event data \u2013 a processor can't prove that only authorized individuals have accessed the data.",
            "searchKeywords": "",
            "usecase": "Compliance"
        },
        "uc0111": {
            "SPLEase": "Advanced",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|Cloud Security",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Land Speed GDPR - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-sfdc-elf|VendorSpecific-aws-cloudtrail",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "To ensure you have a GDPR-mandated audit trail with individual accounts for each person, detect when the same account is logged into twice in a short period of time but from locations very far away, to a GDPR-tagged system.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Land Speed GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Land Speed GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Problem:</h4><p>When monitoring user activity, a key indicator to look for is anomalous authentication attempts (see method above, \u201cBrute Force Access Behavior Detected\u201d). These can point to evidence of stolen or exploited credentials. Concurrent authentication attempts from multiple IP addresses can indicate unauthorized sharing of credentials, or even stolen credentials; and improbable travel anomalies, such as logging in from two geographically distant locations at the same time, which can be an indicator of exploited or misused credentials. </p><h4>Impact:</h4><p>Detecting and proving that individuals within the organization are not sharing user accounts for accessing and processing personal data is an industry best practice and can be considered an effective security control, as required by Article 32. Demonstrating that credentials are not being misused or exploited will help to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82). This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p><h4>Resolution Path:</h4><p>Ensure you have a GDPR-mandated audit trail with individual user accounts for each processor accessing personal data. Detect when the same account is logged into twice in a short period of time but from multiple locations far away from each other, to a GDPR-tagged system.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Salesforce.com logs, during which someone logs in from opposite ends of the earth. Our live search looks for the same activity across the standard index and sourcetype of SFDC data. For this use case, you can use any kind of data source, including VPN logs and others.",
            "highlight": "Yes",
            "howToImplement": "First, use your data mapping results to build a lookup that associates systems to their GDPR category. Then you just need a log source that provide external IP addresses. If you are using SFDC data, as we are in the live example, it will work easily. Otherwise, any data source that is compliant with the Splunk Common Information Model (so that it contains a src_ip field) should work pretty automatically.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "There are two big buckets for false positives. One is where the geoip is unreliable -- particularly outside of major economic areas (e.g., US, larger countries in Western Europe), the free MaxMind GeoIP that ships with Splunk Enterprise tends to be less accurate, causing some customers to add the paid version in their Splunk installations. The other big categories is where IPs are centralized, such as someone in the US using a Korean VPN service, or using a networking service that originates nation-wide traffic from the same set of IPs (for example, years ago all traffic from a major US cellular carrier originated from the same IP space that was geolocated to Ohio).",
            "mitre": "Credential Access",
            "mitre_tactic": "TA0001",
            "mitre_technique": "|T1078",
            "name": "Geographically Improbable Access Detected against Category",
            "operationalize": "When this fires, you should reach out to the user involved to see if they're aware of why their account was used in two places. You should also see what actions were taken, particularly if one of the locations was unusual. If the user is not aware of the reason, it's important to also ask if the user is aware of sharing their credentials with anyone else. You can also see what other activities occurred from the same remote IP addresses.",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_land_speed.png",
            "released": "2.0.0",
            "relevance": "Detecting and proving that your organizations environment does not use shared user accounts for accessing and processing personal data is industry best practice and should be considered as a effective security control which is required by Article 32 and will help you to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82).",
            "searchKeywords": "land speed superman landspeed",
            "usecase": "Compliance"
        },
        "uc0112": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|Operations",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Update Service GDPR - Demo",
            "data_source_categories": "DS019PatchManagement-Eligible",
            "deprecated_not_used_anymore_datasource": "Patch Management",
            "description": "Any GDPR-tagged systems not receiving updates could jeopardize your GDPR status due to Article 32. Detect systems where the Windows Update service is disabled.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Update Service GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Update Service GDPR - Live"
                }
            ],
            "gdpr": "32|58|82",
            "gdprtext": "<h4>Problem:</h4><p>Keeping up with patch maintenance is a critical part of effective cyber-hygiene. Windows-based systems are especially at risk when unpatched, considering the number and frequency of exploits that use Windows vulnerabilities to establish a foothold, move laterally, or propagate. Windows-based systems that stop updating may be the target of malicious activity -- or, the same type of event may simply be the result of an environmental change, other configuration issue on the host, or scheduled downtime. If the update service itself it disabled on the host, then it may indicate a compromised system.</p><h4>Impact:</h4><p>Unpatched systems put data at risk. For any unpatched environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context, since any GDPR-tagged systems not receiving updates could jeopardize a state of compliance. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><h4>Resolution Path:</h4><p>The data mapping exercise from the DPO can inform which Windows-based systems are in-scope -- that is, those systems that are associated with the GDPR category. From there, identify the in-scope systems where updates are not occurring, pinpoint the root issue for updates not occurring, and remediate those hosts by configuring them or the environment appropriately, depending on what the root issue turns out to be.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Windows Service logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standard sourcetypes.",
            "highlight": "Yes",
            "howToImplement": "First, use your data mapping results to build a lookup that associates systems to their GDPR category. If you are using the Windows Forwarder with the WinHostMon://Service input configured, this search should work automatically. If you're using another source to detect Service status, you may need to adjust the search string to match your data source.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "No known false positives at this time.",
            "mitre": "",
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "|TA0005",
            "mitre_technique": "|T1089",
            "name": "In-Scope System with Windows Update Disabled",
            "operationalize": "When Windows Update is disabled, the immediate question is why. Ask the user if they disabled it, look for software installations that might have done it, or look for any errors related to the Windows Update Service (wuauserv.exe).",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_windows_update_disabled.png",
            "released": "2.0.0",
            "relevance": "GDPR Article 32 requires that you regularly test, assess and evaluate the effectiveness of your implemented technical and organizational security controls. If the Authority executes their powers and your Organization is in the scope of a Privacy Audit you need to demonstrate compliance (Article 58). Also in case you face a breach and individuals are impacted they have the right to compensation of the damage - if an organization can prove that they have done everything appropriate to the risk and deployed proper countermeasures, they shouldn't be liable (Article 82). Ensuring patches are applied to your systems is industry best practices and state of the art.",
            "searchKeywords": "",
            "similarUseCases": [
                "UC0115"
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0114": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|Operations",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=New Connection GDPR - Demo",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Alert Data Protection Officers to new systems that become involved in processing GDPR-scoped data via network communication logs, so DPOs can ensure the systems are authorized and documented.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "New Connection GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "New Connection GDPR - Live"
                }
            ],
            "gdpr": "",
            "gdprtext": "<h4>Problem:</h4><p>Data Protection Officers need to be alerted when new systems become involved in processing personal data under the scope of the GDPR, in order to ensure the systems are authorized and processing is properly documented.</p><h4>Impact:</h4><p>In addition to general security benefits, this detection will help inform the data privacy officer whether any new connections have been established to applications or service providers. For these connections, pushing or pulling personal data can be out of compliance. Under Article 30, organizations are required to maintain a record of processing activities, including the name and contact details of the controller, the purposes of the processing, description of the categories of data subjects and personal data processed. Additionally, they must maintain record of categories of recipients to whom the personal data have been or will be disclosed, including recipients in third countries or international. Detecting any new connected applications or service providers which might not be whitelisted or documented, can indicate a potential state of non-compliance state and the Data Privacy Officer will be required to follow up and document. This situation may not impact organizations who employ fewer than 250 persons and therefore may not have critical categories of personal data for processing.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Firewalls or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "First, use your data mapping results to build a lookup that associates systems to their GDPR category. This search should work out of the box with Palo Alto Networks firewalls, and with any other device that uses the Splunk common information model. Just make sure you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!)",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "No known false positives at this time.",
            "mitre": "",
            "mitre_notes": "Does not seem to be ATT&CK technique related",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "New Connection to In-Scope Device",
            "operationalize": "When a new host connects to an in-scope GDPR system, check to make sure it is documented.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_new_connection.png",
            "released": "2.0.0",
            "relevance": "In addition to the general security benefits, this detection will help the data privacy officer of an organization in their GDPR requirements to detect if any new applications or service providers have been connected to push or pull personal data without the proper documentation. This helps to trigger the update of the documentation and engage the DPO, enabling continuous monitoring to detect unauthorized and undocumented new applications that do not follow corporate processes.",
            "searchKeywords": "",
            "usecase": "Security Monitoring|Compliance"
        },
        "uc0115": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "GDPR|Endpoint Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Outdated Malware Definitions GDPR - Demo",
            "data_source_categories": "DS004EndPointAntiMalware-ET02UpdatedSig|DS004EndPointAntiMalware-ET03UpdatedEng",
            "deprecated_not_used_anymore_datasource": "Anti-Virus",
            "description": "Alerts when a GDPR-tagged system has out of date malware definitions, which would conflict with GDPR's requirement to maintain a secure environment.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Outdated Malware Definitions GDPR - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Outdated Malware Definitions GDPR - Live"
                }
            ],
            "gdprtext": "<h4>Problem:</h4><p>Similar to High Number of Hosts Not Updating Malware Signatures and Detection of Uncleaned Malware on Endpoint, malware can persist if an endpoint protection solution is not updating its malware signatures. Even a single host with outdated anti-malware can indicate an infection. If that host is tagged under the GDPR category, then immediate remediation is required to address that non-compliant condition.</p><h4>Impact:</h4><p>When environments that are involved in processing personal data include systems with outdated anti-malware protection (or lacking protection altogether), then those systems are at high risk and therefore out of compliance with the GDPR regulation to maintain and prove privacy requirements are being met per Article 32, Article 58, and Article 82. See above methods, High Number of Hosts Not Updating Malware Signatures and Detection of Uncleaned Malware on Endpoint.</p><h4>Resolution Path:</h4><p>The data mapping exercise from the DPO can inform which systems are in-scope -- that is, those systems that are associated with the GDPR category. From there, identify the in-scope systems with outdated anti-malware or lacking anti-malware protection, pinpoint the root issue for updates not occurring, and remediate those hosts by configuring them or the environment appropriately, depending on what the root issue turns out to be. Also see above methods, High Number of Hosts Not Updating Malware Signatures and Detection of Uncleaned Malware on Endpoint.</p>",
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
            "highlight": "Yes",
            "howToImplement": "First, use your data mapping results to build a lookup that associates systems to their GDPR category. This particular search usually finds most of its success with just Symantec AV. Many Anti-Virus products are found to provide insufficient logging to be able to see when the definitions are updated (often, just when there is malware found). If you are using Symantec AV and followed the data onboarding guide, this should work automatically. If you did not follow the data onboarding guide, make sure that your sourcetypes and indexes match. Always hard-code your sourcetypes and indexes rather than doing index=* in searches.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "knownFP": "No known false positives at this time.",
            "mitre": "",
            "mitre_notes": "Cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "In-Scope Device with Outdated Anti-Malware Found",
            "operationalize": "When this fires, look on the host to see why the Anti-Virus isn't updating. If you don't see an obvious reason (e.g., specific and logical error), then it may be worth investigating that host to see if there are any other suspicious events that have occurred to rule out an infection.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_outdated_av.png",
            "released": "2.0.0",
            "searchKeywords": "",
            "similarUseCases": [
                "UC0112"
            ],
            "usecase": "Security Monitoring|Compliance",
            "visualizations": [
                {
                    "dashboard": "General Windows and Linux Posture",
                    "header": "Broken",
                    "panel": "row1cell1",
                    "search": "| `Load_Sample_Log_Data(Symantec Endpoint Protection Operations)`  |stats max(eval(if(like(Event_Description, \"%LiveUpdate session ran successfully%\") , _time, null))) as LatestUpdate max(_time) as LatestMessage max(eval(if(tag=\"error\", _time, null))) as LatestError by Host_Name   | eval Up_To_Date = if( LatestUpdate < relative_time(LatestMessage, \"-3d\") OR LatestError > LatestUpdate , \"No\", \"Yes\") | lookup gdpr_system_category host as Host_Name| search category=* | stats count by Up_To_Date",
                    "title": "Percentage of In-Scope Hosts with Up To Date AV",
                    "type": "viz",
                    "vizParameters": {
                        "charting.chart": "pie",
                        "link.exportResults.visible": "false",
                        "link.inspectSearch.visible": "false",
                        "link.openPivot.visible": "false",
                        "link.openSearch.visible": "false",
                        "link.visible": "false",
                        "refresh.link.visible": "false",
                        "resizable": true
                    },
                    "vizType": "ChartElement"
                },
                {
                    "dashboard": "General Windows and Linux Posture",
                    "header": "Broken",
                    "panel": "row1cell2",
                    "search": "| `Load_Sample_Log_Data(Symantec Endpoint Protection Operations)`  |stats max(eval(if(like(Event_Description, \"%LiveUpdate session ran successfully%\") , _time, null))) as LatestUpdate max(_time) as LatestMessage max(eval(if(tag=\"error\", _time, null))) as LatestError by Host_Name   | eval Up_To_Date = if( LatestUpdate < relative_time(LatestMessage, \"-3d\") OR LatestError > LatestUpdate , \"No\", \"Yes\") | search Up_To_Date = Yes | lookup gdpr_system_category host as Host_Name| search category=*| convert ctime(LatestUpdate) ctime(LatestMessage) ctime(LatestError) ",
                    "title": "Hosts with Up To Date AV",
                    "type": "viz",
                    "vizParameters": {
                        "link.exportResults.visible": "false",
                        "link.inspectSearch.visible": "false",
                        "link.openPivot.visible": "false",
                        "link.openSearch.visible": "false",
                        "refresh.link.visible": "false",
                        "resizable": true
                    },
                    "vizType": "TableElement"
                },
                {
                    "dashboard": "General Windows and Linux Posture",
                    "header": "Broken",
                    "panel": "row1cell3",
                    "search": "| `Load_Sample_Log_Data(Symantec Endpoint Protection Operations)`  |stats max(eval(if(like(Event_Description, \"%LiveUpdate session ran successfully%\") , _time, null))) as LatestUpdate max(_time) as LatestMessage max(eval(if(tag=\"error\", _time, null))) as LatestError by Host_Name   | eval Up_To_Date = if( LatestUpdate < relative_time(LatestMessage, \"-3d\") OR LatestError > LatestUpdate , \"No\", \"Yes\") | search Up_To_Date = No | lookup gdpr_system_category host as Host_Name| search category=* | convert ctime(LatestUpdate) ctime(LatestMessage) ctime(LatestError)",
                    "title": "Hosts with Expired AV",
                    "type": "viz",
                    "vizParameters": {
                        "link.exportResults.visible": "false",
                        "link.inspectSearch.visible": "false",
                        "link.openPivot.visible": "false",
                        "link.openSearch.visible": "false",
                        "refresh.link.visible": "false",
                        "resizable": true
                    },
                    "vizType": "TableElement"
                }
            ]
        },
        "unauthorized_foreign_country_call": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Compliance",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
            "deprecated_not_used_anymore_datasource": "Other",
            "description": "<p>Tracking unauthorized users who are call foreign countries is very important to organizations subject to certain rules. Find those users with Splunk.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Audit",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": " - Demo"
                },
                {
                    "label": "Live Data",
                    "name": " - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": " - Accelerated"
                }
            ],
            "hasSearch": "No",
            "help": "<p>This example leverages the first time seen search assistant. Our dataset is an anonymized collection of phone records, that we will filter for just the phone ranges that belong to our competitors.</p>",
            "highlight": "No",
            "howToImplement": "<p>There are a few components to implementing this detection -- handling your CDR logs correctly, then resolving those calls to external countries, and maintaining an accurate list of the users who are permitted to call external countries.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "<p>The most common scenarios for false positives in this search relate to the three steps in implementing the search itself -- that phone logs formats are absolutely filled with corner cases, and that resolution of an external phone number to the country is a complicated process. Even maintaining the list of users who are permitted to call externally can be organizationally complicated.</p>",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Unauthorized Call to Foreign Country",
            "operationalize": "<p>Responding to this will depend on the requirements of your organization. This detection will only be implemented by organizations that have specific rules regulating external calls, so your next steps will be dictated by the regulations implemented on your organization.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_foreign_country_call.png",
            "released": "2.2.0",
            "relevance": "<p>Foreign Contacts Reporting is required by some organizations -- fulfill your regulatory requirements with Splunk.</p>",
            "searchKeywords": "",
            "usecase": "Compliance"
        },
        "unauthorized_login_attempt": {
            "SPLEase": "Medium",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Unauthorized Login Attempt - Demo",
            "data_source_categories": "DS003Authentication-ET02Failure|VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "<p>Most login failures are due to failed passwords. Login failure to sensitive systems where the users simply aren't authorized, though, can indicate malicious intent. Detect that.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Unauthorized Login Attempt - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Unauthorized Login Attempt - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of Windows Security logs. For this analysis, we are looking specifically for the event logs that indicate a user authenticated successfully but was not authorized (i.e., correct username and password, but not permitted to log into this system). We're looking for any user with many of these per day, that can indicate attempted access to sensitive resources.</p>",
            "highlight": "No",
            "howToImplement": "<p>Implementation of this should be easy -- just ensure that you have data being ingested from the Universal Forwarder and the Splunk Technology Add-on present, and all will work automatically.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Defense|Construction|Energy|Healthcare",
            "journey": "Stage_1",
            "killchain": "",
            "knownFP": "<p>The most likely scenario where this detection indicates a false positive is where the user's access has simply been messed up. There was an AD group change last night, and this user was accidentally removed from the \"dev_system_access\" security group. Beyond that, there's no standard pattern that would be expected for false positives.</p>",
            "mitre": "Credential Access|Privilege Escalation",
            "mitre_tactic": "TA0006",
            "mitre_technique": "|T1110",
            "name": "Detect Many Unauthorized Access Attempts",
            "operationalize": "<p>When this alert fires, investigative steps you could take are to evaluate whether this user has previously had access to the desired resources, look for recent job role changes, and look for recent changes around AD groups. In most organizations, the next escalation step would be to consult the owner of the desired resources, and/or the user's manager, to determine whether this behavior is intended. Keep an eye out for indications of malicious intent alongside potential account compromise.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_login_attempt.png",
            "released": "2.2.0",
            "relevance": "<p>In most organizations, it's rare for a user to get an unauthorized message, beyond low risk scenarios such as proxy logs. When this is occurring for higher risk activities such as system logins, file share access, etc., and when it occurs persistently for a user, there's usually reason to investigate.</p>",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Insider Threat"
        },
        "unauthorized_web_browsing": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Unauthorized Web Browsing - Demo",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "<p>Detect users who are persistently attempting to violate your proxy policy.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Network",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Unauthorized Web Browsing - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Unauthorized Web Browsing - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Unauthorized Web Browsing - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of Palo Alto Networks proxy logs. For this analysis, we are looking for any user who has a high number of denied proxy requests, excluding advertising and phishing categories.</p>",
            "highlight": "No",
            "howToImplement": "<p>There are two primary triggers for this search -- one is the categories being excluded, and the other is the number of denies that you want to trigger on. There is no standard best practice for either of these, so you can adjust these values to be whatever makes sense for your organization. The most common way we hear of this detection being described is to target suspicious internal users, so most organizations will adjust the filters to look for Acceptable Use Policy violations (e.g., browsing gambling sites) as opposed to denies that are tied to security hygiene (e.g., phishing). That said, you could absolutely implement it in both directions if you so desired. The threshold for triggering would likely be different between those categories though, as a human will likely quit relatively early when they see deny messages versus a script that gets timeouts instead of a big error message.</p><p><b>If this searches creates too many false positives in your environment</b>, it may be because some of your users just generate a very large number of proxy denies on a regular basis. The first bet for dealing with this would be basic tuning of the categories you alert on. If that is not sufficient, you can instead implement this as a per-user time series detection. Look for the # of unauthorized detections per day per user, and then alert when any user exceeds their baseline. You can base this on any of the time series detections in Splunk Security Essentials -- a common and easy one would be to look at <a href=\"/app/Splunk_Security_Essentials/showcase_standard_deviation?ml_toolkit.dataset=Increase in Interactive Logons - Demo\" target=\"_blank\">Increase in Interactive Logons</a> (just swap out the field names and base dataset and implementation will be easy). There's one important adjustment you would need in order to make that work for you though -- because most users don't see proxy denies often, most of your users will end up with very low averages and low standard deviations. To guard against this, in addition to tracking that the most recent # of denies per day is more than 3 (or 6, or whatever) stdev above the average, you should also make sure that the most recent # is more than 5 (or 10, or whatever). That way you don't accidentally alert on a user that just had one deny (no matter how anomalous a deny is for that user).</p>",
            "icon": "Core_Use_Case.png",
            "implementationNotes_Internal": "Validate in Splunk data by looking at whether we should look at dc(ut_domain) or bucket _time span=10m dc(_time) instead of just a straight count.",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Government|Defense|Media|Legal|Finance|Energy|Chemical",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "knownFP": "<p></p>",
            "mitre": "Exfiltration",
            "mitre_tactic": "TA0010|TA0011",
            "mitre_technique": "|T1048|T1071|T1102",
            "name": "Web Browsing to Unauthorized Sites",
            "operationalize": "<p>When this alert fires, look at the sites where it triggered, and importantly the # of different sites. The primary goal is to determine whether there is a persistent desire to violate policy (or any other malicious intent) or whether someone went to one site where there were 15 different requests in a short period.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment",
                "phantom_prompt_and_block_domain"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_web_browsing.png",
            "released": "2.2.0",
            "relevance": "<p>Users persistently violating acceptable use policies are risky in a number of different ways. In low grade situations, it may make sense to have HR follow up with that user. In high grade situations, it may indicate the need for an explicit intervention as the user may be a flight risk (or harbor malicious intent). In widespread scenarios, it may indicate a workplace problem that needs to be remediated. Regardless, things are blocked in your proxy for good reason -- you should track violations of those rules.</p>",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Insider Threat"
        },
        "uncommon_processes_on_endpoint": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Privilege Escalation|Unusual Processes",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Unauthorized Software",
            "dashboard": "showcase_security_content?showcaseId=uncommon_processes_on_endpoint",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2020-07-22",
            "description": "This search looks for applications on the endpoint that you have marked as uncommon.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 2",
            "escu_nist": "ID.AM|PR.DS",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. This search uses a lookup file `uncommon_processes_default.csv` to track various features of process names that are usually uncommon in most environments. Please consider updating `uncommon_processes_local.csv` to hunt for processes that are uncommon in your environment.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. This search uses a lookup file `uncommon_processes_default.csv` to track various features of process names that are usually uncommon in most environments. Please consider updating `uncommon_processes_local.csv` to hunt for processes that are uncommon in your environment.",
            "icon": "ES_Use_Case.png",
            "id": "uncommon_processes_on_endpoint",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "lookup update=true lookup_uncommon_processes_default process_name as process_name outputnew uncommon_default,category_default,analytic_story_default,kill_chain_phase_default,mitre_attack_default | lookup update=true  lookup_uncommon_processes_local process_name as process_name outputnew uncommon_local,category_local,analytic_story_local,kill_chain_phase_local,mitre_attack_local | eval uncommon = coalesce(uncommon_default, uncommon_local), analytic_story = coalesce(analytic_story_default, analytic_story_local), category=coalesce(category_default, category_local), kill_chain_phase=coalesce(kill_chain_phase_default, kill_chain_phase_local), mitre_attack=coalesce(mitre_attack_default, mitre_attack_local) | fields - analytic_story_default, analytic_story_local, category_default, category_local, kill_chain_phase_default, kill_chain_phase_local, mitre_attack_default, mitre_attack_local, uncommon_default, uncommon_local | search uncommon=true",
                    "description": "This macro limits the output to processes that have been marked as uncommon",
                    "lookups": [
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/uncommon_processes_default.csv",
                            "description": "A list of processes that are not common",
                            "filename": "uncommon_processes_default.csv",
                            "match_type": "WILDCARD(process)",
                            "name": "lookup_uncommon_processes_default"
                        },
                        {
                            "case_sensitive_match": "false",
                            "csv_file_url": "https://security-content.s3-us-west-2.amazonaws.com/lookups/uncommon_processes_local.csv",
                            "description": "A list of processes that are not common",
                            "filename": "uncommon_processes_local.csv",
                            "match_type": "WILDCARD(process)",
                            "name": "lookup_uncommon_processes_local"
                        }
                    ],
                    "name": "uncommon_processes"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "uncommon_processes_on_endpoint_filter"
                }
            ],
            "mitre_sub_technique": "T1204.002",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1204",
            "mitre_threat_groups": "Magic Hound|Windshift|APT33|Sandworm Team|Naikon|Whitefly|Tropic Trooper|Gamaredon Group|Sharpshooter|Molerats|Wizard Spider|Mofang|Frankenstein|RTM|Inception|BlackTech|APT-C-36|Machete|admin@338|APT12|TA505|Silence|The White Company|APT39|FIN4|Darkhotel|Gallmaker|APT19|Dragonfly 2.0|BRONZE BUTLER|Cobalt Group|DarkHydrus|Gorgon Group|Patchwork|OilRig|Dark Caracal|MuddyWater|Lazarus Group|FIN7|APT32|Rancor|APT37|FIN8|APT28|Elderwood|TA459|APT29|Leviathan|menuPass|PLATINUM",
            "name": "Uncommon Processes On Endpoint",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest Processes.user Processes.process Processes.process_name | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `uncommon_processes` |`uncommon_processes_on_endpoint_filter` ",
            "search_name": "ESCU - Uncommon Processes On Endpoint - Rule",
            "story": "644e22d3-598a-429c-a007-16fdb802cae5|f4368e3f-d59f-4192-84f6-748ac5a3ddb6",
            "tags": {
                "analytics_story": [
                    "Windows Privilege Escalation",
                    "Unusual Processes"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 2"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Magic Hound",
                    "Windshift",
                    "APT33",
                    "Sandworm Team",
                    "Naikon",
                    "Whitefly",
                    "Tropic Trooper",
                    "Gamaredon Group",
                    "Sharpshooter",
                    "Molerats",
                    "Wizard Spider",
                    "Mofang",
                    "Frankenstein",
                    "RTM",
                    "Inception",
                    "BlackTech",
                    "APT-C-36",
                    "Machete",
                    "admin@338",
                    "APT12",
                    "TA505",
                    "Silence",
                    "The White Company",
                    "APT39",
                    "FIN4",
                    "Darkhotel",
                    "Gallmaker",
                    "APT19",
                    "Dragonfly 2.0",
                    "BRONZE BUTLER",
                    "Cobalt Group",
                    "DarkHydrus",
                    "Gorgon Group",
                    "Patchwork",
                    "OilRig",
                    "Dark Caracal",
                    "MuddyWater",
                    "Lazarus Group",
                    "FIN7",
                    "APT32",
                    "Rancor",
                    "APT37",
                    "FIN8",
                    "APT28",
                    "Elderwood",
                    "TA459",
                    "APT29",
                    "Leviathan",
                    "menuPass",
                    "PLATINUM"
                ],
                "mitre_attack_id": [
                    "T1204"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Malicious File"
                ],
                "nist": [
                    "ID.AM",
                    "PR.DS"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 4
        },
        "unload_sysmon_filter_driver": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Disabling Security Tools",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=unload_sysmon_filter_driver",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.001/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-07-22",
            "description": "Attackers often disable security tools to avoid detection. This search looks for the usage of process `fltMC.exe` to unload a Sysmon Driver that will stop sysmon from collecting the data.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. This search is also shipped with `unload_sysmon_filter_driver_filter` macro, update this macro to filter out false positives.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. This search is also shipped with `unload_sysmon_filter_driver_filter` macro, update this macro to filter out false positives.",
            "icon": "ES_Use_Case.png",
            "id": "unload_sysmon_filter_driver",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "unload_sysmon_filter_driver_filter"
                }
            ],
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1562",
            "mitre_threat_groups": "Gamaredon Group|BRONZE BUTLER|Rocke|Kimsuky|Turla|Night Dragon|Gorgon Group|Lazarus Group|Putter Panda",
            "name": "Unload Sysmon Filter Driver",
            "references": [],
            "released": "2020-07-22",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=fltMC.exe AND Processes.process=*unload* AND Processes.process=*SysmonDrv*  by Processes.process_name Processes.process_id Processes.parent_process_name Processes.process Processes.dest Processes.user | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` |`unload_sysmon_filter_driver_filter`| table firstTime lastTime dest user count process_name process_id parent_process_name process",
            "search_name": "ESCU - Unload Sysmon Filter Driver - Rule",
            "story": "fcc27099-46a0-46b0-a271-5c7dab56b6f1",
            "tags": {
                "analytics_story": [
                    "Disabling Security Tools"
                ],
                "asset_type": "",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.001/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "BRONZE BUTLER",
                    "Rocke",
                    "Kimsuky",
                    "Turla",
                    "Night Dragon",
                    "Gorgon Group",
                    "Lazarus Group",
                    "Putter Panda"
                ],
                "mitre_attack_id": [
                    "T1562"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Disable or Modify Tools"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 3
        },
        "unroutable_activity_detected": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Scanning",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Alerts when activity to or from a host that is unrouteable is detected.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0007|TA0011",
            "mitre_technique": "|T1046|T1032|T1095|T1094",
            "name": "Unrouteable Activity Detected",
            "released": "2.0.0",
            "searchKeywords": "Unroutable",
            "usecase": "Security Monitoring"
        },
        "unsigned_image_loaded_by_lsass": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Credential Dumping",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Windows",
            "author": "Patrick Bareiss, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=unsigned_image_loaded_by_lsass",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": "",
            "date": "2019-12-06",
            "description": "This search detects loading of unsigned images by LSASS. Deprecated because too noisy.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8|CIS 16",
            "escu_nist": "DE.CM",
            "hasSearch": "Yes",
            "help": "This search needs Sysmon Logs with a sysmon configuration, which includes EventCode 7 with lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "highlight": "No",
            "how_to_implement": "This search needs Sysmon Logs with a sysmon configuration, which includes EventCode 7 with lsass.exe. This search uses an input macro named `sysmon`. We strongly recommend that you specify your environment-specific configurations (index, source, sourcetype, etc.) for Windows Sysmon logs. Replace the macro definition with configurations for your Splunk environment. The search also uses a post-filter macro designed to filter out known false positives.",
            "icon": "ES_Use_Case.png",
            "id": "unsigned_image_loaded_by_lsass",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Other tools could load images into LSASS for legitimate reason. But enterprise tools should always use signed DLLs.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "unsigned_image_loaded_by_lsass_filter"
                }
            ],
            "mitre_sub_technique": "T1003.001",
            "mitre_tactic": "TA0006",
            "mitre_tactic_display": "Credential Access",
            "mitre_technique": "T1003",
            "mitre_threat_groups": "Sandworm Team|Whitefly|Blue Mockingbird|Silence|Threat Group-3390|Leviathan|APT41|Soft Cell|TEMP.Veles|APT33|APT39|Stolen Pencil|APT32|Lazarus Group|Leafminer|Magic Hound|MuddyWater|PLATINUM|FIN8|BRONZE BUTLER|OilRig|FIN6|APT3|APT28|APT1|Ke3chang|Cleaver",
            "name": "Unsigned Image Loaded By LSASS",
            "references": [
                "https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf"
            ],
            "released": "2019-12-06",
            "search": "`sysmon` EventID=7 Image=*lsass.exe Signed=false | stats count min(_time) as firstTime max(_time) as lastTime by Computer, Image, ImageLoaded, Signed, SHA1 | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `unsigned_image_loaded_by_lsass_filter` ",
            "search_name": "ESCU - Unsigned Image Loaded by LSASS - Rule",
            "story": "854d78bf-d0e2-4f4e-b05c-640905f86d7a",
            "tags": {
                "analytics_story": [
                    "Credential Dumping"
                ],
                "asset_type": "Windows",
                "cis20": [
                    "CIS 8",
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Whitefly",
                    "Blue Mockingbird",
                    "Silence",
                    "Threat Group-3390",
                    "Leviathan",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT33",
                    "APT39",
                    "Stolen Pencil",
                    "APT32",
                    "Lazarus Group",
                    "Leafminer",
                    "Magic Hound",
                    "MuddyWater",
                    "PLATINUM",
                    "FIN8",
                    "BRONZE BUTLER",
                    "OilRig",
                    "FIN6",
                    "APT3",
                    "APT28",
                    "APT1",
                    "Ke3chang",
                    "Cleaver"
                ],
                "mitre_attack_id": [
                    "T1003"
                ],
                "mitre_attack_tactics": [
                    "Credential Access"
                ],
                "mitre_attack_technique": [
                    "LSASS Memory"
                ],
                "nist": [
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "unsuccessful_netbackup_backups": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Monitor Backup Solution",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": [
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2017-09-12",
                    "description": "This search is intended to give you a feel for how often successful backups are conducted in your environment. Fluctuations in these numbers will allow you to determine when you should investigate.",
                    "how_to_implement": "To successfully implement this search you must be ingesting your backup logs.",
                    "id": "b4d0dfb2-2195-4f6e-93a3-48468ed9734e",
                    "macros": [
                        {
                            "definition": "sourcetype=\"netbackup_logs\"",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "netbackup"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "monitor_successful_backups_filter"
                        }
                    ],
                    "name": "Monitor Successful Backups",
                    "search": "`netbackup` \"Disk/Partition backup completed successfully.\" | bucket _time span=1d | stats dc(COMPUTERNAME) as count values(COMPUTERNAME) as dest by _time, MESSAGE",
                    "tags": {
                        "analytics_story": [
                            "Monitor Backup Solution"
                        ],
                        "detections": [
                            "Unsuccessful Netbackup backups"
                        ]
                    },
                    "version": 1
                },
                {
                    "author": "David Dorsey, Splunk",
                    "date": "2017-09-12",
                    "description": "This search is intended to give you a feel for how often backup failures happen in your environments.  Fluctuations in these numbers will allow you to determine when you should investigate.",
                    "how_to_implement": "To successfully implement this search you must be ingesting your backup logs.",
                    "id": "b2178fed-592f-492b-b851-74161678aa56",
                    "macros": [
                        {
                            "definition": "sourcetype=\"netbackup_logs\"",
                            "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                            "name": "netbackup"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "monitor_unsuccessful_backups_filter"
                        }
                    ],
                    "name": "Monitor Unsuccessful Backups",
                    "search": "`netbackup` \"An error occurred, failed to backup.\" | bucket _time span=1d | stats dc(COMPUTERNAME) as count values(COMPUTERNAME) as dest by _time, MESSAGE",
                    "tags": {
                        "analytics_story": [
                            "Monitor Backup Solution"
                        ],
                        "detections": [
                            "Unsuccessful Netbackup backups"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Compliance",
            "dashboard": "showcase_security_content?showcaseId=unsuccessful_netbackup_backups",
            "data_source_categories": "DS027EndpointBackup-ET01General",
            "datamodel": "",
            "dataset": "",
            "date": "2017-09-12",
            "description": "This search gives you the hosts where a backup was attempted and then failed.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 10",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search you need to obtain data from your backup solution, either from the backup logs on your endpoints or from a central server responsible for performing the backups. If you do not use Netbackup, you can modify this search for your specific backup solution.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search you need to obtain data from your backup solution, either from the backup logs on your endpoints or from a central server responsible for performing the backups. If you do not use Netbackup, you can modify this search for your specific backup solution.",
            "icon": "ES_Use_Case.png",
            "id": "unsuccessful_netbackup_backups",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "None",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=\"netbackup_logs\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "netbackup"
                },
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "unsuccessful_netbackup_backups_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Unsuccessful Netbackup Backups",
            "references": [],
            "released": "2017-09-12",
            "search": "`netbackup` | stats latest(_time) as latestTime by COMPUTERNAME, MESSAGE | search MESSAGE=\"An error occurred, failed to backup.\" | `security_content_ctime(latestTime)` | rename COMPUTERNAME as dest, MESSAGE as signature | table latestTime, dest, signature | `unsuccessful_netbackup_backups_filter`",
            "search_name": "ESCU - Unsuccessful Netbackup backups - Rule",
            "security_domain": "endpoint",
            "story": "abe807c7-1eb6-4304-ac32-6e7aacdb891d",
            "tags": {
                "analytics_story": [
                    "Monitor Backup Solution"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 10"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Compliance",
            "version": 1
        },
        "untriaged_notable_events": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Operations|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS013TicketManagement-ET01",
            "deprecated_not_used_anymore_datasource": "Ticketing System",
            "description": "Alerts when notable events have not been triaged",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Audit",
            "gdprtext": "<h4>Impact:</h4><p>Detecting and proving that priority alerts indicating potential risk to security posture are not being processed in a timely manner is an industry best practice.</p><p>Specific to GDPR, this method is considered an effective security control, as required by Article 32. Demonstrating that noteworthy activity is being triaged and appropriately escalated will help to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82). </p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_5",
            "mitre": "",
            "mitre_notes": "Cyber hygiene",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Untriaged Notable Events",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Audit - Untriaged Notable Events - Rule",
            "usecase": "Security Monitoring|Compliance"
        },
        "unusual_activity_time": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects unusual activity time of day, or time of week by a user based on their normal access profile.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0003|TA0001",
            "mitre_technique": "|T1078",
            "name": "Unusual Activity Time",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat|Security Monitoring|Compliance"
        },
        "unusual_ad_event": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Detects rare events in Microsoft Windows logs.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "too broad for specific attack(s)",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Unusual Windows Security Event",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "unusual_aws_regions": {
            "SPLEase": "Basic",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Account Compromise|SaaS|Cloud Security",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Unusual AWS Regions - Demo",
            "data_source_categories": "VendorSpecific-aws-cloudtrail|VendorSpecific-gcp-audit|VendorSpecific-azure-audit",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Looks for activity in IaaS Regions that have not been used before across the organization.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Unusual AWS Regions - Demo"
                },
                {
                    "is_live_version": true,
                    "label": "AWS Data",
                    "live_split_eligible": true,
                    "name": "Unusual AWS Regions - Live"
                },
                {
                    "label": "GCP Data",
                    "live_split_eligible": true,
                    "name": "Unusual GCP Regions - Live"
                },
                {
                    "label": "Azure Data",
                    "live_split_eligible": true,
                    "name": "Unusual Azure Regions - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetypes for AWS CloudTrail, GCP and Azure Audit, as detailed in How to Implement.",
            "highlight": "No",
            "howToImplement": "Assuming you use the ubiquitous AWS, GCP, or Azure Add-ons for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>Beyond that disclaimer, there are no known false positives from this detection.</p>",
            "mitre": "",
            "mitre_sub_technique": "T1078.004",
            "mitre_tactic": "|TA0003|TA0004",
            "mitre_technique": "|T1078",
            "name": "Unusual Cloud Regions",
            "operationalize": "When this alert fires, your first instinct should be to validate whether this is intended activity. Reach out to the account owner or the user who spun up those instances to see if this is the result of the organization expanding into new areas. Also look to see any indications of known IaaS malware, such as if hundreds of expensive instance types associated with ethereum mining are spun up.",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unusual_aws_regions.png",
            "released": "2.1.0",
            "relevance": "As a best practice, you should monitor activity across any and all IaaS regions. Frequently, organizations focus only on the activity within the set of regions they own because users/administrators look at those consoles more regularly. However, activity in other regions could be malicious activity (bitcoin mining, etc.), or even employees hiding activity where it is often overlooked. In any of these scenarios, changes like this should be monitored for and responded to.",
            "searchKeywords": "cloudtrail aws azure google gcp",
            "usecase": "Advanced Threat Detection"
        },
        "unusual_external_alarm": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Network Attack",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS012NetworkIntrusionDetection-ET01SigDetection|DS020HostIntrustionDetection-ET01SigDetected|DS004EndPointAntiMalware-ET01SigDetected|DS025IPAddressAssignment-ET01General",
            "deprecated_not_used_anymore_datasource": "DLP|IDS or IPS|Host-based IDS|Anti-Virus|Web Application Firewall",
            "description": "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Network|Endpoint|Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_5",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "This is too generic to map to a specific technique. The alarms could be from various systems",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Unusual External Alarm",
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "unusual_geolocation_of_communication_destination": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detects network events with rare destination IP geolocation.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0011|TA0010",
            "mitre_technique": "|T1071|T1095|T1094|T1048|T1041",
            "name": "Unusual Geolocation of Communication Destination",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "unusual_machine_access": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects rare device accesses in Microsoft Windows logs.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0001|TA0004",
            "mitre_technique": "|T1078",
            "name": "Unusual Machine Access",
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance"
        },
        "unusual_network_activity": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Insider Threat|Account Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detects events that have rare combination of port/application in firewall data.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "Yes",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0011",
            "mitre_technique": "|T1024|T1094|T1065",
            "name": "Unusual Network Activity",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain",
                "phantom_ip_investigate_report"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat|Security Monitoring|Insider Threat"
        },
        "unusual_time_of_badge_access": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Insider Threat",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS017PhysicalSecurity-ET01Access",
            "deprecated_not_used_anymore_datasource": "Physical Security",
            "description": "Detects badge access at unusual time.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Threat",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_6",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0025",
            "mitre_technique": "|T1360",
            "name": "Unusual Time of Badge Access",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "released": "2.2.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Insider Threat"
        },
        "unusual_usb_activity": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Data Exfiltration|Unauthorized Software",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
            "deprecated_not_used_anymore_datasource": "DLP|Endpoint Detection and Response",
            "description": "Generates anomalies for unusual transfers to/from USB devices. It also tracks the first time an account uses a USB and the first time a different type (e.g., vendor) of USB is used in the enterprise. ",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0010|TA0001",
            "mitre_technique": "|T1052|T1091|T1200",
            "name": "Unusual USB Activity",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_threat_hunting"
            ],
            "relatedUseCases": [
                "showcase_first_usb",
                "Basic_Malware_Outbreak",
                "outbreak_detected",
                "UC0029"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "unusual_volume_of_network_activity": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Data Exfiltration|Denial of Service",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS010NetworkCommunication-ET01Traffic",
            "deprecated_not_used_anymore_datasource": "Network Communication",
            "description": "Detects unusual network traffic that may be indicative of a DoS attack as indicated by a high number of unique sources or a high volume of firewall packets",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_notes": "DoS is not covered in MITRE ATT&CK",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Unusual Volume of Network Activity",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain",
                "phantom_ip_investigate_report"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Unusual Volume of Network Activity - Rule",
            "usecase": "Insider Threat|Application Security|Advanced Threat Detection"
        },
        "unusual_vpn_login_geolocation": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Account Sharing",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS003Authentication-ET01Success",
            "deprecated_not_used_anymore_datasource": "Authentication",
            "description": "Detects rare authentication locations in VPN data using geolocation.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0001",
            "mitre_technique": "|T1078",
            "name": "Unusual VPN Login Geolocation",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "released": "2.0.0",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "unusual_web_browser": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Endpoint Compromise|Unauthorized Software",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Detects rare events for user agent string, device, and username in outbound HTTP data.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_tactic": "|TA0011|TA0010",
            "mitre_technique": "|T1071|T1041",
            "name": "Unusual Web Browser",
            "phantomPlaybooks": [
                "phantom_malware_investigation",
                "phantom_prompt_and_block_domain"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring"
        },
        "unusually_long_command_line": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Command-Line Executions|Unusual Processes|Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=unusually_long_command_line",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-12-08",
            "description": "Command lines that are extremely long may be indicative of malicious activity on your hosts.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships, from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the process field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that tracks process activity, including parent-child relationships, from your endpoints to populate the Endpoint data model in the Processes node. The command-line arguments are mapped to the process field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "unusually_long_command_line",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Some legitimate applications start with long command lines.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "unusually_long_command_line_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Unusually Long Command Line",
            "references": [],
            "released": "2020-12-08",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes by Processes.user Processes.dest Processes.process_name Processes.process | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`|  eval processlen=len(process) | eventstats stdev(processlen) as stdev, avg(processlen) as avg by dest | stats max(processlen) as maxlen, values(stdev) as stdevperhost, values(avg) as avgperhost by dest, user, process_name, process | `unusually_long_command_line_filter` |eval threshold = 3 | where maxlen > ((threshold*stdevperhost) + avgperhost)",
            "search_name": "ESCU - Unusually Long Command Line - Rule",
            "security_domain": "endpoint",
            "story": "f4368ddf-d59f-4192-84f6-778ac5a3ffc7|f4368e3f-d59f-4192-84f6-748ac5a3ddb6|988C59C5-0A1C-45B6-A555-0C62276E327E|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Suspicious Command-Line Executions",
                    "Unusual Processes",
                    "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 5
        },
        "unusually_long_command_line_-_mltk": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious Command-Line Executions|Unusual Processes|Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "",
            "author": "Rico Valdez, Splunk",
            "baselines": [
                {
                    "author": "Rico Valdez, Splunk",
                    "date": "2019-05-08",
                    "description": "This search is used to build a Machine Learning Toolkit (MLTK) model to characterize the length of the command lines observed for each user in the environment. By default, the search uses the last 30 days of data to build the model. The model created by this search is then used in the corresponding detection search, which identifies outliers in the length of the command line.",
                    "how_to_implement": "You must be ingesting endpoint data and populating the Endpoint data model. In addition, you must have the Machine Learning Toolkit (MLTK) version >= 4.2 installed, along with any required dependencies. Depending on the number of users in your environment, you may also need to adjust the value for max_inputs in the MLTK settings for the DensityFunction algorithm, then ensure that the search completes in a reasonable timeframe. By default, the search builds the model using the past 30 days of data. You can modify the search window to build the model over a longer period of time, which may give you better results. You may also want to periodically re-run this search to rebuild the model with the latest data. More information on the algorithm used in the search can be found at `https://docs.splunk.com/Documentation/MLApp/4.2.0/User/Algorithms#DensityFunction`.",
                    "id": "d2a4d85b-fc6a-47a0-82f6-bc1ec2ebc459",
                    "macros": [
                        {
                            "arguments": [
                                "field"
                            ],
                            "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                            "description": "convert epoch time to string",
                            "name": "security_content_ctime"
                        },
                        {
                            "definition": "summariesonly=false allow_old_summaries=true",
                            "description": "search data model's summaries only",
                            "name": "security_content_summariesonly"
                        },
                        {
                            "definition": "search *",
                            "description": "Update this macro to limit the output results to filter out false positives. ",
                            "name": "baseline_of_command_line_length___mltk_filter"
                        }
                    ],
                    "name": "Baseline of Command Line Length - MLTK",
                    "search": "| tstats `security_content_summariesonly` count min(_time) as start_time max(_time) as end_time FROM datamodel=Endpoint.Processes by Processes.user Processes.dest Processes.process_name Processes.process | `drop_dm_object_name(Processes)` | search user!=unknown | `security_content_ctime(start_time)`| `security_content_ctime(end_time)`| eval processlen=len(process) | fit DensityFunction processlen by user into cmdline_pdfmodel",
                    "tags": {
                        "analytics_story": [
                            "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
                            "Ransomware",
                            "Suspicious Command-Line Executions",
                            "Suspicious MSHTA Activity",
                            "Unusual Processes"
                        ],
                        "detections": [
                            "Detect Prohibited Applications Spawning cmd.exe",
                            "Unusually Long Command Line - MLTK"
                        ]
                    },
                    "version": 1
                }
            ],
            "category": "Malware|",
            "dashboard": "showcase_security_content?showcaseId=unusually_long_command_line_-_mltk",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2019-05-08",
            "description": "Command lines that are extremely long may be indicative of malicious activity on your hosts. This search leverages the Machine Learning Toolkit (MLTK) to help identify command lines with lengths that are unusual for a given user.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting endpoint data that monitors command lines and populates the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. In addition, MLTK version >= 4.2 must be installed on your search heads, along with any required dependencies. Finally, the support search \"Baseline of Command Line Length - MLTK\" must be executed before this detection search, as it builds an ML model over the historical data used by this search. It is important that this search is run in the same app context as the associated support search, so that the model created by the support search is available for use. You should periodically re-run the support search to rebuild the model with the latest data available in your environment.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting endpoint data that monitors command lines and populates the Endpoint data model in the Processes node. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. In addition, MLTK version >= 4.2 must be installed on your search heads, along with any required dependencies. Finally, the support search \"Baseline of Command Line Length - MLTK\" must be executed before this detection search, as it builds an ML model over the historical data used by this search. It is important that this search is run in the same app context as the associated support search, so that the model created by the support search is available for use. You should periodically re-run the support search to rebuild the model with the latest data available in your environment.",
            "icon": "ES_Use_Case.png",
            "id": "unusually_long_command_line_-_mltk",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Some legitimate applications use long command lines for installs or updates. You should review identified command lines for legitimacy. You may modify the first part of the search to omit legitimate command lines from consideration. If you are seeing more results than desired, you may consider changing the value of threshold in the search to a smaller value. You should also periodically re-run the support search to re-build the ML model on the latest data. You may get unexpected results if the user identified in the results is not present in the data used to build the associated model.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "unusually_long_command_line___mltk_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Unusually Long Command Line - MLTK",
            "references": [],
            "released": "2019-05-08",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes by Processes.user Processes.dest Processes.process_name Processes.process | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| eval processlen=len(process) | search user!=unknown | apply cmdline_pdfmodel threshold=0.01 | rename \"IsOutlier(processlen)\" as isOutlier | search isOutlier > 0 | table firstTime lastTime user dest process_name process processlen count | `unusually_long_command_line___mltk_filter`",
            "search_name": "ESCU - Unusually Long Command Line - MLTK - Rule",
            "security_domain": "endpoint",
            "story": "f4368ddf-d59f-4192-84f6-778ac5a3ffc7|f4368e3f-d59f-4192-84f6-748ac5a3ddb6|988C59C5-0A1C-45B6-A555-0C62276E327E|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Suspicious Command-Line Executions",
                    "Unusual Processes",
                    "Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns",
                    "Ransomware"
                ],
                "asset_type": "",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "unusually_long_content-type_length": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Apache Struts Vulnerability",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Web Server",
            "author": "Bhavin Patel, Splunk",
            "baselines": "",
            "category": "Web Attack",
            "dashboard": "showcase_security_content?showcaseId=unusually_long_content-type_length",
            "data_source_categories": "DS014WebServer-ET01Access",
            "datamodel": "",
            "dataset": "",
            "date": "2017-10-13",
            "description": "This search looks for unusually long strings in the Content-Type http header that the client sends the server.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 4|CIS 18|CIS 12",
            "escu_nist": "ID.RA|RS.MI|PR.PT|PR.IP|DE.AE|PR.MA|DE.CM",
            "hasSearch": "Yes",
            "help": "This particular search leverages data extracted from Stream:HTTP. You must configure the http stream using the Splunk Stream App on your Splunk Stream deployment server to extract the cs_content_type field.",
            "highlight": "No",
            "how_to_implement": "This particular search leverages data extracted from Stream:HTTP. You must configure the http stream using the Splunk Stream App on your Splunk Stream deployment server to extract the cs_content_type field.",
            "icon": "ES_Use_Case.png",
            "id": "unusually_long_content-type_length",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Delivery",
            "known_false_positives": "Very few legitimate Content-Type fields will have a length greater than 100 characters.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=stream:http",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "stream_http"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "unusually_long_content_type_length_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Unusually Long Content-Type Length",
            "references": [],
            "released": "2017-10-13",
            "search": "`stream_http` | eval cs_content_type_length = len(cs_content_type) | where cs_content_type_length > 100 | table endtime src_ip dest_ip cs_content_type_length cs_content_type url | `unusually_long_content_type_length_filter`",
            "search_name": "ESCU - Unusually Long Content-Type Length - Rule",
            "security_domain": "network",
            "story": "2dcfd6a2-e7d2-4873-b6ba-adaf819d2a1e",
            "tags": {
                "analytics_story": [
                    "Apache Struts Vulnerability"
                ],
                "asset_type": "Web Server",
                "cis20": [
                    "CIS 3",
                    "CIS 4",
                    "CIS 18",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "ID.RA",
                    "RS.MI",
                    "PR.PT",
                    "PR.IP",
                    "DE.AE",
                    "PR.MA",
                    "DE.CM"
                ],
                "security_domain": "network"
            },
            "usecase": "Application Security",
            "version": 1
        },
        "unusually_long_vpn_session": {
            "alertvolume": "Other",
            "app": "Splunk_User_Behavior_Analytics",
            "category": "Lateral Movement|Account Compromise|Data Exfiltration",
            "dashboard": "UBA_Use_Case",
            "data_source_categories": "DS025IPAddressAssignment-ET01General",
            "deprecated_not_used_anymore_datasource": "IP Address Assignment",
            "description": "Detects unusually long VPN sessions, based on a user's baseline and their peer group.",
            "displayapp": "Splunk User Behavior Analytics",
            "domain": "Other",
            "hasSearch": "No",
            "help": "Help not needed -- UBA Use Case",
            "highlight": "No",
            "icon": "UBA_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "None",
            "mitre": "",
            "mitre_notes": "",
            "mitre_tactic": "|TA0010|TA0003",
            "mitre_technique": "|T1048|T1108",
            "name": "Unusually Long VPN Session",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "usecase": "Advanced Threat Detection|Security Monitoring|Insider Threat"
        },
        "update_service": {
            "SPLEase": "Basic",
            "advancedtags": "Autobahn",
            "alertvolume": "Low",
            "app": "Splunk_Security_Essentials",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset=Update Service - Demo",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "deprecated_not_used_anymore_datasource": "Endpoint Detection and Response",
            "description": "Splunk can detect the status of services, allowing us to find hosts where the Windows Update service is disabled.",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Update Service - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Update Service - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Windows Service logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standard sourcetypes.",
            "highlight": "No",
            "howToImplement": "If you are using the Windows Forwarder with the WinHostMon://Service input configured, this search should work automatically. If you're using another source to detect Service status, you may need to adjust the search string to match your data source.",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "",
            "knownFP": "No known false positives at this time.",
            "mitre": "Defense Evasion",
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "TA0005",
            "mitre_technique": "|T1089",
            "name": "Disabled Update Service",
            "operationalize": "When Windows Update is disabled, the immediate question is why. Ask the user if they disabled it, look for software installations that might have done it, or look for any errors related to the Windows Update Service (wuauserv.exe).",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/disabled_update_service.png",
            "released": "2.0.0",
            "relevance": "It is not uncommon for malware to somehow hamstring the Windows Update service, so that Microsoft can't push out fixes to patches, or push out their periodic malware removal tools. Regardless, finding hosts that aren't receiving updates should always be a big priority, as they leave you literally vulnerable.",
            "searchKeywords": "",
            "usecase": "Security Monitoring"
        },
        "user_login_local_credentials": {
            "SPLEase": "Basic",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat|Privilege Escalation|Endpoint Compromise|Account Compromise",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=Login With Local Credentials - Demo",
            "data_source_categories": "VendorSpecific-winsec",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "<p>Categorically, most interactive logins should use domain credentials. Detect when a new user logs on with local credentials that bypass most centralized logging and policy systems, but not Splunk!</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Endpoint",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Login With Local Credentials - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Login With Local Credentials - Live"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of Windows Authentication logs. For this analysis, we are looking at what domains we expect to see in our authentication logs, and alert on anything unexpected.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Implementing this search is as tricky as your environment is complex. For smaller shops with minimal complexity, run a Splunk search to look at the expected domains, and add them to your explicit whitelist: <pre>index=* daysago=7 source=*win*security | top Account_Domain limit=0</pre>. In more complex environments (such as with many subsidiaries, or services routinely logging in with local accounts), you may wish to run this over a long period of time and create a lookup to tune out your noise. Create the lookup with <pre>index=* daysago=60 source=*win*security | top Account_Domain limit=0 | fields Account_Domain | outputlookup allowable_account_domains.csv</pre>Then in your correlation search, access that lookup by replacing the existing list of account domains so that it reads:<pre>index=* source=*win*security tag=authentication action=success Logon_Type=2 OR Logon_Type=10 OR Logon_Type=11 Logon Type NOT ( [ | inputlookup allowable_account_domains.csv | table Account_Domain ] )</pre></p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "industryMapping": "Telecommunications|Technology|Aerospace|Healthcare|Defense|Education|Construction|Energy|Travel",
            "journey": "Stage_1",
            "killchain": "",
            "knownFP": "Many service accounts will log in with local domains as a matter of normal activities, and computer accounts may also show up. It's best to consider this alert as a contextual alert rather than a material alert that you would send to the SOC.",
            "mitre": "Credential Access|Privilege Escalation",
            "mitre_sub_technique": "T1078.003",
            "mitre_tactic": "TA0004|TA0001|TA0006",
            "mitre_technique": "|T1078|T1098",
            "name": "User Login with Local Credentials",
            "operationalize": "<p>Determine whether this user is authorized to log in with local credentials, and whether the configuration of the local account complies with company policies around password expiration, complexity, and etc. Verify whether this is a service account that should be added to the tuning whitelist moving forward.</p>",
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_login_local_credentials.png",
            "relatedUseCase": [
                "showcase_new_local_admin_account",
                "showcase_new_ad_domain"
            ],
            "released": "2.2.0",
            "relevance": "<p>Local credentials enable a user (or attacker) to bypass some auditing controls, and persist access effectively. There are many different approaches to this problem, including logging the creation of local accounts.</p>",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Insider Threat|Security Monitoring"
        },
        "user_login_unauthorized_geo": {
            "SPLEase": "Medium",
            "advancedtags": "Useful SPL Documentation",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Compliance|Cloud Security",
            "dashboard": "showcase_simple_search?ml_toolkit.dataset=User Login Unauthorized Geo - Demo",
            "data_source_categories": "DS003Authentication-ET01Success|VendorSpecific-aws-cloudtrail",
            "deprecated_not_used_anymore_datasource": "Authentication|Vendor-Specific Data",
            "description": "<p>For regulated environments, detect users logging into servers where they're not permitted.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Access",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "User Login Unauthorized Geo - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "User Login Unauthorized Geo - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "User Login Unauthorized Geo - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of Windows Authentication logs. For this analysis, we are combining the authentication logs with a lookup table that indicates what country the server is a part of and what resources a user is permitted to access, so that we can detect users who are logged into servers in countries they're not permitted to (e.g., a US user logging into a Germany server).</p>",
            "highlight": "No",
            "howToImplement": "<p>This search is easy to implement technically, though difficult for business purposes. Building a reliable list of which servers are in which zones, and which users are permitted to log into which zones can be a project that takes weeks or months to complete, and never completes with complete accuracy (though the importance of absolute accuracy is up to the interpretation of your legal advisor). Once you have two lookups, servers_to_geos and users_authorized_geos, the search implementation should proceed smoothly.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "killchain": "Actions On Objectives",
            "knownFP": "<p>Not Applicable</p>",
            "mitre": "Credential Access|Privilege Escalation|Initial Access",
            "mitre_tactic": "TA0001",
            "mitre_technique": "|T1078",
            "name": "User Login to Unauthorized Geo",
            "operationalize": "<p>When this alert fires, your first step should be to validate whether this user should be allowed to log into the server in question (i.e., if it's a question of out of date or inaccurate lookups). Next, validate whether there is a permissions issue that should have prevented the login, and whether the login was with malicious intent or merely an accident.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_ip_investigate_report",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_login_unauthorized_geo.png",
            "released": "2.2.0",
            "relevance": "<p>For organizations that face strong regulations, you may need to restrict access to servers in specific geographies (particularly, Germany tends to have strict laws). If your legal team has indicated that you need to restrict access based on the types of data that you have, Splunk makes it easy to detect unauthorized logins.</p>",
            "searchKeywords": "login log in logon log on sign",
            "usecase": "Compliance"
        },
        "user_many_dlp_events": {
            "SPLEase": "Medium",
            "alertvolume": "Medium",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_standard_deviation?ml_toolkit.dataset=Many DLP Alerts for User - Demo",
            "data_source_categories": "DS016DataLossPrevention-ET01Violation",
            "deprecated_not_used_anymore_datasource": "DLP",
            "description": "<p>Detect users that have many DLP events in a short period of time.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Threat",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": "Many DLP Alerts for User - Demo"
                },
                {
                    "label": "Live Data",
                    "name": "Many DLP Alerts for User - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": "Many DLP Alerts for User - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of DLP Events. For this analysis, we are looking for a large number of DLP Events based on a specific threshold.</p>",
            "highlight": "Yes",
            "howToImplement": "<p>Ensure that your DLP events are ingested with the Common Information Model, and tune the threshold to the degree you desire.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "knownFP": "<p>DLP systems in most organizations will generate many false positives (or at least, lots of noise). The goal of this search is to take users that have many different DLP events on a given day and escalate the priority of those events. That means that inherently there will still be false positives from this search based on the underlying policy. Tune your DLP system or adjust the threshold to control the noise from this search.</p>",
            "mitre": "Exfiltration|Credential Access",
            "mitre_tactic": "|TA0010",
            "mitre_technique": "|TA0010",
            "name": "User with Many DLP Events",
            "operationalize": "<p>Respond to the underlying events.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain",
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_many_dlp_events.png",
            "released": "2.2.0",
            "relevance": "<p>DLP events track meaningful risks to your organization, but unfortunately in most environments the volume of DLP events creates so much noise that valid events are disregarded. While you should absolutely be correlating DLP events with other security events, you may also wish to surface users that have a high number of DLP events in a short term to prioritize investigation into those events.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "user_separation_events": {
            "SPLEase": "Medium",
            "alertvolume": "High",
            "app": "Splunk_Security_Essentials",
            "category": "Insider Threat",
            "dashboard": "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
            "deprecated_not_used_anymore_datasource": "Other",
            "description": "<p>When an HR Separation event (e.g., terminations) occurs, analyze past behavior to look for signs of malicious intent or data exfiltration.</p>",
            "displayapp": "Splunk Security Essentials",
            "domain": "Audit",
            "examples": [
                {
                    "label": "Demo Data",
                    "name": " - Demo"
                },
                {
                    "label": "Live Data",
                    "name": " - Live"
                },
                {
                    "label": "Accelerated Data",
                    "name": " - Accelerated"
                }
            ],
            "hasSearch": "Yes",
            "help": "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of HR Separation events.</p>",
            "highlight": "No",
            "howToImplement": "<p>Because HR systems don't typically provide API access, when this is enabled is typically by configuring the HR system to send data out when an event occurs. The configuration can depend on the system you use, but most systems will send a confirmation email that can be BCC'd to a mailbox owned by the Security Team, or send out an XML document. For those organizations that opt to configure the email receipt, most teams will ingest that data into Splunk via the <a href=\"https://splunkbase.splunk.com/app/3200/\" target=\"_blank\">TA-mailclient app</a>. When ingested into Splunk, this data will be stored in a separate index to allow for strict access controls.</p>",
            "icon": "Core_Use_Case.png",
            "includeSSE": "No",
            "journey": "Stage_4",
            "killchain": "",
            "knownFP": "<p>Not Applicable</p>",
            "mitre": "",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "User Experiencing Separation Event",
            "operationalize": "<p>When a user leaving the company decides to exfiltrate data, it will usually occur when they start looking for a job, or when they feel like they have found a job that will be high likelihood. It will most often occur at least several days, if not months, before they actually give notice. Similar behaviors can be see for involuntary separations, where an employee on a performance improvement plan may decide to exfiltrate data because they feel wronged, or they see the end coming.</p>",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_malicious_insider_containment"
            ],
            "printable_image": "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_separation_events.png",
            "released": "2.2.0",
            "relevance": "<p>Most employees leaving jobs will take <b>some</b> data with them. Whether it's highly sensitive secrets, all the projects they worked on for their portfolio, or just their address list already synced to iCloud will vary based on their disposition and the nature of the separation. When a separation event occurs, look for behavior in the recent few weeks and months to see if there seems to be any major exfiltration concerns (or other anomalous activities) to detect malicious insiders.</p>",
            "searchKeywords": "",
            "usecase": "Insider Threat"
        },
        "usn_journal_deletion": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Log Manipulation|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Ransomware",
            "dashboard": "showcase_security_content?showcaseId=usn_journal_deletion",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2018-12-03",
            "description": "The fsutil.exe application is a legitimate Windows utility used to perform tasks related to the file allocation table (FAT) and NTFS file systems. The update sequence number (USN) change journal provides a log of all changes made to the files on the disk. This search looks for fsutil.exe deleting the USN journal.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 6|CIS 8|CIS 10",
            "escu_nist": "DE.CM|PR.PT|DE.AE|DE.DP|PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model.",
            "icon": "ES_Use_Case.png",
            "id": "usn_journal_deletion",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "None identified",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "usn_journal_deletion_filter"
                }
            ],
            "mitre_sub_technique": "T1070",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1070",
            "mitre_threat_groups": "no",
            "name": "Usn Journal Deletion",
            "references": [],
            "released": "2018-12-03",
            "search": "| tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=fsutil.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search process=\"*deletejournal*\" AND process=\"*usn*\" | `usn_journal_deletion_filter`",
            "search_name": "ESCU - USN Journal Deletion - Rule",
            "story": "b6db2c60-a281-48b4-95f1-2cd99ed56835|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Windows Log Manipulation",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 6",
                    "CIS 8",
                    "CIS 10"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1070"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Indicator Removal on Host"
                ],
                "nist": [
                    "DE.CM",
                    "PR.PT",
                    "DE.AE",
                    "DE.DP",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 2
        },
        "vulnerability_scanner_detected_by_events": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Scanning",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS012NetworkIntrusionDetection-ET01SigDetection",
            "deprecated_not_used_anymore_datasource": "IDS or IPS",
            "description": "Detects a potential vulnerability scanner by detecting devices that have triggered a large number of unique events. Vulnerability scanners generally trigger a high number unique events when scanning a host since each vulnerability check tends to trigger a unique event.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0007",
            "mitre_technique": "|T1046|T1018",
            "name": "Vulnerability Scanner Detected (by events)",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Vulnerability Scanner Detection (by event) - Rule",
            "similarUseCases": [
                "Basic_Scanning",
                "showcase_network_dc_dest",
                "vulnerability_scanner_detected_by_targets"
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "vulnerability_scanner_detected_by_targets": {
            "SPLEase": "Medium",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Scanning",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS012NetworkIntrusionDetection-ET01SigDetection",
            "deprecated_not_used_anymore_datasource": "IDS or IPS",
            "description": "Detects a potential vulnerability scanner by detecting devices that have triggered events against a large number of unique targets. Vulnerability scanners generally trigger events against a high number of unique hosts when they are scanning a network for vulnerable hosts.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Network",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "Yes",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_tactic": "|TA0007",
            "mitre_technique": "|T1046",
            "name": "Vulnerability Scanner Detected (by targets)",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Network - Vulnerability Scanner Detection (by targets) - Rule",
            "similarUseCases": [
                "Basic_Scanning",
                "showcase_network_dc_dest",
                "vulnerability_scanner_detected_by_events"
            ],
            "usecase": "Security Monitoring|Compliance"
        },
        "watchlisted_event_observed": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Other",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "VendorSpecific-AnySplunk",
            "deprecated_not_used_anymore_datasource": "Vendor-Specific Data",
            "description": "Alerts when an event is discovered including text has been identified as important. This rule triggers whenever an event is discovered with the tag of &quot;watchlist&quot;.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Threat",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_4",
            "mitre": "",
            "mitre_notes": "too broad",
            "mitre_tactic": "",
            "mitre_technique": "",
            "name": "Watchlisted Event Observed",
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Threat - Watchlisted Events - Rule",
            "usecase": "Other"
        },
        "web_fraud_-_account_harvesting": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Web Fraud Detection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Account",
            "author": "Jim Apger, Splunk",
            "baselines": "",
            "category": "Abuse|",
            "dashboard": "showcase_security_content?showcaseId=web_fraud_-_account_harvesting",
            "data_source_categories": "DS014WebServer-ET01Access",
            "datamodel": "",
            "dataset": "",
            "date": "2018-10-08",
            "description": "This search is used to identify the creation of multiple user accounts using the same email domain name.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.CM|DE.DP",
            "hasSearch": "Yes",
            "help": "We start with a dataset that provides visibility into the email address used for the account creation. In this example, we are narrowing our search down to the single web page that hosts the Magento2 e-commerce platform (via URI) used for account creation, the single http content-type to grab only the user's clicks, and the http field that provides the username (form_data), for performance reasons.  After we have the username and email domain, we look for numerous account creations per email domain.  Common data sources used for this detection are customized Apache logs or Splunk Stream.",
            "highlight": "No",
            "how_to_implement": "We start with a dataset that provides visibility into the email address used for the account creation. In this example, we are narrowing our search down to the single web page that hosts the Magento2 e-commerce platform (via URI) used for account creation, the single http content-type to grab only the user's clicks, and the http field that provides the username (form_data), for performance reasons.  After we have the username and email domain, we look for numerous account creations per email domain.  Common data sources used for this detection are customized Apache logs or Splunk Stream.",
            "icon": "ES_Use_Case.png",
            "id": "web_fraud_-_account_harvesting",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "As is common with many fraud-related searches, we are usually looking to attribute risk or synthesize relevant context with loosely written detections that simply detect anamolous behavior. This search will need to be customized to fit your environment&#151;improving its fidelity by counting based on something much more specific, such as a device ID that may be present in your dataset. Consideration for whether the large number of registrations are occuring from a first-time seen domain may also be important.  Extending the search window to look further back in time, or even calculating the average per hour/day for each email domain to look for an anomalous spikes, will improve this search.  You can also use Shannon entropy or Levenshtein Distance (both courtesy of URL Toolbox) to consider the randomness or similarity of the email name or email domain, as the names are often machine-generated.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=stream:http",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "stream_http"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "web_fraud___account_harvesting_filter"
                }
            ],
            "mitre_sub_technique": "T1136",
            "mitre_tactic": "TA0003",
            "mitre_tactic_display": "Persistence",
            "mitre_technique": "T1136",
            "mitre_threat_groups": "no",
            "name": "Web Fraud - Account Harvesting",
            "references": [
                "https://splunkbase.splunk.com/app/2734/",
                "https://splunkbase.splunk.com/app/1809/"
            ],
            "released": "2018-10-08",
            "search": "`stream_http` http_content_type=text* uri=\"/magento2/customer/account/loginPost/\" | rex field=cookie \"form_key=(?<SessionID>\\w+)\" | rex field=form_data \"login\\[username\\]=(?<Username>[^&|^$]+)\" | search Username=* | rex field=Username \"@(?<email_domain>.*)\" | stats dc(Username) as UniqueUsernames list(Username) as src_user by email_domain | where UniqueUsernames> 25 | `web_fraud___account_harvesting_filter`",
            "search_name": "ESCU - Web Fraud - Account Harvesting - Rule",
            "story": "31337aaa-bc22-4752-b599-ef112dq1dq7a",
            "tags": {
                "analytics_story": [
                    "Web Fraud Detection"
                ],
                "asset_type": "Account",
                "cis20": [
                    "CIS 16"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "no"
                ],
                "mitre_attack_id": [
                    "T1136"
                ],
                "mitre_attack_tactics": [
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Create Account"
                ],
                "nist": [
                    "DE.CM",
                    "DE.DP"
                ],
                "security_domain": "threat"
            },
            "usecase": "Other",
            "version": 1
        },
        "web_fraud_-_anomalous_user_clickspeed": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Web Fraud Detection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "account",
            "author": "Jim Apger, Splunk",
            "baselines": "",
            "category": "Abuse|",
            "dashboard": "showcase_security_content?showcaseId=web_fraud_-_anomalous_user_clickspeed",
            "data_source_categories": "DS014WebServer-ET01Access",
            "datamodel": "",
            "dataset": "",
            "date": "2018-10-08",
            "description": "This search is used to examine web sessions to identify those where the clicks are occurring too quickly for a human or are occurring with a near-perfect cadence (high periodicity or low standard deviation), resembling a script driven session.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 6",
            "escu_nist": "DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "Start with a dataset that allows you to see clickstream data for each user click on the website. That data must have a time stamp and must contain a reference to the session identifier being used by the website. This ties the clicks together into clickstreams. This value is usually found in the http cookie. With a bit of tuning, a version of this search could be used in high-volume scenarios, such as scraping, crawling, application DDOS, credit-card testing, account takeover, etc. Common data sources used for this detection are customized Apache logs, customized IIS, and Splunk Stream.",
            "highlight": "No",
            "how_to_implement": "Start with a dataset that allows you to see clickstream data for each user click on the website. That data must have a time stamp and must contain a reference to the session identifier being used by the website. This ties the clicks together into clickstreams. This value is usually found in the http cookie. With a bit of tuning, a version of this search could be used in high-volume scenarios, such as scraping, crawling, application DDOS, credit-card testing, account takeover, etc. Common data sources used for this detection are customized Apache logs, customized IIS, and Splunk Stream.",
            "icon": "ES_Use_Case.png",
            "id": "web_fraud_-_anomalous_user_clickspeed",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "As is common with many fraud-related searches, we are usually looking to attribute risk or synthesize relevant context with loosly written detections that simply detect anamoluous behavior.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=stream:http",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "stream_http"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "web_fraud___anomalous_user_clickspeed_filter"
                }
            ],
            "mitre_sub_technique": "T1078",
            "mitre_tactic": "TA0005|TA0003|TA0004|TA0001",
            "mitre_tactic_display": "Defense Evasion|Persistence|Privilege Escalation|Initial Access",
            "mitre_technique": "T1078",
            "mitre_threat_groups": "Sandworm Team|Wizard Spider|Silence|APT41|Soft Cell|TEMP.Veles|APT39|FIN4|Night Dragon|Dragonfly 2.0|FIN8|Leviathan|APT33|OilRig|FIN5|menuPass|APT28|FIN10|Suckfly|FIN6|Threat Group-3390|APT18|PittyTiger|Carbanak",
            "name": "Web Fraud - Anomalous User Clickspeed",
            "references": [
                "https://en.wikipedia.org/wiki/Session_ID",
                "https://en.wikipedia.org/wiki/Session_(computer_science)",
                "https://en.wikipedia.org/wiki/HTTP_cookie",
                "https://splunkbase.splunk.com/app/1809/"
            ],
            "released": "2018-10-08",
            "search": "`stream_http` http_content_type=text* | rex field=cookie \"form_key=(?<session_id>\\w+)\" | streamstats window=2 current=1 range(_time) as TimeDelta by session_id | where TimeDelta>0 |stats count stdev(TimeDelta) as ClickSpeedStdDev avg(TimeDelta) as ClickSpeedAvg by session_id | where count>5 AND (ClickSpeedStdDev<.5 OR ClickSpeedAvg<.5) | `web_fraud___anomalous_user_clickspeed_filter`",
            "search_name": "ESCU - Web Fraud - Anomalous User Clickspeed - Rule",
            "story": "31337aaa-bc22-4752-b599-ef112dq1dq7a",
            "tags": {
                "analytics_story": [
                    "Web Fraud Detection"
                ],
                "asset_type": "account",
                "cis20": [
                    "CIS 6"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Wizard Spider",
                    "Silence",
                    "APT41",
                    "Soft Cell",
                    "TEMP.Veles",
                    "APT39",
                    "FIN4",
                    "Night Dragon",
                    "Dragonfly 2.0",
                    "FIN8",
                    "Leviathan",
                    "APT33",
                    "OilRig",
                    "FIN5",
                    "menuPass",
                    "APT28",
                    "FIN10",
                    "Suckfly",
                    "FIN6",
                    "Threat Group-3390",
                    "APT18",
                    "PittyTiger",
                    "Carbanak"
                ],
                "mitre_attack_id": [
                    "T1078"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion",
                    "Persistence",
                    "Privilege Escalation",
                    "Initial Access"
                ],
                "mitre_attack_technique": [
                    "Valid Accounts"
                ],
                "nist": [
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "threat"
            },
            "usecase": "Other",
            "version": 1
        },
        "web_fraud_-_password_sharing_across_accounts": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Web Fraud Detection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "account",
            "author": "Jim Apger, Splunk",
            "baselines": "",
            "category": "Abuse|",
            "dashboard": "showcase_security_content?showcaseId=web_fraud_-_password_sharing_across_accounts",
            "data_source_categories": "DS014WebServer-ET01Access",
            "datamodel": "",
            "dataset": "",
            "date": "2018-10-08",
            "description": "This search is used to identify user accounts that share a common password.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 16",
            "escu_nist": "DE.DP",
            "hasSearch": "Yes",
            "help": "We need to start with a dataset that allows us to see the values of usernames and passwords that users are submitting to the website hosting the Magento2 e-commerce platform (commonly found in the HTTP form_data field). A tokenized or hashed value of a password is acceptable and certainly preferable to a clear-text password. Common data sources used for this detection are customized Apache logs, customized IIS, and Splunk Stream.",
            "highlight": "No",
            "how_to_implement": "We need to start with a dataset that allows us to see the values of usernames and passwords that users are submitting to the website hosting the Magento2 e-commerce platform (commonly found in the HTTP form_data field). A tokenized or hashed value of a password is acceptable and certainly preferable to a clear-text password. Common data sources used for this detection are customized Apache logs, customized IIS, and Splunk Stream.",
            "icon": "ES_Use_Case.png",
            "id": "web_fraud_-_password_sharing_across_accounts",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "None",
            "known_false_positives": "As is common with many fraud-related searches, we are usually looking to attribute risk or synthesize relevant context with loosely written detections that simply detect anamoluous behavior.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=stream:http",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "stream_http"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "web_fraud___password_sharing_across_accounts_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Web Fraud - Password Sharing Across Accounts",
            "references": [
                "https://en.wikipedia.org/wiki/Session_ID",
                "https://en.wikipedia.org/wiki/Session_(computer_science)",
                "https://en.wikipedia.org/wiki/HTTP_cookie",
                "https://splunkbase.splunk.com/app/1809/"
            ],
            "released": "2018-10-08",
            "search": "`stream_http` http_content_type=text* uri=/magento2/customer/account/loginPost*  | rex field=form_data \"login\\[username\\]=(?<Username>[^&|^$]+)\" | rex field=form_data \"login\\[password\\]=(?<Password>[^&|^$]+)\" | stats dc(Username) as UniqueUsernames values(Username) as user list(src_ip) as src_ip by Password|where UniqueUsernames>5 | `web_fraud___password_sharing_across_accounts_filter`",
            "search_name": "ESCU - Web Fraud - Password Sharing Across Accounts - Rule",
            "security_domain": "threat",
            "story": "31337aaa-bc22-4752-b599-ef112dq1dq7a",
            "tags": {
                "analytics_story": [
                    "Web Fraud Detection"
                ],
                "asset_type": "account",
                "cis20": [
                    "CIS 16"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "DE.DP"
                ],
                "security_domain": "threat"
            },
            "usecase": "Other",
            "version": 1
        },
        "web_servers_executing_suspicious_processes": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Apache Struts Vulnerability",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Web Server",
            "author": "David Dorsey, Splunk",
            "baselines": "",
            "category": "Web Attack",
            "dashboard": "showcase_security_content?showcaseId=web_servers_executing_suspicious_processes",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": "",
            "date": "2019-04-01",
            "description": "This search looks for suspicious processes on all systems labeled as web servers.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3",
            "escu_nist": "PR.IP",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. In addition, web servers will need to be identified in the Assets and Identity Framework of Enterprise Security.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records process activity from your hosts to populate the Endpoint data model in the Processes node. You must also be ingesting logs with both the process name and command line from your endpoints. The command-line arguments are mapped to the \"process\" field in the Endpoint data model. In addition, web servers will need to be identified in the Assets and Identity Framework of Enterprise Security.",
            "icon": "ES_Use_Case.png",
            "id": "web_servers_executing_suspicious_processes",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Some of these processes may be used legitimately on web servers during maintenance or other administrative tasks.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "web_servers_executing_suspicious_processes_filter"
                }
            ],
            "mitre_sub_technique": "T1082",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1082",
            "mitre_threat_groups": "Rocke|Sandworm Team|Blue Mockingbird|Tropic Trooper|Frankenstein|Inception|Kimsuky|Darkhotel|MuddyWater|APT18|Honeybee|APT19|APT37|APT32|Magic Hound|OilRig|APT3|Sowbug|Gamaredon Group|Patchwork|Stealth Falcon|Lazarus Group|admin@338|Turla|Ke3chang",
            "name": "Web Servers Executing Suspicious Processes",
            "references": [],
            "released": "2019-04-01",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.dest_category=\"web_server\" AND (Processes.process=\"*whoami*\" OR Processes.process=\"*ping*\" OR Processes.process=\"*iptables*\" OR Processes.process=\"*wget*\" OR Processes.process=\"*service*\" OR Processes.process=\"*curl*\") by Processes.process Processes.process_name, Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `web_servers_executing_suspicious_processes_filter`",
            "search_name": "ESCU - Web Servers Executing Suspicious Processes - Rule",
            "story": "2dcfd6a2-e7d2-4873-b6ba-adaf819d2a1e",
            "tags": {
                "analytics_story": [
                    "Apache Struts Vulnerability"
                ],
                "asset_type": "Web Server",
                "cis20": [
                    "CIS 3"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Rocke",
                    "Sandworm Team",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "Inception",
                    "Kimsuky",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "Honeybee",
                    "APT19",
                    "APT37",
                    "APT32",
                    "Magic Hound",
                    "OilRig",
                    "APT3",
                    "Sowbug",
                    "Gamaredon Group",
                    "Patchwork",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "admin@338",
                    "Turla",
                    "Ke3chang"
                ],
                "mitre_attack_id": [
                    "T1082"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "System Information Discovery"
                ],
                "nist": [
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Application Security",
            "version": 1
        },
        "web_uploads_to_noncorporate_sites_by_users": {
            "SPLEase": "Advanced",
            "alertvolume": "Other",
            "app": "Splunk_App_for_Enterprise_Security",
            "category": "Data Exfiltration|Insider Threat|GDPR",
            "dashboard": "ES_Use_Case",
            "data_source_categories": "DS005WebProxyRequest-ET01Requested",
            "deprecated_not_used_anymore_datasource": "Web Proxy",
            "description": "Alerts on high volume web uploads by a user to non-corporate domains.",
            "displayapp": "Splunk App for Enterprise Security",
            "domain": "Identity",
            "gdprtext": "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
            "hasSearch": "No",
            "help": "Help not needed -- ES Use Case",
            "highlight": "No",
            "icon": "ES_Use_Case.png",
            "includeSSE": "Yes",
            "journey": "Stage_2",
            "mitre": "",
            "mitre_tactic": "|TA0010|TA0011|TA0005",
            "mitre_technique": "|T1048|T1102",
            "name": "Web Uploads to Non-corporate Sites by Users",
            "phantomPlaybookAvailable": "Yes",
            "phantomPlaybooks": [
                "phantom_prompt_and_block_domain"
            ],
            "released": "2.0.0",
            "searchKeywords": "",
            "search_name": "Identity - Web Uploads to Non-corporate Domains - Rule",
            "usecase": "Compliance|Insider Threat|Advanced Threat Detection"
        },
        "windows_adfind_exe": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Sunburst Malware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=windows_adfind_exe",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1018/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-12-16",
            "description": "This search looks for the execution of `adfind.exe` with command-line arguments that it uses by default. Specifically the filter or search functions. It also considers the arguments necessary like objectcategory, see readme for more details: https://www.joeware.net/freetools/tools/adfind/usage.htm. This has been seen used before by Wizard Spider, FIN6 and actors whom also launched SUNBURST. AdFind.exe is usually used a recon tool to enumare a domain controller.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you need to be ingesting logs with the process name, and command-line executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you need to be ingesting logs with the process name, and command-line executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
            "icon": "ES_Use_Case.png",
            "id": "windows_adfind_exe",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "administrators rarely use adfind, usually not used for legitimate reasons",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "windows_adfind_exe_filter"
                }
            ],
            "mitre_sub_technique": "T1018",
            "mitre_tactic": "TA0007",
            "mitre_tactic_display": "Discovery",
            "mitre_technique": "T1018",
            "mitre_threat_groups": "Sandworm Team|Rocke|Wizard Spider|Silence|Soft Cell|APT39|APT32|Deep Panda|Threat Group-3390|Dragonfly 2.0|Leafminer|Ke3chang|FIN8|APT3|FIN5|BRONZE BUTLER|menuPass|FIN6|Turla",
            "name": "Windows Adfind Exe",
            "references": [
                "https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/",
                "https://www.fireeye.com/blog/threat-research/2019/01/a-nasty-trick-from-credential-theft-malware-to-business-disruption.html"
            ],
            "released": "2020-12-16",
            "search": " | tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process=*-f* OR Processes.process=*-b*) AND (Processes.process=*objectcategory* OR Processes.process=*-gcb* OR Processes.process=*-sc*) by Processes.dest Processes.user Processes.process_name Processes.process  Processes.parent_process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_adfind_exe_filter` ",
            "search_name": "ESCU - Windows AdFind Exe - Rule",
            "story": "758196b5-2e21-424f-a50c-6e421ce926c2",
            "tags": {
                "analytics_story": [
                    "Sunburst Malware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1018/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Exploitation"
                ],
                "mitre_attack_groups": [
                    "Sandworm Team",
                    "Rocke",
                    "Wizard Spider",
                    "Silence",
                    "Soft Cell",
                    "APT39",
                    "APT32",
                    "Deep Panda",
                    "Threat Group-3390",
                    "Dragonfly 2.0",
                    "Leafminer",
                    "Ke3chang",
                    "FIN8",
                    "APT3",
                    "FIN5",
                    "BRONZE BUTLER",
                    "menuPass",
                    "FIN6",
                    "Turla"
                ],
                "mitre_attack_id": [
                    "T1018"
                ],
                "mitre_attack_tactics": [
                    "Discovery"
                ],
                "mitre_attack_technique": [
                    "Remote System Discovery"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "windows_connhost_exe_started_forcefully": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ryuk Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rod Soto, Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=windows_connhost_exe_started_forcefully",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": "",
            "date": "2020-11-06",
            "description": "The search looks for the Console Window Host process (connhost.exe) executed using the force flag -ForceV1. This is not regular behavior in the Windows OS and is often seen executed by the Ryuk Ransomware.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the process-system activity from your hosts to populate the Endpoint Processes data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the process-system activity from your hosts to populate the Endpoint Processes data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "windows_connhost_exe_started_forcefully",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "This process should not be ran forcefully, we have not see any false positives for this detection",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "windows_connhost_exe_started_forcefully_filter"
                }
            ],
            "mitre_sub_technique": "T1059.003",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1059",
            "mitre_threat_groups": "TA505|Blue Mockingbird|Tropic Trooper|Frankenstein|OilRig|Lazarus Group|Honeybee|Cobalt Group|FIN7|APT41|Soft Cell|Turla|Silence|APT32|APT39|Darkhotel|MuddyWater|APT18|APT38|Dark Caracal|Gorgon Group|Dragonfly 2.0|Rancor|Ke3chang|APT37|Leviathan|FIN8|APT28|Magic Hound|Sowbug|BRONZE BUTLER|FIN10|Threat Group-3390|menuPass|Gamaredon Group|Suckfly|Patchwork|Threat Group-1314|APT3|admin@338|APT1",
            "name": "Windows Connhost Exe Started Forcefully",
            "references": [],
            "released": "2020-11-06",
            "search": "| `sysmon` CommandLine=\"*C:\\\\Windows\\\\system32\\\\conhost.exe 0xffffffff -ForceV1*\" EventCode=4688 | table CommandLine, Computer, EventCode, SubjectUserSid | `windows_connhost_exe_started_forcefully_filter`",
            "search_name": "ESCU - Windows connhost exe started forcefully - Rule",
            "story": "507edc74-13d5-4339-878e-b9744ded1f35",
            "tags": {
                "analytics_story": [
                    "Ryuk Ransomware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "TA505",
                    "Blue Mockingbird",
                    "Tropic Trooper",
                    "Frankenstein",
                    "OilRig",
                    "Lazarus Group",
                    "Honeybee",
                    "Cobalt Group",
                    "FIN7",
                    "APT41",
                    "Soft Cell",
                    "Turla",
                    "Silence",
                    "APT32",
                    "APT39",
                    "Darkhotel",
                    "MuddyWater",
                    "APT18",
                    "APT38",
                    "Dark Caracal",
                    "Gorgon Group",
                    "Dragonfly 2.0",
                    "Rancor",
                    "Ke3chang",
                    "APT37",
                    "Leviathan",
                    "FIN8",
                    "APT28",
                    "Magic Hound",
                    "Sowbug",
                    "BRONZE BUTLER",
                    "FIN10",
                    "Threat Group-3390",
                    "menuPass",
                    "Gamaredon Group",
                    "Suckfly",
                    "Patchwork",
                    "Threat Group-1314",
                    "APT3",
                    "admin@338",
                    "APT1"
                ],
                "mitre_attack_id": [
                    "T1059"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Command Shell"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "windows_disableantispyware_registry": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ryuk Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rod Soto, Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=windows_disableantispyware_registry",
            "data_source_categories": "Other",
            "datamodel": "Endpoint.Registry",
            "dataset": "",
            "date": "2020-11-06",
            "description": "The search looks for the Registry Key DisableAntiSpyware set to disable. This is consistent with Ryuk infections across a fleet of endpoints.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the process-system activity from your hosts to populate the Endpoint Processes data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the process-system activity from your hosts to populate the Endpoint Processes data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "windows_disableantispyware_registry",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "It is unusual to turn this feature on a Windows system since it is a default security control, although it is not rare for some policies to disable it. Although no false positives have been identified, use the provided filter macro to tune the search.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "windows_disableantispyware_registry_filter"
                }
            ],
            "mitre_sub_technique": "T1562.001",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1562",
            "mitre_threat_groups": "Gamaredon Group|BRONZE BUTLER|Rocke|Kimsuky|Turla|Night Dragon|Gorgon Group|Lazarus Group|Putter Panda",
            "name": "Windows Disableantispyware Registry",
            "references": [],
            "released": "2020-11-06",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Registry where Registry.registry_key_name=\"DisableAntiSpyware\" AND Registry.registry_value_name=\"DWORD (0x00000000)\" by Registry.dest Registry.user Registry.registry_path Registry.registry_value_name | `drop_dm_object_name(Registry)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `windows_disableantispyware_registry_filter`",
            "search_name": "ESCU - Windows DisableAntiSpyware Registry - Rule",
            "story": "507edc74-13d5-4339-878e-b9744ded1f35",
            "tags": {
                "analytics_story": [
                    "Ryuk Ransomware"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 8"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "Gamaredon Group",
                    "BRONZE BUTLER",
                    "Rocke",
                    "Kimsuky",
                    "Turla",
                    "Night Dragon",
                    "Gorgon Group",
                    "Lazarus Group",
                    "Putter Panda"
                ],
                "mitre_attack_id": [
                    "T1562"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Disable or Modify Tools"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "windows_event_log_cleared": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Windows Log Manipulation|Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=windows_event_log_cleared",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.001/atomic_red_team/windows-security.log",
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.001/atomic_red_team/windows-system.log"
            ],
            "date": "2020-07-06",
            "description": "This search looks for Windows events that indicate one of the Windows event logs has been purged.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5|CIS 6",
            "escu_nist": "DE.DP|PR.IP|PR.AC|PR.AT|DE.AE",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you need to be ingesting Windows event logs from your hosts.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you need to be ingesting Windows event logs from your hosts.",
            "icon": "ES_Use_Case.png",
            "id": "windows_event_log_cleared",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "It is possible that these logs may be legitimately cleared by Administrators.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "eventtype=wineventlog_security",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_security"
                },
                {
                    "definition": "eventtype=wineventlog_system",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wineventlog_system"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "windows_event_log_cleared_filter"
                }
            ],
            "mitre_sub_technique": "T1070.001",
            "mitre_tactic": "TA0005",
            "mitre_tactic_display": "Defense Evasion",
            "mitre_technique": "T1070",
            "mitre_threat_groups": "APT41|APT38|Dragonfly 2.0|APT32|FIN8|FIN5|APT28",
            "name": "Windows Event Log Cleared",
            "references": [],
            "released": "2020-07-06",
            "search": "(`wineventlog_security` (EventCode=1102 OR EventCode=1100)) OR (`wineventlog_system` EventCode=104) | stats count min(_time) as firstTime max(_time) as lastTime by EventCode dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_event_log_cleared_filter`",
            "search_name": "ESCU - Windows Event Log Cleared - Rule",
            "story": "b6db2c60-a281-48b4-95f1-2cd99ed56835|cf309d0d-d4aa-4fbb-963d-1e79febd3756",
            "tags": {
                "analytics_story": [
                    "Windows Log Manipulation",
                    "Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5",
                    "CIS 6"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.001/atomic_red_team/windows-security.log",
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.001/atomic_red_team/windows-system.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT41",
                    "APT38",
                    "Dragonfly 2.0",
                    "APT32",
                    "FIN8",
                    "FIN5",
                    "APT28"
                ],
                "mitre_attack_id": [
                    "T1070"
                ],
                "mitre_attack_tactics": [
                    "Defense Evasion"
                ],
                "mitre_attack_technique": [
                    "Clear Windows Event Logs"
                ],
                "nist": [
                    "DE.DP",
                    "PR.IP",
                    "PR.AC",
                    "PR.AT",
                    "DE.AE"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 4
        },
        "windows_hosts_file_modification": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Host Redirection",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Endpoint Compromise",
            "dashboard": "showcase_security_content?showcaseId=windows_hosts_file_modification",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange",
            "datamodel": "Endpoint.Filesystem",
            "dataset": "",
            "date": "2018-11-02",
            "description": "The search looks for modifications to the hosts file on all Windows endpoints across your environment.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 8|CIS 12",
            "escu_nist": "PR.IP|PR.PT|PR.AC|DE.AE|DE.CM",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting data that records the file-system activity from your hosts to populate the Endpoint.Filesystem data model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or by other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file-system reads and writes.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting data that records the file-system activity from your hosts to populate the Endpoint.Filesystem data model node. This is typically populated via endpoint detection-and-response products, such as Carbon Black, or by other endpoint data sources, such as Sysmon. The data used for this search is typically generated via logs that report file-system reads and writes.",
            "icon": "ES_Use_Case.png",
            "id": "windows_hosts_file_modification",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Command and Control",
            "known_false_positives": "There may be legitimate reasons for system administrators to add entries to this file.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "windows_hosts_file_modification_filter"
                }
            ],
            "mitre_tactic": "",
            "mitre_tactic_display": "",
            "mitre_threat_groups": "",
            "name": "Windows Hosts File Modification",
            "references": [],
            "released": "2018-11-02",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem  by Filesystem.file_name Filesystem.file_path Filesystem.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | search Filesystem.file_name=hosts AND Filesystem.file_path=*Windows\\\\System32\\\\* | `drop_dm_object_name(Filesystem)` | `windows_hosts_file_modification_filter`",
            "search_name": "ESCU - Windows hosts file modification - Rule",
            "security_domain": "endpoint",
            "story": "2e8948a5-5239-406b-b56b-6c50fe268af4",
            "tags": {
                "analytics_story": [
                    "Host Redirection"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 8",
                    "CIS 12"
                ],
                "kill_chain_phases": [
                    "Command and Control"
                ],
                "mitre_attack_groups": [],
                "mitre_attack_tactics": [],
                "mitre_attack_technique": [],
                "nist": [
                    "PR.IP",
                    "PR.PT",
                    "PR.AC",
                    "DE.AE",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "windows_security_account_manager_stopped": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Ryuk Ransomware",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rod Soto, Jose Hernandez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics",
            "dashboard": "showcase_security_content?showcaseId=windows_security_account_manager_stopped",
            "data_source_categories": "DS009EndPointIntel-ET01ProcessLaunch",
            "datamodel": "Endpoint.Processes",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/ryuk/windows-sysmon.log"
            ],
            "date": "2020-11-06",
            "description": "The search looks for a Windows Security Account Manager (SAM) was stopped via command-line. This is consistent with Ryuk infections across a fleet of endpoints.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 8",
            "escu_nist": "PR.PT|DE.CM",
            "hasSearch": "Yes",
            "help": "You must be ingesting data that records the process-system activity from your hosts to populate the Endpoint Processes data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "highlight": "No",
            "how_to_implement": "You must be ingesting data that records the process-system activity from your hosts to populate the Endpoint Processes data-model object. If you are using Sysmon, you will need a Splunk Universal Forwarder on each endpoint from which you want to collect data.",
            "icon": "ES_Use_Case.png",
            "id": "windows_security_account_manager_stopped",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "",
            "known_false_positives": "SAM is a critical windows service, stopping it would cause major issues on an endpoint this makes false positive rare. AlthoughNo false positives have been identified.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "summariesonly=false allow_old_summaries=true",
                    "description": "search data model's summaries only",
                    "name": "security_content_summariesonly"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "windows_security_account_manager_stopped_filter"
                }
            ],
            "mitre_sub_technique": "T1489",
            "mitre_tactic": "TA0040",
            "mitre_tactic_display": "Impact",
            "mitre_technique": "T1489",
            "mitre_threat_groups": "Lazarus Group",
            "name": "Windows Security Account Manager Stopped",
            "references": [],
            "released": "2020-11-06",
            "search": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes WHERE (\"Processes.process_name\"=\"net*.exe\" \"Processes.process\"=\"*stop \\\"samss\\\"*\") BY \"Processes.dest\", \"Processes.user\", \"Processes.process\" | `drop_dm_object_name(Processes)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `windows_security_account_manager_stopped_filter`",
            "search_name": "ESCU - Windows Security Account Manager Stopped - Rule",
            "story": "507edc74-13d5-4339-878e-b9744ded1f35",
            "tags": {
                "analytics_story": [
                    "Ryuk Ransomware"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 8"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/ryuk/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Delivery"
                ],
                "mitre_attack_groups": [
                    "Lazarus Group"
                ],
                "mitre_attack_id": [
                    "T1489"
                ],
                "mitre_attack_tactics": [
                    "Impact"
                ],
                "mitre_attack_technique": [
                    "Service Stop"
                ],
                "nist": [
                    "PR.PT",
                    "DE.CM"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Security Monitoring",
            "version": 1
        },
        "wmi_permanent_event_subscription": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious WMI Use",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=wmi_permanent_event_subscription",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": "",
            "date": "2018-10-23",
            "description": "This search looks for the creation of WMI permanent event subscriptions.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting the Windows WMI activity logs. This can be done by adding a stanza to inputs.conf on the system generating logs with a title of [WinEventLog://Microsoft-Windows-WMI-Activity/Operational].",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting the Windows WMI activity logs. This can be done by adding a stanza to inputs.conf on the system generating logs with a title of [WinEventLog://Microsoft-Windows-WMI-Activity/Operational].",
            "icon": "ES_Use_Case.png",
            "id": "wmi_permanent_event_subscription",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Although unlikely, administrators may use event subscriptions for legitimate purposes.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=\"wineventlog:microsoft-windows-wmi-activity/operational\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wmi"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "wmi_permanent_event_subscription_filter"
                }
            ],
            "mitre_sub_technique": "T1047",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1047",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Frankenstein|APT41|FIN6|Soft Cell|APT32|MuddyWater|OilRig|Threat Group-3390|FIN8|Leviathan|menuPass|Stealth Falcon|Lazarus Group|APT29|Deep Panda",
            "name": "WMI Permanent Event Subscription",
            "references": [],
            "released": "2018-10-23",
            "search": "`wmi` EventCode=5861 Binding | rex field=Message \"Consumer =\\s+(?<consumer>[^;|^$]+)\" | search consumer!=\"NTEventLogEventConsumer=\\\"SCM Event Log Consumer\\\"\" | stats count min(_time) as firstTime max(_time) as lastTime by ComputerName, consumer, Message | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | rename ComputerName as dest | `wmi_permanent_event_subscription_filter`",
            "search_name": "ESCU - WMI Permanent Event Subscription - Rule",
            "story": "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "tags": {
                "analytics_story": [
                    "Suspicious WMI Use"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 5"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT41",
                    "FIN6",
                    "Soft Cell",
                    "APT32",
                    "MuddyWater",
                    "OilRig",
                    "Threat Group-3390",
                    "FIN8",
                    "Leviathan",
                    "menuPass",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1047"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Management Instrumentation"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        },
        "wmi_permanent_event_subscription_-_sysmon": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious WMI Use",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=wmi_permanent_event_subscription_-_sysmon",
            "data_source_categories": "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET03ProcessLaunchwithCLI|DS009EndPointIntel-ET04ProcessLaunchWithHash",
            "datamodel": "",
            "dataset": [
                "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.003/atomic_red_team/windows-sysmon.log"
            ],
            "date": "2020-12-08",
            "description": "This search looks for the creation of WMI permanent event subscriptions.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be collecting Sysmon data using Sysmon version 6.1 or greater and have Sysmon configured to generate alerts for WMI activity. In addition, you must have at least version 6.0.4 of the Sysmon TA installed to properly parse the fields.",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be collecting Sysmon data using Sysmon version 6.1 or greater and have Sysmon configured to generate alerts for WMI activity. In addition, you must have at least version 6.0.4 of the Sysmon TA installed to properly parse the fields.",
            "icon": "ES_Use_Case.png",
            "id": "wmi_permanent_event_subscription_-_sysmon",
            "includeSSE": "Yes",
            "journey": "Stage_3",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Although unlikely, administrators may use event subscriptions for legitimate purposes.",
            "lookups": "",
            "macros": [
                {
                    "definition": "sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "sysmon"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "wmi_permanent_event_subscription___sysmon_filter"
                }
            ],
            "mitre_sub_technique": "T1546.003",
            "mitre_tactic": "TA0004|TA0003",
            "mitre_tactic_display": "Privilege Escalation|Persistence",
            "mitre_technique": "T1546",
            "mitre_threat_groups": "APT33|Blue Mockingbird|Turla|Leviathan|APT29",
            "name": "WMI Permanent Event Subscription - Sysmon",
            "references": [],
            "released": "2020-12-08",
            "search": "`sysmon` EventCode=21 | rename host as dest | table _time, dest, user, Operation, EventType, Query, Consumer, Filter | `wmi_permanent_event_subscription___sysmon_filter`",
            "search_name": "ESCU - WMI Permanent Event Subscription - Sysmon - Rule",
            "story": "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "tags": {
                "analytics_story": [
                    "Suspicious WMI Use"
                ],
                "asset_type": "Endpoint",
                "automated_detection_testing": "passed",
                "cis20": [
                    "CIS 3",
                    "CIS 5"
                ],
                "dataset": [
                    "https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.003/atomic_red_team/windows-sysmon.log"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "APT33",
                    "Blue Mockingbird",
                    "Turla",
                    "Leviathan",
                    "APT29"
                ],
                "mitre_attack_id": [
                    "T1546"
                ],
                "mitre_attack_tactics": [
                    "Privilege Escalation",
                    "Persistence"
                ],
                "mitre_attack_technique": [
                    "Windows Management Instrumentation Event Subscription"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 2
        },
        "wmi_temporary_event_subscription": {
            "SPLEase": "None",
            "alertvolume": "None",
            "analytic_story": "Suspicious WMI Use",
            "app": "Enterprise_Security_Content_Update",
            "asset_type": "Endpoint",
            "author": "Rico Valdez, Splunk",
            "baselines": "",
            "category": "Adversary Tactics|",
            "dashboard": "showcase_security_content?showcaseId=wmi_temporary_event_subscription",
            "data_source_categories": "VendorSpecific-winsec",
            "datamodel": "",
            "dataset": "",
            "date": "2018-10-23",
            "description": "This search looks for the creation of WMI temporary event subscriptions.",
            "displayapp": "Enterprise Security Content Update",
            "domain": "Threat",
            "escu_cis": "CIS 3|CIS 5",
            "escu_nist": "PR.PT|PR.AT|PR.AC|PR.IP",
            "hasSearch": "Yes",
            "help": "To successfully implement this search, you must be ingesting the Windows WMI activity logs. This can be done by adding a stanza to inputs.conf on the system generating logs with a title of [WinEventLog://Microsoft-Windows-WMI-Activity/Operational].",
            "highlight": "No",
            "how_to_implement": "To successfully implement this search, you must be ingesting the Windows WMI activity logs. This can be done by adding a stanza to inputs.conf on the system generating logs with a title of [WinEventLog://Microsoft-Windows-WMI-Activity/Operational].",
            "icon": "ES_Use_Case.png",
            "id": "wmi_temporary_event_subscription",
            "includeSSE": "Yes",
            "journey": "Stage_1",
            "killchain": "Actions On Objectives",
            "known_false_positives": "Some software may create WMI temporary event subscriptions for various purposes. The included search contains an exception for two of these that occur by default on Windows 10 systems. You may need to modify the search to create exceptions for other legitimate events.",
            "lookups": "",
            "macros": [
                {
                    "arguments": [
                        "field"
                    ],
                    "definition": "convert timeformat=\"%Y-%m-%dT%H:%M:%S\" ctime($field$)",
                    "description": "convert epoch time to string",
                    "name": "security_content_ctime"
                },
                {
                    "definition": "sourcetype=\"wineventlog:microsoft-windows-wmi-activity/operational\"",
                    "description": "customer specific splunk configurations(eg- index, source, sourcetype). Replace the macro definition with configurations for your Splunk Environmnent.",
                    "name": "wmi"
                },
                {
                    "definition": "search *",
                    "description": "Update this macro to limit the output results to filter out false positives. ",
                    "name": "wmi_temporary_event_subscription_filter"
                }
            ],
            "mitre_sub_technique": "T1047",
            "mitre_tactic": "TA0002",
            "mitre_tactic_display": "Execution",
            "mitre_technique": "T1047",
            "mitre_threat_groups": "Blue Mockingbird|Wizard Spider|Frankenstein|APT41|FIN6|Soft Cell|APT32|MuddyWater|OilRig|Threat Group-3390|FIN8|Leviathan|menuPass|Stealth Falcon|Lazarus Group|APT29|Deep Panda",
            "name": "WMI Temporary Event Subscription",
            "references": [],
            "released": "2018-10-23",
            "search": "`wmi` EventCode=5860 Temporary | rex field=Message \"NotificationQuery =\\s+(?<query>[^;|^$]+)\" | search query!=\"SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = 'wsmprovhost.exe'\" AND query!=\"SELECT * FROM __InstanceOperationEvent WHERE TargetInstance ISA 'AntiVirusProduct' OR TargetInstance ISA 'FirewallProduct' OR TargetInstance ISA 'AntiSpywareProduct'\" | stats count min(_time) as firstTime max(_time) as lastTime by ComputerName, query  | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `wmi_temporary_event_subscription_filter`",
            "search_name": "ESCU - WMI Temporary Event Subscription - Rule",
            "story": "c8ddc5be-69bc-4202-b3ab-4010b27d7ad5",
            "tags": {
                "analytics_story": [
                    "Suspicious WMI Use"
                ],
                "asset_type": "Endpoint",
                "cis20": [
                    "CIS 3",
                    "CIS 5"
                ],
                "kill_chain_phases": [
                    "Actions on Objectives"
                ],
                "mitre_attack_groups": [
                    "Blue Mockingbird",
                    "Wizard Spider",
                    "Frankenstein",
                    "APT41",
                    "FIN6",
                    "Soft Cell",
                    "APT32",
                    "MuddyWater",
                    "OilRig",
                    "Threat Group-3390",
                    "FIN8",
                    "Leviathan",
                    "menuPass",
                    "Stealth Falcon",
                    "Lazarus Group",
                    "APT29",
                    "Deep Panda"
                ],
                "mitre_attack_id": [
                    "T1047"
                ],
                "mitre_attack_tactics": [
                    "Execution"
                ],
                "mitre_attack_technique": [
                    "Windows Management Instrumentation"
                ],
                "nist": [
                    "PR.PT",
                    "PR.AT",
                    "PR.AC",
                    "PR.IP"
                ],
                "security_domain": "endpoint"
            },
            "usecase": "Advanced Threat Detection",
            "version": 1
        }
    }
}